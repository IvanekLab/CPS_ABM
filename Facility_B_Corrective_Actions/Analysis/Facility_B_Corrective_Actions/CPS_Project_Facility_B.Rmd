---
title: "CPS_Project_Facility_B"
author: "Cecil W. Barnett-Neefs"
date: "20/02/2020"
output: pdf_document
---

```{r setup}
#Packages
#Uncomment installation if missing packages
# install.packages('corrplot')
# install.packages('data.table')
# install.packages('DescTools')
# install.packages('dplyr')
# install.packages('epiR')
# install.packages('FactoMineR')
# install.packages('factoextra')
# install.packages('GGally')
# install.packages('ggplot2')
# install.packages('ggpubr')
# install.packages('grid')
# install.packages('gridExtra')
# install.packages('Hmisc')
# install.packages('matrixStats')
# install.packages('readxl')
# install.packages('reshape2')
# install.packages('sensitivity')
# install.packages('stringr')
# install.packages('survival')
# install.packages('vioplot')
library(corrplot)
library(data.table)
library(DescTools)
library(dplyr)
library(epiR)
library(FactoMineR)
library(factoextra)
library(GGally)
library(ggplot2)
library(ggpubr)
library(grid)
library(gridExtra)
library(Hmisc)
library(matrixStats)
library(readxl)
library(reshape2)
library(sensitivity)
library(stringr)
library(survival)
library(vioplot)

f_mode <- function(x) { 
  ta = table(x)
  tam = max(ta)
  #If all values appeared with the same frequency (i.e. no mod), return NA
  if (all(ta == tam)) {
    mod = NA
  }
  #Else if there is an "outlier", return that
  else {
    if(is.numeric(x)) {
      mod = as.numeric(names(ta)[ta == tam])
    }
    else {
      mod = names(ta)[ta == tam]
    }
  }
  return(mod)
}

vector_splitter <- function(x) {
  return(t(as.matrix(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(x)), "\\s+")[[1]])))))
}
```

```{r create Cluster Data}
cluster_table <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-11-22-49 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Baseline-table.csv'), skip = 6, sep = ",", header = TRUE)
cluster_table <- cluster_table[cluster_table$scenario==0,]

while (any(grepl('-', names(cluster_table), fixed = TRUE))) {
  cluster_table <- cluster_table %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(cluster_table), fixed = TRUE))) {
  cluster_table <- cluster_table %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(cluster_table), fixed = TRUE))) {
  cluster_table <- cluster_table %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(cluster_table), fixed = TRUE))) {
  cluster_table <- cluster_table %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('concentration_list','time_contaminated_list','max_contam_bout_list','contacts_list','transfers_list','temp_niche_list','niches_estab_list','food_cont_list','zone4_cont_list','random_cont_list','random_event_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

cluster_table <- cluster_table[ , ..list_columns]


vector <- cluster_table$concentration_list
vector <- vector[vector!='[]']
cluster_concentration_list <- do.call('rbind',lapply(vector, vector_splitter))
cluster_contamination_probability <- colSums(cluster_concentration_list > 0)/length(cluster_concentration_list[,1])
cluster_concentration_list_mean <- base::colMeans(cluster_concentration_list, na.rm = TRUE)
cluster_concentration_list_median <- matrixStats::colMedians(cluster_concentration_list, na.rm = TRUE)
cluster_concentration_list[cluster_concentration_list==0] <- NA
cluster_concentration_list_mean_filtered <- base::colMeans(cluster_concentration_list, na.rm = TRUE)
cluster_concentration_list_median_filtered <- matrixStats::colMedians(cluster_concentration_list, na.rm = TRUE)

vector <- cluster_table$time_contaminated_list
vector <- vector[vector!='[]']
cluster_time_contaminated_list <- do.call('rbind',lapply(vector, vector_splitter))
# cluster_time_contaminated_list[cluster_time_contaminated_list==0] <- NA
cluster_time_contaminated_list_mean <- base::colMeans(cluster_time_contaminated_list, na.rm = TRUE)
cluster_time_contaminated_list_median <- matrixStats::colMedians(cluster_time_contaminated_list, na.rm = TRUE)

vector <- cluster_table$max_contam_bout_list
vector <- vector[vector!='[]']
cluster_max_contam_bout_list <- do.call('rbind',lapply(vector, vector_splitter))
# cluster_max_contam_bout_list[cluster_max_contam_bout_list==0] <- NA
cluster_max_contam_bout_list_mean <- base::colMeans(cluster_max_contam_bout_list, na.rm = TRUE)
cluster_max_contam_bout_list_median <- matrixStats::colMedians(cluster_max_contam_bout_list, na.rm = TRUE)

vector <- cluster_table$contacts_list
vector <- vector[vector!='[]']
cluster_contacts_list <- do.call('rbind',lapply(vector, vector_splitter))
# cluster_contacts_list[cluster_contacts_list==0] <- NA
cluster_contacts_list_mean <- base::colMeans(cluster_contacts_list, na.rm = TRUE)
cluster_contacts_list_median <- matrixStats::colMedians(cluster_contacts_list, na.rm = TRUE)

vector <- cluster_table$transfers_list
vector <- vector[vector!='[]']
cluster_transfers_list <- do.call('rbind',lapply(vector, vector_splitter))
cluster_transfers_probability <- colSums(cluster_transfers_list > 0)/length(cluster_transfers_list[,1])
cluster_transfers_list_mean <- base::colMeans(cluster_transfers_list)
cluster_transfers_list_median <- matrixStats::colMedians(cluster_transfers_list)
cluster_transfers_list[cluster_transfers_list==0] <- NA
cluster_transfers_mean_filtered <- base::colMeans(cluster_transfers_list, na.rm = TRUE)
cluster_transfers_median_filtered <- matrixStats::colMedians(cluster_transfers_list, na.rm = TRUE)

vector <- cluster_table$temp_niche_list
vector <- vector[vector!='[]']
cluster_temp_niche_list <- do.call('rbind',lapply(vector, vector_splitter))
# cluster_temp_niche_list[cluster_temp_niche_list==0] <- NA
cluster_temp_niche_list_mean <- base::colMeans(cluster_temp_niche_list, na.rm = TRUE)
cluster_temp_niche_list_median <- matrixStats::colMedians(cluster_temp_niche_list, na.rm = TRUE)

vector <- cluster_table$niches_estab_list
vector <- vector[vector!='[]']
cluster_niches_estab_list <- do.call('rbind',lapply(vector, vector_splitter))
# cluster_niches_estab_list[cluster_niches_estab_list==0] <- NA
cluster_niches_estab_list_mean <- base::colMeans(cluster_niches_estab_list, na.rm = TRUE)
cluster_niches_estab_list_median <- matrixStats::colMedians(cluster_niches_estab_list, na.rm = TRUE)

vector <- cluster_table$food_cont_list
vector <- vector[vector!='[]']
cluster_food_cont_list <- do.call('rbind',lapply(vector, vector_splitter))
# cluster_food_cont_list[cluster_food_cont_list==0] <- NA
cluster_food_cont_list_mean <- base::colMeans(cluster_food_cont_list, na.rm = TRUE)
cluster_food_cont_list_median <- matrixStats::colMedians(cluster_food_cont_list, na.rm = TRUE)

vector <- cluster_table$zone4_cont_list
vector <- vector[vector!='[]']
cluster_zone4_cont_list <- do.call('rbind',lapply(vector, vector_splitter))
# cluster_zone4_cont_list[cluster_zone4_cont_list==0] <- NA
cluster_zone4_cont_list_mean <- base::colMeans(cluster_zone4_cont_list, na.rm = TRUE)
cluster_zone4_cont_list_median <- matrixStats::colMedians(cluster_zone4_cont_list, na.rm = TRUE)

vector <- cluster_table$random_cont_list
vector <- vector[vector!='[]']
cluster_random_cont_list <- do.call('rbind',lapply(vector, vector_splitter))
# cluster_random_cont_list[cluster_random_cont_list==0] <- NA
cluster_random_cont_list_mean <- base::colMeans(cluster_random_cont_list, na.rm = TRUE)
cluster_random_cont_list_median <- matrixStats::colMedians(cluster_random_cont_list, na.rm = TRUE)

# vector <- cluster_table$random_event_list
# vector <- vector[vector!='[]']
# cluster_random_event_list <- do.call('rbind',lapply(vector, vector_splitter))
# cluster_contacts_list_mean <- base::colMeans(cluster_contacts_list)
# cluster_contacts_list_median <- matrixStats::colMedians(cluster_contacts_list)

vector <- cluster_table$cluster_conc_mid_mon_list
vector <- vector[vector!='[]']
cluster_cluster_conc_mid_mon_list <- do.call('rbind',lapply(vector, vector_splitter))
cluster_contamination_mon_probability <- colSums(cluster_cluster_conc_mid_mon_list > 0)/length(cluster_cluster_conc_mid_mon_list[,1])
cluster_cluster_conc_mid_mon_list_mean <- base::colMeans(cluster_cluster_conc_mid_mon_list)
cluster_cluster_conc_mid_mon_list_median <- matrixStats::colMedians(cluster_cluster_conc_mid_mon_list)
cluster_cluster_conc_mid_mon_list[cluster_cluster_conc_mid_mon_list==0] <- NA
cluster_conc_mid_mon_mean_filtered <- base::colMeans(cluster_cluster_conc_mid_mon_list, na.rm = TRUE)
cluster_conc_mid_mon_median_filtered <- matrixStats::colMedians(cluster_cluster_conc_mid_mon_list, na.rm = TRUE)

vector <- cluster_table$cluster_conc_mid_tue_list
vector <- vector[vector!='[]']
cluster_cluster_conc_mid_tue_list <- do.call('rbind',lapply(vector, vector_splitter))
cluster_contamination_tue_probability <- colSums(cluster_cluster_conc_mid_tue_list > 0)/length(cluster_cluster_conc_mid_tue_list[,1])
cluster_cluster_conc_mid_tue_list_mean <- base::colMeans(cluster_cluster_conc_mid_tue_list)
cluster_cluster_conc_mid_tue_list_median <- matrixStats::colMedians(cluster_cluster_conc_mid_tue_list)
cluster_cluster_conc_mid_tue_list[cluster_cluster_conc_mid_tue_list==0] <- NA
cluster_conc_mid_tue_mean_filtered <- base::colMeans(cluster_cluster_conc_mid_tue_list, na.rm = TRUE)
cluster_conc_mid_tue_median_filtered <- matrixStats::colMedians(cluster_cluster_conc_mid_tue_list, na.rm = TRUE)

vector <- cluster_table$cluster_conc_mid_wed_list
vector <- vector[vector!='[]']
cluster_cluster_conc_mid_wed_list <- do.call('rbind',lapply(vector, vector_splitter))
cluster_contamination_wed_probability <- colSums(cluster_cluster_conc_mid_wed_list > 0)/length(cluster_cluster_conc_mid_wed_list[,1])
cluster_cluster_conc_mid_wed_list_mean <- base::colMeans(cluster_cluster_conc_mid_wed_list)
cluster_cluster_conc_mid_wed_list_median <- matrixStats::colMedians(cluster_cluster_conc_mid_wed_list)
cluster_cluster_conc_mid_wed_list[cluster_cluster_conc_mid_wed_list==0] <- NA
cluster_conc_mid_wed_mean_filtered <- base::colMeans(cluster_cluster_conc_mid_wed_list, na.rm = TRUE)
cluster_conc_mid_wed_median_filtered <- matrixStats::colMedians(cluster_cluster_conc_mid_wed_list, na.rm = TRUE)

vector <- cluster_table$cluster_conc_mid_thu_list
vector <- vector[vector!='[]']
cluster_cluster_conc_mid_thu_list <- do.call('rbind',lapply(vector, vector_splitter))
cluster_contamination_thu_probability <- colSums(cluster_cluster_conc_mid_thu_list > 0)/length(cluster_cluster_conc_mid_thu_list[,1])
cluster_cluster_conc_mid_thu_list_mean <- base::colMeans(cluster_cluster_conc_mid_thu_list)
cluster_cluster_conc_mid_thu_list_median <- matrixStats::colMedians(cluster_cluster_conc_mid_thu_list)
cluster_cluster_conc_mid_thu_list[cluster_cluster_conc_mid_thu_list==0] <- NA
cluster_conc_mid_thu_mean_filtered <- base::colMeans(cluster_cluster_conc_mid_thu_list, na.rm = TRUE)
cluster_conc_mid_thu_median_filtered <- matrixStats::colMedians(cluster_cluster_conc_mid_thu_list, na.rm = TRUE)

vector <- cluster_table$cluster_conc_mid_fri_list
vector <- vector[vector!='[]']
cluster_cluster_conc_mid_fri_list <- do.call('rbind',lapply(vector, vector_splitter))
cluster_contamination_fri_probability <- colSums(cluster_cluster_conc_mid_fri_list > 0)/length(cluster_cluster_conc_mid_fri_list[,1])
cluster_cluster_conc_mid_fri_list_mean <- base::colMeans(cluster_cluster_conc_mid_fri_list)
cluster_cluster_conc_mid_fri_list_median <- matrixStats::colMedians(cluster_cluster_conc_mid_fri_list)
cluster_cluster_conc_mid_fri_list[cluster_cluster_conc_mid_fri_list==0] <- NA
cluster_conc_mid_fri_mean_filtered <- base::colMeans(cluster_cluster_conc_mid_fri_list, na.rm = TRUE)
cluster_conc_mid_fri_median_filtered <- matrixStats::colMedians(cluster_cluster_conc_mid_fri_list, na.rm = TRUE)

cluster_dataset <- as.data.frame(cbind(
  cluster_concentration_list_mean,
  cluster_concentration_list_median,
  cluster_concentration_list_mean_filtered,
  cluster_concentration_list_median_filtered,
  cluster_contamination_probability,
  
  cluster_time_contaminated_list_mean,
  cluster_time_contaminated_list_median,
  
  cluster_max_contam_bout_list_mean,
  cluster_max_contam_bout_list_median,
  
  cluster_contacts_list_mean,
  cluster_contacts_list_median,
  
  cluster_transfers_list_mean,
  cluster_transfers_list_median,
  
  cluster_temp_niche_list_mean,
  cluster_temp_niche_list_median,
  
  cluster_niches_estab_list_mean,
  cluster_niches_estab_list_median,
  
  cluster_food_cont_list_mean,
  cluster_food_cont_list_median,
  
  cluster_zone4_cont_list_mean,
  cluster_zone4_cont_list_median,
  
  cluster_random_cont_list_mean,
  cluster_random_cont_list_median,
  
  cluster_cluster_conc_mid_mon_list_mean,
  cluster_cluster_conc_mid_mon_list_median,
  cluster_conc_mid_mon_mean_filtered,
  cluster_conc_mid_mon_median_filtered,
  cluster_contamination_mon_probability,
  
  cluster_cluster_conc_mid_tue_list_mean,
  cluster_cluster_conc_mid_tue_list_median,
  cluster_conc_mid_tue_mean_filtered,
  cluster_conc_mid_tue_median_filtered,
  cluster_contamination_tue_probability,
  
  cluster_cluster_conc_mid_wed_list_mean,
  cluster_cluster_conc_mid_wed_list_median,
  cluster_conc_mid_wed_mean_filtered,
  cluster_conc_mid_wed_median_filtered,
  cluster_contamination_wed_probability,
  
  cluster_cluster_conc_mid_thu_list_mean,
  cluster_cluster_conc_mid_thu_list_median,
  cluster_conc_mid_thu_mean_filtered,
  cluster_conc_mid_thu_median_filtered,
  cluster_contamination_thu_probability,
  
  cluster_cluster_conc_mid_fri_list_mean,
  cluster_cluster_conc_mid_fri_list_median,
  cluster_conc_mid_fri_mean_filtered,
  cluster_conc_mid_fri_median_filtered,
  cluster_contamination_fri_probability
))
names(cluster_dataset) <- c(cbind(
  'concentration_mean',
  'concentration_median',
  'concentration_mean_filtered',
  'concentration_median_filtered',
  'prob_contamination',
  
  'time_contaminated_mean',
  'time_contaminated_median',
  
  'max_contam_bout_mean',
  'max_contam_bout_median',
  
  'contacts_mean',
  'contacts_median',
  
  'transfers_mean',
  'transfers_median',
  
  'temp_niche_mean',
  'temp_niche_median',
  
  'niches_estab_mean',
  'niches_estab_median',
  
  'food_cont_mean',
  'food_cont_median',
  
  'zone4_cont_mean',
  'zone4_cont_median',
  
  'random_cont_mean',
  'random_cont_median',
  
  'conc_mid_mon_mean',
  'conc_mid_mon_median',
  'conc_mid_mon_mean_filtered',
  'conc_mid_mon_median_filtered',
  'prob_cont_mon',
  
  'conc_mid_tue_mean',
  'conc_mid_tue_median',
  'conc_mid_tue_mean_filtered',
  'conc_mid_tue_median_filtered',
  'prob_cont_tue',
  
  'conc_mid_wed_mean',
  'conc_mid_wed_median',
  'conc_mid_wed_mean_filtered',
  'conc_mid_wed_median_filtered',
  'prob_cont_wed',
  
  'conc_mid_thu_mean',
  'conc_mid_thu_median',
  'conc_mid_thu_mean_filtered',
  'conc_mid_thu_median_filtered',
  'prob_cont_thu',
  
  'conc_mid_fri_mean',
  'conc_mid_fri_median',
  'conc_mid_fri_mean_filtered',
  'conc_mid_fri_median_filtered',
  'prob_cont_fri'))


# names(cluster_dataset) <- c(cbind('concentration_list_mean','concentration_list_median','contamination_probability','time_contaminated_list_mean','time_contaminated_list_median','max_contam_bout_list_mean','max_contam_bout_list_median','contacts_list_mean','contacts_list_median','transfers_list_mean','transfers_list_median','temp_niche_list_mean','temp_niche_list_median','niches_estab_list_mean','niches_estab_list_median','food_cont_list_mean','food_cont_list_median','zone4_cont_list_mean','zone4_cont_list_median','random_cont_list_mean','random_cont_list_median','conc_mid_mon_list_mean','conc_mid_mon_list_median','conc_mid_tue_list_mean','conc_mid_tue_list_median','conc_mid_wed_list_mean','conc_mid_wed_list_median','conc_mid_thu_list_mean','conc_mid_thu_list_median','conc_mid_fri_list_mean','conc_mid_fri_list_median','conc_mid_mon_median_list_median','conc_mid_tue_median_list_median','conc_mid_wed_median_list_median','conc_mid_thu_median_list_median','conc_mid_fri_median_list_median','conc_mid_mon_mean_list_mean','conc_mid_tue_mean_list_mean','conc_mid_wed_mean_list_mean','conc_mid_thu_mean_list_mean','conc_mid_fri_mean_list_mean','cluster_contamination_mon_probability','cluster_contamination_tue_probability','cluster_contamination_wed_probability','cluster_contamination_thu_probability','cluster_contamination_fri_probability'))

write.csv(cluster_dataset,paste0(getwd(),'/Data/Cluster Data Averages.csv'), row.names = FALSE)
```

```{r import Baseline}
NL_table <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-11-22-49 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Baseline-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table <- NL_table[NL_table$scenario==0,]

while (any(grepl('-', names(NL_table), fixed = TRUE))) {
  NL_table <- NL_table %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table), fixed = TRUE))) {
  NL_table <- NL_table %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table), fixed = TRUE))) {
  NL_table <- NL_table %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table), fixed = TRUE))) {
  NL_table <- NL_table %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table[ , ..list_columns]

NL_table[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table <- as.data.frame(NL_table)

NL_table[NL_table==-1] <- NA

NL_table <- subset(NL_table, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table)[names(NL_table)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table)[names(NL_table)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table$loading_w2wed_conc_list
vector <- vector[vector!='[]']
baseline_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_loading_w2wed_conc_list <- append(baseline_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
baseline_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_cleaning_w2wed_conc_list <- append(baseline_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table$drying_w2wed_conc_list
vector <- vector[vector!='[]']
baseline_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_drying_w2wed_conc_list <- append(baseline_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
baseline_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_sorting_w2wed_conc_list <- append(baseline_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
baseline_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_tray_packing_w2wed_conc_list <- append(baseline_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table$reject_w2wed_conc_list
vector <- vector[vector!='[]']
baseline_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_reject_w2wed_conc_list <- append(baseline_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table$other_w2wed_conc_list
vector <- vector[vector!='[]']
baseline_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_other_w2wed_conc_list <- append(baseline_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table$z1_w2wed_conc_list[order(NL_table$local_seed)]
vector <- vector[vector!='[]']
baseline_z1_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_z1_w2wed_conc_list <- append(baseline_z1_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table$z1_w2wed_conc_list[order(NL_table$local_seed)]
vector <- vector[vector!='[]']
baseline_z2_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_z2_w2wed_conc_list <- append(baseline_z2_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table$z3_w2wed_conc_list[order(NL_table$local_seed)]
vector <- vector[vector!='[]']
baseline_z3_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_z3_w2wed_conc_list <- append(baseline_z3_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

baseline_loading_concs <- as.data.frame(baseline_loading_w2wed_conc_list)
baseline_loading_concs$area <- as.factor('loading')
baseline_loading_concs$scenario <- as.factor('Baseline')
baseline_loading_concs$water <- as.factor('Wet')
names(baseline_loading_concs) <- c('concentration','area','scenario','water')

baseline_cleaning_concs <- as.data.frame(baseline_cleaning_w2wed_conc_list)
baseline_cleaning_concs$area <- as.factor('cleaning')
baseline_cleaning_concs$scenario <- as.factor('Baseline')
baseline_cleaning_concs$water <- as.factor('Wet')
names(baseline_cleaning_concs) <- c('concentration','area','scenario','water')

baseline_sorting_concs <- as.data.frame(baseline_sorting_w2wed_conc_list)
baseline_sorting_concs$area <- as.factor('sorting')
baseline_sorting_concs$scenario <- as.factor('Baseline')
baseline_sorting_concs$water <- as.factor('Dry')
names(baseline_sorting_concs) <- c('concentration','area','scenario','water')

baseline_reject_concs <- as.data.frame(baseline_reject_w2wed_conc_list)
baseline_reject_concs$area <- as.factor('reject')
baseline_reject_concs$scenario <- as.factor('Baseline')
baseline_reject_concs$water <- as.factor('Dry')
names(baseline_reject_concs) <- c('concentration','area','scenario','water')

baseline_tray_packing_concs <- as.data.frame(baseline_tray_packing_w2wed_conc_list)
baseline_tray_packing_concs$area <- as.factor('tray packing')
baseline_tray_packing_concs$scenario <- as.factor('Baseline')
baseline_tray_packing_concs$water <- as.factor('Dry')
names(baseline_tray_packing_concs) <- c('concentration','area','scenario','water')

baseline_other_concs <- as.data.frame(baseline_other_w2wed_conc_list)
baseline_other_concs$area <- as.factor('other')
baseline_other_concs$scenario <- as.factor('Baseline')
baseline_other_concs$water <- as.factor('Dry')
names(baseline_other_concs) <- c('concentration','area','scenario','water')

baseline_concs <- rbind(baseline_loading_concs,baseline_cleaning_concs,baseline_sorting_concs,baseline_tray_packing_concs,baseline_reject_concs,baseline_other_concs)

baseline_loading_prev <- as.data.frame(NL_table$loading_w2wed_prev[order(NL_table$local_seed)])
baseline_loading_prev$area <- as.factor('loading')
baseline_loading_prev$scenario <- as.factor('Baseline')
baseline_loading_prev$water <- as.factor('Wet')
names(baseline_loading_prev) <- c('prevalence','area','scenario','water')

baseline_cleaning_prev <- as.data.frame(NL_table$cleaning_w2wed_prev[order(NL_table$local_seed)])
baseline_cleaning_prev$area <- as.factor('cleaning')
baseline_cleaning_prev$scenario <- as.factor('Baseline')
baseline_cleaning_prev$water <- as.factor('Wet')
names(baseline_cleaning_prev) <- c('prevalence','area','scenario','water')

baseline_sorting_prev <- as.data.frame(NL_table$sorting_w2wed_prev[order(NL_table$local_seed)])
baseline_sorting_prev$area <- as.factor('sorting')
baseline_sorting_prev$scenario <- as.factor('Baseline')
baseline_sorting_prev$water <- as.factor('Dry')
names(baseline_sorting_prev) <- c('prevalence','area','scenario','water')

baseline_reject_prev <- as.data.frame(NL_table$reject_w2wed_prev[order(NL_table$local_seed)])
baseline_reject_prev$area <- as.factor('reject')
baseline_reject_prev$scenario <- as.factor('Baseline')
baseline_reject_prev$water <- as.factor('Dry')
names(baseline_reject_prev) <- c('prevalence','area','scenario','water')

baseline_tray_packing_prev <- as.data.frame(NL_table$tray_packing_w2wed_prev[order(NL_table$local_seed)])
baseline_tray_packing_prev$area <- as.factor('tray packing')
baseline_tray_packing_prev$scenario <- as.factor('Baseline')
baseline_tray_packing_prev$water <- as.factor('Dry')
names(baseline_tray_packing_prev) <- c('prevalence','area','scenario','water')

baseline_other_prev <- as.data.frame(NL_table$other_w2wed_prev[order(NL_table$local_seed)])
baseline_other_prev$area <- as.factor('other')
baseline_other_prev$scenario <- as.factor('Baseline')
baseline_other_prev$water <- as.factor('Dry')
names(baseline_other_prev) <- c('prevalence','area','scenario','water')

baseline_prev <- rbind(baseline_loading_prev,baseline_cleaning_prev,baseline_sorting_prev,baseline_tray_packing_prev,baseline_reject_prev,baseline_other_prev)

baseline_wet_prev <- as.data.frame(baseline_loading_prev$prevalence*21/100+baseline_cleaning_prev$prevalence*28/100)/49*100
baseline_wet_prev$scenario <- as.factor('Baseline')
baseline_wet_prev$water <- as.factor('Wet')
names(baseline_wet_prev) <- c('prevalence','scenario','water')

baseline_dry_prev <- as.data.frame(baseline_sorting_prev$prevalence*20/100+baseline_reject_prev$prevalence*23/100+baseline_tray_packing_prev$prevalence*123/100+baseline_other_prev$prevalence*10/100)/176*100
baseline_dry_prev$scenario <- as.factor('Baseline')
baseline_dry_prev$water <- as.factor('Dry')
names(baseline_dry_prev) <- c('prevalence','scenario','water')

baseline_recombined_prev <- rbind(baseline_wet_prev, baseline_dry_prev)

baseline_z1_prev <- as.data.frame(NL_table$z1_w2wed_prev[order(NL_table$local_seed)])
baseline_z1_prev$zone <- as.factor('Z1')
baseline_z1_prev$scenario <- as.factor('Baseline')
names(baseline_z1_prev) <- c('prevalence','zone','scenario')

baseline_z2_prev <- as.data.frame(NL_table$z2_w2wed_prev[order(NL_table$local_seed)])
baseline_z2_prev$zone <- as.factor('Z2')
baseline_z2_prev$scenario <- as.factor('Baseline')
names(baseline_z2_prev) <- c('prevalence','zone','scenario')

baseline_z3_prev <- as.data.frame(NL_table$z3_w2wed_prev[order(NL_table$local_seed)])
baseline_z3_prev$zone <- as.factor('Z3')
baseline_z3_prev$scenario <- as.factor('Baseline')
names(baseline_z3_prev) <- c('prevalence','zone','scenario')

baseline_zone_prev <- rbind(baseline_z1_prev,baseline_z2_prev,baseline_z3_prev)

baseline_z1_concs <- as.data.frame(baseline_z1_w2wed_conc_list)
baseline_z1_concs$zone <- as.factor('Z1')
baseline_z1_concs$scenario <- as.factor('Baseline')
names(baseline_z1_concs) <- c('concentration','zone','scenario')

baseline_z2_concs <- as.data.frame(baseline_z2_w2wed_conc_list)
baseline_z2_concs$zone <- as.factor('Z2')
baseline_z2_concs$scenario <- as.factor('Baseline')
names(baseline_z2_concs) <- c('concentration','zone','scenario')

baseline_z3_concs <- as.data.frame(baseline_z3_w2wed_conc_list)
baseline_z3_concs$zone <- as.factor('Z3')
baseline_z3_concs$scenario <- as.factor('Baseline')
names(baseline_z3_concs) <- c('concentration','zone','scenario')

baseline_zone_concs <- rbind(baseline_z1_concs,baseline_z2_concs,baseline_z3_concs)
```

``` {r import validation site lists}
v_sites <- read_excel(paste0(getwd(),'/Data/Facility_B Historical Site Results.xlsx'))

#All samples were mid shift
header_monday <- c('Monday_01', 'Monday_02', 'Monday_03')
header_tuesday <- c('Tuesday_01', 'Tuesday_02', 'Tuesday_03')
header_wednesday <- c('Wednesday_01')
header_days <- c('Tuesday_01', 'Wednesday_01', 'Tuesday_02', 'Monday_01', 'Monday_02', 'Monday_03', 'Tuesday_03')

sites_monday <- as.data.frame(v_sites[header_monday])
sites_tuesday <- as.data.frame(v_sites[header_tuesday])
sites_wednesday <- as.data.frame(v_sites[header_wednesday])

sites_mid <- as.data.frame(v_sites[c(header_days)])

sites_cleaning_total <- as.data.frame(v_sites[which(v_sites$area=='cleaning'),c(header_days)])

sites_loading_total <- as.data.frame(v_sites[which(v_sites$area=='loading'),c(header_days)])

sites_reject_total <- as.data.frame(v_sites[which(v_sites$area=='reject'),c(header_days)])

sites_sorting_total <- as.data.frame(v_sites[which(v_sites$area=='sorting'),c(header_days)])

sites_tray_packing_total <- as.data.frame(v_sites[which(v_sites$area=='tray-packing'),c(header_days)])

sites_other_total <- as.data.frame(v_sites[which(v_sites$area=='crack'|v_sites$area=='drying'|v_sites$area=='overflow-packing'|v_sites$area=='qc'),c(header_days)])

sites_wet <- as.data.frame(v_sites[which(v_sites$area=='cleaning'|v_sites$area=='loading'),c(header_days)])

sites_dry <- as.data.frame(v_sites[which(v_sites$area=='sorting'|v_sites$area=='reject'|v_sites$area=='drying'|v_sites$area=='overflow-packing'|v_sites$area=='tray-packing'|v_sites$area=='qc'),c(header_days)])

sites_z1 <- as.data.frame(v_sites[which(v_sites$zone==1),c(header_days)])
sites_z2 <- as.data.frame(v_sites[which(v_sites$zone==2),c(header_days)])
sites_z3 <- as.data.frame(v_sites[which(v_sites$zone==3),c(header_days)])

sites_all <- as.data.frame(v_sites[,c(header_days)])

```

``` {r import Cluster Data}
agents <-  as.data.frame(read_excel(paste0(getwd(),'/Data/2021-04-18 Cluster Data.xlsx'), 
    n_max = 225))

agent_names <- c('control-panel','produce-crate-01','produce-crate-02','dumper-sandwich-juncture','drain-under-dumper','trench-drain-under-flume','dumper','flume','loading-track-01','loading-track-02','loading-track-03','loading-track-04','brush-bed-inspection','brush-bed-inspection-catch-pan','debris-chute-west','debris-chute-east','fan-rollers','roller-tubing','fan-rollers-catch-pan','flume-exit-rollers','fans','hot-fans','large-debris-filter','npw-bin','warm-fans','npw-belt','rot-trolley','rot-trolley-track','drain-under-cleaning','trench-drain-cleaning','waxer-support','roller-area-sponge-squeegee','npw-bin-feet','produce-crate-03','produce-crate-04','produce-crate-05','crate-filler-01','crate-filler-02','crate-filler-03','loader-belt-01','loader-belt-02','loader-belt-03','reject-belt-01','reject-belt-02','reject-loading-belt-01','reject-loading-belt-02','reject-loading-belt-03','small-produce-filter','small-produce-crate-feed','hot-room-belt','box-belt','box-sticker-printer-01','box-sticker-printer-02','box-sticker-printer-03','box-sticker-printer-04','box-sticker-printer-05','box-sticker-printer-06','box-sticker-printer-07','box-sticker-printer-08','box-sticker-printer-09','floormat-01','floormat-02','floormat-03','floormat-04','floormat-05','floormat-06','floormat-07','floormat-08','floormat-09','floormat-10','floormat-11','floormat-12','floormat-13','floormat-14','floormat-15','floormat-16','floormat-17','floormat-18','large-floormat','packing-belt-18','packing-belt-17','packing-belt-16','packing-belt-15','packing-belt-14','packing-belt-13','packing-belt-12','packing-belt-11','packing-belt-10','packing-belt-09','packing-belt-08','packing-belt-07','packing-belt-06','packing-belt-05','packing-belt-04','packing-belt-03','packing-belt-02','packing-belt-01','packing-roll-01','packing-roll-02','packing-roll-03','packing-roll-04','packing-roll-05','packing-roll-06','packing-roll-07','packing-roll-08','packing-roll-09','packing-roll-10','packing-roll-11','packing-roll-12','packing-roll-13','packing-roll-14','packing-roll-15','packing-roll-16','packing-roll-17','packing-roll-18','track-belt','compact-trolley','tray-belt-18','tray-belt-17','tray-belt-16','tray-belt-15','tray-belt-14','tray-belt-13','tray-belt-12','tray-belt-11','tray-belt-10','tray-belt-09','tray-belt-08','tray-belt-07','tray-belt-06','tray-belt-05','tray-belt-04','tray-belt-03','tray-belt-02','tray-belt-01','tray-storage-01','tray-storage-02','tray-storage-03','tray-storage-04','tray-storage-05','tray-storage-06','tray-storage-07','tray-storage-08','weigh-station-01','weigh-station-02','weigh-station-03','weigh-station-04','weigh-station-05','weigh-station-06','weigh-station-07','weigh-station-08','weigh-station-09','weigh-station-10','weigh-station-11','weigh-station-12','weigh-station-13','weigh-station-14','weigh-station-15','weigh-station-16','weigh-station-17','weigh-station-18','scanner','reject-belt-03','reject-belt-04','reject-belt-05','sorting-station','belt','produce-sticker-01','produce-sticker-02','workstation','forklift-01','forklift-02','employee-01','employee-02','employee-03','employee-04','employee-05','employee-06','employee-07','employee-08','employee-09','employee-10','employee-11','employee-12','employee-13','floor-crack','shovel','pressure-washer-frame','bin-filler-car','bin-car-juncture','main-drain-overflow-juncture','hot-room-flaps','floormat-19','floormat-20','flume-support-beam-lip-underneath','flume-support-beam-sandwich-juncture','railing-interior-by-rollers','outlet-pvc','yellow-sandwich-juncture-bin-fillers','stool','floormat-21','qc-table','monorail-pan-17','red-pallet-jack','under-cable-conduit-by-rollers','brooms-by-wet-rollers','trench-drain-drying','chemical-dolley','gray-roller-tape','return-belt-motor','compact-trolley-mat','under-sizer-platform','blue-brush-drop','floormat-22','light-stand','box-lift','wooden-box-stand','drain-by-dry-rollers','tray-trash-dolley','bin-filler-platform','bin-filler-control-panel','dls-taper-support','return-belt','flume-exterior','flume-support-frame')

row.names(agents) <- agent_names
agents$zone <- as.factor(agents$zone)
agents$equipment <- as.factor(agents$equipment)
agents$water <- as.factor(agents$water)
agents$concentration_mean <- suppressWarnings(as.numeric(agents$concentration_mean))
agents$concentration_median <- suppressWarnings(as.numeric(agents$concentration_median))
agents$concentration_mean_filtered <- suppressWarnings(as.numeric(agents$concentration_mean_filtered))
agents$concentration_median_filtered <- suppressWarnings(as.numeric(agents$concentration_median_filtered))
agents$conc_mid_mon_mean_filtered <- suppressWarnings(as.numeric(agents$conc_mid_mon_mean_filtered))
agents$conc_mid_mon_median_filtered <- suppressWarnings(as.numeric(agents$conc_mid_mon_median_filtered))
agents$conc_mid_tue_mean_filtered <- suppressWarnings(as.numeric(agents$conc_mid_tue_mean_filtered))
agents$conc_mid_tue_median_filtered <- suppressWarnings(as.numeric(agents$conc_mid_tue_median_filtered))
agents$conc_mid_wed_mean_filtered <- suppressWarnings(as.numeric(agents$conc_mid_wed_mean_filtered))
agents$conc_mid_wed_median_filtered <- suppressWarnings(as.numeric(agents$conc_mid_wed_median_filtered))
agents$conc_mid_thu_mean_filtered <- suppressWarnings(as.numeric(agents$conc_mid_thu_mean_filtered))
agents$conc_mid_thu_median_filtered <- suppressWarnings(as.numeric(agents$conc_mid_thu_median_filtered))
agents$conc_mid_fri_mean_filtered <- suppressWarnings(as.numeric(agents$conc_mid_fri_mean_filtered))
agents$conc_mid_fri_median_filtered <- suppressWarnings(as.numeric(agents$conc_mid_fri_median_filtered))
```

```{r Statistical Significance Validity Test}
#Midday/All
print('Midday')
pos <- length(which(sites_mid=='pos'))
total <- (length(which(sites_mid=='neg'))+length(which(sites_mid=='pos')))
modelMid <- (mean(NL_table$z_sample_mid_prev)/100)*total
prop.test(x=c(modelMid,pos), n=c(total,total), correct=FALSE)
neg <- total-pos
# cl_lower <- (pos/total)-(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(pos*neg))
# cl_upper <- (pos/total)+(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(pos*neg))
print('Validation Data')
print(round(binconf(pos,total)[1]*100,0))
print(round(binconf(pos,total)[2]*100,0))
print(round(binconf(pos,total)[3]*100,0))

neg <- total-modelMid
# cl_lower <- (modelMid/total)-(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(modelMid*neg))
# cl_upper <- (modelMid/total)+(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(modelMid*neg))
print('Model Data')
print(round(binconf(modelMid,total)[1]*100,0))
print(round(binconf(modelMid,total)[2]*100,0))
print(round(binconf(modelMid,total)[3]*100,0))

#Monday
# print('Monday')
# pos <- length(which(sites_monday=='pos'))
# total <- (length(which(sites_monday=='neg'))+length(which(sites_monday=='pos')))
# modelMon<-(mean(NL_table$m_z_prev[!is.na(NL_table$m_z_prev)])/100)*total
# prop.test(x=c(modelMon,pos), n=c(total,total), correct=FALSE)
# 
# #Tuesday
# print('Tuesday')
# pos <- length(which(sites_tuesday=='pos'))
# total <- (length(which(sites_tuesday=='neg'))+length(which(sites_tuesday=='pos')))
# modelTue<-(mean(NL_table$t_z_prev[!is.na(NL_table$t_z_prev)])/100)*total
# prop.test(x=c(modelTue,pos), n=c(total,total), correct=FALSE)
# # fisher.test(matrix(c(modelTue,total-modelTue,pos,total-pos),ncol=2))
# 
# #Wednesday
# print('Wednesday')
# pos <- length(which(sites_wednesday=='pos'))
# total <- (length(which(sites_wednesday=='neg'))+length(which(sites_wednesday=='pos')))
# modelWed <- (mean(NL_table$w_z_prev[!is.na(NL_table$w_z_prev)])/100)*total
# prop.test(x=c(modelWed,pos), n=c(total,total), correct=FALSE)
# fisher.test(matrix(c(modelWed,total-modelWed,pos,total-pos),ncol=2))
# 
# #Areas
# #Cleaning
# print('Cleaning')
# pos <- length(which(sites_cleaning_total=='pos'))
# total <- (length(which(sites_cleaning_total=='neg'))+length(which(sites_cleaning_total=='pos')))
# modelCleaning <- (mean(NL_table$cleaning_total_prev[!is.na(NL_table$cleaning_total_prev)])/100)*total
# prop.test(x=c(modelCleaning,pos), n=c(total,total), correct=FALSE)
# 
# #Loading
# print('Loading')
# pos <- length(which(sites_loading_total=='pos'))
# total <- (length(which(sites_loading_total=='neg'))+length(which(sites_loading_total=='pos')))
# modelLoading <- (mean(NL_table$loading_total_prev[!is.na(NL_table$loading_total_prev)])/100)*total
# prop.test(x=c(modelLoading,pos), n=c(total,total), correct=FALSE)
# 
# #Sorting
# print('Sorting')
# pos <- length(which(sites_sorting_total=='pos'))
# total <- (length(which(sites_sorting_total=='neg'))+length(which(sites_sorting_total=='pos')))
# modelSorting <- (mean(NL_table$sorting_total_prev[!is.na(NL_table$sorting_total_prev)])/100)*total
# prop.test(x=c(modelSorting,pos), n=c(total,total), correct=FALSE)
# fisher.test(matrix(c(modelSorting,total-modelSorting,pos,total-pos),ncol=2))
# 
# #Tray Packing
# print('Tray Packing')
# pos <- length(which(sites_tray_packing_total=='pos'))
# total <- (length(which(sites_tray_packing_total=='neg'))+length(which(sites_tray_packing_total=='pos')))
# modelTrayPacking <- (mean(NL_table$tray_packing_total_prev[!is.na(NL_table$tray_packing_total_prev)])/100)*total
# prop.test(x=c(modelTrayPacking,pos), n=c(total,total), correct=FALSE)
# fisher.test(matrix(c(modelTrayPacking,total-modelTrayPacking,pos,total-pos),ncol=2))
# 
# #Reject
# print('Reject')
# pos <- length(which(sites_reject_total=='pos'))
# total <- (length(which(sites_reject_total=='neg'))+length(which(sites_reject_total=='pos')))
# modelReject <- (mean(NL_table$reject_total_prev[!is.na(NL_table$reject_total_prev)])/100)*total
# prop.test(x=c(modelReject,pos), n=c(total,total), correct=FALSE)
# fisher.test(matrix(c(modelReject,total-modelReject,pos,total-pos),ncol=2))
# 
# #Other
# print('Other')
# pos <- length(which(sites_wet=='pos'))
# total <- (length(which(sites_wet=='neg'))+length(which(sites_wet=='pos')))
# modelOther <- (mean(NL_table$other_total_prev[!is.na(NL_table$other_total_prev)])/100)*total
# prop.test(x=c(modelOther,pos), n=c(total,total), correct=FALSE)
# fisher.test(matrix(c(modelOther,total-modelOther,pos,total-pos),ncol=2))

#Moisture
#Wet
print('Wet')
pos <- length(which(sites_wet=='pos'))
total <- (length(which(sites_wet=='neg'))+length(which(sites_wet=='pos')))
modelWet <- ((mean(c(NL_table$loading_total_prev,NL_table$cleaning_total_prev),na.rm = TRUE))/100)*total
prop.test(x=c(modelWet,pos), n=c(total,total), correct=FALSE)
# fisher.test(matrix(c(modelWet,total-modelWet,pos,total-pos),ncol=2))
neg <- total-pos
# cl_lower <- (pos/total)-(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(pos*neg))
# cl_upper <- (pos/total)+(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(pos*neg))
print('Validation Data')
print(round(binconf(pos,total)[1]*100,0))
print(round(binconf(pos,total)[2]*100,0))
print(round(binconf(pos,total)[3]*100,0))

neg <- total-modelWet
# cl_lower <- (modelWet/total)-(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(modelWet*neg))
# cl_upper <- (modelWet/total)+(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(modelWet*neg))
print('Model Data')
print(round(binconf(modelWet,total)[1]*100,0))
print(round(binconf(modelWet,total)[2]*100,0))
print(round(binconf(modelWet,total)[3]*100,0))

#Dry
print('Dry')
pos <- length(which(sites_dry=='pos'))
total <- (length(which(sites_dry=='neg'))+length(which(sites_dry=='pos')))
modelDry <- ((mean(c(NL_table$sorting_total_prev,NL_table$reject_total_prev,NL_table$tray_packing_total_prev,NL_table$reject_total_prev,NL_table$other_total_prev),na.rm = TRUE))/100)*total
prop.test(x=c(modelDry,pos), n=c(total,total), correct=FALSE)
# fisher.test(matrix(c(modelDry,total-modelDry,pos,total-pos),ncol=2))
neg <- total-pos
# cl_lower <- (pos/total)-(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(pos*neg))
# cl_upper <- (pos/total)+(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(pos*neg))
print('Validation Data')
print(round(binconf(pos,total)[1]*100,0))
print(round(binconf(pos,total)[2]*100,0))
print(round(binconf(pos,total)[3]*100,0))

neg <- total-modelDry
# cl_lower <- (modelDry/total)-(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(modelDry*neg))
# cl_upper <- (modelDry/total)+(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(modelDry*neg))
print('Model Data')
print(round(binconf(modelDry,total)[1]*100,0))
print(round(binconf(modelDry,total)[2]*100,0))
print(round(binconf(modelDry,total)[3]*100,0))

#Z Categories
#Z1
# print('Z1')
# pos <- length(which(sites_z1=='pos'))
# total <- (length(which(sites_z1=='neg'))+length(which(sites_z1=='pos')))
# modelZ1 <- (mean(NL_table$z1_prev[!is.na(NL_table$z1_prev)])/100)*total
# prop.test(x=c(modelZ1,pos), n=c(total,total), correct=FALSE)

#Z2
print('Z2')
pos <- length(which(sites_z2=='pos'))
total <- (length(which(sites_z2=='neg'))+length(which(sites_z2=='pos')))
modelZ2 <- (mean(NL_table$z2_prev[!is.na(NL_table$z2_prev)])/100)*total
prop.test(x=c(modelZ2,pos), n=c(total,total), correct=FALSE)
neg <- total-pos
# cl_lower <- (pos/total)-(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(pos*neg))
# cl_upper <- (pos/total)+(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(pos*neg))
print('Validation Data')
print(round(binconf(pos,total)[1]*100,0))
print(round(binconf(pos,total)[2]*100,0))
print(round(binconf(pos,total)[3]*100,0))

neg <- total-modelZ2
# cl_lower <- (modelZ2/total)-(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(modelZ2*neg))
# cl_upper <- (modelZ2/total)+(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(modelZ2*neg))
print('Model Data')
print(round(binconf(modelZ2,total)[1]*100,0))
print(round(binconf(modelZ2,total)[2]*100,0))
print(round(binconf(modelZ2,total)[3]*100,0))

#Z3
print('Z3')
pos <- length(which(sites_z3=='pos'))
total <- (length(which(sites_z3=='neg'))+length(which(sites_z3=='pos')))
modelZ3 <- (mean(NL_table$z3_prev[!is.na(NL_table$z3_prev)])/100)*total
prop.test(x=c(modelZ3,pos), n=c(total,total), correct=FALSE)
neg <- total-pos
# cl_lower <- (pos/total)-(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(pos*neg))
# cl_upper <- (pos/total)+(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(pos*neg))
print('Validation Data')
print(round(binconf(pos,total)[1]*100,0))
print(round(binconf(pos,total)[2]*100,0))
print(round(binconf(pos,total)[3]*100,0))

neg <- total-modelZ3
# cl_lower <- (modelZ3/total)-(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(modelZ3*neg))
# cl_upper <- (modelZ3/total)+(qnorm(1-0.05/2)/(total*sqrt(total))*sqrt(modelZ3*neg))
print('Model Data')
print(round(binconf(modelZ3,total)[1]*100,0))
print(round(binconf(modelZ3,total)[2]*100,0))
print(round(binconf(modelZ3,total)[3]*100,0))
```

```{r Day Prevalence Validation}
prevalence_melted <- reshape2::melt(NL_table[c('m_z_prev', 't_z_prev', 'w_z_prev')])
levels(prevalence_melted$variable) <- c('M', 'T', 'W')

mean_point_mon <- length(which(sites_monday=='pos'))/(length(which(sites_monday=='neg'))+length(which(sites_monday=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_monday=='pos')),(length(which(sites_monday=='neg'))+length(which(sites_monday=='pos'))))
CI_lower_mon <- exact_binomial_test$conf.int[1]*100
CI_upper_mon <- exact_binomial_test$conf.int[2]*100

mean_point_tue <- length(which(sites_tuesday=='pos'))/(length(which(sites_tuesday=='neg'))+length(which(sites_tuesday=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_tuesday=='pos')),(length(which(sites_tuesday=='neg'))+length(which(sites_tuesday=='pos'))))
CI_lower_tue <- exact_binomial_test$conf.int[1]*100
CI_upper_tue <- exact_binomial_test$conf.int[2]*100

mean_point_wed <- length(which(sites_wednesday=='pos'))/(length(which(sites_wednesday=='neg'))+length(which(sites_wednesday=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_wednesday=='pos')),(length(which(sites_wednesday=='neg'))+length(which(sites_wednesday=='pos'))))
CI_lower_wed <- exact_binomial_test$conf.int[1]*100
CI_upper_wed <- exact_binomial_test$conf.int[2]*100

ggplot(prevalence_melted, aes(x=variable, y=value, color=variable)) + stat_boxplot(geom ='errorbar') + geom_boxplot() +
  geom_point(aes(x = 'M', y = mean_point_mon), color="black") +
  geom_errorbar(aes(x = 'M', ymin = CI_lower_mon, ymax = CI_upper_mon), color="black") +
  geom_point(aes(x = 'T', y = mean_point_tue), color="black") +
  geom_errorbar(aes(x = 'T', ymin = CI_lower_tue, ymax = CI_upper_tue), color="black") +
  geom_point(aes(x = 'W', y = mean_point_wed), color="black") +
  geom_errorbar(aes(x = 'W', ymin = CI_lower_wed, ymax = CI_upper_wed), color="black") +
  ylim(0, 100) +
  xlab('Day of the week') +
  ylab('Prevalence %') +
  ggtitle('Model B: I. Weekday Prevalence Validation') +
  theme(legend.position = "none")
```

``` {r Shift Prevalence Validation}
prevalence_melted_validation_shift <- reshape2::melt(NL_table[c('z_sample_mid_prev')])
levels(prevalence_melted_validation_shift$variable) <- c('Mid')

mean_point_mid <- length(which(sites_mid=='pos'))/(length(which(sites_mid=='neg'))+length(which(sites_mid=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_mid=='pos')),(length(which(sites_mid=='neg'))+length(which(sites_mid=='pos'))))
CI_lower_mid <- exact_binomial_test$conf.int[1]*100
CI_upper_mid <- exact_binomial_test$conf.int[2]*100

pos <- length(which(sites_mid=='pos'))
total <- (length(which(sites_mid=='neg'))+length(which(sites_mid=='pos')))
modelMid <- (mean(NL_table$z_sample_mid_prev)/100)*total
sig_mid <- round(as.numeric(prop.test(x=c(modelMid,pos), n=c(total,total), correct=FALSE)[3]),2)

ggplot(prevalence_melted_validation_shift, aes(x=variable, y=value, color=variable)) +
  stat_boxplot(geom ='errorbar', color="#0C7BDC") +
  geom_boxplot(width = 0.5, color="#0C7BDC") +
  geom_point(aes(x = 'Mid', y = mean(value)), color = "#0C7BDC", shape = 4) +
  geom_point(aes(x = 'Mid', y = mean_point_mid), color="black", shape = 4) +
  geom_errorbar(aes(x = 'Mid', ymin = CI_lower_mid, ymax = CI_upper_mid), color="black") +
  xlab('') +
  scale_x_discrete(labels= c('All Agents')) +
  ylim(0, 100) +
  ylab('Prevalence %') +
  ggtitle('B') +
  theme(legend.position = "none") +
  theme(axis.text.x = element_text(size = 20, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 26, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"))
ggsave("Fig_2B.tiff", device = "tiff", height = 10, width = (9/12) * 10, dpi = 600)
```

``` {r Zone Prevalence Validation}
prevalence_melted_validation_zone <- reshape2::melt(NL_table[c('z2_prev', 'z3_prev')])
levels(prevalence_melted_validation_zone$variable) <- c('Zone 2', 'Zone 3')

mean_point_z2 <- length(which(sites_z2=='pos'))/(length(which(sites_z2=='neg'))+length(which(sites_z2=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_z2=='pos')),(length(which(sites_z2=='neg'))+length(which(sites_z2=='pos'))))
CI_lower_z2 <- exact_binomial_test$conf.int[1]*100
CI_upper_z2 <- exact_binomial_test$conf.int[2]*100

mean_point_z3 <- length(which(sites_z3=='pos'))/(length(which(sites_z3=='neg'))+length(which(sites_z3=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_z3=='pos')),(length(which(sites_z3=='neg'))+length(which(sites_z3=='pos'))))
CI_lower_z3 <- exact_binomial_test$conf.int[1]*100
CI_upper_z3 <- exact_binomial_test$conf.int[2]*100

ggplot(prevalence_melted_validation_zone, aes(x=variable, y=value, color=variable)) +
  stat_boxplot(geom ='errorbar', color=c("#0C7BDC","#FFC20A")) +
  geom_boxplot(width = 0.5, color=c("#0C7BDC","#FFC20A")) +
  geom_point(aes(x = 'Zone 2', y = mean(value, na.rm = TRUE)), color = "#0C7BDC", shape = 4) +
  geom_point(aes(x = 'Zone 2', y = mean_point_z2), color="black", shape = 4) +
  geom_errorbar(aes(x = 'Zone 2', ymin = CI_lower_z2, ymax = CI_upper_z2), color="black") +
  geom_point(aes(x = 'Zone 3', y = mean(value, na.rm = TRUE)), color = "#FFC20A", shape = 4) +
  geom_point(aes(x = 'Zone 3', y = mean_point_z3), color="black", shape = 4) +
  geom_errorbar(aes(x = 'Zone 3', ymin = CI_lower_z3, ymax = CI_upper_z3), color="black") +
  ylim(0, 100) +
  xlab('Zone') +
  ylab('Prevalence %') +
  ggtitle('D') +
  theme(legend.position = "none") +
  theme(axis.text.x = element_text(size = 20, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 26, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"))
ggsave("Fig_2D.tiff", device = "tiff", height = 10, width = (9/12) * 10, dpi = 600)
```

```{r Area Prevalence Validation}
prevalence_melted <- reshape2::melt(NL_table[c('loading_total_prev','cleaning_total_prev','sorting_total_prev','tray_packing_total_prev','reject_total_prev','other_total_prev')])
# prevalence_melted[which(prevalence_melted$variable=='drying_total_prev'),] <- as.factor('other_total_prev')
prevalence_melted$variable <- factor(prevalence_melted$variable)
levels(prevalence_melted$variable) <- c('Loading','Cleaning','Sorting','Tray Packing','Reject','Other')
prevalence_melted$value <- as.numeric(prevalence_melted$value)

mean_point_loading <- length(which(sites_loading_total=='pos'))/(length(which(sites_loading_total=='neg'))+length(which(sites_loading_total=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_loading_total=='pos')),(length(which(sites_loading_total=='neg'))+length(which(sites_loading_total=='pos'))))
CI_lower_loading <- exact_binomial_test$conf.int[1]*100
CI_upper_loading <- exact_binomial_test$conf.int[2]*100

mean_point_cleaning <- length(which(sites_cleaning_total=='pos'))/(length(which(sites_cleaning_total=='neg'))+length(which(sites_cleaning_total=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_cleaning_total=='pos')),(length(which(sites_cleaning_total=='neg'))+length(which(sites_cleaning_total=='pos'))))
CI_lower_cleaning <- exact_binomial_test$conf.int[1]*100
CI_upper_cleaning <- exact_binomial_test$conf.int[2]*100

mean_point_sorting <- length(which(sites_sorting_total=='pos'))/(length(which(sites_sorting_total=='neg'))+length(which(sites_sorting_total=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_sorting_total=='pos')),(length(which(sites_sorting_total=='neg'))+length(which(sites_sorting_total=='pos'))))
CI_lower_sorting <- exact_binomial_test$conf.int[1]*100
CI_upper_sorting <- exact_binomial_test$conf.int[2]*100

mean_point_reject <- length(which(sites_reject_total=='pos'))/(length(which(sites_reject_total=='neg'))+length(which(sites_reject_total=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_reject_total=='pos')),(length(which(sites_reject_total=='neg'))+length(which(sites_reject_total=='pos'))))
CI_lower_reject <- exact_binomial_test$conf.int[1]*100
CI_upper_reject <- exact_binomial_test$conf.int[2]*100

mean_point_tray_packing <- length(which(sites_tray_packing_total=='pos'))/(length(which(sites_tray_packing_total=='neg'))+length(which(sites_tray_packing_total=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_tray_packing_total=='pos')),(length(which(sites_tray_packing_total=='neg'))+length(which(sites_tray_packing_total=='pos'))))
CI_lower_tray_packing <- exact_binomial_test$conf.int[1]*100
CI_upper_tray_packing <- exact_binomial_test$conf.int[2]*100

mean_point_other <- length(which(sites_other_total=='pos'))/(length(which(sites_other_total=='neg'))+length(which(sites_other_total=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_other_total=='pos')),(length(which(sites_other_total=='neg'))+length(which(sites_other_total=='pos'))))
CI_lower_other <- exact_binomial_test$conf.int[1]*100
CI_upper_other <- exact_binomial_test$conf.int[2]*100

ggplot(prevalence_melted, aes(x=variable, y=value, color=variable)) +
  stat_boxplot(geom ='errorbar') +
  geom_boxplot() +
  geom_point(aes(x = 'Loading', y = mean_point_loading), color="black") +
  geom_errorbar(aes(x = 'Loading', ymin = CI_lower_loading, ymax = CI_upper_loading), color="black") +
  geom_point(aes(x = 'Cleaning', y = mean_point_cleaning), color="black") +
  geom_errorbar(aes(x = 'Cleaning', ymin = CI_lower_cleaning, ymax = CI_upper_cleaning), color="black") +
  geom_point(aes(x = 'Sorting', y = mean_point_sorting), color="black") +
  geom_errorbar(aes(x = 'Sorting', ymin = CI_lower_sorting, ymax = CI_upper_sorting), color="black") +
  geom_point(aes(x = 'Tray Packing', y = mean_point_tray_packing), color="black") +
  geom_errorbar(aes(x = 'Tray Packing', ymin = CI_lower_tray_packing, ymax = CI_upper_tray_packing), color="black") +
  geom_point(aes(x = 'Reject', y = mean_point_reject), color="black") +
  geom_errorbar(aes(x = 'Reject', ymin = CI_lower_reject, ymax = CI_upper_reject), color="black") +
  geom_point(aes(x = 'Other', y = mean_point_other), color="black") +
  geom_errorbar(aes(x = 'Other', ymin = CI_lower_other, ymax = CI_upper_other), color="black") +
  ylim(0, 100) +
  xlab('Packinghouse Area') +
  ylab('%') +
  ggtitle('Model B: II. Area Prevalence Validation') +
  theme(legend.position = "none")
```

```{r Moisture Prevalence Validation}
prevalence_melted_validation_water <- reshape2::melt(NL_table[c('loading_total_prev','cleaning_total_prev','sorting_total_prev','tray_packing_total_prev','reject_total_prev','other_total_prev')])
prevalence_melted_validation_water$variable <- factor(prevalence_melted_validation_water$variable)
levels(prevalence_melted_validation_water$variable) <- c('Wet','Wet','Dry','Dry','Dry','Dry')
prevalence_melted_validation_water$value <- as.numeric(prevalence_melted_validation_water$value)

mean_point_wet <- length(which(sites_wet=='pos'))/(length(which(sites_wet=='neg'))+length(which(sites_wet=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_wet=='pos')),(length(which(sites_wet=='neg'))+length(which(sites_wet=='pos'))))
CI_lower_wet <- exact_binomial_test$conf.int[1]*100
CI_upper_wet <- exact_binomial_test$conf.int[2]*100

mean_point_dry <- length(which(sites_dry=='pos'))/(length(which(sites_dry=='neg'))+length(which(sites_dry=='pos')))*100
exact_binomial_test <- binom.test(length(which(sites_dry=='pos')),(length(which(sites_dry=='neg'))+length(which(sites_dry=='pos'))))
CI_lower_dry <- exact_binomial_test$conf.int[1]*100
CI_upper_dry <- exact_binomial_test$conf.int[2]*100

pos <- length(which(sites_wet=='pos'))
total <- (length(which(sites_wet=='neg'))+length(which(sites_wet=='pos')))
modelWet <- ((mean(c(NL_table$loading_total_prev,NL_table$cleaning_total_prev),na.rm = TRUE))/100)*total
sig_wet <- round(as.numeric(prop.test(x=c(modelWet,pos), n=c(total,total), correct=FALSE)[3]),2)

pos <- length(which(sites_dry=='pos'))
total <- (length(which(sites_dry=='neg'))+length(which(sites_dry=='pos')))
modelDry <- ((mean(c(NL_table$sorting_total_prev,NL_table$reject_total_prev,NL_table$tray_packing_total_prev,NL_table$bag_packing_total_prev),na.rm = TRUE))/100)*total
sig_dry <- round(as.numeric(fisher.test(matrix(c(modelDry,total-modelDry,pos,total-pos),ncol=2))[1]),2)

ggplot(prevalence_melted_validation_water, aes(x=variable, y=value, color=variable)) +
  stat_boxplot(geom ='errorbar', color=c("#0C7BDC","#FFC20A")) +
  geom_boxplot(width = 0.5, color=c("#0C7BDC","#FFC20A")) +
  geom_point(aes(x = 'Wet', y = mean(value, na.rm = TRUE)), color = "#0C7BDC", shape = 4) +
  geom_point(aes(x = 'Wet', y = mean_point_wet), color="black", shape = 4) +
  geom_errorbar(aes(x = 'Wet', ymin = CI_lower_wet, ymax = CI_upper_wet), color="black") +
  geom_point(aes(x = 'Dry', y = mean(value, na.rm = TRUE)), color = "#FFC20A", shape = 4) +
  geom_point(aes(x = 'Dry', y = mean_point_dry), color="black", shape = 4) +
  geom_errorbar(aes(x = 'Dry', ymin = CI_lower_dry, ymax = CI_upper_dry), color="black") +
  ylim(0, 100) +
  xlab('Packinghouse Area') +
  ylab('Prevalence %') +
  ggtitle('F') +
  theme(legend.position = "none") +
  theme(axis.text.x = element_text(size = 20, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 26, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"))
ggsave("Fig_2F.tiff", device = "tiff", height = 10, width = (9/12) * 10, dpi = 600)
```

```{r}
boxplot(cleaning_conc_list,loading_conc_list, reject_conc_list, sorting_conc_list, c(drying_conc_list, other_conc_list),
        main="F. Area Concentrations",
        ylab="CFU/cm2",
        # ylim=c(0,100),
        col=c("lightblue","lightblue1","lightblue2","lightblue3","blue"),
        las = 1,
        names=c("Cleaning", "Loading", "Reject", "Sorting", "Other"),
        outline=TRUE)
```

```{r}
boxplot(cleaning_niche_time_list,loading_niche_time_list, reject_niche_time_list, sorting_niche_time_list, c(drying_niche_time_list, other_niche_time_list),
        main="G. Time to Niche",
        ylab="Ticks",
        # ylim=c(0,100),
        col=c("lightblue","lightblue1","lightblue2","lightblue3","blue"),
        las = 1,
        names=c("Cleaning", "Loading", "Reject", "Sorting", "Other"),
        outline=TRUE)
```

```{r}
boxplot(cleaning_niche_length_list,loading_niche_length_list, reject_niche_length_list, sorting_niche_length_list, c(drying_niche_length_list, other_niche_length_list),
        main="H. Niche Length",
        ylab="Ticks",
        #ylim=c(0,335),
        col=c("lightblue","lightblue1","lightblue2","lightblue3","blue"),
        las = 1,
        names=c("Cleaning", "Loading", "Reject", "Sorting", "Other"),
        outline=TRUE)
```

```{r Check Inputs}
####Check Inputs####
data_01 <- NL_table[header_list]
inputs <- data.frame(cor(data_01, method="spearman"))
plot(NL_table$p21~NL_table$p24)
plot(NL_table$tc11~NL_table$tc24)
plot(NL_table$p_patch_spread~NL_table$spread_tc)
plot(NL_table$crate_prevalence~NL_table$random_load)
#plot(NL_table$san_reduction~NL_table$san_reduction)
```

```{r Partial Correlation Coefficient}
#linear relationships of multiple inputs on output
pcc(data_01,NL_table$z1_prev,rank = FALSE, nboot=10, conf = 0.95 )
pcc(data_01,NL_table$m_z_sample_prev,rank = FALSE, nboot=10, conf = 0.95 )
#non-linear but monotonic relationships of multiple inputs on output
pcc(data_01,NL_table$z1_prev,rank = TRUE, nboot=10, conf = 0.9991)
pcc(data_01,NL_table$m_z_sample_prev,rank = TRUE, nboot=10, conf = 0.9991)
pcc(data_01,NL_table$t_z_sample_prev,rank = TRUE, nboot=10, conf = 0.9991)
pcc(data_01,NL_table$w_z_sample_prev,rank = TRUE, nboot=10, conf = 0.9991)
pcc(data_01,NL_table$z_sample_mid_prev,rank = TRUE, nboot=10, conf = 0.9991)
pcc(data_01,NL_table$loading_total_prev,rank = TRUE, nboot=10, conf = 0.9991)
pcc(data_01,NL_table$z_sample_post_prev,rank = TRUE, nboot=10, conf = 0.9991)

```

```{r cleaning Sensitivity Analysis}
#Subset data with total cleaning prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$cleaning_total_prev))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)
prcc$abs <- abs(prcc$PRCC)

new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(0.5, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Sensitivity: Loading area Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Cleaning area Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
full_data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(full_data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Cleaning area Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Loading Sensitivity Analysis}
#Subset data with total loading prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$loading_total_prev))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(0.5, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Sensitivity: Loading area Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Loading area Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Loading area Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r reject Sensitivity Analysis}
#Subset data with total reject prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$reject_total_prev))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Sensitivity: Reject area Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Reject area Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Reject area Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r sorting Sensitivity Analysis}
#Subset data with total sorting prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$sorting_total_prev))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Sensitivity: Reject area Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Sorting area Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Sorting area Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r tray packing Sensitivity Analysis}
#Subset data with total reject prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$tray_packing_total_prev))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Sensitivity: Reject area Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Tray Packing area Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Tray Packing area Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r other Sensitivity Analysis}
#Subset data with other sorting prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$other_total_prev))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Sensitivity: Reject area Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Other area Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Other area Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Monday Sample Prevalence Sensitivity}
#Subset data with total Monday prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$m_z_sample_prev))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Sensitivity: Monday Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Monday Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Monday Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Tuesday Sample Prevalence Sensitivity}
#Subset data with total Tuesday prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$t_z_sample_prev))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Sensitivity: Tuesday Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Tuesday Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Tuesday Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Wednesday Sample Prevalence Sensitivity}
#Subset data with total Wednesday prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$w_z_sample_prev))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Sensitivity: Wednesday Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Wednesday Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Wednesday Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Z1 Prevalence Sensitivity}
#Subset data with z1 prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$z1_prev))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Zone 1 Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Zone 1 Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Zone 1 Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Z2 Prevalence Sensitivity}
#Subset data with z2 prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$z2_prev))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#ggplot2 Graph, looks better to me than base
# data_matrix_melted <- reshape2::melt(data_matrix)
# ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Zone 2 Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Zone 1 Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Zone 2 Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Zone 2 Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Z3 Prevalence Sensitivity}
#Subset data with z3 prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$z3_prev))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#ggplot2 Graph, looks better to me than base
# data_matrix_melted <- reshape2::melt(data_matrix)
# ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Zone 3 Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Zone 1 Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Zone 3 Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Zone 3 Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Midday Sampling Sensitivity Analysis}
#Subset data with midday sampling prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$z_sample_mid_prev))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc <- subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs <- abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc <- sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Midday Sample Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Midday Sampling Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Midday Sampling Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Model-wide Midday Sampling Sensitivity Analysis}
#Subset data with model-wide midday sampling prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$mid_all))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$est,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs <- abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc <- sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Midday Sample Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
data_matrix_melted <- transform(data_matrix_melted, variable=reorder(Var2, value))
ggplot(data_matrix_melted, aes(x = factor(variable), y = value)) +
  geom_bar(stat = "identity") +
  ggtitle('B') +
  xlab('') +
  ylab('PRCC') +
  ylim(-0.25,0.75) +
  coord_flip() +
  geom_hline(yintercept = 0)

#ggplot of significant - Confirm custom labels
data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
data_matrix_melted <- transform(data_matrix_melted, variable=reorder(Var2, value))
ggplot(data_matrix_melted, aes(x = factor(variable), y = value)) +
  geom_bar(stat = "identity") +
  ggtitle('B') +
  xlab('') +
  ylab('PRCC') +
  ylim(-0.25,0.75) +
  coord_flip() +
  geom_hline(yintercept = 0) +
  scale_x_discrete(labels = c(expression(tau[21]),expression(tau[11]),expression("P"[21]),expression(alpha),expression("P"["z"]),expression("P"[31]),expression("P"["r"]),expression("R"["d"]),expression("P"[11]),expression("N"["R"])))
ggsave("Fig 4_B.tiff", device = "tiff", dpi = 600)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Model B: Midday Prevalence') + xlab('') + ylab('PRCC') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Model-wide Z2 Sampling Sensitivity Analysis}
#Subset data with model-wide midday sampling prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$z2_all))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Midday Sample Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Z2 Prevalence') + xlab('PRCC') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Z2 Prevalence') + xlab('PRCC') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Model-wide Z3 Sampling Sensitivity Analysis}
vector <- NL_table$z3_all
vector <- vector[vector!='[]']
if (length(vector)>0) {
  matrix <- do.call('rbind',lapply(vector, vector_splitter))
  baseline_prev_all <- rowSums(matrix >  0)/225*100
}

#Subset data with model-wide midday sampling prevalence
data_sub <- data.frame(cbind(NL_table[header_list],baseline_prev_all))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Midday Sample Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Z3 Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Z3 Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Model-wide Loading Sensitivity Analysis}
vector <- NL_table$loading_all
vector <- vector[vector!='[]']
if (length(vector)>0) {
  matrix <- do.call('rbind',lapply(vector, vector_splitter))
  baseline_prev_all <- rowSums(matrix >  0)/225*100
}

#Subset data with model-wide midday sampling prevalence
data_sub <- data.frame(cbind(NL_table[header_list],baseline_prev_all))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Midday Sample Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Loading Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Loading Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Model-wide Cleaning Sensitivity Analysis}
vector <- NL_table$cleaning_all
vector <- vector[vector!='[]']
if (length(vector)>0) {
  matrix <- do.call('rbind',lapply(vector, vector_splitter))
  baseline_prev_all <- rowSums(matrix >  0)/225*100
}

#Subset data with model-wide midday sampling prevalence
data_sub <- data.frame(cbind(NL_table[header_list],baseline_prev_all))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Midday Sample Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Cleaning Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Cleaning Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Model-wide Sorting Sensitivity Analysis}
vector <- NL_table$sorting_all
vector <- vector[vector!='[]']
if (length(vector)>0) {
  matrix <- do.call('rbind',lapply(vector, vector_splitter))
  baseline_prev_all <- rowSums(matrix >  0)/225*100
}

#Subset data with model-wide midday sampling prevalence
data_sub <- data.frame(cbind(NL_table[header_list],baseline_prev_all))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Midday Sample Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Sorting Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Sorting Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Model-wide Tray Packing Sensitivity Analysis}
vector <- NL_table$tray_packing_all
vector <- vector[vector!='[]']
if (length(vector)>0) {
  matrix <- do.call('rbind',lapply(vector, vector_splitter))
  baseline_prev_all <- rowSums(matrix >  0)/225*100
}

#Subset data with model-wide midday sampling prevalence
data_sub <- data.frame(cbind(NL_table[header_list],baseline_prev_all))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Midday Sample Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Tray Packing Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Tray Packing Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Model-wide Reject Sensitivity Analysis}
vector <- NL_table$reject_all
vector <- vector[vector!='[]']
if (length(vector)>0) {
  matrix <- do.call('rbind',lapply(vector, vector_splitter))
  baseline_prev_all <- rowSums(matrix >  0)/225*100
}

#Subset data with model-wide midday sampling prevalence
data_sub <- data.frame(cbind(NL_table[header_list],baseline_prev_all))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Midday Sample Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Reject Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Reject Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r Model-wide Other Sensitivity Analysis}
vector <- NL_table$other_all
vector <- vector[vector!='[]']
if (length(vector)>0) {
  matrix <- do.call('rbind',lapply(vector, vector_splitter))
  baseline_prev_all <- rowSums(matrix >  0)/225*100
}

#Subset data with model-wide midday sampling prevalence
data_sub <- data.frame(cbind(NL_table[header_list],baseline_prev_all))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Midday Sample Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Other Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Other Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r}
C <- matrix(NA ,length(header_list),6)
rownames(C) <- header_list
colnames(C) <- c("Min", "25%","50%","Mean", "75%", "Max")
#for (i in (1:52)){ C[i,]<-round(summary(FinalParams[,(i+3)]), digits = 8)}
C[1,] <- round(summary(NL_table$spread_tc), digits = 8)
C[2,] <- round(summary(NL_table$crate_prevalence), digits = 8)
C[3,] <- round(summary(NL_table$food_conc), digits = 8)
C[4,] <- round(summary(NL_table$food_tc), digits = 8)
C[5,] <- round(summary(NL_table$zone4_load), digits = 8)
C[6,] <- round(summary(NL_table$random_load), digits = 8)
C[7,] <- round(summary(NL_table$san_reduction), digits = 8)
C[8,] <- round(summary(NL_table$p_patch_spread), digits = 8)
C[9,] <- round(summary(NL_table$p_water_spread), digits = 8)
C[10,] <- round(summary(NL_table$p_food_dropped), digits = 8)
C[11,] <- round(summary(NL_table$p_condensation), digits = 8)
C[12,] <- round(summary(NL_table$p_random_noise), digits = 8)
C[12,] <- round(summary(NL_table$p_zone4_intro), digits = 8)
C[13,] <- round(summary(NL_table$p11), digits = 8)
C[14,] <- round(summary(NL_table$p12), digits = 8)
C[15,] <- round(summary(NL_table$p13), digits = 8)
C[16,] <- round(summary(NL_table$p14), digits = 8)
C[17,] <- round(summary(NL_table$p21), digits = 8)
C[18,] <- round(summary(NL_table$p22), digits = 8)
C[19,] <- round(summary(NL_table$p23), digits = 8)
C[20,] <- round(summary(NL_table$p24), digits = 8)
C[21,] <- round(summary(NL_table$p31), digits = 8)
C[22,] <- round(summary(NL_table$p32), digits = 8)
C[23,] <- round(summary(NL_table$p33), digits = 8)
C[24,] <- round(summary(NL_table$p34), digits = 8)
C[25,] <- round(summary(NL_table$p41), digits = 8)
C[26,] <- round(summary(NL_table$p42), digits = 8)
C[27,] <- round(summary(NL_table$p43), digits = 8)
C[28,] <- round(summary(NL_table$p44), digits = 8)
C[29,] <- round(summary(NL_table$tc11), digits = 8)
C[30,] <- round(summary(NL_table$tc12), digits = 8)
C[31,] <- round(summary(NL_table$tc13), digits = 8)
C[32,] <- round(summary(NL_table$tc14), digits = 8)
C[33,] <- round(summary(NL_table$tc21), digits = 8)
C[34,] <- round(summary(NL_table$tc22), digits = 8)
C[35,] <- round(summary(NL_table$tc23), digits = 8)
C[36,] <- round(summary(NL_table$tc24), digits = 8)
C[37,] <- round(summary(NL_table$tc31), digits = 8)
C[38,] <- round(summary(NL_table$tc32), digits = 8)
C[39,] <- round(summary(NL_table$tc33), digits = 8)
C[40,] <- round(summary(NL_table$tc34), digits = 8)
C[41,] <- round(summary(NL_table$tc41), digits = 8)
C[42,] <- round(summary(NL_table$tc42), digits = 8)
C[43,] <- round(summary(NL_table$tc43), digits = 8)
C[44,] <- round(summary(NL_table$tc44), digits = 8)

Cmode <- matrix(NA ,length(header_list),1)
rownames(Cmode) <- header_list
colnames(Cmode) <- c("Mode")

Cmode[1,] <- round(f_mode(NL_table$spread_tc), digits = 8)
Cmode[2,] <- round(f_mode(NL_table$crate_prevalence), digits = 8)
Cmode[3,] <- round(f_mode(NL_table$food_conc), digits = 8)
Cmode[4,] <- round(f_mode(NL_table$food_tc), digits = 8)
Cmode[5,] <- round(f_mode(NL_table$zone4_load), digits = 8)
Cmode[6,] <- round(f_mode(NL_table$random_load), digits = 8)
Cmode[7,] <- round(f_mode(NL_table$san_reduction), digits = 8)
Cmode[8,] <- round(f_mode(NL_table$p_patch_spread), digits = 8)
Cmode[9,] <- round(f_mode(NL_table$p_water_spread), digits = 8)
Cmode[10,] <- round(f_mode(NL_table$p_food_dropped), digits = 8)
Cmode[11,] <- round(f_mode(NL_table$p_condensation), digits = 8)
Cmode[12,] <- round(f_mode(NL_table$p_random_noise), digits = 8)
Cmode[12,] <- round(f_mode(NL_table$p_zone4_intro), digits = 8)
Cmode[13,] <- round(f_mode(NL_table$p11), digits = 8)
Cmode[14,] <- round(f_mode(NL_table$p12), digits = 8)
Cmode[15,] <- round(f_mode(NL_table$p13), digits = 8)
Cmode[16,] <- round(f_mode(NL_table$p14), digits = 8)
Cmode[17,] <- round(f_mode(NL_table$p21), digits = 8)
Cmode[18,] <- round(f_mode(NL_table$p22), digits = 8)
Cmode[19,] <- round(f_mode(NL_table$p23), digits = 8)
Cmode[20,] <- round(f_mode(NL_table$p24), digits = 8)
Cmode[21,] <- round(f_mode(NL_table$p31), digits = 8)
Cmode[22,] <- round(f_mode(NL_table$p32), digits = 8)
Cmode[23,] <- round(f_mode(NL_table$p33), digits = 8)
Cmode[24,] <- round(f_mode(NL_table$p34), digits = 8)
Cmode[25,] <- round(f_mode(NL_table$p41), digits = 8)
Cmode[26,] <- round(f_mode(NL_table$p42), digits = 8)
Cmode[27,] <- round(f_mode(NL_table$p43), digits = 8)
Cmode[28,] <- round(f_mode(NL_table$p44), digits = 8)
Cmode[29,] <- round(f_mode(NL_table$tc11), digits = 8)
Cmode[30,] <- round(f_mode(NL_table$tc12), digits = 8)
Cmode[31,] <- round(f_mode(NL_table$tc13), digits = 8)
Cmode[32,] <- round(f_mode(NL_table$tc14), digits = 8)
Cmode[33,] <- round(f_mode(NL_table$tc21), digits = 8)
Cmode[34,] <- round(f_mode(NL_table$tc22), digits = 8)
Cmode[35,] <- round(f_mode(NL_table$tc23), digits = 8)
Cmode[36,] <- round(f_mode(NL_table$tc24), digits = 8)
Cmode[37,] <- round(f_mode(NL_table$tc31), digits = 8)
Cmode[38,] <- round(f_mode(NL_table$tc32), digits = 8)
Cmode[39,] <- round(f_mode(NL_table$tc33), digits = 8)
Cmode[40,] <- round(f_mode(NL_table$tc34), digits = 8)
Cmode[41,] <- round(f_mode(NL_table$tc41), digits = 8)
Cmode[42,] <- round(f_mode(NL_table$tc42), digits = 8)
Cmode[43,] <- round(f_mode(NL_table$tc43), digits = 8)
Cmode[44,] <- round(f_mode(NL_table$tc44), digits = 8)
```

```{r Sampling Prevalence Comparision}
vioplot(NL_table[c('m_z_prev','m_z_all','t_z_prev','t_z_all','w_z_prev','w_z_all')],
        main="Sampled Days versus Entire Days",
        ylab="%",
        ylim=c(0,100),
        col=c("lightsteelblue","lightsalmon","lightsteelblue1","lightsalmon1","lightsteelblue2","lightsalmon3","lightsteelblue3","lightsteelblue4","lightsalmon4"),
        names=c('M','M-All','T','T-All','W','W-All'),
        outline=TRUE)
vioplot(NL_table[,c('z_sample_mid_prev','mid_all')],
        main='Sampled Mid-shift versus Entire Mid-Shift',
        ylab='%',
        ylim=c(0,100),
        col=c('honeydew1','goldenrod1'),
        names=c('Mid. (4 hrs)','Mid. (4 hrs)-All'),
        outline=TRUE)

vioplot(NL_table[,c('z1_all','z2_prev','z2_all', 'z3_prev', 'z3_all')],
        main="Sampled Zones versus Entire Zones",
        ylab="%",
        ylim=c(0,100),
        col=c("lightpink","lightcyan1","lightpink1","lightcyan2","lightpink2","lightcyan3","lightpink3"),
        las = 1,
        names=c("Zone 1-All","Zone 2","Zone 2-All","Zone 3","Zone 3-All"),
        outline=TRUE)

vioplot(NL_table[c('cleaning_total_prev','cleaning_all','loading_total_prev','loading_all','reject_total_prev','reject_all','sorting_total_prev','sorting_all','other_total_prev','other_all')],
        main="Sampled Area versus Entire Area",
        ylab="%",
        ylim=c(0,100),
        las = 1,
        col=c("lightblue","indianred","lightblue1","indianred1","lightblue2", "indianred2","lightblue3","indianred4","blue","red"),
        names=c("Cleaning", "Cleaning-All", "Loading", "Loading-All", "Reject", "Reject-All", "Sorting", "Sorting-All", "Other", "Other-All"),
        outline=TRUE)

boxplot(NL_table[c('cleaning_all_employees','sorting_all_employees','other_all_employees')],
        main='Projected Employee Prevalence',
        ylab="%",
        ylim=c(0,100),
        las = 1,
        col=c('tomato','tomato1','tomato2'),
        names=c("Cleaning", "Sorting", "Other"),
        outline=TRUE)
```

```{r Z1 Prevalence Sensitivity}
#Subset data with z1 projected prevalence
data_sub <- data.frame(cbind(NL_table[header_list],NL_table$z1_all))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$gamma,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#ggplot2 Graph, looks better to me than base
# data_matrix_melted <- reshape2::melt(data_matrix)
# ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Zone 3 Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#Base plot package, for standardization
# par(mfrow=c(1,1), mai=c(1, 1.75, 1, 1))
# barplot(data_matrix, horiz = T,main="Zone 1 Prevalence",beside=T,col=c('gray'),las=2, xlim = c(floor(min(data_matrix)/0.1)*0.1, ceiling(max(data_matrix)/0.1)*0.1))
# abline(v=0)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = Var2, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Projected Zone 1 Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)

#ggplot of all
data_matrix <- as.data.frame(matrix(c(prcc$PRCC), ncol=length(prcc$PRCC)))
colnames(data_matrix) <- rownames(prcc)
data_matrix_melted <- reshape2::melt(data_matrix)
ggplot(data_matrix_melted, aes(x = variable, y = value)) + geom_bar(stat = "identity") + ggtitle('Sensitivity: Projected Zone 1 Prevalence') + xlab('') + ylab('') + coord_flip() + geom_hline(yintercept = 0)
```

```{r List Conversion}
#Z1 All
vector <- list_outputs$z1_conc_time_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  z1_conc_time_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(z1_conc_time_list)
  z1_conc_time_list_means <- numeric()
  i <- 0
  while (i < 335) {
    z1_conc_time_list_means <- base::append(z1_conc_time_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  z1_conc_time_list_means <- as.data.frame(z1_conc_time_list_means)
  z1_conc_time_list_means$factor <- 'Z1'
  z1_conc_time_list_means$tick <- 1:335
  names(z1_conc_time_list_means) <- c('concentration', 'category', 'tick')
  z1_conc_time_list_means$category <- as.factor(z1_conc_time_list_means$category)  
}

#Z1 Cleanable
vector <- list_outputs$z1_conc_time_cleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  z1_conc_time_cleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(z1_conc_time_cleanable_list)
  z1_conc_time_cleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    z1_conc_time_cleanable_list_means <- base::append(z1_conc_time_cleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  z1_conc_time_cleanable_list_means <- as.data.frame(z1_conc_time_cleanable_list_means)
  z1_conc_time_cleanable_list_means$factor <- 'Z1'
  z1_conc_time_cleanable_list_means$dual_factor <- 'Z1-Cleanable'
  z1_conc_time_cleanable_list_means$tick <- 1:335
  names(z1_conc_time_cleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  z1_conc_time_cleanable_list_means$category <- as.factor(z1_conc_time_cleanable_list_means$category)
}

#Z1 Uncleanable
vector <- list_outputs$z1_conc_time_uncleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  z1_conc_time_uncleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(z1_conc_time_uncleanable_list)
  z1_conc_time_uncleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    z1_conc_time_uncleanable_list_means <- base::append(z1_conc_time_uncleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  z1_conc_time_uncleanable_list_means <- as.data.frame(z1_conc_time_uncleanable_list_means)
  z1_conc_time_uncleanable_list_means$factor <- 'Z1'
  z1_conc_time_uncleanable_list_means$dual_factor <- 'Z1-Uncleanable'
  z1_conc_time_uncleanable_list_means$tick <- 1:335
  names(z1_conc_time_uncleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  z1_conc_time_uncleanable_list_means$category <- as.factor(z1_conc_time_uncleanable_list_means$category)
}

#Z2 All
vector <- list_outputs$z2_conc_time_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  z2_conc_time_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(z2_conc_time_list)
  z2_conc_time_list_means <- numeric()
  i <- 0
  while (i < 335) {
    z2_conc_time_list_means <- base::append(z2_conc_time_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  z2_conc_time_list_means <- as.data.frame(z2_conc_time_list_means)
  z2_conc_time_list_means$factor <- 'Z2'
  z2_conc_time_list_means$tick <- 1:335
  names(z2_conc_time_list_means) <- c('concentration', 'category', 'tick')
  z2_conc_time_list_means$category <- as.factor(z2_conc_time_list_means$category)
}

#Z2 Cleanable
vector <- list_outputs$z2_conc_time_cleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  z2_conc_time_cleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(z2_conc_time_cleanable_list)
  z2_conc_time_cleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    z2_conc_time_cleanable_list_means <- base::append(z2_conc_time_cleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  z2_conc_time_cleanable_list_means <- as.data.frame(z2_conc_time_cleanable_list_means)
  z2_conc_time_cleanable_list_means$factor <- 'Z2'
  z2_conc_time_cleanable_list_means$dual_factor <- 'Z2-Cleanable'
  z2_conc_time_cleanable_list_means$tick <- 1:335
  names(z2_conc_time_cleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  z2_conc_time_cleanable_list_means$category <- as.factor(z2_conc_time_cleanable_list_means$category)
}

#Z2 Uncleanable
vector <- list_outputs$z2_conc_time_uncleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  z2_conc_time_uncleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(z2_conc_time_uncleanable_list)
  z2_conc_time_uncleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    z2_conc_time_uncleanable_list_means <- base::append(z2_conc_time_uncleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  z2_conc_time_uncleanable_list_means <- as.data.frame(z2_conc_time_uncleanable_list_means)
  z2_conc_time_uncleanable_list_means$factor <- 'Z2'
  z2_conc_time_uncleanable_list_means$dual_factor <- 'Z2-Uncleanable'
  z2_conc_time_uncleanable_list_means$tick <- 1:335
  names(z2_conc_time_uncleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  z2_conc_time_uncleanable_list_means$category <- as.factor(z2_conc_time_uncleanable_list_means$category)
}

#Z3 All
vector <- list_outputs$z3_conc_time_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  z3_conc_time_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(z3_conc_time_list)
  z3_conc_time_list_means <- numeric()
  i <- 0
  while (i < 335) {
    z3_conc_time_list_means <- base::append(z3_conc_time_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  z3_conc_time_list_means <- as.data.frame(z3_conc_time_list_means)
  z3_conc_time_list_means$factor <- 'Z3'
  z3_conc_time_list_means$tick <- 1:335
  names(z3_conc_time_list_means) <- c('concentration', 'category', 'tick')
  z3_conc_time_list_means$category <- as.factor(z3_conc_time_list_means$category)
}

#Z3 Cleanable
vector <- list_outputs$z3_conc_time_cleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  z3_conc_time_cleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(z3_conc_time_cleanable_list)
  z3_conc_time_cleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    z3_conc_time_cleanable_list_means <- base::append(z3_conc_time_cleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  z3_conc_time_cleanable_list_means <- as.data.frame(z3_conc_time_cleanable_list_means)
  z3_conc_time_cleanable_list_means$factor <- 'Z3'
  z3_conc_time_cleanable_list_means$dual_factor <- 'Z3-Cleanable'
  z3_conc_time_cleanable_list_means$tick <- 1:335
  names(z3_conc_time_cleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  z3_conc_time_cleanable_list_means$category <- as.factor(z3_conc_time_cleanable_list_means$category)
}

#Z3 Uncleanable
vector <- list_outputs$z3_conc_time_uncleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  z3_conc_time_uncleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(z3_conc_time_uncleanable_list)
  z3_conc_time_uncleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    z3_conc_time_uncleanable_list_means <- base::append(z3_conc_time_uncleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  z3_conc_time_uncleanable_list_means <- as.data.frame(z3_conc_time_uncleanable_list_means)
  z3_conc_time_uncleanable_list_means$factor <- 'Z3'
  z3_conc_time_uncleanable_list_means$dual_factor <- 'Z3-Uncleanable'
  z3_conc_time_uncleanable_list_means$tick <- 1:335
  names(z3_conc_time_uncleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  z3_conc_time_uncleanable_list_means$category <- as.factor(z3_conc_time_uncleanable_list_means$category)
}

#Loading All
vector <- list_outputs$loading_conc_time_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  loading_conc_time_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(loading_conc_time_list)
  loading_conc_time_list_means <- numeric()
  i <- 0
  while (i < 335) {
    loading_conc_time_list_means <- base::append(loading_conc_time_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  loading_conc_time_list_means <- as.data.frame(loading_conc_time_list_means)
  loading_conc_time_list_means$factor <- 'Loading'
  loading_conc_time_list_means$tick <- 1:335
  names(loading_conc_time_list_means) <- c('concentration', 'category', 'tick')
  loading_conc_time_list_means$category <- as.factor(loading_conc_time_list_means$category)
}

#Loading Cleanable
vector <- list_outputs$loading_conc_time_cleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  loading_conc_time_cleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(loading_conc_time_cleanable_list)
  loading_conc_time_cleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    loading_conc_time_cleanable_list_means <- base::append(loading_conc_time_cleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  loading_conc_time_cleanable_list_means <- as.data.frame(loading_conc_time_cleanable_list_means)
  loading_conc_time_cleanable_list_means$factor <- 'Loading'
  loading_conc_time_cleanable_list_means$dual_factor <- 'Loading-Cleanable'
  loading_conc_time_cleanable_list_means$tick <- 1:335
  names(loading_conc_time_cleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  loading_conc_time_cleanable_list_means$category <- as.factor(loading_conc_time_cleanable_list_means$category)
}

#Loading Uncleanable
vector <- list_outputs$loading_conc_time_uncleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  loading_conc_time_uncleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(loading_conc_time_uncleanable_list)
  loading_conc_time_uncleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    loading_conc_time_uncleanable_list_means <- base::append(loading_conc_time_uncleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  loading_conc_time_uncleanable_list_means <- as.data.frame(loading_conc_time_uncleanable_list_means)
  loading_conc_time_uncleanable_list_means$factor <- 'Loading'
  loading_conc_time_uncleanable_list_means$dual_factor <- 'Loading-Uncleanable'
  loading_conc_time_uncleanable_list_means$tick <- 1:335
  names(loading_conc_time_uncleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  loading_conc_time_uncleanable_list_means$category <- as.factor(loading_conc_time_uncleanable_list_means$category)
}

#Cleaning All
vector <- list_outputs$cleaning_conc_time_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cleaning_conc_time_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(cleaning_conc_time_list)
  cleaning_conc_time_list_means <- numeric()
  i <- 0
  while (i < 335) {
    cleaning_conc_time_list_means <- base::append(cleaning_conc_time_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  cleaning_conc_time_list_means <- as.data.frame(cleaning_conc_time_list_means)
  cleaning_conc_time_list_means$factor <- 'Cleaning'
  cleaning_conc_time_list_means$tick <- 1:335
  names(cleaning_conc_time_list_means) <- c('concentration', 'category', 'tick')
  cleaning_conc_time_list_means$category <- as.factor(cleaning_conc_time_list_means$category)
}

#Cleaning Cleanable
vector <- list_outputs$cleaning_conc_time_cleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cleaning_conc_time_cleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(cleaning_conc_time_cleanable_list)
  cleaning_conc_time_cleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    cleaning_conc_time_cleanable_list_means <- base::append(cleaning_conc_time_cleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  cleaning_conc_time_cleanable_list_means <- as.data.frame(cleaning_conc_time_cleanable_list_means)
  cleaning_conc_time_cleanable_list_means$factor <- 'Cleaning'
  cleaning_conc_time_cleanable_list_means$dual_factor <- 'Cleaning-Cleanable'
  cleaning_conc_time_cleanable_list_means$tick <- 1:335
  names(cleaning_conc_time_cleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  cleaning_conc_time_cleanable_list_means$category <- as.factor(cleaning_conc_time_cleanable_list_means$category)
}

#Cleaning Unleanable
vector <- list_outputs$cleaning_conc_time_uncleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cleaning_conc_time_uncleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(cleaning_conc_time_uncleanable_list)
  cleaning_conc_time_uncleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    cleaning_conc_time_uncleanable_list_means <- base::append(cleaning_conc_time_uncleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  cleaning_conc_time_uncleanable_list_means <- as.data.frame(cleaning_conc_time_uncleanable_list_means)
  cleaning_conc_time_uncleanable_list_means$factor <- 'Cleaning'
  cleaning_conc_time_uncleanable_list_means$dual_factor <- 'Cleaning-Uncleanable'
  cleaning_conc_time_uncleanable_list_means$tick <- 1:335
  names(cleaning_conc_time_uncleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  cleaning_conc_time_uncleanable_list_means$category <- as.factor(cleaning_conc_time_uncleanable_list_means$category)
}

#Drying All
vector <- list_outputs$drying_conc_time_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  drying_conc_time_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(drying_conc_time_list)
  drying_conc_time_list_means <- numeric()
  i <- 0
  while (i < 335) {
    drying_conc_time_list_means <- base::append(drying_conc_time_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  drying_conc_time_list_means <- as.data.frame(drying_conc_time_list_means)
  drying_conc_time_list_means$factor <- 'Drying'
  drying_conc_time_list_means$tick <- 1:335
  names(drying_conc_time_list_means) <- c('concentration', 'category', 'tick')
  drying_conc_time_list_means$category <- as.factor(drying_conc_time_list_means$category)
}

#Drying Cleanable
vector <- list_outputs$drying_conc_time_cleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  drying_conc_time_cleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(drying_conc_time_cleanable_list)
  drying_conc_time_cleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    drying_conc_time_cleanable_list_means <- base::append(drying_conc_time_cleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  drying_conc_time_cleanable_list_means <- as.data.frame(drying_conc_time_cleanable_list_means)
  drying_conc_time_cleanable_list_means$factor <- 'Drying'
  drying_conc_time_cleanable_list_means$dual_factor <- 'Drying-Cleanable'
  drying_conc_time_cleanable_list_means$tick <- 1:335
  names(drying_conc_time_cleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  drying_conc_time_cleanable_list_means$category <- as.factor(drying_conc_time_cleanable_list_means$category)
}

#Drying Uncleanable
vector <- list_outputs$drying_conc_time_uncleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  drying_conc_time_uncleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(drying_conc_time_uncleanable_list)
  drying_conc_time_uncleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    drying_conc_time_uncleanable_list_means <- base::append(drying_conc_time_uncleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  drying_conc_time_uncleanable_list_means <- as.data.frame(drying_conc_time_uncleanable_list_means)
  drying_conc_time_uncleanable_list_means$factor <- 'Drying'
  drying_conc_time_uncleanable_list_means$dual_factor <- 'Drying-Uncleanable'
  drying_conc_time_uncleanable_list_means$tick <- 1:335
  names(drying_conc_time_uncleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  drying_conc_time_uncleanable_list_means$category <- as.factor(drying_conc_time_uncleanable_list_means$category)
}

#Sorting All
vector <- list_outputs$sorting_conc_time_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  sorting_conc_time_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(sorting_conc_time_list)
  sorting_conc_time_list_means <- numeric()
  i <- 0
  while (i < 335) {
    sorting_conc_time_list_means <- base::append(sorting_conc_time_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  sorting_conc_time_list_means <- as.data.frame(sorting_conc_time_list_means)
  sorting_conc_time_list_means$factor <- 'Sorting'
  sorting_conc_time_list_means$tick <- 1:335
  names(sorting_conc_time_list_means) <- c('concentration', 'category', 'tick')
  sorting_conc_time_list_means$category <- as.factor(sorting_conc_time_list_means$category)
}

#Sorting Cleanable
vector <- list_outputs$sorting_conc_time_cleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  sorting_conc_time_cleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(sorting_conc_time_cleanable_list)
  sorting_conc_time_cleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    sorting_conc_time_cleanable_list_means <- base::append(sorting_conc_time_cleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  sorting_conc_time_cleanable_list_means <- as.data.frame(sorting_conc_time_cleanable_list_means)
  sorting_conc_time_cleanable_list_means$factor <- 'Sorting'
  sorting_conc_time_cleanable_list_means$dual_factor <- 'Sorting-Cleanable'
  sorting_conc_time_cleanable_list_means$tick <- 1:335
  names(sorting_conc_time_cleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  sorting_conc_time_cleanable_list_means$category <- as.factor(sorting_conc_time_cleanable_list_means$category)
}

#Sorting Uncleanable
vector <- list_outputs$sorting_conc_time_uncleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  sorting_conc_time_uncleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(sorting_conc_time_uncleanable_list)
  sorting_conc_time_uncleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    sorting_conc_time_uncleanable_list_means <- base::append(sorting_conc_time_uncleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  sorting_conc_time_uncleanable_list_means <- as.data.frame(sorting_conc_time_uncleanable_list_means)
  sorting_conc_time_uncleanable_list_means$factor <- 'Sorting'
  sorting_conc_time_uncleanable_list_means$dual_factor <- 'Sorting-Uncleanable'
  sorting_conc_time_uncleanable_list_means$tick <- 1:335
  names(sorting_conc_time_uncleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  sorting_conc_time_uncleanable_list_means$category <- as.factor(sorting_conc_time_uncleanable_list_means$category)
}

#Reject All
vector <- list_outputs$reject_conc_time_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  reject_conc_time_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(reject_conc_time_list)
  reject_conc_time_list_means <- numeric()
  i <- 0
  while (i < 335) {
    reject_conc_time_list_means <- base::append(reject_conc_time_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  reject_conc_time_list_means <- as.data.frame(reject_conc_time_list_means)
  reject_conc_time_list_means$factor <- 'Reject'
  reject_conc_time_list_means$tick <- 1:335
  names(reject_conc_time_list_means) <- c('concentration', 'category', 'tick')
  reject_conc_time_list_means$category <- as.factor(reject_conc_time_list_means$category)
}

#Reject Cleanable
vector <- list_outputs$reject_conc_time_cleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  reject_conc_time_cleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(reject_conc_time_cleanable_list)
  reject_conc_time_cleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    reject_conc_time_cleanable_list_means <- base::append(reject_conc_time_cleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  reject_conc_time_cleanable_list_means <- as.data.frame(reject_conc_time_cleanable_list_means)
  reject_conc_time_cleanable_list_means$factor <- 'Reject'
  reject_conc_time_cleanable_list_means$dual_factor <- 'Reject-Cleanable'
  reject_conc_time_cleanable_list_means$tick <- 1:335
  names(reject_conc_time_cleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  reject_conc_time_cleanable_list_means$category <- as.factor(reject_conc_time_cleanable_list_means$category)
}

#Reject Uncleanable
vector <- list_outputs$reject_conc_time_uncleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  reject_conc_time_uncleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(reject_conc_time_uncleanable_list)
  reject_conc_time_uncleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    reject_conc_time_uncleanable_list_means <- base::append(reject_conc_time_uncleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  reject_conc_time_uncleanable_list_means <- as.data.frame(reject_conc_time_uncleanable_list_means)
  reject_conc_time_uncleanable_list_means$factor <- 'Reject'
  reject_conc_time_uncleanable_list_means$dual_factor <- 'Reject-Uncleanable'
  reject_conc_time_uncleanable_list_means$tick <- 1:335
  names(reject_conc_time_uncleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  reject_conc_time_uncleanable_list_means$category <- as.factor(reject_conc_time_uncleanable_list_means$category)
}

#Other All
vector <- list_outputs$other_conc_time_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  other_conc_time_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(other_conc_time_list)
  other_conc_time_list_means <- numeric()
  i <- 0
  while (i < 335) {
    other_conc_time_list_means <- base::append(other_conc_time_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  other_conc_time_list_means <- as.data.frame(other_conc_time_list_means)
  other_conc_time_list_means$factor <- 'Other'
  other_conc_time_list_means$tick <- 1:335
  names(other_conc_time_list_means) <- c('concentration', 'category', 'tick')
  other_conc_time_list_means$category <- as.factor(other_conc_time_list_means$category)
}

#Other Cleanable
vector <- list_outputs$other_conc_time_cleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  other_conc_time_cleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(other_conc_time_cleanable_list)
  other_conc_time_cleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    other_conc_time_cleanable_list_means <- base::append(other_conc_time_cleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  other_conc_time_cleanable_list_means <- as.data.frame(other_conc_time_cleanable_list_means)
  other_conc_time_cleanable_list_means$factor <- 'Other'
  other_conc_time_cleanable_list_means$dual_factor <- 'Other-Cleanable'
  other_conc_time_cleanable_list_means$tick <- 1:335
  names(other_conc_time_cleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  other_conc_time_cleanable_list_means$category <- as.factor(other_conc_time_cleanable_list_means$category)
}

#Other Uncleanable
vector <- list_outputs$other_conc_time_uncleanable_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  other_conc_time_uncleanable_list <- do.call('rbind',lapply(vector, vector_splitter))
  matrix_mean <- colMeans(other_conc_time_uncleanable_list)
  other_conc_time_uncleanable_list_means <- numeric()
  i <- 0
  while (i < 335) {
    other_conc_time_uncleanable_list_means <- base::append(other_conc_time_uncleanable_list_means, mean(matrix_mean[(1+(length(matrix_mean)/335)*(i)):((length(matrix_mean)/335)*(i+1))]))
    i <- i+1
  }
  other_conc_time_uncleanable_list_means <- as.data.frame(other_conc_time_uncleanable_list_means)
  other_conc_time_uncleanable_list_means$factor <- 'Other'
  other_conc_time_uncleanable_list_means$dual_factor <- 'Other-Uncleanable'
  other_conc_time_uncleanable_list_means$tick <- 1:335
  names(other_conc_time_uncleanable_list_means) <- c('concentration', 'category', 'dual_factor', 'tick')
  other_conc_time_uncleanable_list_means$category <- as.factor(other_conc_time_uncleanable_list_means$category)
}

#Cluster Concentration Mid Monday
vector <- list_outputs$cluster_conc_mid_mon_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_mon_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_mon_list_means <- colMeans(cluster_conc_mid_mon_list)
}

#Cluster Concentration Mid Tuesday
vector <- list_outputs$cluster_conc_mid_tue_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_tue_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_tue_list_means <- colMeans(cluster_conc_mid_tue_list)
}

#Cluster Concentration Mid Wednesday
vector <- list_outputs$cluster_conc_mid_wed_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_wed_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_wed_list_means <- colMeans(cluster_conc_mid_wed_list)
}

#Cluster Concentration Mid Thursday
vector <- list_outputs$cluster_conc_mid_thu_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_thu_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_thu_list_means <- colMeans(cluster_conc_mid_thu_list)
}

#Cluster Concentration Mid Friday
vector <- list_outputs$cluster_conc_mid_fri_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_fri_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_fri_list_means <- colMeans(cluster_conc_mid_fri_list)
}

#Cluster Concentration Median Start to Mid Monday
vector <- list_outputs$cluster_conc_mid_mon_median_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_mon_median_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_mon_median_list_medians <- matrixStats::colMedians(cluster_conc_mid_mon_median_list)
}

#Cluster Concentration Median Start to Mid Tuesday
vector <- list_outputs$cluster_conc_mid_tue_median_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_tue_median_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_tue_median_list_medians <- matrixStats::colMedians(cluster_conc_mid_tue_median_list)
}

#Cluster Concentration Median Start to Mid Wednesday
vector <- list_outputs$cluster_conc_mid_wed_median_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_wed_median_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_wed_median_list_medians <- matrixStats::colMedians(cluster_conc_mid_wed_median_list)
}

#Cluster Concentration Median Start to Mid Thursday
vector <- list_outputs$cluster_conc_mid_thu_median_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_thu_median_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_thu_median_list_medians <- matrixStats::colMedians(cluster_conc_mid_thu_median_list)
}

#Cluster Concentration Median Start to Mid Friday
vector <- list_outputs$cluster_conc_mid_fri_median_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_fri_median_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_fri_median_list_medians <- matrixStats::colMedians(cluster_conc_mid_fri_median_list)
}

#Cluster Concentration Mean Start to Mid Monday
vector <- list_outputs$cluster_conc_mid_mon_mean_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_mon_mean_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_mon_mean_list_means <- colMeans(cluster_conc_mid_mon_mean_list)
}

#Cluster Concentration Mean Start to Mid Tuesday
vector <- list_outputs$cluster_conc_mid_tue_mean_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_tue_mean_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_tue_mean_list_means <- colMeans(cluster_conc_mid_tue_mean_list)
}

#Cluster Concentration Mean Start to Mid Wednesday
vector <- list_outputs$cluster_conc_mid_wed_mean_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_wed_mean_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_wed_mean_list_means <- colMeans(cluster_conc_mid_wed_mean_list)
}

#Cluster Concentration Mean Start to Mid Thursday
vector <- list_outputs$cluster_conc_mid_thu_mean_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_thu_mean_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_thu_mean_list_means <- colMeans(cluster_conc_mid_thu_mean_list)
}

#Cluster Concentration Mean Start to Mid Friday
vector <- list_outputs$cluster_conc_mid_fri_mean_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  cluster_conc_mid_fri_mean_list <- do.call('rbind',lapply(vector, vector_splitter))
  cluster_conc_mid_fri_mean_list_means <- colMeans(cluster_conc_mid_fri_mean_list)
}

vector <- NL_table$contacts_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  contacts_list <- do.call('rbind',lapply(vector, vector_splitter))
  contacts_list_medians <- matrixStats::colMedians(contacts_list)
}

vector <- NL_table$transfers_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  transfers_list <- do.call('rbind',lapply(vector, vector_splitter))
  transfers_list_medians <- matrixStats::colMedians(transfers_list)
}

vector <- NL_table$time_contaminated_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  time_contaminated_list <- do.call('rbind',lapply(vector, vector_splitter))
  time_contaminated_list_medians <- matrixStats::colMedians(time_contaminated_list)
}

vector <- NL_table$max_contam_bout_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  max_contam_bout_list <- do.call('rbind',lapply(vector, vector_splitter))
  max_contam_bout_list_medians <- matrixStats::colMedians(max_contam_bout_list)
}

vector <- NL_table$temp_niche_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  temp_niche_list <- do.call('rbind',lapply(vector, vector_splitter))
  temp_niche_list_medians <- matrixStats::colMedians(temp_niche_list)
}

vector <- NL_table$niches_estab_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  niches_estab_list <- do.call('rbind',lapply(vector, vector_splitter))
  niches_estab_list_medians <- matrixStats::colMedians(niches_estab_list)
}

vector <- NL_table$food_cont_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  food_cont_list <- do.call('rbind',lapply(vector, vector_splitter))
  food_cont_list_medians <- matrixStats::colMedians(food_cont_list)
}

vector <- NL_table$zone4_cont_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  zone4_cont_list <- do.call('rbind',lapply(vector, vector_splitter))
  zone4_cont_list_medians <- matrixStats::colMedians(zone4_cont_list)
}

vector <- NL_table$random_cont_list
vector <- vector[vector!='[]']
if (length(vector)>0) {
  random_cont_list <- do.call('rbind',lapply(vector, vector_splitter))
  random_cont_list_medians <- matrixStats::colMedians(random_cont_list)
}
```

```{r Z Category Concentration Plots}
#Rbind
z_category <- rbind(z1_conc_time_list_means,z2_conc_time_list_means,z3_conc_time_list_means)
z_category_cleanable <- rbind(z1_conc_time_cleanable_list_means,z2_conc_time_cleanable_list_means,z3_conc_time_cleanable_list_means)
z_category_uncleanable <- rbind(z1_conc_time_uncleanable_list_means,z2_conc_time_uncleanable_list_means,z3_conc_time_uncleanable_list_means)
z_category_both <- rbind(z_category_cleanable,z_category_uncleanable)
#Plot All
ggplot(data = z_category) +
  geom_point(aes(x=tick, y=concentration, color=category)) +
  xlab('Time (Ticks)') +
  ylab('Concentration (CFU/sq. cm)') +
  ggtitle('Mean Agent Z-Category Comparision')
#Plot Uncleanable
ggplot(data = z_category_uncleanable) +
  geom_point(aes(x=tick, y=concentration, color=category)) +
  xlab('Time (Ticks)') +
  ylab('Concentration (CFU/sq. cm)') +
  ggtitle('Mean Uncleanable Agent Z-Category Comparision')
#Plot Cleanable
ggplot(data = z_category_cleanable) +
  geom_point(aes(x=tick, y=concentration, color=category)) +
  xlab('Time (Ticks)') +
  ylab('Concentration (CFU/sq. cm)') +
  ggtitle('Mean Cleanable Agent Z-Category Comparision')
#Plot Both
ggplot(data = z_category_both) +
  geom_point(aes(x=tick, y=concentration, color=dual_factor)) +
  xlab('Time (Ticks)') +
  ylab('Concentration (CFU/sq. cm)') +
  ggtitle('Mean Agent Z-Category Comparision')
```

```{r Area Concentration Plots}
areas <- rbind(loading_conc_time_list_means, cleaning_conc_time_list_means, drying_conc_time_list_means, sorting_conc_time_list_means, reject_conc_time_list_means, other_conc_time_list_means)
areas_cleanable <- rbind(loading_conc_time_cleanable_list_means, cleaning_conc_time_cleanable_list_means, drying_conc_time_cleanable_list_means, sorting_conc_time_cleanable_list_means, reject_conc_time_cleanable_list_means, other_conc_time_cleanable_list_means)
areas_uncleanable <- rbind(loading_conc_time_uncleanable_list_means, cleaning_conc_time_uncleanable_list_means, drying_conc_time_uncleanable_list_means, sorting_conc_time_uncleanable_list_means, reject_conc_time_uncleanable_list_means, other_conc_time_uncleanable_list_means)
areas_both <- rbind(areas_cleanable,areas_uncleanable)
#Plot All
ggplot(data = areas) +
  geom_point(aes(x=tick, y=concentration, color=category)) +
  xlab('Time (Ticks)') +
  ylab('Concentration (CFU/sq. cm)') +
  ggtitle('Mean Agent Area Comparision')
#Plot Uncleanable
ggplot(data = areas_uncleanable) +
  geom_point(aes(x=tick, y=concentration, color=category)) +
  xlab('Time (Ticks)') +
  ylab('Concentration (CFU/sq. cm)') +
  ggtitle('Mean Uncleanable Agent Area Comparision')
#Plot Cleanable
ggplot(data = areas_cleanable) +
  geom_point(aes(x=tick, y=concentration, color=category)) +
  xlab('Time (Ticks)') +
  ylab('Concentration (CFU/sq. cm)') +
  ggtitle('Mean Cleanable Agent Area Comparision')
#Plot Both
ggplot(data = areas_both) +
  geom_point(aes(x=tick, y=concentration, color=dual_factor)) +
  xlab('Time (Ticks)') +
  ylab('Concentration (CFU/sq. cm)') +
  ggtitle('Mean Agent Area Comparision')
```

```{r Agent Listeria Counts}
if (identical(loading_z1_cleanable_w2wed_count_list, numeric(0))) {
  loading_z1_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  loading_z1_cleanable_w2wed_count_list <- as.data.frame(loading_z1_cleanable_w2wed_count_list)
}
loading_z1_cleanable_w2wed_count_list$area <- as.factor('loading')
loading_z1_cleanable_w2wed_count_list$z <- as.factor('z1')
names(loading_z1_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(cleaning_z1_cleanable_w2wed_count_list, numeric(0))) {
  cleaning_z1_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  cleaning_z1_cleanable_w2wed_count_list <- as.data.frame(cleaning_z1_cleanable_w2wed_count_list)
}
cleaning_z1_cleanable_w2wed_count_list$area <- as.factor('cleaning')
cleaning_z1_cleanable_w2wed_count_list$z <- as.factor('z1')
names(cleaning_z1_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(drying_z1_cleanable_w2wed_count_list, numeric(0))) {
  drying_z1_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  drying_z1_cleanable_w2wed_count_list <- as.data.frame(drying_z1_cleanable_w2wed_count_list)
}
drying_z1_cleanable_w2wed_count_list$area <- as.factor('drying')
drying_z1_cleanable_w2wed_count_list$z <- as.factor('z1')
names(drying_z1_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(drying_z1_cleanable_w2wed_count_list, numeric(0))) {
  sorting_z1_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  sorting_z1_cleanable_w2wed_count_list <- as.data.frame(sorting_z1_cleanable_w2wed_count_list)
}
sorting_z1_cleanable_w2wed_count_list$area <- as.factor('sorting')
sorting_z1_cleanable_w2wed_count_list$z <- as.factor('z1')
names(sorting_z1_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(reject_z1_cleanable_w2wed_count_list, numeric(0))) {
  reject_z1_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  reject_z1_cleanable_w2wed_count_list <- as.data.frame(reject_z1_cleanable_w2wed_count_list)
}
reject_z1_cleanable_w2wed_count_list$area <- as.factor('reject')
reject_z1_cleanable_w2wed_count_list$z <- as.factor('z1')
names(reject_z1_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(other_z1_cleanable_w2wed_count_list, numeric(0))) {
  other_z1_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  other_z1_cleanable_w2wed_count_list <- as.data.frame(other_z1_cleanable_w2wed_count_list)
}
other_z1_cleanable_w2wed_count_list$area <- as.factor('other')
other_z1_cleanable_w2wed_count_list$z <- as.factor('z1')
names(other_z1_cleanable_w2wed_count_list) <- c('count','area','z')

if (identical(loading_z2_cleanable_w2wed_count_list, numeric(0))) {
  loading_z2_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  loading_z2_cleanable_w2wed_count_list <- as.data.frame(loading_z2_cleanable_w2wed_count_list)
}
loading_z2_cleanable_w2wed_count_list$area <- as.factor('loading')
loading_z2_cleanable_w2wed_count_list$z <- as.factor('z2')
names(loading_z2_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(cleaning_z2_cleanable_w2wed_count_list, numeric(0))) {
  cleaning_z2_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  cleaning_z2_cleanable_w2wed_count_list <- as.data.frame(cleaning_z2_cleanable_w2wed_count_list)
}
cleaning_z2_cleanable_w2wed_count_list$area <- as.factor('cleaning')
cleaning_z2_cleanable_w2wed_count_list$z <- as.factor('z2')
names(cleaning_z2_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(drying_z2_cleanable_w2wed_count_list, numeric(0))) {
  drying_z2_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  drying_z2_cleanable_w2wed_count_list <- as.data.frame(drying_z2_cleanable_w2wed_count_list)
}
drying_z2_cleanable_w2wed_count_list$area <- as.factor('drying')
drying_z2_cleanable_w2wed_count_list$z <- as.factor('z2')
names(drying_z2_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(sorting_z2_cleanable_w2wed_count_list, numeric(0))) {
  sorting_z2_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  sorting_z2_cleanable_w2wed_count_list <- as.data.frame(sorting_z2_cleanable_w2wed_count_list)
}
sorting_z2_cleanable_w2wed_count_list$area <- as.factor('sorting')
sorting_z2_cleanable_w2wed_count_list$z <- as.factor('z2')
names(sorting_z2_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(reject_z2_cleanable_w2wed_count_list, numeric(0))) {
  reject_z2_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  reject_z2_cleanable_w2wed_count_list <- as.data.frame(reject_z2_cleanable_w2wed_count_list)
}
reject_z2_cleanable_w2wed_count_list$area <- as.factor('reject')
reject_z2_cleanable_w2wed_count_list$z <- as.factor('z2')
names(reject_z2_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(other_z2_cleanable_w2wed_count_list, numeric(0))) {
  other_z2_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  other_z2_cleanable_w2wed_count_list <- as.data.frame(other_z2_cleanable_w2wed_count_list)
}
other_z2_cleanable_w2wed_count_list$area <- as.factor('other')
other_z2_cleanable_w2wed_count_list$z <- as.factor('z2')
names(other_z2_cleanable_w2wed_count_list) <- c('count','area','z')

if (identical(loading_z3_cleanable_w2wed_count_list, numeric(0))) {
  loading_z3_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  loading_z3_cleanable_w2wed_count_list <- as.data.frame(loading_z3_cleanable_w2wed_count_list)
}
loading_z3_cleanable_w2wed_count_list$area <- as.factor('loading')
loading_z3_cleanable_w2wed_count_list$z <- as.factor('z3')
names(loading_z3_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(cleaning_z3_cleanable_w2wed_count_list, numeric(0))) {
  cleaning_z3_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  cleaning_z3_cleanable_w2wed_count_list <- as.data.frame(cleaning_z3_cleanable_w2wed_count_list)
}
cleaning_z3_cleanable_w2wed_count_list$area <- as.factor('cleaning')
cleaning_z3_cleanable_w2wed_count_list$z <- as.factor('z3')
names(cleaning_z3_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(drying_z3_cleanable_w2wed_count_list, numeric(0))) {
  drying_z3_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  drying_z3_cleanable_w2wed_count_list <- as.data.frame(drying_z3_cleanable_w2wed_count_list)
}
drying_z3_cleanable_w2wed_count_list$area <- as.factor('drying')
drying_z3_cleanable_w2wed_count_list$z <- as.factor('z3')
names(drying_z3_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(sorting_z3_cleanable_w2wed_count_list, numeric(0))) {
  sorting_z3_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  sorting_z3_cleanable_w2wed_count_list <- as.data.frame(sorting_z3_cleanable_w2wed_count_list)
}
sorting_z3_cleanable_w2wed_count_list$area <- as.factor('sorting')
sorting_z3_cleanable_w2wed_count_list$z <- as.factor('z3')
names(sorting_z3_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(reject_z3_cleanable_w2wed_count_list, numeric(0))) {
  reject_z3_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  reject_z3_cleanable_w2wed_count_list <- as.data.frame(reject_z3_cleanable_w2wed_count_list)
}
reject_z3_cleanable_w2wed_count_list$area <- as.factor('reject')
reject_z3_cleanable_w2wed_count_list$z <- as.factor('z3')
names(reject_z3_cleanable_w2wed_count_list) <- c('count','area','z')
if (identical(other_z3_cleanable_w2wed_count_list, numeric(0))) {
  other_z3_cleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  other_z3_cleanable_w2wed_count_list <- as.data.frame(other_z3_cleanable_w2wed_count_list)
}
other_z3_cleanable_w2wed_count_list$area <- as.factor('other')
other_z3_cleanable_w2wed_count_list$z <- as.factor('z3')
names(other_z3_cleanable_w2wed_count_list) <- c('count','area','z')

if (identical(loading_z1_uncleanable_w2wed_count_list, numeric(0))) {
  loading_z1_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  loading_z1_uncleanable_w2wed_count_list <- as.data.frame(loading_z1_uncleanable_w2wed_count_list)
}
loading_z1_uncleanable_w2wed_count_list$area <- as.factor('loading')
loading_z1_uncleanable_w2wed_count_list$z <- as.factor('z1')
names(loading_z1_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(cleaning_z1_uncleanable_w2wed_count_list, numeric(0))) {
  cleaning_z1_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  cleaning_z1_uncleanable_w2wed_count_list <- as.data.frame(cleaning_z1_uncleanable_w2wed_count_list)
}
cleaning_z1_uncleanable_w2wed_count_list$area <- as.factor('cleaning')
cleaning_z1_uncleanable_w2wed_count_list$z <- as.factor('z1')
names(cleaning_z1_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(drying_z1_uncleanable_w2wed_count_list, numeric(0))) {
  drying_z1_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  drying_z1_uncleanable_w2wed_count_list <- as.data.frame(drying_z1_uncleanable_w2wed_count_list)
}
drying_z1_uncleanable_w2wed_count_list$area <- as.factor('drying')
drying_z1_uncleanable_w2wed_count_list$z <- as.factor('z1')
names(drying_z1_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(sorting_z1_uncleanable_w2wed_count_list, numeric(0))) {
  sorting_z1_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  sorting_z1_uncleanable_w2wed_count_list <- as.data.frame(sorting_z1_uncleanable_w2wed_count_list)
}
sorting_z1_uncleanable_w2wed_count_list$area <- as.factor('sorting')
sorting_z1_uncleanable_w2wed_count_list$z <- as.factor('z1')
names(sorting_z1_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(reject_z1_uncleanable_w2wed_count_list, numeric(0))) {
  reject_z1_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  reject_z1_uncleanable_w2wed_count_list <- as.data.frame(reject_z1_uncleanable_w2wed_count_list)
}
reject_z1_uncleanable_w2wed_count_list$area <- as.factor('reject')
reject_z1_uncleanable_w2wed_count_list$z <- as.factor('z1')
names(reject_z1_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(other_z1_uncleanable_w2wed_count_list, numeric(0))) {
  other_z1_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  other_z1_uncleanable_w2wed_count_list <- as.data.frame(other_z1_uncleanable_w2wed_count_list)
}
other_z1_uncleanable_w2wed_count_list$area <- as.factor('other')
other_z1_uncleanable_w2wed_count_list$z <- as.factor('z1')
names(other_z1_uncleanable_w2wed_count_list) <- c('count','area','z')

if (identical(loading_z2_uncleanable_w2wed_count_list, numeric(0))) {
  loading_z2_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  loading_z2_uncleanable_w2wed_count_list <- as.data.frame(loading_z2_uncleanable_w2wed_count_list)
}
loading_z2_uncleanable_w2wed_count_list$area <- as.factor('loading')
loading_z2_uncleanable_w2wed_count_list$z <- as.factor('z2')
names(loading_z2_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(cleaning_z2_uncleanable_w2wed_count_list, numeric(0))) {
  cleaning_z2_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  cleaning_z2_uncleanable_w2wed_count_list <- as.data.frame(cleaning_z2_uncleanable_w2wed_count_list)
}
cleaning_z2_uncleanable_w2wed_count_list$area <- as.factor('cleaning')
cleaning_z2_uncleanable_w2wed_count_list$z <- as.factor('z2')
names(cleaning_z2_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(drying_z2_uncleanable_w2wed_count_list, numeric(0))) {
  drying_z2_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  drying_z2_uncleanable_w2wed_count_list <- as.data.frame(drying_z2_uncleanable_w2wed_count_list)
}
drying_z2_uncleanable_w2wed_count_list$area <- as.factor('drying')
drying_z2_uncleanable_w2wed_count_list$z <- as.factor('z2')
names(drying_z2_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(sorting_z2_uncleanable_w2wed_count_list, numeric(0))) {
  sorting_z2_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  sorting_z2_uncleanable_w2wed_count_list <- as.data.frame(sorting_z2_uncleanable_w2wed_count_list)
}
sorting_z2_uncleanable_w2wed_count_list$area <- as.factor('sorting')
sorting_z2_uncleanable_w2wed_count_list$z <- as.factor('z2')
names(sorting_z2_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(reject_z2_uncleanable_w2wed_count_list, numeric(0))) {
  reject_z2_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  reject_z2_uncleanable_w2wed_count_list <- as.data.frame(reject_z2_uncleanable_w2wed_count_list)
}
reject_z2_uncleanable_w2wed_count_list$area <- as.factor('reject')
reject_z2_uncleanable_w2wed_count_list$z <- as.factor('z2')
names(reject_z2_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(other_z2_uncleanable_w2wed_count_list, numeric(0))) {
  other_z2_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  other_z2_uncleanable_w2wed_count_list <- as.data.frame(other_z2_uncleanable_w2wed_count_list)
}
other_z2_uncleanable_w2wed_count_list$area <- as.factor('other')
other_z2_uncleanable_w2wed_count_list$z <- as.factor('z2')
names(other_z2_uncleanable_w2wed_count_list) <- c('count','area','z')

if (identical(loading_z3_uncleanable_w2wed_count_list, numeric(0))) {
  loading_z3_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  loading_z3_uncleanable_w2wed_count_list <- as.data.frame(loading_z3_uncleanable_w2wed_count_list)
}
loading_z3_uncleanable_w2wed_count_list$area <- as.factor('loading')
loading_z3_uncleanable_w2wed_count_list$z <- as.factor('z3')
names(loading_z3_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(cleaning_z3_uncleanable_w2wed_count_list, numeric(0))) {
  cleaning_z3_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  cleaning_z3_uncleanable_w2wed_count_list <- as.data.frame(cleaning_z3_uncleanable_w2wed_count_list)
}
cleaning_z3_uncleanable_w2wed_count_list$area <- as.factor('cleaning')
cleaning_z3_uncleanable_w2wed_count_list$z <- as.factor('z3')
names(cleaning_z3_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(drying_z3_uncleanable_w2wed_count_list, numeric(0))) {
  drying_z3_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  drying_z3_uncleanable_w2wed_count_list <- as.data.frame(drying_z3_uncleanable_w2wed_count_list)
}
drying_z3_uncleanable_w2wed_count_list$area <- as.factor('drying')
drying_z3_uncleanable_w2wed_count_list$z <- as.factor('z3')
names(drying_z3_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(sorting_z3_uncleanable_w2wed_count_list, numeric(0))) {
  sorting_z3_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  sorting_z3_uncleanable_w2wed_count_list <- as.data.frame(sorting_z3_uncleanable_w2wed_count_list)
}
sorting_z3_uncleanable_w2wed_count_list$area <- as.factor('sorting')
sorting_z3_uncleanable_w2wed_count_list$z <- as.factor('z3')
names(sorting_z3_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(reject_z3_uncleanable_w2wed_count_list, numeric(0))) {
  reject_z3_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  reject_z3_uncleanable_w2wed_count_list <- as.data.frame(reject_z3_uncleanable_w2wed_count_list)
}
reject_z3_uncleanable_w2wed_count_list$area <- as.factor('reject')
reject_z3_uncleanable_w2wed_count_list$z <- as.factor('z3')
names(reject_z3_uncleanable_w2wed_count_list) <- c('count','area','z')
if (identical(other_z3_uncleanable_w2wed_count_list, numeric(0))) {
  other_z3_uncleanable_w2wed_count_list <- as.data.frame(NA)
} else {
  other_z3_uncleanable_w2wed_count_list <- as.data.frame(other_z3_uncleanable_w2wed_count_list)
}
other_z3_uncleanable_w2wed_count_list$area <- as.factor('other')
other_z3_uncleanable_w2wed_count_list$z <- as.factor('z3')
names(other_z3_uncleanable_w2wed_count_list) <- c('count','area','z')

NL_table_w2wed_cleanable_count <- rbind(loading_z1_cleanable_w2wed_count_list,cleaning_z1_cleanable_w2wed_count_list,drying_z1_cleanable_w2wed_count_list,sorting_z1_cleanable_w2wed_count_list,reject_z1_cleanable_w2wed_count_list,other_z1_cleanable_w2wed_count_list,loading_z2_cleanable_w2wed_count_list,cleaning_z2_cleanable_w2wed_count_list,drying_z2_cleanable_w2wed_count_list,sorting_z2_cleanable_w2wed_count_list,reject_z2_cleanable_w2wed_count_list,other_z2_cleanable_w2wed_count_list,loading_z3_cleanable_w2wed_count_list,cleaning_z3_cleanable_w2wed_count_list,drying_z3_cleanable_w2wed_count_list,sorting_z3_cleanable_w2wed_count_list,reject_z3_cleanable_w2wed_count_list,other_z3_cleanable_w2wed_count_list)

NL_table_w2wed_cleanable_count_wet <- rbind(loading_z1_cleanable_w2wed_count_list,cleaning_z1_cleanable_w2wed_count_list,loading_z2_cleanable_w2wed_count_list,cleaning_z2_cleanable_w2wed_count_list,loading_z3_cleanable_w2wed_count_list,cleaning_z3_cleanable_w2wed_count_list)
NL_table_w2wed_cleanable_count_wet$water <- as.factor('wet')

NL_table_w2wed_cleanable_count_dry <- rbind(sorting_z1_cleanable_w2wed_count_list,reject_z1_cleanable_w2wed_count_list,other_z1_cleanable_w2wed_count_list,sorting_z2_cleanable_w2wed_count_list,reject_z2_cleanable_w2wed_count_list,other_z2_cleanable_w2wed_count_list,sorting_z3_cleanable_w2wed_count_list,reject_z3_cleanable_w2wed_count_list,other_z3_cleanable_w2wed_count_list)
NL_table_w2wed_cleanable_count_dry$water <- as.factor('dry')

NL_table_w2wed_cleanable_count_mixed <- rbind(drying_z1_cleanable_w2wed_count_list,drying_z2_cleanable_w2wed_count_list,drying_z3_cleanable_w2wed_count_list)
NL_table_w2wed_cleanable_count_mixed$water <- as.factor('mixed')

NL_table_w2wed_uncleanable_count <- rbind(loading_z1_uncleanable_w2wed_count_list,cleaning_z1_uncleanable_w2wed_count_list,drying_z1_uncleanable_w2wed_count_list,sorting_z1_uncleanable_w2wed_count_list,reject_z1_uncleanable_w2wed_count_list,other_z1_uncleanable_w2wed_count_list,loading_z2_uncleanable_w2wed_count_list,cleaning_z2_uncleanable_w2wed_count_list,drying_z2_uncleanable_w2wed_count_list,sorting_z2_uncleanable_w2wed_count_list,reject_z2_uncleanable_w2wed_count_list,other_z2_uncleanable_w2wed_count_list,loading_z3_uncleanable_w2wed_count_list,cleaning_z3_uncleanable_w2wed_count_list,drying_z3_uncleanable_w2wed_count_list,sorting_z3_uncleanable_w2wed_count_list,reject_z3_uncleanable_w2wed_count_list,other_z3_uncleanable_w2wed_count_list)

NL_table_w2wed_uncleanable_count_wet <- rbind(loading_z1_uncleanable_w2wed_count_list,cleaning_z1_uncleanable_w2wed_count_list,loading_z2_uncleanable_w2wed_count_list,cleaning_z2_uncleanable_w2wed_count_list,loading_z3_uncleanable_w2wed_count_list,cleaning_z3_uncleanable_w2wed_count_list)
NL_table_w2wed_uncleanable_count_wet$water <- as.factor('wet')

NL_table_w2wed_uncleanable_count_dry <- rbind(sorting_z1_uncleanable_w2wed_count_list,reject_z1_uncleanable_w2wed_count_list,other_z1_uncleanable_w2wed_count_list,sorting_z2_uncleanable_w2wed_count_list,reject_z2_uncleanable_w2wed_count_list,other_z2_uncleanable_w2wed_count_list,sorting_z3_uncleanable_w2wed_count_list,reject_z3_uncleanable_w2wed_count_list,other_z3_uncleanable_w2wed_count_list)
NL_table_w2wed_uncleanable_count_dry$water <- as.factor('dry')

NL_table_w2wed_uncleanable_count_mixed <- rbind(drying_z1_uncleanable_w2wed_count_list,drying_z2_uncleanable_w2wed_count_list,drying_z3_uncleanable_w2wed_count_list)
NL_table_w2wed_uncleanable_count_mixed$water <- as.factor('mixed')

ggplot(NL_table_w2wed_cleanable_count, aes(x=area, y=count, fill=z)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Count (CFU)') +
  ggtitle('Cleanable Agent Counts')

ggplot(NL_table_w2wed_uncleanable_count, aes(x=area, y=count, fill=z)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Count (CFU)') +
  ggtitle('Uncleanable Agent Counts')

ggplot(rbind(NL_table_w2wed_cleanable_count,NL_table_w2wed_uncleanable_count), aes(x=area, y=count, fill=z)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Count (CFU)') +
  ggtitle('All Agent Counts')

ggplot(rbind(NL_table_w2wed_cleanable_count_wet,NL_table_w2wed_cleanable_count_dry,NL_table_w2wed_cleanable_count_mixed), aes(x=water, y=count, fill=z)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Count (CFU)') +
  ggtitle('Cleanable Agent Counts')

ggplot(rbind(NL_table_w2wed_uncleanable_count_wet,NL_table_w2wed_uncleanable_count_dry,NL_table_w2wed_uncleanable_count_mixed), aes(x=water, y=count, fill=z)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Count (CFU)') +
  ggtitle('Uncleanable Agent Counts')

ggplot(rbind(NL_table_w2wed_cleanable_count_wet,NL_table_w2wed_cleanable_count_dry,NL_table_w2wed_cleanable_count_mixed,NL_table_w2wed_uncleanable_count_wet,NL_table_w2wed_uncleanable_count_dry,NL_table_w2wed_uncleanable_count_mixed), aes(x=water, y=count, fill=z)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Count (CFU)') +
  ggtitle('All Agent Counts')

ggplot(rbind(NL_table_w2wed_cleanable_count_wet,NL_table_w2wed_cleanable_count_dry,NL_table_w2wed_cleanable_count_mixed,NL_table_w2wed_uncleanable_count_wet,NL_table_w2wed_uncleanable_count_dry,NL_table_w2wed_uncleanable_count_mixed), aes(x=water, y=log10(count), fill=z)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Count (CFU)') +
  ggtitle('Log10 All Agent Counts')
```

```{r Agent Listeria Concentrations}
if (identical(loading_z1_cleanable_w2wed_conc_list, numeric(0))) {
  loading_z1_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  loading_z1_cleanable_w2wed_conc_list <- as.data.frame(loading_z1_cleanable_w2wed_conc_list)
}
loading_z1_cleanable_w2wed_conc_list$area <- as.factor('loading')
loading_z1_cleanable_w2wed_conc_list$z <- as.factor('z1')
names(loading_z1_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(cleaning_z1_cleanable_w2wed_conc_list, numeric(0))) {
  cleaning_z1_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  cleaning_z1_cleanable_w2wed_conc_list <- as.data.frame(cleaning_z1_cleanable_w2wed_conc_list)
}
cleaning_z1_cleanable_w2wed_conc_list$area <- as.factor('cleaning')
cleaning_z1_cleanable_w2wed_conc_list$z <- as.factor('z1')
names(cleaning_z1_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(drying_z1_cleanable_w2wed_conc_list, numeric(0))) {
  drying_z1_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  drying_z1_cleanable_w2wed_conc_list <- as.data.frame(drying_z1_cleanable_w2wed_conc_list)
}
drying_z1_cleanable_w2wed_conc_list$area <- as.factor('drying')
drying_z1_cleanable_w2wed_conc_list$z <- as.factor('z1')
names(drying_z1_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(sorting_z1_cleanable_w2wed_conc_list, numeric(0))) {
  sorting_z1_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  sorting_z1_cleanable_w2wed_conc_list <- as.data.frame(sorting_z1_cleanable_w2wed_conc_list)
}
sorting_z1_cleanable_w2wed_conc_list$area <- as.factor('sorting')
sorting_z1_cleanable_w2wed_conc_list$z <- as.factor('z1')
names(sorting_z1_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(reject_z1_cleanable_w2wed_conc_list, numeric(0))) {
  reject_z1_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  reject_z1_cleanable_w2wed_conc_list <- as.data.frame(reject_z1_cleanable_w2wed_conc_list)
}
reject_z1_cleanable_w2wed_conc_list$area <- as.factor('reject')
reject_z1_cleanable_w2wed_conc_list$z <- as.factor('z1')
names(reject_z1_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(other_z1_cleanable_w2wed_conc_list, numeric(0))) {
  other_z1_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  other_z1_cleanable_w2wed_conc_list <- as.data.frame(other_z1_cleanable_w2wed_conc_list)
}
other_z1_cleanable_w2wed_conc_list$area <- as.factor('other')
other_z1_cleanable_w2wed_conc_list$z <- as.factor('z1')
names(other_z1_cleanable_w2wed_conc_list) <- c('conc','area','z')

if (identical(loading_z2_cleanable_w2wed_conc_list, numeric(0))) {
  loading_z2_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  loading_z2_cleanable_w2wed_conc_list <- as.data.frame(loading_z2_cleanable_w2wed_conc_list)
}
loading_z2_cleanable_w2wed_conc_list$area <- as.factor('loading')
loading_z2_cleanable_w2wed_conc_list$z <- as.factor('z2')
names(loading_z2_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(cleaning_z2_cleanable_w2wed_conc_list, numeric(0))) {
  cleaning_z2_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  cleaning_z2_cleanable_w2wed_conc_list <- as.data.frame(cleaning_z2_cleanable_w2wed_conc_list)
}
cleaning_z2_cleanable_w2wed_conc_list$area <- as.factor('cleaning')
cleaning_z2_cleanable_w2wed_conc_list$z <- as.factor('z2')
names(cleaning_z2_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(drying_z2_cleanable_w2wed_conc_list, numeric(0))) {
  drying_z2_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  drying_z2_cleanable_w2wed_conc_list <- as.data.frame(drying_z2_cleanable_w2wed_conc_list)
}
drying_z2_cleanable_w2wed_conc_list$area <- as.factor('drying')
drying_z2_cleanable_w2wed_conc_list$z <- as.factor('z2')
names(drying_z2_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(sorting_z2_cleanable_w2wed_conc_list, numeric(0))) {
  sorting_z2_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  sorting_z2_cleanable_w2wed_conc_list <- as.data.frame(sorting_z2_cleanable_w2wed_conc_list)
}
sorting_z2_cleanable_w2wed_conc_list$area <- as.factor('sorting')
sorting_z2_cleanable_w2wed_conc_list$z <- as.factor('z2')
names(sorting_z2_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(reject_z2_cleanable_w2wed_conc_list, numeric(0))) {
  reject_z2_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  reject_z2_cleanable_w2wed_conc_list <- as.data.frame(reject_z2_cleanable_w2wed_conc_list)
}
reject_z2_cleanable_w2wed_conc_list$area <- as.factor('reject')
reject_z2_cleanable_w2wed_conc_list$z <- as.factor('z2')
names(reject_z2_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(other_z2_cleanable_w2wed_conc_list, numeric(0))) {
  other_z2_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  other_z2_cleanable_w2wed_conc_list <- as.data.frame(other_z2_cleanable_w2wed_conc_list)
}
other_z2_cleanable_w2wed_conc_list$area <- as.factor('other')
other_z2_cleanable_w2wed_conc_list$z <- as.factor('z2')
names(other_z2_cleanable_w2wed_conc_list) <- c('conc','area','z')

if (identical(loading_z3_cleanable_w2wed_conc_list, numeric(0))) {
  loading_z3_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  loading_z3_cleanable_w2wed_conc_list <- as.data.frame(loading_z3_cleanable_w2wed_conc_list)
}
loading_z3_cleanable_w2wed_conc_list$area <- as.factor('loading')
loading_z3_cleanable_w2wed_conc_list$z <- as.factor('z3')
names(loading_z3_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(cleaning_z3_cleanable_w2wed_conc_list, numeric(0))) {
  cleaning_z3_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  cleaning_z3_cleanable_w2wed_conc_list <- as.data.frame(cleaning_z3_cleanable_w2wed_conc_list)
}
cleaning_z3_cleanable_w2wed_conc_list$area <- as.factor('cleaning')
cleaning_z3_cleanable_w2wed_conc_list$z <- as.factor('z3')
names(cleaning_z3_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(drying_z3_cleanable_w2wed_conc_list, numeric(0))) {
  drying_z3_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  drying_z3_cleanable_w2wed_conc_list <- as.data.frame(drying_z3_cleanable_w2wed_conc_list)
}
drying_z3_cleanable_w2wed_conc_list$area <- as.factor('drying')
drying_z3_cleanable_w2wed_conc_list$z <- as.factor('z3')
names(drying_z3_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(sorting_z3_cleanable_w2wed_conc_list, numeric(0))) {
  sorting_z3_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  sorting_z3_cleanable_w2wed_conc_list <- as.data.frame(sorting_z3_cleanable_w2wed_conc_list)
}
sorting_z3_cleanable_w2wed_conc_list$area <- as.factor('sorting')
sorting_z3_cleanable_w2wed_conc_list$z <- as.factor('z3')
names(sorting_z3_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(reject_z3_cleanable_w2wed_conc_list, numeric(0))) {
  reject_z3_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  reject_z3_cleanable_w2wed_conc_list <- as.data.frame(reject_z3_cleanable_w2wed_conc_list)
}
reject_z3_cleanable_w2wed_conc_list$area <- as.factor('reject')
reject_z3_cleanable_w2wed_conc_list$z <- as.factor('z3')
names(reject_z3_cleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(other_z3_cleanable_w2wed_conc_list, numeric(0))) {
  other_z3_cleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  other_z3_cleanable_w2wed_conc_list <- as.data.frame(other_z3_cleanable_w2wed_conc_list)
}
other_z3_cleanable_w2wed_conc_list$area <- as.factor('other')
other_z3_cleanable_w2wed_conc_list$z <- as.factor('z3')
names(other_z3_cleanable_w2wed_conc_list) <- c('conc','area','z')

if (identical(loading_z1_uncleanable_w2wed_conc_list, numeric(0))) {
  loading_z1_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  loading_z1_uncleanable_w2wed_conc_list <- as.data.frame(loading_z1_uncleanable_w2wed_conc_list)
}
loading_z1_uncleanable_w2wed_conc_list$area <- as.factor('loading')
loading_z1_uncleanable_w2wed_conc_list$z <- as.factor('z1')
names(loading_z1_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(cleaning_z1_uncleanable_w2wed_conc_list, numeric(0))) {
  cleaning_z1_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  cleaning_z1_uncleanable_w2wed_conc_list <- as.data.frame(cleaning_z1_uncleanable_w2wed_conc_list)
}
cleaning_z1_uncleanable_w2wed_conc_list$area <- as.factor('cleaning')
cleaning_z1_uncleanable_w2wed_conc_list$z <- as.factor('z1')
names(cleaning_z1_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(drying_z1_uncleanable_w2wed_conc_list, numeric(0))) {
  drying_z1_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  drying_z1_uncleanable_w2wed_conc_list <- as.data.frame(drying_z1_uncleanable_w2wed_conc_list)
}
drying_z1_uncleanable_w2wed_conc_list$area <- as.factor('drying')
drying_z1_uncleanable_w2wed_conc_list$z <- as.factor('z1')
names(drying_z1_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(sorting_z1_uncleanable_w2wed_conc_list, numeric(0))) {
  sorting_z1_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  sorting_z1_uncleanable_w2wed_conc_list <- as.data.frame(sorting_z1_uncleanable_w2wed_conc_list)
}
sorting_z1_uncleanable_w2wed_conc_list$area <- as.factor('sorting')
sorting_z1_uncleanable_w2wed_conc_list$z <- as.factor('z1')
names(sorting_z1_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(reject_z1_uncleanable_w2wed_conc_list, numeric(0))) {
  reject_z1_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  reject_z1_uncleanable_w2wed_conc_list <- as.data.frame(reject_z1_uncleanable_w2wed_conc_list)
}
reject_z1_uncleanable_w2wed_conc_list$area <- as.factor('reject')
reject_z1_uncleanable_w2wed_conc_list$z <- as.factor('z1')
names(reject_z1_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(other_z1_uncleanable_w2wed_conc_list, numeric(0))) {
  other_z1_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  other_z1_uncleanable_w2wed_conc_list <- as.data.frame(other_z1_uncleanable_w2wed_conc_list)
}
other_z1_uncleanable_w2wed_conc_list$area <- as.factor('other')
other_z1_uncleanable_w2wed_conc_list$z <- as.factor('z1')
names(other_z1_uncleanable_w2wed_conc_list) <- c('conc','area','z')

if (identical(loading_z2_uncleanable_w2wed_conc_list, numeric(0))) {
  loading_z2_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  loading_z2_uncleanable_w2wed_conc_list <- as.data.frame(loading_z2_uncleanable_w2wed_conc_list)
}
loading_z2_uncleanable_w2wed_conc_list$area <- as.factor('loading')
loading_z2_uncleanable_w2wed_conc_list$z <- as.factor('z2')
names(loading_z2_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(cleaning_z2_uncleanable_w2wed_conc_list, numeric(0))) {
  cleaning_z2_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  cleaning_z2_uncleanable_w2wed_conc_list <- as.data.frame(cleaning_z2_uncleanable_w2wed_conc_list)
}
cleaning_z2_uncleanable_w2wed_conc_list$area <- as.factor('cleaning')
cleaning_z2_uncleanable_w2wed_conc_list$z <- as.factor('z2')
names(cleaning_z2_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(drying_z2_uncleanable_w2wed_conc_list, numeric(0))) {
  drying_z2_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  drying_z2_uncleanable_w2wed_conc_list <- as.data.frame(drying_z2_uncleanable_w2wed_conc_list)
}
drying_z2_uncleanable_w2wed_conc_list$area <- as.factor('drying')
drying_z2_uncleanable_w2wed_conc_list$z <- as.factor('z2')
names(drying_z2_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(sorting_z2_uncleanable_w2wed_conc_list, numeric(0))) {
  sorting_z2_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  sorting_z2_uncleanable_w2wed_conc_list <- as.data.frame(sorting_z2_uncleanable_w2wed_conc_list)
}
sorting_z2_uncleanable_w2wed_conc_list$area <- as.factor('sorting')
sorting_z2_uncleanable_w2wed_conc_list$z <- as.factor('z2')
names(sorting_z2_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(reject_z2_uncleanable_w2wed_conc_list, numeric(0))) {
  reject_z2_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  reject_z2_uncleanable_w2wed_conc_list <- as.data.frame(reject_z2_uncleanable_w2wed_conc_list)
}
reject_z2_uncleanable_w2wed_conc_list$area <- as.factor('reject')
reject_z2_uncleanable_w2wed_conc_list$z <- as.factor('z2')
names(reject_z2_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(other_z2_uncleanable_w2wed_conc_list, numeric(0))) {
  other_z2_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  other_z2_uncleanable_w2wed_conc_list <- as.data.frame(other_z2_uncleanable_w2wed_conc_list)
}
other_z2_uncleanable_w2wed_conc_list$area <- as.factor('other')
other_z2_uncleanable_w2wed_conc_list$z <- as.factor('z2')
names(other_z2_uncleanable_w2wed_conc_list) <- c('conc','area','z')

if (identical(loading_z3_uncleanable_w2wed_conc_list, numeric(0))) {
  loading_z3_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  loading_z3_uncleanable_w2wed_conc_list <- as.data.frame(loading_z3_uncleanable_w2wed_conc_list)
}
loading_z3_uncleanable_w2wed_conc_list$area <- as.factor('loading')
loading_z3_uncleanable_w2wed_conc_list$z <- as.factor('z3')
names(loading_z3_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(cleaning_z3_uncleanable_w2wed_conc_list, numeric(0))) {
  cleaning_z3_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  cleaning_z3_uncleanable_w2wed_conc_list <- as.data.frame(cleaning_z3_uncleanable_w2wed_conc_list)
}
cleaning_z3_uncleanable_w2wed_conc_list$area <- as.factor('cleaning')
cleaning_z3_uncleanable_w2wed_conc_list$z <- as.factor('z3')
names(cleaning_z3_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(drying_z3_uncleanable_w2wed_conc_list, numeric(0))) {
  drying_z3_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  drying_z3_uncleanable_w2wed_conc_list <- as.data.frame(drying_z3_uncleanable_w2wed_conc_list)
}
drying_z3_uncleanable_w2wed_conc_list$area <- as.factor('drying')
drying_z3_uncleanable_w2wed_conc_list$z <- as.factor('z3')
names(drying_z3_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(sorting_z3_uncleanable_w2wed_conc_list, numeric(0))) {
  sorting_z3_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  sorting_z3_uncleanable_w2wed_conc_list <- as.data.frame(sorting_z3_uncleanable_w2wed_conc_list)
}
sorting_z3_uncleanable_w2wed_conc_list$area <- as.factor('sorting')
sorting_z3_uncleanable_w2wed_conc_list$z <- as.factor('z3')
names(sorting_z3_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(reject_z3_uncleanable_w2wed_conc_list, numeric(0))) {
  reject_z3_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  reject_z3_uncleanable_w2wed_conc_list <- as.data.frame(reject_z3_uncleanable_w2wed_conc_list)
}
reject_z3_uncleanable_w2wed_conc_list$area <- as.factor('reject')
reject_z3_uncleanable_w2wed_conc_list$z <- as.factor('z3')
names(reject_z3_uncleanable_w2wed_conc_list) <- c('conc','area','z')
if (identical(other_z3_uncleanable_w2wed_conc_list, numeric(0))) {
  other_z3_uncleanable_w2wed_conc_list <- as.data.frame(NA)
} else {
  other_z3_uncleanable_w2wed_conc_list <- as.data.frame(other_z3_uncleanable_w2wed_conc_list)
}
other_z3_uncleanable_w2wed_conc_list$area <- as.factor('other')
other_z3_uncleanable_w2wed_conc_list$z <- as.factor('z3')
names(other_z3_uncleanable_w2wed_conc_list) <- c('conc','area','z')

NL_table_w2wed_cleanable_conc <- rbind(loading_z1_cleanable_w2wed_conc_list,cleaning_z1_cleanable_w2wed_conc_list,drying_z1_cleanable_w2wed_conc_list,sorting_z1_cleanable_w2wed_conc_list,reject_z1_cleanable_w2wed_conc_list,other_z1_cleanable_w2wed_conc_list,loading_z2_cleanable_w2wed_conc_list,cleaning_z2_cleanable_w2wed_conc_list,drying_z2_cleanable_w2wed_conc_list,sorting_z2_cleanable_w2wed_conc_list,reject_z2_cleanable_w2wed_conc_list,other_z2_cleanable_w2wed_conc_list,loading_z3_cleanable_w2wed_conc_list,cleaning_z3_cleanable_w2wed_conc_list,drying_z3_cleanable_w2wed_conc_list,sorting_z3_cleanable_w2wed_conc_list,reject_z3_cleanable_w2wed_conc_list,other_z3_cleanable_w2wed_conc_list)

NL_table_w2wed_cleanable_conc_wet <- rbind(loading_z1_cleanable_w2wed_conc_list,cleaning_z1_cleanable_w2wed_conc_list,loading_z2_cleanable_w2wed_conc_list,cleaning_z2_cleanable_w2wed_conc_list,loading_z3_cleanable_w2wed_conc_list,cleaning_z3_cleanable_w2wed_conc_list)
NL_table_w2wed_cleanable_conc_wet$water <- as.factor('wet')

NL_table_w2wed_cleanable_conc_dry <- rbind(sorting_z1_cleanable_w2wed_conc_list,reject_z1_cleanable_w2wed_conc_list,other_z1_cleanable_w2wed_conc_list,sorting_z2_cleanable_w2wed_conc_list,reject_z2_cleanable_w2wed_conc_list,other_z2_cleanable_w2wed_conc_list,sorting_z3_cleanable_w2wed_conc_list,reject_z3_cleanable_w2wed_conc_list,other_z3_cleanable_w2wed_conc_list)
NL_table_w2wed_cleanable_conc_dry$water <- as.factor('dry')

NL_table_w2wed_cleanable_conc_dry <- rbind(drying_z1_cleanable_w2wed_conc_list,drying_z2_cleanable_w2wed_conc_list,drying_z3_cleanable_w2wed_conc_list)
NL_table_w2wed_cleanable_conc_dry$water <- as.factor('mixed')

NL_table_w2wed_uncleanable_conc <- rbind(loading_z1_uncleanable_w2wed_conc_list,cleaning_z1_uncleanable_w2wed_conc_list,drying_z1_uncleanable_w2wed_conc_list,sorting_z1_uncleanable_w2wed_conc_list,reject_z1_uncleanable_w2wed_conc_list,other_z1_uncleanable_w2wed_conc_list,loading_z2_uncleanable_w2wed_conc_list,cleaning_z2_uncleanable_w2wed_conc_list,drying_z2_uncleanable_w2wed_conc_list,sorting_z2_uncleanable_w2wed_conc_list,reject_z2_uncleanable_w2wed_conc_list,other_z2_uncleanable_w2wed_conc_list,loading_z3_uncleanable_w2wed_conc_list,cleaning_z3_uncleanable_w2wed_conc_list,drying_z3_uncleanable_w2wed_conc_list,sorting_z3_uncleanable_w2wed_conc_list,reject_z3_uncleanable_w2wed_conc_list,other_z3_uncleanable_w2wed_conc_list)

NL_table_w2wed_uncleanable_conc_wet <- rbind(loading_z1_uncleanable_w2wed_conc_list,cleaning_z1_uncleanable_w2wed_conc_list,loading_z2_uncleanable_w2wed_conc_list,cleaning_z2_uncleanable_w2wed_conc_list,loading_z3_uncleanable_w2wed_conc_list,cleaning_z3_uncleanable_w2wed_conc_list)
NL_table_w2wed_uncleanable_conc_wet$water <- as.factor('wet')

NL_table_w2wed_uncleanable_conc_dry <- rbind(sorting_z1_uncleanable_w2wed_conc_list,reject_z1_uncleanable_w2wed_conc_list,other_z1_uncleanable_w2wed_conc_list,sorting_z2_uncleanable_w2wed_conc_list,reject_z2_uncleanable_w2wed_conc_list,other_z2_uncleanable_w2wed_conc_list,sorting_z3_uncleanable_w2wed_conc_list,reject_z3_uncleanable_w2wed_conc_list,other_z3_uncleanable_w2wed_conc_list)
NL_table_w2wed_uncleanable_conc_dry$water <- as.factor('dry')

NL_table_w2wed_uncleanable_conc_mixed <- rbind(drying_z1_uncleanable_w2wed_conc_list,drying_z2_uncleanable_w2wed_conc_list,drying_z3_uncleanable_w2wed_conc_list)
NL_table_w2wed_uncleanable_conc_mixed$water <- as.factor('mixed')

ggplot(NL_table_w2wed_cleanable_conc, aes(x=area, y=conc, fill=z)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Concentration (CFU/sq. cm)') +
  ggtitle('Cleanable Agent Concentrations')

ggplot(NL_table_w2wed_uncleanable_conc, aes(x=area, y=conc, fill=z)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Concentration (CFU/sq. cm)') +
  ggtitle('Uncleanable Agent Concentrations')

ggplot(rbind(NL_table_w2wed_cleanable_conc,NL_table_w2wed_uncleanable_conc), aes(x=area, y=conc, fill=z)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Concentration (CFU/sq. cm)') +
  ggtitle('All Agent Concentrations')

ggplot(rbind(NL_table_w2wed_cleanable_conc_wet,NL_table_w2wed_cleanable_conc_dry,NL_table_w2wed_cleanable_conc_dry), aes(x=water, y=conc, fill=z)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Concentration (CFU/sq. cm)') +
  ggtitle('Cleanable Agent Concentrations')

ggplot(rbind(NL_table_w2wed_uncleanable_conc_wet,NL_table_w2wed_uncleanable_conc_dry,NL_table_w2wed_uncleanable_conc_mixed), aes(x=water, y=conc, fill=z)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Concentration (CFU/sq. cm)') +
  ggtitle('Uncleanable Agent Concentrations')

ggplot(rbind(NL_table_w2wed_cleanable_conc_wet,NL_table_w2wed_cleanable_conc_dry,NL_table_w2wed_cleanable_conc_dry,NL_table_w2wed_uncleanable_conc_wet,NL_table_w2wed_uncleanable_conc_dry,NL_table_w2wed_uncleanable_conc_mixed), aes(x=water, y=conc, fill=z)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Concentration (CFU/sq. cm)') +
  ggtitle('All Agent Concentrations')

ggplot(rbind(NL_table_w2wed_cleanable_conc_wet,NL_table_w2wed_cleanable_conc_dry,NL_table_w2wed_cleanable_conc_dry,NL_table_w2wed_uncleanable_conc_wet,NL_table_w2wed_uncleanable_conc_dry,NL_table_w2wed_uncleanable_conc_mixed), aes(x=water, y=log10(conc), fill=z)) + 
    geom_boxplot() +
    xlab('Area') +
    ylab('Listeria Concentration Log10(CFU/sq. cm)') +
    ggtitle('Log10 All Agent Concentrations')
```

```{r}
loading_w2wed_prev <- as.data.frame(NL_table$loading_w2wed_prev)
loading_w2wed_prev$area <- as.factor('loading')
names(loading_w2wed_prev) <- c('prev','area')
cleaning_w2wed_prev <- as.data.frame(NL_table$cleaning_w2wed_prev)
cleaning_w2wed_prev$area <- as.factor('cleaning')
names(cleaning_w2wed_prev) <- c('prev','area')
drying_w2wed_prev <- as.data.frame(NL_table$drying_w2wed_prev)
drying_w2wed_prev$area <- as.factor('drying')
names(drying_w2wed_prev) <- c('prev','area')
sorting_w2wed_prev <- as.data.frame(NL_table$sorting_w2wed_prev)
sorting_w2wed_prev$area <- as.factor('sorting')
names(sorting_w2wed_prev) <- c('prev','area')
reject_w2wed_prev <- as.data.frame(NL_table$reject_w2wed_prev)
reject_w2wed_prev$area <- as.factor('reject')
names(reject_w2wed_prev) <- c('prev','area')
other_w2wed_prev <- as.data.frame(NL_table$other_w2wed_prev)
other_w2wed_prev$area <- as.factor('other')
names(other_w2wed_prev) <- c('prev','area')

w2wed_prev_wet <- rbind(loading_w2wed_prev,cleaning_w2wed_prev)
w2wed_prev_wet$water <- as.factor('wet')

w2wed_prev_dry <- rbind(sorting_w2wed_prev,reject_w2wed_prev,other_w2wed_prev)
w2wed_prev_dry$water <- as.factor('dry')

w2wed_prev_mixed <- rbind(drying_w2wed_prev)
w2wed_prev_mixed$water <- as.factor('mixed')

ggplot(rbind(w2wed_prev_wet,w2wed_prev_dry,w2wed_prev_mixed), aes(x=area, y=prev, fill=water)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Prevalence (%)') +
  ggtitle('All Agent Prevalences at Midday Wednesday Week 2')
```

```{r Monday Prevalence Violins}
# #x11()
# # par(mfrow=c(1,3), mar=c(2.5,4,1.5,1))
# layout(matrix(c(1,2,3),1, byrow = TRUE))
# #Monday Z1
# # zone_period_prevalence_z1 <- reshape2::melt(NL_table[, c('m.z1.pre', 'm.z1.beg', 'm.z1.mid', 'm.z1.post')])
# # levels(zone_period_prevalence_z1$variable) <- c('pre-op', 'beginning', 'middle', 'end')
# # names(zone_period_prevalence_z1) <- c('period', 'prevalence')
# # ggplot(zone_period_prevalence_z1, aes(x=period, y=prevalence)) + geom_violin() + geom_jitter(height = 0, width = 0.1) + xlab('Time During Shift') + ylab('Prevalence %')
# 
# plot(1,1,xlim=c(0.5,4.5),ylim=c(0,50),type="n",
#      xlab="",ylab="%",axes=FALSE)
# axis(side=1,at=1:4,labels=c("pre-op","beginning","middle","end"))
# axis(side=2)
# vioplot(NL_table$m.z1.pre,at=1,col="indianred1",add=TRUE)
# vioplot(NL_table$m.z1.beg,at=2,col="indianred2",add=TRUE)
# vioplot(NL_table$m.z1.mid,at=3,col="indianred3",add=TRUE)
# vioplot(NL_table$m.z1.post,at=4,col="indianred4",add=TRUE)
# title("Zone 1")
# 
# #Monday Z2
# # zone_period_prevalence_z2 <- reshape2::melt(NL_table[, c('m.z2.pre', 'm.z2.beg', 'm.z2.mid', 'm.z2.post')])
# # levels(zone_period_prevalence_z2$variable) <- c('pre-op', 'beginning', 'middle', 'end')
# # names(zone_period_prevalence_z2) <- c('period', 'prevalence')
# # ggplot(zone_period_prevalence_z2, aes(x=period, y=prevalence)) + geom_violin() + geom_jitter(height = 0, width = 0.1) + xlab('Time During Shift') + ylab('Prevalence %')
# 
# plot(1,1,xlim=c(0.5,4.5),ylim=c(0,50),type="n",
#      xlab="",ylab="",axes=FALSE)
# ## bottom axis, with user-specified labels
# axis(side=1,at=1:4,labels=c("pre-op","beginning","middle","end"))
# axis(side=2)
# vioplot(NL_table$m.z2.pre,at=1,col="darkorange",add=TRUE)
# vioplot(NL_table$m.z2.beg,at=2,col="darkorange1",add=TRUE)
# vioplot(NL_table$m.z2.mid,at=3,col="darkorange2",add=TRUE)
# vioplot(NL_table$m.z2.post,at=4,col="darkorange3",add=TRUE)
# title("Zone 2")
# 
# #Monday Z3
# # zone_period_prevalence_z3 <- reshape2::melt(NL_table[, c('m.z3.pre', 'm.z3.beg', 'm.z3.mid', 'm.z3.post')])
# # levels(zone_period_prevalence_z3$variable) <- c('pre-op', 'beginning', 'middle', 'end')
# # names(zone_period_prevalence_z3) <- c('period', 'prevalence')
# # ggplot(zone_period_prevalence_z3, aes(x=period, y=prevalence)) + geom_violin() + geom_jitter(height = 0, width = 0.1) + xlab('Time During Shift') + ylab('Prevalence %')
# 
# plot(1,1,xlim=c(0.5,4.5),ylim=c(0,50),type="n",
#      xlab="",ylab="",axes=FALSE)
# ## bottom axis, with user-specified labels
# axis(side=1,at=1:4,labels=c("pre-op","beginning","middle","end"))
# axis(side=2)
# vioplot(NL_table$m.z3.pre,at=1,col="orchid1",add=TRUE)
# vioplot(NL_table$m.z3.beg,at=2,col="orchid2",add=TRUE)
# vioplot(NL_table$m.z3.mid,at=3,col="orchid3",add=TRUE)
# vioplot(NL_table$m.z3.post,at=4,col="orchid4",add=TRUE)
# title("Zone 3")
# 
# my_data <- data.frame( 
#   rep = rep(c(1:10000), 12),
#   time = rep(c("preop", "begin", "mid", "post"), each = 10000),
#   zone = rep(c("1","2","3"),each = 40000),
#   prev = c(NL_table$m.z1.pre, NL_table$m.z1.beg, NL_table$m.z1.mid, NL_table$m.z1.post, NL_table$m.z2.pre, NL_table$m.z2.beg, NL_table$m.z2.mid, NL_table$m.z2.post, NL_table$m.z3.pre, NL_table$m.z3.beg, NL_table$m.z3.mid, NL_table$m.z3.post)
# )
# hist(my_data$prev)
# my_data$prev[my_data$prev==0] <-0.000000001
# my_data$logprev<-log10(my_data$prev)
# hist(my_data$logprev)
# str(my_data)
# boxplot(my_data$prev~my_data$time*my_data$zone,ylim=c(0,100))
# 
# kruskal.test(prev ~ time, data = my_data, subset = my_data$zone == 1)
# kruskal.test(prev ~ time, data = my_data, subset = my_data$zone == 2)
# kruskal.test(prev ~ time, data = my_data, subset = my_data$zone == 3)
# pairwise.wilcox.test(my_data$prev, my_data$time, subset = my_data$zone == 1, p.adjust.method = "BH")
# pairwise.wilcox.test(my_data$prev, my_data$time, subset = my_data$zone == 2, p.adjust.method = "BH")
# pairwise.wilcox.test(my_data$prev, my_data$time, subset = my_data$zone == 3, p.adjust.method = "BH")
# ```
# 
# ```{r Wednesday Prevalence Violins}
# layout(matrix(c(1,2,3),1, byrow = TRUE))
# #Wednesday Z1
# # zone_period_prevalence_z1 <- reshape2::melt(NL_table[, c('w.z1.pre', 'w.z1.beg', 'w.z1.mid', 'w.z1.post')])
# # levels(zone_period_prevalence_z1$variable) <- c('pre-op', 'beginning', 'middle', 'end')
# # names(zone_period_prevalence_z1) <- c('period', 'prevalence')
# # ggplot(zone_period_prevalence_z1, aes(x=period, y=prevalence)) + geom_violin() + geom_jitter(height = 0, width = 0.1) + xlab('Time During Shift') + ylab('Prevalence %')
# 
# plot(1,1,xlim=c(0.5,4.5),ylim=c(0,50),type="n",
#      xlab="",ylab="%",axes=FALSE)
# axis(side=1,at=1:4,labels=c("pre-op","beginning","middle","end"))
# axis(side=2)
# vioplot(NL_table$w.z1.pre,at=1,col="indianred1",add=TRUE)
# vioplot(NL_table$w.z1.beg,at=2,col="indianred2",add=TRUE)
# vioplot(NL_table$w.z1.mid,at=3,col="indianred3",add=TRUE)
# vioplot(NL_table$w.z1.post,at=4,col="indianred4",add=TRUE)
# title("Zone 1")
# 
# #Wednesday Z2
# # zone_period_prevalence_z2 <- reshape2::melt(NL_table[, c('w.z2.pre', 'w.z2.beg', 'w.z2.mid', 'w.z2.post')])
# # levels(zone_period_prevalence_z2$variable) <- c('pre-op', 'beginning', 'middle', 'end')
# # names(zone_period_prevalence_z2) <- c('period', 'prevalence')
# # ggplot(zone_period_prevalence_z2, aes(x=period, y=prevalence)) + geom_violin() + geom_jitter(height = 0, width = 0.1) + xlab('Time During Shift') + ylab('Prevalence %')
# 
# plot(1,1,xlim=c(0.5,4.5),ylim=c(0,50),type="n",
#      xlab="",ylab="",axes=FALSE)
# axis(side=1,at=1:4,labels=c("pre-op","beginning","middle","end"))
# axis(side=2)
# vioplot(NL_table$w.z2.pre,at=1,col="darkorange",add=TRUE)
# vioplot(NL_table$w.z2.beg,at=2,col="darkorange1",add=TRUE)
# vioplot(NL_table$w.z2.mid,at=3,col="darkorange2",add=TRUE)
# vioplot(NL_table$w.z2.post,at=4,col="darkorange3",add=TRUE)
# title("Zone 2")
# 
# #Wednesday Z3
# # zone_period_prevalence_z3 <- reshape2::melt(NL_table[, c('w.z3.pre', 'w.z3.beg', 'w.z3.mid', 'w.z3.post')])
# # levels(zone_period_prevalence_z3$variable) <- c('pre-op', 'beginning', 'middle', 'end')
# # names(zone_period_prevalence_z3) <- c('period', 'prevalence')
# # ggplot(zone_period_prevalence_z3, aes(x=period, y=prevalence)) + geom_violin() + geom_jitter(height = 0, width = 0.1) + xlab('Time During Shift') + ylab('Prevalence %')
# 
# plot(1,1,xlim=c(0.5,4.5),ylim=c(0,50),type="n",
#      xlab="",ylab="",axes=FALSE)
# axis(side=1,at=1:4,labels=c("pre-op","beginning","middle","end"))
# axis(side=2)
# vioplot(NL_table$w.z3.pre,at=1,col="orchid1",add=TRUE)
# vioplot(NL_table$w.z3.beg,at=2,col="orchid2",add=TRUE)
# vioplot(NL_table$w.z3.mid,at=3,col="orchid3",add=TRUE)
# vioplot(NL_table$w.z3.post,at=4,col="orchid4",add=TRUE)
# title("Zone 3")
# 
# my_data <- data.frame( 
#   rep = rep(c(1:10000), 12),
#   time = rep(c("preop", "begin", "mid", "post"), each = 10000),
#   zone = rep(c("1","2","3"),each = 40000),
#   prev = c(NL_table$w.z1.pre, NL_table$w.z1.beg, NL_table$w.z1.mid, NL_table$w.z1.post, NL_table$w.z2.pre, NL_table$w.z2.beg, NL_table$w.z2.mid, NL_table$w.z2.post, NL_table$w.z3.pre, NL_table$w.z3.beg, NL_table$w.z3.mid, NL_table$w.z3.post)
# )
# hist(my_data$prev)
# my_data$prev[my_data$prev==0] <-0.000000001
# my_data$logprev<-log10(my_data$prev)
# hist(my_data$logprev)
# str(my_data)
# boxplot(my_data$prev~my_data$time*my_data$zone,ylim=c(0,100))
# 
# kruskal.test(prev ~ time, data = my_data, subset = my_data$zone == 1)
# kruskal.test(prev ~ time, data = my_data, subset = my_data$zone == 2)
# kruskal.test(prev ~ time, data = my_data, subset = my_data$zone == 3)
# pairwise.wilcox.test(my_data$prev, my_data$time, subset = my_data$zone == 1, p.adjust.method = "BH")
# pairwise.wilcox.test(my_data$prev, my_data$time, subset = my_data$zone == 2, p.adjust.method = "BH")
# pairwise.wilcox.test(my_data$prev, my_data$time, subset = my_data$zone == 3, p.adjust.method = "BH")
```
 
```{r Friday Prevalence Violins}
# layout(matrix(c(1,2,3),1, byrow = TRUE))
# #Friday Z1
# # zone_period_prevalence_z1 <- reshape2::melt(NL_table[, c('f.z1.pre', 'f.z1.beg', 'f.z1.mid', 'f.z1.post')])
# # levels(zone_period_prevalence_z1$variable) <- c('pre-op', 'beginning', 'middle', 'end')
# # names(zone_period_prevalence_z1) <- c('period', 'prevalence')
# # ggplot(zone_period_prevalence_z1, aes(x=period, y=prevalence)) + geom_violin() + geom_jitter(height = 0, width = 0.1) + xlab('Time During Shift') + ylab('Prevalence %')
# 
# plot(1,1,xlim=c(0.5,4.5),ylim=c(0,50),type="n",
#      xlab="",ylab="%",axes=FALSE)
# axis(side=1,at=1:4,labels=c("pre-op","beginning","middle","end"))
# axis(side=2)
# vioplot(NL_table$f.z1.pre,at=1,col="indianred1",add=TRUE)
# vioplot(NL_table$f.z1.beg,at=2,col="indianred2",add=TRUE)
# vioplot(NL_table$f.z1.mid,at=3,col="indianred3",add=TRUE)
# vioplot(NL_table$f.z1.post,at=4,col="indianred4",add=TRUE)
# title("Zone 1")
# 
# #Friday Z2
# # zone_period_prevalence_z2 <- reshape2::melt(NL_table[, c('f.z2.pre', 'f.z2.beg', 'f.z2.mid', 'f.z2.post')])
# # levels(zone_period_prevalence_z2$variable) <- c('pre-op', 'beginning', 'middle', 'end')
# # names(zone_period_prevalence_z2) <- c('period', 'prevalence')
# # ggplot(zone_period_prevalence_z2, aes(x=period, y=prevalence)) + geom_violin() + geom_jitter(height = 0, width = 0.1) + xlab('Time During Shift') + ylab('Prevalence %')
# 
# plot(1,1,xlim=c(0.5,4.5),ylim=c(0,50),type="n",
#      xlab="",ylab="",axes=FALSE)
# axis(side=1,at=1:4,labels=c("pre-op","beginning","middle","end"))
# axis(side=2)
# vioplot(NL_table$f.z2.pre,at=1,col="darkorange",add=TRUE)
# vioplot(NL_table$f.z2.beg,at=2,col="darkorange1",add=TRUE)
# vioplot(NL_table$f.z2.mid,at=3,col="darkorange2",add=TRUE)
# vioplot(NL_table$f.z2.post,at=4,col="darkorange3",add=TRUE)
# title("Zone 2")
# 
# #Friday Z3
# # zone_period_prevalence_z3 <- reshape2::melt(NL_table[, c('f.z3.pre', 'f.z3.beg', 'f.z3.mid', 'f.z3.post')])
# # levels(zone_period_prevalence_z3$variable) <- c('pre-op', 'beginning', 'middle', 'end')
# # names(zone_period_prevalence_z3) <- c('period', 'prevalence')
# # ggplot(zone_period_prevalence_z3, aes(x=period, y=prevalence)) + geom_violin() + geom_jitter(height = 0, width = 0.1) + xlab('Time During Shift') + ylab('Prevalence %')
# 
# plot(1,1,xlim=c(0.5,4.5),ylim=c(0,50),type="n",
#      xlab="",ylab="",axes=FALSE)
# axis(side=1,at=1:4,labels=c("pre-op","beginning","middle","end"))
# axis(side=2)
# vioplot(NL_table$f.z3.pre,at=1,col="orchid1",add=TRUE)
# vioplot(NL_table$f.z3.beg,at=2,col="orchid2",add=TRUE)
# vioplot(NL_table$f.z3.mid,at=3,col="orchid3",add=TRUE)
# vioplot(NL_table$f.z3.post,at=4,col="orchid4",add=TRUE)
# title("Zone 3")
# 
# my_data <- data.frame( 
#   rep = rep(c(1:10000), 12),
#   time = rep(c("preop", "begin", "mid", "post"), each = 10000),
#   zone = rep(c("1","2","3"),each = 40000),
#   prev = c(NL_table$f.z1.pre, NL_table$f.z1.beg, NL_table$f.z1.mid, NL_table$f.z1.post, NL_table$f.z2.pre, NL_table$f.z2.beg, NL_table$f.z2.mid, NL_table$f.z2.post, NL_table$f.z3.pre, NL_table$f.z3.beg, NL_table$f.z3.mid, NL_table$f.z3.post)
# )
# hist(my_data$prev)
# my_data$prev[my_data$prev==0] <-0.000000001
# my_data$logprev<-log10(my_data$prev)
# hist(my_data$logprev)
# str(my_data)
# boxplot(my_data$prev~my_data$time*my_data$zone,ylim=c(0,100))
# 
# kruskal.test(prev ~ time, data = my_data, subset = my_data$zone == 1)
# kruskal.test(prev ~ time, data = my_data, subset = my_data$zone == 2)
# kruskal.test(prev ~ time, data = my_data, subset = my_data$zone == 3)
# pairwise.wilcox.test(my_data$prev, my_data$time, subset = my_data$zone == 1, p.adjust.method = "BH")
# pairwise.wilcox.test(my_data$prev, my_data$time, subset = my_data$zone == 2, p.adjust.method = "BH")
# pairwise.wilcox.test(my_data$prev, my_data$time, subset = my_data$zone == 3, p.adjust.method = "BH")
```

```{r Cluster Value Corrplots}
# GGally::ggpairs(agents[,c('zone','height','cleanable','out_links','in_links','undirected_links')])
# GGally::ggpairs(agents[,c('zone','cleanable','out_links','in_links','undirected_links')])
# GGally::ggpairs(agents[,c('contam_mid_mon','contam_mid_tue','contam_mid_wed','contam_mid_thu','contam_mid_fri','conc_mid_mon_median','conc_mid_tue_median','conc_mid_wed_median','conc_mid_thu_median','conc_mid_fri_median','contacts_median','transfers_median','food_cont_median')])
# GGally::ggpairs(agents[,c('contam_mid_mon','contam_mid_tue','contam_mid_wed','contam_mid_thu','contam_mid_fri','conc_mid_mon_median','conc_mid_tue_median','conc_mid_wed_median','conc_mid_thu_median','conc_mid_fri_median','time_contaminated_median','max_contam_bout_median','contacts_median','transfers_median','temp_niche_list_medians','niches_estab_list_medians','food_cont_median','zone4_cont_median','random_cont_median')])
# GGally::ggpairs(agents[,c('time_contaminated_median','max_contam_bout_median','contacts_median','transfers_median')])
GGally::ggpairs(agents[,c('contamination_probability','time_contaminated_list_mean','max_contam_bout_list_mean','contacts_list_mean','transfers_list_mean','temp_niche_list_mean','niches_estab_list_mean','conc_mid_mon_list_mean','conc_mid_tue_list_mean','conc_mid_wed_list_mean','conc_mid_thu_list_mean','conc_mid_fri_list_mean','conc_mid_mon_mean_list_mean','conc_mid_tue_mean_list_mean','conc_mid_wed_mean_list_mean','conc_mid_thu_mean_list_mean','conc_mid_fri_mean_list_mean')])
GGally::ggpairs(agents[,c('contamination_probability','time_contaminated_list_median','max_contam_bout_list_median','contacts_list_median','transfers_list_median','temp_niche_list_median','niches_estab_list_median','conc_mid_mon_list_median','conc_mid_tue_list_median','conc_mid_wed_list_median','conc_mid_thu_list_median','conc_mid_fri_list_median','conc_mid_mon_median_list_median','conc_mid_tue_median_list_median','conc_mid_wed_median_list_median','conc_mid_thu_median_list_median','conc_mid_fri_median_list_median')])
```

```{r FAMD Cluster}
# df2 <- agents[,c('zone','height','cleanable','out_links','in_links','undirected_links')]
df2 <- agents[,c('cleanable','out_links','in_links','undirected_links')]
# df2 <- agents[,c('zone','cleanable','out_links','undirected_links')]

#FAMD analysis 
res_famd <- FAMD(df2, graph = FALSE, ncp=3)

#visualize output of FAMD/PCA analysis
#The proportion of variances retained by the different dimensions (axes) can be extracted using the function get_eigenvalue()
#print eigenvalues to determine the number of dimensions/principle components to use
eig_val <- get_eigenvalue(res_famd)
print(eig_val)
fviz_screeplot(res_famd)

#FAMD- ALL variables analysis
#The function get_mfa_var() [in factoextra] is used to extract the results for variables. 
#By default, this function returns a list containing the coordinates, the cos2 and the contribution of all variables
var <- get_famd_var(res_famd)
corrplot(var$cos2, is.corr=FALSE)
# Plot of variables
#Positively correlated variables are grouped together
#Negatively correlated variables are positioned on opposite sides of the plot origin (opposed quadrants)
fviz_famd_var(res_famd, repel = TRUE)
# Contribution to the first dimension
fviz_contrib(res_famd, "var", axes = 1)
# Contribution to the second dimension
fviz_contrib(res_famd, "var", axes = 2)
fviz_contrib(res_famd, "var", axes = 3)
# fviz_contrib(res_famd, "var", axes = 4)

# Contributions of variables to PC1
fviz_contrib(res_famd, choice = "var", axes = 1, top = 10)

#FAMD- Quantitative variables analysis
#Briefly, the graph of variables (correlation circle) shows the relationship between variables, 
#the quality of the representation of variables, as well as, the correlation between variables and the dimensions.
quanti_var <- get_famd_var(res_famd, "quanti.var")
quanti_var 
fviz_famd_var(res_famd, "quanti.var", repel = TRUE,
              col.var = "black")

#The most contributing quantitative variables can be highlighted on the scatter plot using the 
#argument col.var = "contrib". This produces a gradient colors, which can be customized using the argument gradient.cols.

fviz_famd_var(res_famd, "quanti.var", col.var = "contrib", 
              gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
              repel = TRUE)

#Similarly, you can highlight quantitative variables using their cos2 values representing the quality of representation on the factor map. 
#If a variable is well represented by two dimensions, the sum of the cos2 is close to one. 
#For some of the items, more than 2 dimensions might be required to perfectly represent the data.

# Color by cos2 values: quality on the factor map
fviz_famd_var(res_famd, "quanti.var", col.var = "cos2",
              gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
              repel = TRUE)

#Like quantitative variables, the results for qualitative variables can be extracted as follow:
quali_var <- get_famd_var(res_famd, "quali.var")
quali_var 
fviz_famd_var(res_famd, "quali.var", col.var = "contrib", 
              gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"))

#To get the results for individuals, type this:
ind <- get_famd_ind(res_famd)
ind
fviz_famd_ind(res_famd, col.ind = "cos2", 
              gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
              repel = FALSE)
fviz_famd_ind(res_famd, col.ind = "contrib", 
              gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
              repel = FALSE, invisible = "quali.var")

#Individuals with similar profiles are close to each other on the factor map. 
#It's possible to color the individuals using any of the qualitative variables in the initial data table. 
#To do this, the argument habillage is used in the fviz_famd_ind() function. 
#For example, if you want to color the agents according to the supplementary qualitative variable "zone.category", type this:
fviz_mfa_ind(res_famd, 
             habillage = "cleanable", # color by groups 
             #palette = c("#00AFBB", "#E7B800", "#FC4E07"),
             #addEllipses = TRUE, ellipse.type = "confidence", 
             repel = FALSE # Avoid text overlapping
) 

#If you want to color individuals using multiple categorical variables at the same time, use the function fviz_ellipses() [in factoextra] as follow:
# fviz_ellipses(res_famd,"zone", repel = FALSE)
# fviz_ellipses(res_famd, habillage = c("zone", "cleanable"), repel = FALSE)

#HCPC - Hierarchical Clustering on Principal Components
#When you have a mixed data of continuous and categorical variables, you can first perform FAMD (factor analysis of mixed data) or MFA (multiple factor analysis). 
#Next, you can apply cluster analysis on the FAMD/MFA outputs. nb.clust = 0, user clicks. nb.clust = -1, program decides. or enter any positive integer
res_hcpc <- HCPC(res_famd, graph = FALSE, nb.clust = -1)
res_hc <- hclust(dist(df2))
fviz_dend(res_hc, rect= TRUE)
head(res_hcpc$data.clust$clust, 10)
agents$FAMDClusters <- (res_hcpc$data.clust$clust)
# agentsub$PCAClusters <- (res_hcpc$data.clust$clust)
#save the file with cluster numbers 
# write.csv(zones, file ="zones052418_clusterNumbers.csv")
# write.csv(df3, file ="df3053018_clusterNumbers.csv")

#It's possible to visualize individuals on the principal component map and to color individuals according to the cluster they belong to. 
#The function fviz_cluster() [in factoextra] can be used to visualize individuals clusters.
fviz_cluster(res_hcpc,
             geom = "point",
             repel = FALSE,            # Avoid label overlapping
             show.clust.cent = TRUE, # Show cluster centers
             palette = "jco",         # Color palette see ?ggpubr::ggpar
             ggtheme = theme_minimal(),
             main = "B"
) +
    # theme(legend.position="bottom")
    theme(legend.position="none") +
    geom_text(x=-1, y=-2, label="rot-trolley-track\nbox-sticker-printer-01\nbox-sticker-printer-02\nbox-sticker-printer-03\nbox-sticker-printer-04", hjust = 0, color = "#0073C2FF") +
    geom_text(x=2.25, y=0, label="tray-belt-02\nsmall-produce-crate-feed\ntrench-drain-drying\nnpw-belt\ncrate-filler-01", hjust = 0, color = "#EFC00F") +
    geom_text(x=0, y=5, label="produce-crate-03\nproduce-crate-04\nproduce-crate-05\ndumper\nflume-exterior", hjust = 0, color = "#868686FF") +
    geom_text(x=5, y=-1.25, label="reject-belt-05\nbox-belt\nrot-trolley\ntrack-belt", hjust = 0, color = "#CD534CFF")

plot(res_hcpc, choice = "3D.map")
#To display the original data with cluster assignments, type this:
head(res_hcpc$data.clust, 10)

#To display quantitative variables that describe the most each cluster, type this:
print('qanti')
res_hcpc$desc.var$quanti
print('test.chi2')
res_hcpc$desc.var$test.chi2
print('category')
res_hcpc$desc.var$category

#to show principal dimensions that are the most associated with clusters, type this:
res_hcpc$desc.axes$quanti
res_hcpc$desc.axes

#representative individuals of each cluster can be extracted as follow:
res_hcpc$desc.ind$para

# plot(agents$conc_mid_mon_list_mean~agents$conc_mid_mon_median_list_median)
# plot(agents$conc_mid_tue_list_mean~agents$conc_mid_thu_median_list_median)

FAMD1 <- subset(agents,FAMDClusters==1)
summary(FAMD1)
print('Cluster 1: Probabilities Mon-Fri')
print(formatC(mean(FAMD1$prob_cont_mon), format = "f", digits = 2))
print(formatC(mean(FAMD1$prob_cont_tue), format = "f", digits = 2))
print(formatC(mean(FAMD1$prob_cont_wed), format = "f", digits = 2))
print(formatC(mean(FAMD1$prob_cont_thu), format = "f", digits = 2))
print(formatC(mean(FAMD1$prob_cont_fri), format = "f", digits = 2))
print('Cluster 1: Concentrations Mon-Fri')
print(formatC(mean(FAMD1$conc_mid_mon_mean), format = "e", digits = 2))
print(formatC(mean(FAMD1$conc_mid_tue_mean), format = "e", digits = 2))
print(formatC(mean(FAMD1$conc_mid_wed_mean), format = "e", digits = 2))
print(formatC(mean(FAMD1$conc_mid_thu_mean), format = "e", digits = 2))
print(formatC(mean(FAMD1$conc_mid_fri_mean), format = "e", digits = 2))
print('Cluster 1: Probabilities Zone')
print(formatC(mean(FAMD1$prob_cont_wed[FAMD1$zone==1]), format = "f", digits = 2))
print(formatC(mean(FAMD1$prob_cont_wed[FAMD1$zone==2]), format = "f", digits = 2))
print(formatC(mean(FAMD1$prob_cont_wed[FAMD1$zone==3]), format = "f", digits = 2))
print('Cluster 1: Concentrations Zone')
print(formatC(mean(FAMD1$conc_mid_wed_mean[FAMD1$zone==1]), format = "e", digits = 2))
print(formatC(mean(FAMD1$conc_mid_wed_mean[FAMD1$zone==2]), format = "e", digits = 2))
print(formatC(mean(FAMD1$conc_mid_wed_mean[FAMD1$zone==3]), format = "e", digits = 2))
print('Cluster 1: Probabilities Water')
print(formatC(mean(FAMD1$prob_cont_wed[FAMD1$water=='wet']), format = "f", digits = 2))
print(formatC(mean(FAMD1$prob_cont_wed[FAMD1$water=='dry']), format = "f", digits = 2))
print('Cluster 1: Concentrations Water')
print(formatC(mean(FAMD1$conc_mid_wed_mean[FAMD1$water=='wet']), format = "e", digits = 2))
print(formatC(mean(FAMD1$conc_mid_wed_mean[FAMD1$water=='dry']), format = "e", digits = 2))
FAMD2 <- subset(agents,FAMDClusters==2)
summary(FAMD2)
print('Cluster 2: Probabilities Mon-Fri')
print(formatC(mean(FAMD2$prob_cont_mon), format = "f", digits = 2))
print(formatC(mean(FAMD2$prob_cont_tue), format = "f", digits = 2))
print(formatC(mean(FAMD2$prob_cont_wed), format = "f", digits = 2))
print(formatC(mean(FAMD2$prob_cont_thu), format = "f", digits = 2))
print(formatC(mean(FAMD2$prob_cont_fri), format = "f", digits = 2))
print('Cluster 2: Concentrations Mon-Fri')
print(formatC(mean(FAMD2$conc_mid_mon_mean), format = "e", digits = 2))
print(formatC(mean(FAMD2$conc_mid_tue_mean), format = "e", digits = 2))
print(formatC(mean(FAMD2$conc_mid_wed_mean), format = "e", digits = 2))
print(formatC(mean(FAMD2$conc_mid_thu_mean), format = "e", digits = 2))
print(formatC(mean(FAMD2$conc_mid_fri_mean), format = "e", digits = 2))
print('Cluster 2: Probabilities Zone')
print(formatC(mean(FAMD2$prob_cont_wed[FAMD2$zone==1]), format = "f", digits = 2))
print(formatC(mean(FAMD2$prob_cont_wed[FAMD2$zone==2]), format = "f", digits = 2))
print(formatC(mean(FAMD2$prob_cont_wed[FAMD2$zone==3]), format = "f", digits = 2))
print('Cluster 2: Concentrations Zone')
print(formatC(mean(FAMD2$conc_mid_wed_mean[FAMD2$zone==1]), format = "e", digits = 2))
print(formatC(mean(FAMD2$conc_mid_wed_mean[FAMD2$zone==2]), format = "e", digits = 2))
print(formatC(mean(FAMD2$conc_mid_wed_mean[FAMD2$zone==3]), format = "e", digits = 2))
print('Cluster 2: Probabilities Water')
print(formatC(mean(FAMD2$prob_cont_wed[FAMD2$water=='wet']), format = "f", digits = 2))
print(formatC(mean(FAMD2$prob_cont_wed[FAMD2$water=='dry']), format = "f", digits = 2))
print('Cluster 2: Concentrations Water')
print(formatC(mean(FAMD2$conc_mid_wed_mean[FAMD2$water=='wet']), format = "e", digits = 2))
print(formatC(mean(FAMD2$conc_mid_wed_mean[FAMD2$water=='dry']), format = "e", digits = 2))
FAMD3 <- subset(agents,FAMDClusters==3)
summary(FAMD3)
print('Cluster 3: Probabilities Mon-Fri')
print(formatC(mean(FAMD3$prob_cont_mon), format = "f", digits = 2))
print(formatC(mean(FAMD3$prob_cont_tue), format = "f", digits = 2))
print(formatC(mean(FAMD3$prob_cont_wed), format = "f", digits = 2))
print(formatC(mean(FAMD3$prob_cont_thu), format = "f", digits = 2))
print(formatC(mean(FAMD3$prob_cont_fri), format = "f", digits = 2))
print('Cluster 3: Concentrations Mon-Fri')
print(formatC(mean(FAMD3$conc_mid_mon_mean), format = "e", digits = 2))
print(formatC(mean(FAMD3$conc_mid_tue_mean), format = "e", digits = 2))
print(formatC(mean(FAMD3$conc_mid_wed_mean), format = "e", digits = 2))
print(formatC(mean(FAMD3$conc_mid_thu_mean), format = "e", digits = 2))
print(formatC(mean(FAMD3$conc_mid_fri_mean), format = "e", digits = 2))
print('Cluster 3: Probabilities Zone')
print(formatC(mean(FAMD3$prob_cont_wed[FAMD3$zone==1]), format = "f", digits = 2))
print(formatC(mean(FAMD3$prob_cont_wed[FAMD3$zone==2]), format = "f", digits = 2))
print(formatC(mean(FAMD3$prob_cont_wed[FAMD3$zone==3]), format = "f", digits = 2))
print('Cluster 3: Concentrations Zone')
print(formatC(mean(FAMD3$conc_mid_wed_mean[FAMD3$zone==1]), format = "e", digits = 2))
print(formatC(mean(FAMD3$conc_mid_wed_mean[FAMD3$zone==2]), format = "e", digits = 2))
print(formatC(mean(FAMD3$conc_mid_wed_mean[FAMD3$zone==3]), format = "e", digits = 2))
print('Cluster 3: Probabilities Water')
print(formatC(mean(FAMD3$prob_cont_wed[FAMD3$water=='wet']), format = "f", digits = 2))
print(formatC(mean(FAMD3$prob_cont_wed[FAMD3$water=='dry']), format = "f", digits = 2))
print('Cluster 3: Concentrations Water')
print(formatC(mean(FAMD3$conc_mid_wed_mean[FAMD3$water=='wet']), format = "e", digits = 2))
print(formatC(mean(FAMD3$conc_mid_wed_mean[FAMD3$water=='dry']), format = "e", digits = 2))
FAMD4 <- subset(agents,FAMDClusters==4)
summary(FAMD4)
print('Cluster 4: Probabilities Mon-Fri')
print(formatC(mean(FAMD4$prob_cont_mon), format = "f", digits = 2))
print(formatC(mean(FAMD4$prob_cont_tue), format = "f", digits = 2))
print(formatC(mean(FAMD4$prob_cont_wed), format = "f", digits = 2))
print(formatC(mean(FAMD4$prob_cont_thu), format = "f", digits = 2))
print(formatC(mean(FAMD4$prob_cont_fri), format = "f", digits = 2))
print('Cluster 4: Concentrations Mon-Fri')
print(formatC(mean(FAMD4$conc_mid_mon_mean), format = "e", digits = 2))
print(formatC(mean(FAMD4$conc_mid_tue_mean), format = "e", digits = 2))
print(formatC(mean(FAMD4$conc_mid_wed_mean), format = "e", digits = 2))
print(formatC(mean(FAMD4$conc_mid_thu_mean), format = "e", digits = 2))
print(formatC(mean(FAMD4$conc_mid_fri_mean), format = "e", digits = 2))
print('Cluster 4: Probabilities Zone')
print(formatC(mean(FAMD4$prob_cont_wed[FAMD4$zone==1]), format = "f", digits = 2))
print(formatC(mean(FAMD4$prob_cont_wed[FAMD4$zone==2]), format = "f", digits = 2))
print(formatC(mean(FAMD4$prob_cont_wed[FAMD4$zone==3]), format = "f", digits = 2))
print('Cluster 4: Concentrations Zone')
print(formatC(mean(FAMD4$conc_mid_wed_mean[FAMD4$zone==1]), format = "e", digits = 2))
print(formatC(mean(FAMD4$conc_mid_wed_mean[FAMD4$zone==2]), format = "e", digits = 2))
print(formatC(mean(FAMD4$conc_mid_wed_mean[FAMD4$zone==3]), format = "e", digits = 2))
print('Cluster 4: Probabilities Water')
print(formatC(mean(FAMD4$prob_cont_wed[FAMD4$water=='wet']), format = "f", digits = 2))
print(formatC(mean(FAMD4$prob_cont_wed[FAMD4$water=='dry']), format = "f", digits = 2))
print('Cluster 4: Concentrations Water')
print(formatC(mean(FAMD4$conc_mid_wed_mean[FAMD4$water=='wet']), format = "e", digits = 2))
print(formatC(mean(FAMD4$conc_mid_wed_mean[FAMD4$water=='dry']), format = "e", digits = 2))
FAMD5 <- subset(agents,FAMDClusters==5)
summary(FAMD5)
print('Cluster 5: Probabilities Mon-Fri')
print(formatC(mean(FAMD5$prob_cont_mon), format = "f", digits = 2))
print(formatC(mean(FAMD5$prob_cont_tue), format = "f", digits = 2))
print(formatC(mean(FAMD5$prob_cont_wed), format = "f", digits = 2))
print(formatC(mean(FAMD5$prob_cont_thu), format = "f", digits = 2))
print(formatC(mean(FAMD5$prob_cont_fri), format = "f", digits = 2))
print('Cluster 5: Concentrations Mon-Fri')
print(formatC(mean(FAMD5$conc_mid_mon_mean), format = "e", digits = 2))
print(formatC(mean(FAMD5$conc_mid_tue_mean), format = "e", digits = 2))
print(formatC(mean(FAMD5$conc_mid_wed_mean), format = "e", digits = 2))
print(formatC(mean(FAMD5$conc_mid_thu_mean), format = "e", digits = 2))
print(formatC(mean(FAMD5$conc_mid_fri_mean), format = "e", digits = 2))
print('Cluster 5: Probabilities Zone')
print(formatC(mean(FAMD5$prob_cont_wed[FAMD5$zone==1]), format = "f", digits = 2))
print(formatC(mean(FAMD5$prob_cont_wed[FAMD5$zone==2]), format = "f", digits = 2))
print(formatC(mean(FAMD5$prob_cont_wed[FAMD5$zone==3]), format = "f", digits = 2))
print('Cluster 5: Concentrations Zone')
print(formatC(mean(FAMD5$conc_mid_wed_mean[FAMD5$zone==1]), format = "e", digits = 2))
print(formatC(mean(FAMD5$conc_mid_wed_mean[FAMD5$zone==2]), format = "e", digits = 2))
print(formatC(mean(FAMD5$conc_mid_wed_mean[FAMD5$zone==3]), format = "e", digits = 2))
print('Cluster 5: Probabilities Water')
print(formatC(mean(FAMD5$prob_cont_wed[FAMD5$water=='wet']), format = "f", digits = 2))
print(formatC(mean(FAMD5$prob_cont_wed[FAMD5$water=='dry']), format = "f", digits = 2))
print('Cluster 5: Concentrations Water')
print(formatC(mean(FAMD5$conc_mid_wed_mean[FAMD5$water=='wet']), format = "e", digits = 2))
print(formatC(mean(FAMD5$conc_mid_wed_mean[FAMD5$water=='dry']), format = "e", digits = 2))
```

```{r PCA Cluster}
subagents <- agents
# subagents <- subagents[rownames(subagents)!='dumper-sandwich-juncture',]
# subagents <- subagents[rownames(subagents)!='roller-area-sponge-squeegee',]
df3 <- subagents[,c('prob_contamination','time_contaminated_mean','max_contam_bout_mean','contacts_mean','transfers_mean','temp_niche_mean','niches_estab_mean','conc_mid_mon_mean','conc_mid_tue_mean','conc_mid_wed_mean','conc_mid_thu_mean','conc_mid_fri_mean')]

#PCA analysis for contamination outcomes - continuous
res_pca <- PCA(df3, scale.unit = TRUE, ncp = 4, graph = FALSE)

#visualize output of FAMD/PCA analysis
#The proportion of variances retained by the different dimensions (axes) can be extracted using the function get_eigenvalue()
#print eigenvalues to determine the number of dimensions/principle components to use
eig_val <- get_eigenvalue(res_pca)
print(eig_val)
fviz_screeplot(res_pca)

#FAMD- ALL variables analysis
#The function get_mfa_var() [in factoextra] is used to extract the results for variables. 
#By default, this function returns a list containing the coordinates, the cos2 and the contribution of all variables
var <- get_pca_var(res_pca)
# Plot of variables
#Positively correlated variables are grouped together
#Negatively correlated variables are positioned on opposite sides of the plot origin (opposed quadrants)
fviz_pca_var(res_pca, col_var = "black") #Variables that are away from the origin are well represented on the factor map

#visualize the cos2 of variables on all the dimensions (PCA)
corrplot(var$cos2, is.corr=FALSE)
fviz_pca_var(res_pca, col.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)
# Contributions of variables to PC1
fviz_contrib(res_pca, choice = "var", axes = 1, top = 10)
# Contributions of variables to PC2
fviz_contrib(res_pca, choice = "var", axes = 2, top = 10)
# Contributions of variables to dimensions
fviz_pca_var(res_pca, col.var = "contrib",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07")
)
##individual analysis from PCA output
#fviz_pca_ind(res_pca, pointsize = "cos2", 
#             pointshape = 21, fill = "#E7B800",
#             repel = TRUE # Avoid text overlapping (slow if many points)
#)
fviz_pca_ind(res_pca,
             geom.ind = "point", # show points only (nbut not "text")
             col.ind = subagents$zone, # color by groups
             palette = c("#00AFBB", "#E7B800", "#FC4E07"),
             addEllipses = TRUE, # Concentration ellipses
             legend.title = "Groups"
)
str(subagents)
fviz_pca_ind(res_pca,
             geom.ind = "point", # show points only (nbut not "text")
             col.ind = subagents$cleanable, # color by groups
             palette = c("#00AFBB", "#E7B800", "#FC4E07"),
             addEllipses = TRUE, # Concentration ellipses
             legend.title = "Cleanable"
)
fviz_pca_biplot(res_pca, select.ind = list(contrib = 10), 
                select.var = list(contrib = 5),
                ggtheme = theme_minimal()
)

#HCPC - Hierarchical Clustering on Principal Components
#When you have a mixed data of continuous and categorical variables, you can first perform FAMD (factor analysis of mixed data) or MFA (multiple factor analysis). 
#Next, you can apply cluster analysis on the FAMD/MFA outputs. nb.clust = 0, user clicks. nb.clust = -1, program decides. or enter any positive integer
res_hcpc <- HCPC(res_pca, graph = FALSE, nb.clust=-1) #play around with number of clusters, try 2 and see if the match
subagents$PCAClusters <- (res_hcpc$data.clust$clust)
# agentsubub$PCAClusters <- (res_hcpc$data.clust$clust)
df3$PCAClustersII<- (res_hcpc$data.clust$clust)
#save the file with cluster numbers 
# write.csv(zones, file ="zones052418_clusterNumbers.csv")
# write.csv(df3, file ="df3053018_clusterNumbers.csv")
#To visualize the dendrogram generated by the hierarchical clustering, we'll use the function fviz_dend() [factoextra package]:
fviz_dend(res_hcpc, 
          cex = 0.5,                     # Label size
          labels(row.names(df3)),
          palette = "jco",               # Color palette see ?ggpubr::ggpar
          rect = TRUE, rect_fill = TRUE, # Add rectangle around groups
          rect_border = "jco",           # Rectangle color
          #labels_track_height = 0.8      # Augment the room for labels
)

#It's possible to visualize individuals on the principal component map and to color individuals according to the cluster they belong to. 
#The function fviz_cluster() [in factoextra] can be used to visualize individuals clusters.
fviz_cluster(res_hcpc,
             geom = "point",
             repel = FALSE,            # Avoid label overlapping
             show.clust.cent = TRUE, # Show cluster centers
             palette = "jco",         # Color palette see ?ggpubr::ggpar
             ggtheme = theme_minimal(),
             # main = "Model B: PCA Agent Outcomes Cluster Visualisation",
             main = "D"
) +
    # theme(legend.position="bottom")
    theme(legend.position="none") +
    geom_text(x=-1, y=-4.50, label="loader-belt-03\nloader-belt-01\nloader-belt-02\ntray-belt-05\nsmall-produce-filter", hjust = 0, color = "#0073C2FF") +
    geom_text(x=5, y=2, label="flume\nlarge-debris-filter\ndumper\nflume-exit-rollers\nrot-trolley", hjust = 0, color = "#EFC00F") +
    geom_text(x=15, y=-12, label="dumper-sandwich-juncture\nroller-area-sponge-squeegee", hjust = 0, color = "#868686FF")

plot(res_hcpc, choice = "3D.map")
#To display the original data with cluster assignments, type this:
head(res_hcpc$data.clust, 10)

#To display quantitative variables that describe the most each cluster, type this:
print('qanti')
res_hcpc$desc.var$quanti
print('test.chi2')
res_hcpc$desc.var$test.chi2
print('category')
res_hcpc$desc.var$category

#to show principal dimensions that are the most associated with clusters, type this:
res_hcpc$desc.axes$quanti
res_hcpc$desc.axes

#representative individuals of each cluster can be extracted as follow:
res_hcpc$desc.ind$para

# plot(subagents$conc_mid_mon_median~subagents$contam_mid_mon)
# plot(subagents$conc_mid_tue_median~subagents$conc_mid_thu_median)

PCA1 <- subset(subagents,PCAClusters==1)
summary(PCA1)
print('Cluster 1: Probabilities Mon-Fri')
print(formatC(mean(PCA1$prob_cont_mon), format = "f", digits = 2))
print(formatC(mean(PCA1$prob_cont_tue), format = "f", digits = 2))
print(formatC(mean(PCA1$prob_cont_wed), format = "f", digits = 2))
print(formatC(mean(PCA1$prob_cont_thu), format = "f", digits = 2))
print(formatC(mean(PCA1$prob_cont_fri), format = "f", digits = 2))
print('Cluster 1: Concentrations Mon-Fri')
print(formatC(mean(PCA1$conc_mid_mon_mean), format = "e", digits = 2))
print(formatC(mean(PCA1$conc_mid_tue_mean), format = "e", digits = 2))
print(formatC(mean(PCA1$conc_mid_wed_mean), format = "e", digits = 2))
print(formatC(mean(PCA1$conc_mid_thu_mean), format = "e", digits = 2))
print(formatC(mean(PCA1$conc_mid_fri_mean), format = "e", digits = 2))
print('Cluster 1: Probabilities Zone')
print(formatC(mean(PCA1$prob_cont_wed[PCA1$zone==1]), format = "f", digits = 2))
print(formatC(mean(PCA1$prob_cont_wed[PCA1$zone==2]), format = "f", digits = 2))
print(formatC(mean(PCA1$prob_cont_wed[PCA1$zone==3]), format = "f", digits = 2))
print('Cluster 1: Concentrations Zone')
print(formatC(mean(PCA1$conc_mid_wed_mean[PCA1$zone==1]), format = "e", digits = 2))
print(formatC(mean(PCA1$conc_mid_wed_mean[PCA1$zone==2]), format = "e", digits = 2))
print(formatC(mean(PCA1$conc_mid_wed_mean[PCA1$zone==3]), format = "e", digits = 2))
print('Cluster 1: Probabilities Water')
print(formatC(mean(PCA1$prob_cont_wed[PCA1$water=='wet']), format = "f", digits = 2))
print(formatC(mean(PCA1$prob_cont_wed[PCA1$water=='dry']), format = "f", digits = 2))
print('Cluster 1: Concentrations Water')
print(formatC(mean(PCA1$conc_mid_wed_mean[PCA1$water=='wet']), format = "e", digits = 2))
print(formatC(mean(PCA1$conc_mid_wed_mean[PCA1$water=='dry']), format = "e", digits = 2))
PCA2 <- subset(subagents,PCAClusters==2)
summary(PCA2)
print('Cluster 2: Probabilities Mon-Fri')
print(formatC(mean(PCA2$prob_cont_mon), format = "f", digits = 2))
print(formatC(mean(PCA2$prob_cont_tue), format = "f", digits = 2))
print(formatC(mean(PCA2$prob_cont_wed), format = "f", digits = 2))
print(formatC(mean(PCA2$prob_cont_thu), format = "f", digits = 2))
print(formatC(mean(PCA2$prob_cont_fri), format = "f", digits = 2))
print('Cluster 2: Concentrations Mon-Fri')
print(formatC(mean(PCA2$conc_mid_mon_mean), format = "e", digits = 2))
print(formatC(mean(PCA2$conc_mid_tue_mean), format = "e", digits = 2))
print(formatC(mean(PCA2$conc_mid_wed_mean), format = "e", digits = 2))
print(formatC(mean(PCA2$conc_mid_thu_mean), format = "e", digits = 2))
print(formatC(mean(PCA2$conc_mid_fri_mean), format = "e", digits = 2))
print('Cluster 2: Probabilities Zone')
print(formatC(mean(PCA2$prob_cont_wed[PCA2$zone==1]), format = "f", digits = 2))
print(formatC(mean(PCA2$prob_cont_wed[PCA2$zone==2]), format = "f", digits = 2))
print(formatC(mean(PCA2$prob_cont_wed[PCA2$zone==3]), format = "f", digits = 2))
print('Cluster 2: Concentrations Zone')
print(formatC(mean(PCA2$conc_mid_wed_mean[PCA2$zone==1]), format = "e", digits = 2))
print(formatC(mean(PCA2$conc_mid_wed_mean[PCA2$zone==2]), format = "e", digits = 2))
print(formatC(mean(PCA2$conc_mid_wed_mean[PCA2$zone==3]), format = "e", digits = 2))
print('Cluster 2: Probabilities Water')
print(formatC(mean(PCA2$prob_cont_wed[PCA2$water=='wet']), format = "f", digits = 2))
print(formatC(mean(PCA2$prob_cont_wed[PCA2$water=='dry']), format = "f", digits = 2))
print('Cluster 2: Concentrations Water')
print(formatC(mean(PCA2$conc_mid_wed_mean[PCA2$water=='wet']), format = "e", digits = 2))
print(formatC(mean(PCA2$conc_mid_wed_mean[PCA2$water=='dry']), format = "e", digits = 2))
PCA3 <- subset(subagents,PCAClusters==3)
summary(PCA3)
print('Cluster 3: Probabilities Mon-Fri')
print(formatC(mean(PCA3$prob_cont_mon), format = "f", digits = 2))
print(formatC(mean(PCA3$prob_cont_tue), format = "f", digits = 2))
print(formatC(mean(PCA3$prob_cont_wed), format = "f", digits = 2))
print(formatC(mean(PCA3$prob_cont_thu), format = "f", digits = 2))
print(formatC(mean(PCA3$prob_cont_fri), format = "f", digits = 2))
print('Cluster 3: Concentrations Mon-Fri')
print(formatC(mean(PCA3$conc_mid_mon_mean), format = "e", digits = 2))
print(formatC(mean(PCA3$conc_mid_tue_mean), format = "e", digits = 2))
print(formatC(mean(PCA3$conc_mid_wed_mean), format = "e", digits = 2))
print(formatC(mean(PCA3$conc_mid_thu_mean), format = "e", digits = 2))
print(formatC(mean(PCA3$conc_mid_fri_mean), format = "e", digits = 2))
print('Cluster 3: Probabilities Zone')
print(formatC(mean(PCA3$prob_cont_wed[PCA3$zone==1]), format = "f", digits = 2))
print(formatC(mean(PCA3$prob_cont_wed[PCA3$zone==2]), format = "f", digits = 2))
print(formatC(mean(PCA3$prob_cont_wed[PCA3$zone==3]), format = "f", digits = 2))
print('Cluster 3: Concentrations Zone')
print(formatC(mean(PCA3$conc_mid_wed_mean[PCA3$zone==1]), format = "e", digits = 2))
print(formatC(mean(PCA3$conc_mid_wed_mean[PCA3$zone==2]), format = "e", digits = 2))
print(formatC(mean(PCA3$conc_mid_wed_mean[PCA3$zone==3]), format = "e", digits = 2))
print('Cluster 3: Probabilities Water')
print(formatC(mean(PCA3$prob_cont_wed[PCA3$water=='wet']), format = "f", digits = 2))
print(formatC(mean(PCA3$prob_cont_wed[PCA3$water=='dry']), format = "f", digits = 2))
print('Cluster 3: Concentrations Water')
print(formatC(mean(PCA3$conc_mid_wed_mean[PCA3$water=='wet']), format = "e", digits = 2))
print(formatC(mean(PCA3$conc_mid_wed_mean[PCA3$water=='dry']), format = "e", digits = 2))
# PCA4 <- subset(subagents,PCAClusters==4)
# summary(PCA4)
# print('Cluster 4: Probabilities Mon-Fri')
# print(formatC(mean(PCA4$prob_cont_mon), format = "f", digits = 2))
# print(formatC(mean(PCA4$prob_cont_tue), format = "f", digits = 2))
# print(formatC(mean(PCA4$prob_cont_wed), format = "f", digits = 2))
# print(formatC(mean(PCA4$prob_cont_thu), format = "f", digits = 2))
# print(formatC(mean(PCA4$prob_cont_fri), format = "f", digits = 2))
# print('Cluster 4: Concentrations Mon-Fri')
# print(formatC(mean(PCA4$conc_mid_mon_mean), format = "e", digits = 2))
# print(formatC(mean(PCA4$conc_mid_tue_mean), format = "e", digits = 2))
# print(formatC(mean(PCA4$conc_mid_wed_mean), format = "e", digits = 2))
# print(formatC(mean(PCA4$conc_mid_thu_mean), format = "e", digits = 2))
# print(formatC(mean(PCA4$conc_mid_fri_mean), format = "e", digits = 2))
# print('Cluster 4: Probabilities Zone')
# print(formatC(mean(PCA4$prob_cont_wed[PCA4$zone==1]), format = "f", digits = 2))
# print(formatC(mean(PCA4$prob_cont_wed[PCA4$zone==2]), format = "f", digits = 2))
# print(formatC(mean(PCA4$prob_cont_wed[PCA4$zone==3]), format = "f", digits = 2))
# print('Cluster 4: Concentrations Zone')
# print(formatC(mean(PCA4$conc_mid_wed_mean[PCA4$zone==1]), format = "e", digits = 2))
# print(formatC(mean(PCA4$conc_mid_wed_mean[PCA4$zone==2]), format = "e", digits = 2))
# print(formatC(mean(PCA4$conc_mid_wed_mean[PCA4$zone==3]), format = "e", digits = 2))
# print('Cluster 4: Probabilities Water')
# print(formatC(mean(PCA4$prob_cont_wed[PCA4$water=='wet']), format = "f", digits = 2))
# print(formatC(mean(PCA4$prob_cont_wed[PCA4$water=='dry']), format = "f", digits = 2))
# print('Cluster 4: Concentrations Water')
# print(formatC(mean(PCA4$conc_mid_wed_mean[PCA4$water=='wet']), format = "e", digits = 2))
# print(formatC(mean(PCA4$conc_mid_wed_mean[PCA4$water=='dry']), format = "e", digits = 2))
```

```{r import Crate Only}
NL_table_Crate_Introduction_Only <- fread(paste0(getwd(),'/BehaviorSpace/2020-10-27-14-21 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Introduction_Route_Checks-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Crate_Introduction_Only <- NL_table_Crate_Introduction_Only[NL_table_Crate_Introduction_Only$scenario==2,]

while (any(grepl('-', names(NL_table_Crate_Introduction_Only), fixed = TRUE))) {
  NL_table_Crate_Introduction_Only <- NL_table_Crate_Introduction_Only %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Crate_Introduction_Only), fixed = TRUE))) {
  NL_table_Crate_Introduction_Only <- NL_table_Crate_Introduction_Only %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Crate_Introduction_Only), fixed = TRUE))) {
  NL_table_Crate_Introduction_Only <- NL_table_Crate_Introduction_Only %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Crate_Introduction_Only), fixed = TRUE))) {
  NL_table_Crate_Introduction_Only <- NL_table_Crate_Introduction_Only %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Crate_Introduction_Only[ , ..list_columns]

NL_table_Crate_Introduction_Only[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Crate_Introduction_Only <- as.data.frame(NL_table_Crate_Introduction_Only)

NL_table_Crate_Introduction_Only[NL_table_Crate_Introduction_Only==-1] <- NA

NL_table_Crate_Introduction_Only <- subset(NL_table_Crate_Introduction_Only, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Crate_Introduction_Only)[names(NL_table_Crate_Introduction_Only)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Crate_Introduction_Only)[names(NL_table_Crate_Introduction_Only)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Crate_Introduction_Only$loading_w2wed_conc_list[order(NL_table_Crate_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
crate_introduction_only_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_introduction_only_loading_w2wed_conc_list <- append(crate_introduction_only_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Introduction_Only$cleaning_w2wed_conc_list[order(NL_table_Crate_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
crate_introduction_only_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_introduction_only_cleaning_w2wed_conc_list <- append(crate_introduction_only_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Introduction_Only$drying_w2wed_conc_list[order(NL_table_Crate_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
crate_introduction_only_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_introduction_only_drying_w2wed_conc_list <- append(crate_introduction_only_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Introduction_Only$sorting_w2wed_conc_list[order(NL_table_Crate_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
crate_introduction_only_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_introduction_only_sorting_w2wed_conc_list <- append(crate_introduction_only_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Introduction_Only$reject_w2wed_conc_list[order(NL_table_Crate_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
crate_introduction_only_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_introduction_only_reject_w2wed_conc_list <- append(crate_introduction_only_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Introduction_Only$tray_packing_w2wed_conc_list[order(NL_table_Crate_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
crate_introduction_only_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_introduction_only_tray_packing_w2wed_conc_list <- append(crate_introduction_only_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Introduction_Only$other_w2wed_conc_list[order(NL_table_Crate_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
crate_introduction_only_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_introduction_only_other_w2wed_conc_list <- append(crate_introduction_only_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

crate_introduction_only_loading_concs <- as.data.frame(crate_introduction_only_loading_w2wed_conc_list)
crate_introduction_only_loading_concs$area <- as.factor('loading')
crate_introduction_only_loading_concs$scenario <- as.factor('TI_01')
crate_introduction_only_loading_concs$water <- as.factor('Wet')
names(crate_introduction_only_loading_concs) <- c('concentration','area','scenario','water')

crate_introduction_only_cleaning_concs <- as.data.frame(crate_introduction_only_cleaning_w2wed_conc_list)
crate_introduction_only_cleaning_concs$area <- as.factor('cleaning')
crate_introduction_only_cleaning_concs$scenario <- as.factor('TI_01')
crate_introduction_only_cleaning_concs$water <- as.factor('Wet')
names(crate_introduction_only_cleaning_concs) <- c('concentration','area','scenario','water')

crate_introduction_only_sorting_concs <- as.data.frame(crate_introduction_only_sorting_w2wed_conc_list)
crate_introduction_only_sorting_concs$area <- as.factor('sorting')
crate_introduction_only_sorting_concs$scenario <- as.factor('TI_01')
crate_introduction_only_sorting_concs$water <- as.factor('Dry')
names(crate_introduction_only_sorting_concs) <- c('concentration','area','scenario','water')

crate_introduction_only_reject_concs <- as.data.frame(crate_introduction_only_reject_w2wed_conc_list)
crate_introduction_only_reject_concs$area <- as.factor('reject')
crate_introduction_only_reject_concs$scenario <- as.factor('TI_01')
crate_introduction_only_reject_concs$water <- as.factor('Dry')
names(crate_introduction_only_reject_concs) <- c('concentration','area','scenario','water')

crate_introduction_only_tray_packing_concs <- as.data.frame(crate_introduction_only_tray_packing_w2wed_conc_list)
crate_introduction_only_tray_packing_concs$area <- as.factor('tray packing')
crate_introduction_only_tray_packing_concs$scenario <- as.factor('TI_01')
crate_introduction_only_tray_packing_concs$water <- as.factor('Dry')
names(crate_introduction_only_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_introduction_only_other_concs <- as.data.frame(crate_introduction_only_other_w2wed_conc_list)
crate_introduction_only_other_concs$area <- as.factor('other')
crate_introduction_only_other_concs$scenario <- as.factor('TI_01')
crate_introduction_only_other_concs$water <- as.factor('Dry')
names(crate_introduction_only_other_concs) <- c('concentration','area','scenario','water')

crate_introduction_only_concs <- rbind(crate_introduction_only_loading_concs,crate_introduction_only_cleaning_concs,crate_introduction_only_sorting_concs,crate_introduction_only_tray_packing_concs,crate_introduction_only_reject_concs,crate_introduction_only_other_concs)

crate_introduction_only_loading_prev <- as.data.frame(NL_table_Crate_Introduction_Only$loading_w2wed_prev)
crate_introduction_only_loading_prev$area <- as.factor('loading')
crate_introduction_only_loading_prev$scenario <- as.factor('TI_01')
crate_introduction_only_loading_prev$water <- as.factor('Wet')
names(crate_introduction_only_loading_prev) <- c('prevalence','area','scenario','water')

crate_introduction_only_cleaning_prev <- as.data.frame(NL_table_Crate_Introduction_Only$cleaning_w2wed_prev)
crate_introduction_only_cleaning_prev$area <- as.factor('cleaning')
crate_introduction_only_cleaning_prev$scenario <- as.factor('TI_01')
crate_introduction_only_cleaning_prev$water <- as.factor('Wet')
names(crate_introduction_only_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_introduction_only_sorting_prev <- as.data.frame(NL_table_Crate_Introduction_Only$sorting_w2wed_prev)
crate_introduction_only_sorting_prev$area <- as.factor('sorting')
crate_introduction_only_sorting_prev$scenario <- as.factor('TI_01')
crate_introduction_only_sorting_prev$water <- as.factor('Dry')
names(crate_introduction_only_sorting_prev) <- c('prevalence','area','scenario','water')

crate_introduction_only_reject_prev <- as.data.frame(NL_table_Crate_Introduction_Only$reject_w2wed_prev)
crate_introduction_only_reject_prev$area <- as.factor('reject')
crate_introduction_only_reject_prev$scenario <- as.factor('TI_01')
crate_introduction_only_reject_prev$water <- as.factor('Dry')
names(crate_introduction_only_reject_prev) <- c('prevalence','area','scenario','water')

crate_introduction_only_tray_packing_prev <- as.data.frame(NL_table_Crate_Introduction_Only$tray_packing_w2wed_prev)
crate_introduction_only_tray_packing_prev$area <- as.factor('tray packing')
crate_introduction_only_tray_packing_prev$scenario <- as.factor('TI_01')
crate_introduction_only_tray_packing_prev$water <- as.factor('Dry')
names(crate_introduction_only_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_introduction_only_other_prev <- as.data.frame(NL_table_Crate_Introduction_Only$other_w2wed_prev)
crate_introduction_only_other_prev$area <- as.factor('other')
crate_introduction_only_other_prev$scenario <- as.factor('TI_01')
crate_introduction_only_other_prev$water <- as.factor('Dry')
names(crate_introduction_only_other_prev) <- c('prevalence','area','scenario','water')

crate_introduction_only_prev <- rbind(crate_introduction_only_loading_prev,crate_introduction_only_cleaning_prev,crate_introduction_only_sorting_prev,crate_introduction_only_tray_packing_prev,crate_introduction_only_reject_prev,crate_introduction_only_other_prev)

crate_introduction_only_z1_prev <- as.data.frame(NL_table_Crate_Introduction_Only$z1_w2wed_prev)
crate_introduction_only_z1_prev$zone <- as.factor('Z1')
crate_introduction_only_z1_prev$scenario <- as.factor('TI_01')
names(crate_introduction_only_z1_prev) <- c('prevalence','zone','scenario')

crate_introduction_only_z2_prev <- as.data.frame(NL_table_Crate_Introduction_Only$z2_w2wed_prev)
crate_introduction_only_z2_prev$zone <- as.factor('Z2')
crate_introduction_only_z2_prev$scenario <- as.factor('TI_01')
names(crate_introduction_only_z2_prev) <- c('prevalence','zone','scenario')

crate_introduction_only_z3_prev <- as.data.frame(NL_table_Crate_Introduction_Only$z3_w2wed_prev)
crate_introduction_only_z3_prev$zone <- as.factor('Z2')
crate_introduction_only_z3_prev$scenario <- as.factor('TI_01')
names(crate_introduction_only_z3_prev) <- c('prevalence','zone','scenario')

crate_introduction_only_zone_prev <- rbind(crate_introduction_only_z1_prev,crate_introduction_only_z2_prev,crate_introduction_only_z3_prev)
```

```{r import Z4 Only}
NL_table_Z4_Introduction_Only <- fread(paste0(getwd(),'/BehaviorSpace/2020-10-27-14-21 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Introduction_Route_Checks-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Introduction_Only <- NL_table_Z4_Introduction_Only[NL_table_Z4_Introduction_Only$scenario==4,]

while (any(grepl('-', names(NL_table_Z4_Introduction_Only), fixed = TRUE))) {
  NL_table_Z4_Introduction_Only <- NL_table_Z4_Introduction_Only %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Introduction_Only), fixed = TRUE))) {
  NL_table_Z4_Introduction_Only <- NL_table_Z4_Introduction_Only %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Introduction_Only), fixed = TRUE))) {
  NL_table_Z4_Introduction_Only <- NL_table_Z4_Introduction_Only %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Introduction_Only), fixed = TRUE))) {
  NL_table_Z4_Introduction_Only <- NL_table_Z4_Introduction_Only %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Introduction_Only[ , ..list_columns]

NL_table_Z4_Introduction_Only[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Introduction_Only <- as.data.frame(NL_table_Z4_Introduction_Only)

NL_table_Z4_Introduction_Only[NL_table_Z4_Introduction_Only==-1] <- NA

NL_table_Z4_Introduction_Only <- subset(NL_table_Z4_Introduction_Only, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Introduction_Only)[names(NL_table_Z4_Introduction_Only)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Introduction_Only)[names(NL_table_Z4_Introduction_Only)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Z4_Introduction_Only$loading_w2wed_conc_list[order(NL_table_Z4_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
z4_introduction_only_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_introduction_only_loading_w2wed_conc_list <- append(z4_introduction_only_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Introduction_Only$cleaning_w2wed_conc_list[order(NL_table_Z4_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
z4_introduction_only_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_introduction_only_cleaning_w2wed_conc_list <- append(z4_introduction_only_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Introduction_Only$drying_w2wed_conc_list[order(NL_table_Z4_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
z4_introduction_only_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_introduction_only_drying_w2wed_conc_list <- append(z4_introduction_only_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Introduction_Only$sorting_w2wed_conc_list[order(NL_table_Z4_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
z4_introduction_only_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_introduction_only_sorting_w2wed_conc_list <- append(z4_introduction_only_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Introduction_Only$reject_w2wed_conc_list[order(NL_table_Z4_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
z4_introduction_only_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_introduction_only_reject_w2wed_conc_list <- append(z4_introduction_only_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Introduction_Only$tray_packing_w2wed_conc_list[order(NL_table_Z4_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
z4_introduction_only_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_introduction_only_tray_packing_w2wed_conc_list <- append(z4_introduction_only_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Introduction_Only$other_w2wed_conc_list[order(NL_table_Z4_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
z4_introduction_only_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_introduction_only_other_w2wed_conc_list <- append(z4_introduction_only_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

z4_introduction_only_loading_concs <- as.data.frame(z4_introduction_only_loading_w2wed_conc_list)
z4_introduction_only_loading_concs$area <- as.factor('loading')
z4_introduction_only_loading_concs$scenario <- as.factor('TI_02')
z4_introduction_only_loading_concs$water <- as.factor('Wet')
names(z4_introduction_only_loading_concs) <- c('concentration','area','scenario','water')

z4_introduction_only_cleaning_concs <- as.data.frame(z4_introduction_only_cleaning_w2wed_conc_list)
z4_introduction_only_cleaning_concs$area <- as.factor('cleaning')
z4_introduction_only_cleaning_concs$scenario <- as.factor('TI_02')
z4_introduction_only_cleaning_concs$water <- as.factor('Wet')
names(z4_introduction_only_cleaning_concs) <- c('concentration','area','scenario','water')

z4_introduction_only_sorting_concs <- as.data.frame(z4_introduction_only_sorting_w2wed_conc_list)
z4_introduction_only_sorting_concs$area <- as.factor('sorting')
z4_introduction_only_sorting_concs$scenario <- as.factor('TI_02')
z4_introduction_only_sorting_concs$water <- as.factor('Dry')
names(z4_introduction_only_sorting_concs) <- c('concentration','area','scenario','water')

z4_introduction_only_reject_concs <- as.data.frame(z4_introduction_only_reject_w2wed_conc_list)
z4_introduction_only_reject_concs$area <- as.factor('reject')
z4_introduction_only_reject_concs$scenario <- as.factor('TI_02')
z4_introduction_only_reject_concs$water <- as.factor('Dry')
names(z4_introduction_only_reject_concs) <- c('concentration','area','scenario','water')

z4_introduction_only_tray_packing_concs <- as.data.frame(z4_introduction_only_tray_packing_w2wed_conc_list)
z4_introduction_only_tray_packing_concs$area <- as.factor('tray packing')
z4_introduction_only_tray_packing_concs$scenario <- as.factor('TI_02')
z4_introduction_only_tray_packing_concs$water <- as.factor('Dry')
names(z4_introduction_only_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_introduction_only_other_concs <- as.data.frame(z4_introduction_only_other_w2wed_conc_list)
z4_introduction_only_other_concs$area <- as.factor('other')
z4_introduction_only_other_concs$scenario <- as.factor('TI_02')
z4_introduction_only_other_concs$water <- as.factor('Dry')
names(z4_introduction_only_other_concs) <- c('concentration','area','scenario','water')

z4_introduction_only_concs <- rbind(z4_introduction_only_loading_concs,z4_introduction_only_cleaning_concs,z4_introduction_only_sorting_concs,z4_introduction_only_tray_packing_concs,z4_introduction_only_reject_concs,z4_introduction_only_other_concs)

z4_introduction_only_loading_prev <- as.data.frame(NL_table_Z4_Introduction_Only$loading_w2wed_prev)
z4_introduction_only_loading_prev$area <- as.factor('loading')
z4_introduction_only_loading_prev$scenario <- as.factor('TI_02')
z4_introduction_only_loading_prev$water <- as.factor('Wet')
names(z4_introduction_only_loading_prev) <- c('prevalence','area','scenario','water')

z4_introduction_only_cleaning_prev <- as.data.frame(NL_table_Z4_Introduction_Only$cleaning_w2wed_prev)
z4_introduction_only_cleaning_prev$area <- as.factor('cleaning')
z4_introduction_only_cleaning_prev$scenario <- as.factor('TI_02')
z4_introduction_only_cleaning_prev$water <- as.factor('Wet')
names(z4_introduction_only_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_introduction_only_sorting_prev <- as.data.frame(NL_table_Z4_Introduction_Only$sorting_w2wed_prev)
z4_introduction_only_sorting_prev$area <- as.factor('sorting')
z4_introduction_only_sorting_prev$scenario <- as.factor('TI_02')
z4_introduction_only_sorting_prev$water <- as.factor('Dry')
names(z4_introduction_only_sorting_prev) <- c('prevalence','area','scenario','water')

z4_introduction_only_reject_prev <- as.data.frame(NL_table_Z4_Introduction_Only$reject_w2wed_prev)
z4_introduction_only_reject_prev$area <- as.factor('reject')
z4_introduction_only_reject_prev$scenario <- as.factor('TI_02')
z4_introduction_only_reject_prev$water <- as.factor('Dry')
names(z4_introduction_only_reject_prev) <- c('prevalence','area','scenario','water')

z4_introduction_only_tray_packing_prev <- as.data.frame(NL_table_Z4_Introduction_Only$tray_packing_w2wed_prev)
z4_introduction_only_tray_packing_prev$area <- as.factor('tray packing')
z4_introduction_only_tray_packing_prev$scenario <- as.factor('TI_02')
z4_introduction_only_tray_packing_prev$water <- as.factor('Dry')
names(z4_introduction_only_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_introduction_only_other_prev <- as.data.frame(NL_table_Z4_Introduction_Only$other_w2wed_prev)
z4_introduction_only_other_prev$area <- as.factor('other')
z4_introduction_only_other_prev$scenario <- as.factor('TI_02')
z4_introduction_only_other_prev$water <- as.factor('Dry')
names(z4_introduction_only_other_prev) <- c('prevalence','area','scenario','water')

z4_introduction_only_prev <- rbind(z4_introduction_only_loading_prev,z4_introduction_only_cleaning_prev,z4_introduction_only_sorting_prev,z4_introduction_only_tray_packing_prev,z4_introduction_only_reject_prev,z4_introduction_only_other_prev)

z4_introduction_only_z1_prev <- as.data.frame(NL_table_Z4_Introduction_Only$z1_w2wed_prev)
z4_introduction_only_z1_prev$zone <- as.factor('Z1')
z4_introduction_only_z1_prev$scenario <- as.factor('TI_02')
names(z4_introduction_only_z1_prev) <- c('prevalence','zone','scenario')

z4_introduction_only_z2_prev <- as.data.frame(NL_table_Z4_Introduction_Only$z2_w2wed_prev)
z4_introduction_only_z2_prev$zone <- as.factor('Z2')
z4_introduction_only_z2_prev$scenario <- as.factor('TI_02')
names(z4_introduction_only_z2_prev) <- c('prevalence','zone','scenario')

z4_introduction_only_z3_prev <- as.data.frame(NL_table_Z4_Introduction_Only$z2_w2wed_prev)
z4_introduction_only_z3_prev$zone <- as.factor('Z3')
z4_introduction_only_z3_prev$scenario <- as.factor('TI_02')
names(z4_introduction_only_z3_prev) <- c('prevalence','zone','scenario')

z4_introduction_only_zone_prev <- rbind(z4_introduction_only_z1_prev,z4_introduction_only_z2_prev,z4_introduction_only_z3_prev)
```

```{r import Random Only}
NL_table_Random_Introduction_Only <- fread(paste0(getwd(),'/BehaviorSpace/2020-10-27-14-21 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Introduction_Route_Checks-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Introduction_Only <- NL_table_Random_Introduction_Only[NL_table_Random_Introduction_Only$scenario==3,]

while (any(grepl('-', names(NL_table_Random_Introduction_Only), fixed = TRUE))) {
  NL_table_Random_Introduction_Only <- NL_table_Random_Introduction_Only %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Introduction_Only), fixed = TRUE))) {
  NL_table_Random_Introduction_Only <- NL_table_Random_Introduction_Only %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Introduction_Only), fixed = TRUE))) {
  NL_table_Random_Introduction_Only <- NL_table_Random_Introduction_Only %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Introduction_Only), fixed = TRUE))) {
  NL_table_Random_Introduction_Only <- NL_table_Random_Introduction_Only %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Introduction_Only[ , ..list_columns]

NL_table_Random_Introduction_Only[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Introduction_Only <- as.data.frame(NL_table_Random_Introduction_Only)

NL_table_Random_Introduction_Only[NL_table_Random_Introduction_Only==-1] <- NA

NL_table_Random_Introduction_Only <- subset(NL_table_Random_Introduction_Only, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Introduction_Only)[names(NL_table_Random_Introduction_Only)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Introduction_Only)[names(NL_table_Random_Introduction_Only)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Random_Introduction_Only$loading_w2wed_conc_list[order(NL_table_Random_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
random_introduction_only_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_introduction_only_loading_w2wed_conc_list <- append(random_introduction_only_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Introduction_Only$cleaning_w2wed_conc_list[order(NL_table_Random_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
random_introduction_only_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_introduction_only_cleaning_w2wed_conc_list <- append(random_introduction_only_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Introduction_Only$drying_w2wed_conc_list[order(NL_table_Random_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
random_introduction_only_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_introduction_only_drying_w2wed_conc_list <- append(random_introduction_only_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Introduction_Only$sorting_w2wed_conc_list[order(NL_table_Random_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
random_introduction_only_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_introduction_only_sorting_w2wed_conc_list <- append(random_introduction_only_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Introduction_Only$reject_w2wed_conc_list[order(NL_table_Random_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
random_introduction_only_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_introduction_only_reject_w2wed_conc_list <- append(random_introduction_only_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Introduction_Only$tray_packing_w2wed_conc_list[order(NL_table_Random_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
random_introduction_only_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_introduction_only_tray_packing_w2wed_conc_list <- append(random_introduction_only_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Introduction_Only$other_w2wed_conc_list[order(NL_table_Random_Introduction_Only$local_seed)]
vector <- vector[vector!='[]']
random_introduction_only_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_introduction_only_other_w2wed_conc_list <- append(random_introduction_only_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

random_introduction_only_loading_concs <- as.data.frame(random_introduction_only_loading_w2wed_conc_list)
random_introduction_only_loading_concs$area <- as.factor('loading')
random_introduction_only_loading_concs$scenario <- as.factor('TI_03')
random_introduction_only_loading_concs$water <- as.factor('Wet')
names(random_introduction_only_loading_concs) <- c('concentration','area','scenario','water')

random_introduction_only_cleaning_concs <- as.data.frame(random_introduction_only_cleaning_w2wed_conc_list)
random_introduction_only_cleaning_concs$area <- as.factor('cleaning')
random_introduction_only_cleaning_concs$scenario <- as.factor('TI_03')
random_introduction_only_cleaning_concs$water <- as.factor('Wet')
names(random_introduction_only_cleaning_concs) <- c('concentration','area','scenario','water')

random_introduction_only_sorting_concs <- as.data.frame(random_introduction_only_sorting_w2wed_conc_list)
random_introduction_only_sorting_concs$area <- as.factor('sorting')
random_introduction_only_sorting_concs$scenario <- as.factor('TI_03')
random_introduction_only_sorting_concs$water <- as.factor('Dry')
names(random_introduction_only_sorting_concs) <- c('concentration','area','scenario','water')

random_introduction_only_reject_concs <- as.data.frame(random_introduction_only_reject_w2wed_conc_list)
random_introduction_only_reject_concs$area <- as.factor('reject')
random_introduction_only_reject_concs$scenario <- as.factor('TI_03')
random_introduction_only_reject_concs$water <- as.factor('Dry')
names(random_introduction_only_reject_concs) <- c('concentration','area','scenario','water')

random_introduction_only_tray_packing_concs <- as.data.frame(random_introduction_only_tray_packing_w2wed_conc_list)
random_introduction_only_tray_packing_concs$area <- as.factor('tray packing')
random_introduction_only_tray_packing_concs$scenario <- as.factor('TI_03')
random_introduction_only_tray_packing_concs$water <- as.factor('Dry')
names(random_introduction_only_tray_packing_concs) <- c('concentration','area','scenario','water')

random_introduction_only_other_concs <- as.data.frame(random_introduction_only_other_w2wed_conc_list)
random_introduction_only_other_concs$area <- as.factor('other')
random_introduction_only_other_concs$scenario <- as.factor('TI_03')
random_introduction_only_other_concs$water <- as.factor('Dry')
names(random_introduction_only_other_concs) <- c('concentration','area','scenario','water')

random_introduction_only_concs <- rbind(random_introduction_only_loading_concs,random_introduction_only_cleaning_concs,random_introduction_only_sorting_concs,random_introduction_only_tray_packing_concs,random_introduction_only_reject_concs,random_introduction_only_other_concs)

random_introduction_only_loading_prev <- as.data.frame(NL_table_Random_Introduction_Only$loading_w2wed_prev)
random_introduction_only_loading_prev$area <- as.factor('loading')
random_introduction_only_loading_prev$scenario <- as.factor('TI_03')
random_introduction_only_loading_prev$water <- as.factor('Wet')
names(random_introduction_only_loading_prev) <- c('prevalence','area','scenario','water')

random_introduction_only_cleaning_prev <- as.data.frame(NL_table_Random_Introduction_Only$cleaning_w2wed_prev)
random_introduction_only_cleaning_prev$area <- as.factor('cleaning')
random_introduction_only_cleaning_prev$scenario <- as.factor('TI_03')
random_introduction_only_cleaning_prev$water <- as.factor('Wet')
names(random_introduction_only_cleaning_prev) <- c('prevalence','area','scenario','water')

random_introduction_only_sorting_prev <- as.data.frame(NL_table_Random_Introduction_Only$sorting_w2wed_prev)
random_introduction_only_sorting_prev$area <- as.factor('sorting')
random_introduction_only_sorting_prev$scenario <- as.factor('TI_03')
random_introduction_only_sorting_prev$water <- as.factor('Dry')
names(random_introduction_only_sorting_prev) <- c('prevalence','area','scenario','water')

random_introduction_only_reject_prev <- as.data.frame(NL_table_Random_Introduction_Only$reject_w2wed_prev)
random_introduction_only_reject_prev$area <- as.factor('reject')
random_introduction_only_reject_prev$scenario <- as.factor('TI_03')
random_introduction_only_reject_prev$water <- as.factor('Dry')
names(random_introduction_only_reject_prev) <- c('prevalence','area','scenario','water')

random_introduction_only_tray_packing_prev <- as.data.frame(NL_table_Random_Introduction_Only$tray_packing_w2wed_prev)
random_introduction_only_tray_packing_prev$area <- as.factor('tray packing')
random_introduction_only_tray_packing_prev$scenario <- as.factor('TI_03')
random_introduction_only_tray_packing_prev$water <- as.factor('Dry')
names(random_introduction_only_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_introduction_only_other_prev <- as.data.frame(NL_table_Random_Introduction_Only$other_w2wed_prev)
random_introduction_only_other_prev$area <- as.factor('other')
random_introduction_only_other_prev$scenario <- as.factor('TI_03')
random_introduction_only_other_prev$water <- as.factor('Dry')
names(random_introduction_only_other_prev) <- c('prevalence','area','scenario','water')

random_introduction_only_prev <- rbind(random_introduction_only_loading_prev,random_introduction_only_cleaning_prev,random_introduction_only_sorting_prev,random_introduction_only_tray_packing_prev,random_introduction_only_reject_prev,random_introduction_only_other_prev)

random_introduction_only_z1_prev <- as.data.frame(NL_table_Random_Introduction_Only$z1_w2wed_prev)
random_introduction_only_z1_prev$zone <- as.factor('Z1')
random_introduction_only_z1_prev$scenario <- as.factor('TI_03')
names(random_introduction_only_z1_prev) <- c('prevalence','zone','scenario')

random_introduction_only_z2_prev <- as.data.frame(NL_table_Random_Introduction_Only$z2_w2wed_prev)
random_introduction_only_z2_prev$zone <- as.factor('Z2')
random_introduction_only_z2_prev$scenario <- as.factor('TI_03')
names(random_introduction_only_z2_prev) <- c('prevalence','zone','scenario')

random_introduction_only_z3_prev <- as.data.frame(NL_table_Random_Introduction_Only$z2_w2wed_prev)
random_introduction_only_z3_prev$zone <- as.factor('Z3')
random_introduction_only_z3_prev$scenario <- as.factor('TI_03')
names(random_introduction_only_z3_prev) <- c('prevalence','zone','scenario')

random_introduction_only_zone_prev <- rbind(random_introduction_only_z1_prev,random_introduction_only_z2_prev,random_introduction_only_z3_prev)
```

```{r import No Introduction}
NL_table_Zero_Introduction <- fread(paste0(getwd(),'/BehaviorSpace/2020-10-27-14-21 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Introduction_Route_Checks-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Zero_Introduction <- NL_table_Zero_Introduction[NL_table_Zero_Introduction$scenario==1,]

while (any(grepl('-', names(NL_table_Zero_Introduction), fixed = TRUE))) {
  NL_table_Zero_Introduction <- NL_table_Zero_Introduction %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Zero_Introduction), fixed = TRUE))) {
  NL_table_Zero_Introduction <- NL_table_Zero_Introduction %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Zero_Introduction), fixed = TRUE))) {
  NL_table_Zero_Introduction <- NL_table_Zero_Introduction %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Zero_Introduction), fixed = TRUE))) {
  NL_table_Zero_Introduction <- NL_table_Zero_Introduction %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Zero_Introduction[ , ..list_columns]

NL_table_Zero_Introduction[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Zero_Introduction <- as.data.frame(NL_table_Zero_Introduction)

NL_table_Zero_Introduction[NL_table_Zero_Introduction==-1] <- NA

NL_table_Zero_Introduction <- subset(NL_table_Zero_Introduction, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Zero_Introduction)[names(NL_table_Zero_Introduction)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Zero_Introduction)[names(NL_table_Zero_Introduction)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Zero_Introduction$loading_w2wed_conc_list[order(NL_table_Zero_Introduction$local_seed)]
vector <- vector[vector!='[]']
zero_introduction_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  zero_introduction_loading_w2wed_conc_list <- append(zero_introduction_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Zero_Introduction$cleaning_w2wed_conc_list[order(NL_table_Zero_Introduction$local_seed)]
vector <- vector[vector!='[]']
zero_introduction_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  zero_introduction_cleaning_w2wed_conc_list <- append(zero_introduction_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Zero_Introduction$drying_w2wed_conc_list[order(NL_table_Zero_Introduction$local_seed)]
vector <- vector[vector!='[]']
zero_introduction_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  zero_introduction_drying_w2wed_conc_list <- append(zero_introduction_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Zero_Introduction$sorting_w2wed_conc_list[order(NL_table_Zero_Introduction$local_seed)]
vector <- vector[vector!='[]']
zero_introduction_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  zero_introduction_sorting_w2wed_conc_list <- append(zero_introduction_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Zero_Introduction$reject_w2wed_conc_list[order(NL_table_Zero_Introduction$local_seed)]
vector <- vector[vector!='[]']
zero_introduction_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  zero_introduction_reject_w2wed_conc_list <- append(zero_introduction_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Zero_Introduction$tray_packing_w2wed_conc_list[order(NL_table_Zero_Introduction$local_seed)]
vector <- vector[vector!='[]']
zero_introduction_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  zero_introduction_tray_packing_w2wed_conc_list <- append(zero_introduction_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Zero_Introduction$other_w2wed_conc_list[order(NL_table_Zero_Introduction$local_seed)]
vector <- vector[vector!='[]']
zero_introduction_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  zero_introduction_other_w2wed_conc_list <- append(zero_introduction_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

zero_introduction_loading_concs <- as.data.frame(zero_introduction_loading_w2wed_conc_list)
zero_introduction_loading_concs$area <- as.factor('loading')
zero_introduction_loading_concs$scenario <- as.factor('TI_04')
zero_introduction_loading_concs$water <- as.factor('Wet')
names(zero_introduction_loading_concs) <- c('concentration','area','scenario','water')

zero_introduction_cleaning_concs <- as.data.frame(zero_introduction_cleaning_w2wed_conc_list)
zero_introduction_cleaning_concs$area <- as.factor('cleaning')
zero_introduction_cleaning_concs$scenario <- as.factor('TI_04')
zero_introduction_cleaning_concs$water <- as.factor('Wet')
names(zero_introduction_cleaning_concs) <- c('concentration','area','scenario','water')

zero_introduction_sorting_concs <- as.data.frame(zero_introduction_sorting_w2wed_conc_list)
zero_introduction_sorting_concs$area <- as.factor('sorting')
zero_introduction_sorting_concs$scenario <- as.factor('TI_04')
zero_introduction_sorting_concs$water <- as.factor('Dry')
names(zero_introduction_sorting_concs) <- c('concentration','area','scenario','water')

zero_introduction_reject_concs <- as.data.frame(zero_introduction_reject_w2wed_conc_list)
zero_introduction_reject_concs$area <- as.factor('reject')
zero_introduction_reject_concs$scenario <- as.factor('TI_04')
zero_introduction_reject_concs$water <- as.factor('Dry')
names(zero_introduction_reject_concs) <- c('concentration','area','scenario','water')

zero_introduction_tray_packing_concs <- as.data.frame(zero_introduction_tray_packing_w2wed_conc_list)
zero_introduction_tray_packing_concs$area <- as.factor('tray packing')
zero_introduction_tray_packing_concs$scenario <- as.factor('TI_04')
zero_introduction_tray_packing_concs$water <- as.factor('Dry')
names(zero_introduction_tray_packing_concs) <- c('concentration','area','scenario','water')

zero_introduction_other_concs <- as.data.frame(zero_introduction_other_w2wed_conc_list)
zero_introduction_other_concs$area <- as.factor('other')
zero_introduction_other_concs$scenario <- as.factor('TI_04')
zero_introduction_other_concs$water <- as.factor('Dry')
names(zero_introduction_other_concs) <- c('concentration','area','scenario','water')

zero_introduction_concs <- rbind(zero_introduction_loading_concs,zero_introduction_cleaning_concs,zero_introduction_sorting_concs,zero_introduction_tray_packing_concs,zero_introduction_reject_concs,zero_introduction_other_concs)

zero_introduction_loading_prev <- as.data.frame(NL_table_Zero_Introduction$loading_w2wed_prev)
zero_introduction_loading_prev$area <- as.factor('loading')
zero_introduction_loading_prev$scenario <- as.factor('TI_04')
zero_introduction_loading_prev$water <- as.factor('Wet')
names(zero_introduction_loading_prev) <- c('prevalence','area','scenario','water')

zero_introduction_cleaning_prev <- as.data.frame(NL_table_Zero_Introduction$cleaning_w2wed_prev)
zero_introduction_cleaning_prev$area <- as.factor('cleaning')
zero_introduction_cleaning_prev$scenario <- as.factor('TI_04')
zero_introduction_cleaning_prev$water <- as.factor('Wet')
names(zero_introduction_cleaning_prev) <- c('prevalence','area','scenario','water')

zero_introduction_sorting_prev <- as.data.frame(NL_table_Zero_Introduction$sorting_w2wed_prev)
zero_introduction_sorting_prev$area <- as.factor('sorting')
zero_introduction_sorting_prev$scenario <- as.factor('TI_04')
zero_introduction_sorting_prev$water <- as.factor('Dry')
names(zero_introduction_sorting_prev) <- c('prevalence','area','scenario','water')

zero_introduction_reject_prev <- as.data.frame(NL_table_Zero_Introduction$reject_w2wed_prev)
zero_introduction_reject_prev$area <- as.factor('reject')
zero_introduction_reject_prev$scenario <- as.factor('TI_04')
zero_introduction_reject_prev$water <- as.factor('Dry')
names(zero_introduction_reject_prev) <- c('prevalence','area','scenario','water')

zero_introduction_tray_packing_prev <- as.data.frame(NL_table_Zero_Introduction$tray_packing_w2wed_prev)
zero_introduction_tray_packing_prev$area <- as.factor('tray packing')
zero_introduction_tray_packing_prev$scenario <- as.factor('TI_04')
zero_introduction_tray_packing_prev$water <- as.factor('Dry')
names(zero_introduction_tray_packing_prev) <- c('prevalence','area','scenario','water')

zero_introduction_other_prev <- as.data.frame(NL_table_Zero_Introduction$other_w2wed_prev)
zero_introduction_other_prev$area <- as.factor('other')
zero_introduction_other_prev$scenario <- as.factor('TI_04')
zero_introduction_other_prev$water <- as.factor('Dry')
names(zero_introduction_other_prev) <- c('prevalence','area','scenario','water')

zero_introduction_prev <- rbind(zero_introduction_loading_prev,zero_introduction_cleaning_prev,zero_introduction_sorting_prev,zero_introduction_tray_packing_prev,zero_introduction_reject_prev,zero_introduction_other_prev)

zero_introduction_z1_prev <- as.data.frame(NL_table_Zero_Introduction$z1_w2wed_prev)
zero_introduction_z1_prev$zone <- as.factor('Z1')
zero_introduction_z1_prev$scenario <- as.factor('TI_04')
names(zero_introduction_z1_prev) <- c('prevalence','zone','scenario')

zero_introduction_z2_prev <- as.data.frame(NL_table_Zero_Introduction$z2_w2wed_prev)
zero_introduction_z2_prev$zone <- as.factor('Z2')
zero_introduction_z2_prev$scenario <- as.factor('TI_04')
names(zero_introduction_z2_prev) <- c('prevalence','zone','scenario')

zero_introduction_z3_prev <- as.data.frame(NL_table_Zero_Introduction$z2_w2wed_prev)
zero_introduction_z3_prev$zone <- as.factor('Z3')
zero_introduction_z3_prev$scenario <- as.factor('TI_04')
names(zero_introduction_z3_prev) <- c('prevalence','zone','scenario')

zero_introduction_zone_prev <- rbind(zero_introduction_z1_prev,zero_introduction_z2_prev,zero_introduction_z3_prev)
```

```{r import Z4 Load 1 Log Reduction}
NL_table_Z4_Load_1_Log_Red <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-19-21-17 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Z4_Load_Reduction-table_15.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Load_1_Log_Red <- NL_table_Z4_Load_1_Log_Red[NL_table_Z4_Load_1_Log_Red$scenario==15,]

while (any(grepl('-', names(NL_table_Z4_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_1_Log_Red <- NL_table_Z4_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_1_Log_Red <- NL_table_Z4_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_1_Log_Red <- NL_table_Z4_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_1_Log_Red <- NL_table_Z4_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Load_1_Log_Red[ , ..list_columns]

NL_table_Z4_Load_1_Log_Red[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Load_1_Log_Red <- as.data.frame(NL_table_Z4_Load_1_Log_Red)

NL_table_Z4_Load_1_Log_Red[NL_table_Z4_Load_1_Log_Red==-1] <- NA

NL_table_Z4_Load_1_Log_Red <- subset(NL_table_Z4_Load_1_Log_Red, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Load_1_Log_Red)[names(NL_table_Z4_Load_1_Log_Red)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Load_1_Log_Red)[names(NL_table_Z4_Load_1_Log_Red)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Z4_Load_1_Log_Red$loading_w2wed_conc_list[order(NL_table_Z4_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_1_log_red_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_loading_w2wed_conc_list <- append(z4_load_1_log_red_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_1_Log_Red$cleaning_w2wed_conc_list[order(NL_table_Z4_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_1_log_red_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_cleaning_w2wed_conc_list <- append(z4_load_1_log_red_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_1_Log_Red$drying_w2wed_conc_list[order(NL_table_Z4_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_1_log_red_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_drying_w2wed_conc_list <- append(z4_load_1_log_red_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_1_Log_Red$sorting_w2wed_conc_list[order(NL_table_Z4_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_1_log_red_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_sorting_w2wed_conc_list <- append(z4_load_1_log_red_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_1_Log_Red$reject_w2wed_conc_list[order(NL_table_Z4_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_1_log_red_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_reject_w2wed_conc_list <- append(z4_load_1_log_red_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_1_Log_Red$tray_packing_w2wed_conc_list[order(NL_table_Z4_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_1_log_red_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_tray_packing_w2wed_conc_list <- append(z4_load_1_log_red_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_1_Log_Red$other_w2wed_conc_list[order(NL_table_Z4_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_1_log_red_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_other_w2wed_conc_list <- append(z4_load_1_log_red_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

z4_load_1_log_red_loading_concs <- as.data.frame(z4_load_1_log_red_loading_w2wed_conc_list)
z4_load_1_log_red_loading_concs$area <- as.factor('loading')
z4_load_1_log_red_loading_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_cleaning_concs <- as.data.frame(z4_load_1_log_red_cleaning_w2wed_conc_list)
z4_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_sorting_concs <- as.data.frame(z4_load_1_log_red_sorting_w2wed_conc_list)
z4_load_1_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_1_log_red_sorting_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_tray_packing_concs <- as.data.frame(z4_load_1_log_red_tray_packing_w2wed_conc_list)
z4_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_reject_concs <- as.data.frame(z4_load_1_log_red_reject_w2wed_conc_list)
z4_load_1_log_red_reject_concs$area <- as.factor('reject')
z4_load_1_log_red_reject_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_other_concs <- as.data.frame(z4_load_1_log_red_other_w2wed_conc_list)
z4_load_1_log_red_other_concs$area <- as.factor('other')
z4_load_1_log_red_other_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_concs <- rbind(z4_load_1_log_red_loading_concs,z4_load_1_log_red_cleaning_concs,z4_load_1_log_red_sorting_concs,z4_load_1_log_red_tray_packing_concs,z4_load_1_log_red_reject_concs,z4_load_1_log_red_other_concs)

z4_load_1_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$loading_w2wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_loading_prev$area <- as.factor('loading')
z4_load_1_log_red_loading_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$cleaning_w2wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$sorting_w2wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_1_log_red_sorting_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$reject_w2wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_reject_prev$area <- as.factor('reject')
z4_load_1_log_red_reject_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$tray_packing_w2wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$other_w2wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_other_prev$area <- as.factor('other')
z4_load_1_log_red_other_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_prev <- rbind(z4_load_1_log_red_loading_prev,z4_load_1_log_red_cleaning_prev,z4_load_1_log_red_sorting_prev,z4_load_1_log_red_tray_packing_prev,z4_load_1_log_red_reject_prev,z4_load_1_log_red_other_prev)

z4_load_1_log_red_wet_prev <- as.data.frame(z4_load_1_log_red_loading_prev$prevalence*21/100+z4_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_1_log_red_wet_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_wet_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_wet_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_dry_prev <- as.data.frame(z4_load_1_log_red_sorting_prev$prevalence*20/100+z4_load_1_log_red_reject_prev$prevalence*23/100+z4_load_1_log_red_tray_packing_prev$prevalence*123/100+z4_load_1_log_red_other_prev$prevalence*10/100)/176*100
z4_load_1_log_red_dry_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_dry_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_dry_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_recombined_prev <- rbind(z4_load_1_log_red_wet_prev, z4_load_1_log_red_dry_prev)

z4_load_1_log_red_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(z4_load_1_log_red_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('LZ_01'),
  as.factor(baseline_recombined_prev$water)
)
colnames(z4_load_1_log_red_eff_prev)<- c('prevalence', 'scenario', 'water')

z4_load_1_log_red_z1_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$z1_w2wed_prev)
z4_load_1_log_red_z1_prev$zone <- as.factor('Z1')
z4_load_1_log_red_z1_prev$scenario <- as.factor('LZ_01')
names(z4_load_1_log_red_z1_prev) <- c('prevalence','zone','scenario')

z4_load_1_log_red_z2_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$z2_w2wed_prev)
z4_load_1_log_red_z2_prev$zone <- as.factor('Z2')
z4_load_1_log_red_z2_prev$scenario <- as.factor('LZ_01')
names(z4_load_1_log_red_z2_prev) <- c('prevalence','zone','scenario')

z4_load_1_log_red_z3_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$z2_w2wed_prev)
z4_load_1_log_red_z3_prev$zone <- as.factor('Z3')
z4_load_1_log_red_z3_prev$scenario <- as.factor('LZ_01')
names(z4_load_1_log_red_z3_prev) <- c('prevalence','zone','scenario')

z4_load_1_log_red_zone_prev <- rbind(z4_load_1_log_red_z1_prev,z4_load_1_log_red_z2_prev,z4_load_1_log_red_z3_prev)
```

```{r import Z4 Load 2 Log Reduction}
NL_table_Z4_Load_2_Log_Red <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-19-21-17 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Z4_Load_Reduction-table_16.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Load_2_Log_Red <- NL_table_Z4_Load_2_Log_Red[NL_table_Z4_Load_2_Log_Red$scenario==16,]

while (any(grepl('-', names(NL_table_Z4_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_2_Log_Red <- NL_table_Z4_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_2_Log_Red <- NL_table_Z4_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_2_Log_Red <- NL_table_Z4_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_2_Log_Red <- NL_table_Z4_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Load_2_Log_Red[ , ..list_columns]

NL_table_Z4_Load_2_Log_Red[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Load_2_Log_Red <- as.data.frame(NL_table_Z4_Load_2_Log_Red)

NL_table_Z4_Load_2_Log_Red[NL_table_Z4_Load_2_Log_Red==-1] <- NA

NL_table_Z4_Load_2_Log_Red <- subset(NL_table_Z4_Load_2_Log_Red, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Load_2_Log_Red)[names(NL_table_Z4_Load_2_Log_Red)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Load_2_Log_Red)[names(NL_table_Z4_Load_2_Log_Red)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Z4_Load_2_Log_Red$loading_w2wed_conc_list[order(NL_table_Z4_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_2_log_red_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_loading_w2wed_conc_list <- append(z4_load_2_log_red_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_2_Log_Red$cleaning_w2wed_conc_list[order(NL_table_Z4_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_2_log_red_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_cleaning_w2wed_conc_list <- append(z4_load_2_log_red_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_2_Log_Red$drying_w2wed_conc_list[order(NL_table_Z4_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_2_log_red_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_drying_w2wed_conc_list <- append(z4_load_2_log_red_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_2_Log_Red$sorting_w2wed_conc_list[order(NL_table_Z4_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_2_log_red_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_sorting_w2wed_conc_list <- append(z4_load_2_log_red_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_2_Log_Red$reject_w2wed_conc_list[order(NL_table_Z4_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_2_log_red_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_reject_w2wed_conc_list <- append(z4_load_2_log_red_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_2_Log_Red$tray_packing_w2wed_conc_list[order(NL_table_Z4_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_2_log_red_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_tray_packing_w2wed_conc_list <- append(z4_load_2_log_red_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_2_Log_Red$other_w2wed_conc_list[order(NL_table_Z4_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_2_log_red_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_other_w2wed_conc_list <- append(z4_load_2_log_red_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

z4_load_2_log_red_loading_concs <- as.data.frame(z4_load_2_log_red_loading_w2wed_conc_list)
z4_load_2_log_red_loading_concs$area <- as.factor('loading')
z4_load_2_log_red_loading_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_cleaning_concs <- as.data.frame(z4_load_2_log_red_cleaning_w2wed_conc_list)
z4_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_sorting_concs <- as.data.frame(z4_load_2_log_red_sorting_w2wed_conc_list)
z4_load_2_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_2_log_red_sorting_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_reject_concs <- as.data.frame(z4_load_2_log_red_reject_w2wed_conc_list)
z4_load_2_log_red_reject_concs$area <- as.factor('reject')
z4_load_2_log_red_reject_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_tray_packing_concs <- as.data.frame(z4_load_2_log_red_tray_packing_w2wed_conc_list)
z4_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_other_concs <- as.data.frame(z4_load_2_log_red_other_w2wed_conc_list)
z4_load_2_log_red_other_concs$area <- as.factor('other')
z4_load_2_log_red_other_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_concs <- rbind(z4_load_2_log_red_loading_concs,z4_load_2_log_red_cleaning_concs,z4_load_2_log_red_sorting_concs,z4_load_2_log_red_tray_packing_concs,z4_load_2_log_red_reject_concs,z4_load_2_log_red_other_concs)

z4_load_2_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$loading_w2wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_loading_prev$area <- as.factor('loading')
z4_load_2_log_red_loading_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$cleaning_w2wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$sorting_w2wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_2_log_red_sorting_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$reject_w2wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_reject_prev$area <- as.factor('reject')
z4_load_2_log_red_reject_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$tray_packing_w2wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$other_w2wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_other_prev$area <- as.factor('other')
z4_load_2_log_red_other_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_prev <- rbind(z4_load_2_log_red_loading_prev,z4_load_2_log_red_cleaning_prev,z4_load_2_log_red_sorting_prev,z4_load_2_log_red_tray_packing_prev,z4_load_2_log_red_reject_prev,z4_load_2_log_red_other_prev)

z4_load_2_log_red_wet_prev <- as.data.frame(z4_load_2_log_red_loading_prev$prevalence*21/100+z4_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_2_log_red_wet_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_wet_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_wet_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_dry_prev <- as.data.frame(z4_load_2_log_red_sorting_prev$prevalence*20/100+z4_load_2_log_red_reject_prev$prevalence*23/100+z4_load_2_log_red_tray_packing_prev$prevalence*123/100+z4_load_2_log_red_other_prev$prevalence*10/100)/176*100
z4_load_2_log_red_dry_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_dry_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_dry_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_recombined_prev <- rbind(z4_load_2_log_red_wet_prev, z4_load_2_log_red_dry_prev)

z4_load_2_log_red_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(z4_load_2_log_red_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('LZ_02'),
  as.factor(baseline_recombined_prev$water)
)
colnames(z4_load_2_log_red_eff_prev)<- c('prevalence', 'scenario', 'water')

z4_load_2_log_red_z1_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$z1_w2wed_prev)
z4_load_2_log_red_z1_prev$zone <- as.factor('Z1')
z4_load_2_log_red_z1_prev$scenario <- as.factor('LZ_02')
names(z4_load_2_log_red_z1_prev) <- c('prevalence','zone','scenario')

z4_load_2_log_red_z2_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$z2_w2wed_prev)
z4_load_2_log_red_z2_prev$zone <- as.factor('Z2')
z4_load_2_log_red_z2_prev$scenario <- as.factor('LZ_02')
names(z4_load_2_log_red_z2_prev) <- c('prevalence','zone','scenario')

z4_load_2_log_red_z3_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$z2_w2wed_prev)
z4_load_2_log_red_z3_prev$zone <- as.factor('Z3')
z4_load_2_log_red_z3_prev$scenario <- as.factor('LZ_02')
names(z4_load_2_log_red_z3_prev) <- c('prevalence','zone','scenario')

z4_load_2_log_red_zone_prev <- rbind(z4_load_2_log_red_z1_prev,z4_load_2_log_red_z2_prev,z4_load_2_log_red_z3_prev)
```

```{r import Z4 Load 3 Log Reduction}
NL_table_Z4_Load_3_Log_Red <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-19-21-17 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Z4_Load_Reduction-table_17.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Load_3_Log_Red <- NL_table_Z4_Load_3_Log_Red[NL_table_Z4_Load_3_Log_Red$scenario==17,]

while (any(grepl('-', names(NL_table_Z4_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_3_Log_Red <- NL_table_Z4_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_3_Log_Red <- NL_table_Z4_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_3_Log_Red <- NL_table_Z4_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_3_Log_Red <- NL_table_Z4_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Load_3_Log_Red[ , ..list_columns]

NL_table_Z4_Load_3_Log_Red[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Load_3_Log_Red <- as.data.frame(NL_table_Z4_Load_3_Log_Red)

NL_table_Z4_Load_3_Log_Red[NL_table_Z4_Load_3_Log_Red==-1] <- NA

NL_table_Z4_Load_3_Log_Red <- subset(NL_table_Z4_Load_3_Log_Red, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Load_3_Log_Red)[names(NL_table_Z4_Load_3_Log_Red)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Load_3_Log_Red)[names(NL_table_Z4_Load_3_Log_Red)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Z4_Load_3_Log_Red$loading_w2wed_conc_list[order(NL_table_Z4_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_3_log_red_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_loading_w2wed_conc_list <- append(z4_load_3_log_red_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_3_Log_Red$cleaning_w2wed_conc_list[order(NL_table_Z4_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_3_log_red_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_cleaning_w2wed_conc_list <- append(z4_load_3_log_red_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_3_Log_Red$drying_w2wed_conc_list[order(NL_table_Z4_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_3_log_red_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_drying_w2wed_conc_list <- append(z4_load_3_log_red_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_3_Log_Red$sorting_w2wed_conc_list[order(NL_table_Z4_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_3_log_red_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_sorting_w2wed_conc_list <- append(z4_load_3_log_red_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_3_Log_Red$reject_w2wed_conc_list[order(NL_table_Z4_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_3_log_red_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_reject_w2wed_conc_list <- append(z4_load_3_log_red_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_3_Log_Red$tray_packing_w2wed_conc_list[order(NL_table_Z4_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_3_log_red_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_tray_packing_w2wed_conc_list <- append(z4_load_3_log_red_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_3_Log_Red$other_w2wed_conc_list[order(NL_table_Z4_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
z4_load_3_log_red_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_other_w2wed_conc_list <- append(z4_load_3_log_red_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

z4_load_3_log_red_loading_concs <- as.data.frame(z4_load_3_log_red_loading_w2wed_conc_list)
z4_load_3_log_red_loading_concs$area <- as.factor('loading')
z4_load_3_log_red_loading_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_cleaning_concs <- as.data.frame(z4_load_3_log_red_cleaning_w2wed_conc_list)
z4_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_sorting_concs <- as.data.frame(z4_load_3_log_red_sorting_w2wed_conc_list)
z4_load_3_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_3_log_red_sorting_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_reject_concs <- as.data.frame(z4_load_3_log_red_reject_w2wed_conc_list)
z4_load_3_log_red_reject_concs$area <- as.factor('reject')
z4_load_3_log_red_reject_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_tray_packing_concs <- as.data.frame(z4_load_3_log_red_tray_packing_w2wed_conc_list)
z4_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_other_concs <- as.data.frame(z4_load_3_log_red_other_w2wed_conc_list)
z4_load_3_log_red_other_concs$area <- as.factor('other')
z4_load_3_log_red_other_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_concs <- rbind(z4_load_3_log_red_loading_concs,z4_load_3_log_red_cleaning_concs,z4_load_3_log_red_sorting_concs,z4_load_3_log_red_tray_packing_concs,z4_load_3_log_red_reject_concs,z4_load_3_log_red_other_concs)

z4_load_3_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$loading_w2wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_loading_prev$area <- as.factor('loading')
z4_load_3_log_red_loading_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$cleaning_w2wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$sorting_w2wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_3_log_red_sorting_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$reject_w2wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_reject_prev$area <- as.factor('reject')
z4_load_3_log_red_reject_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$tray_packing_w2wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$other_w2wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_other_prev$area <- as.factor('other')
z4_load_3_log_red_other_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_prev <- rbind(z4_load_3_log_red_loading_prev,z4_load_3_log_red_cleaning_prev,z4_load_3_log_red_sorting_prev,z4_load_3_log_red_tray_packing_prev,z4_load_3_log_red_reject_prev,z4_load_3_log_red_other_prev)

z4_load_3_log_red_wet_prev <- as.data.frame(z4_load_3_log_red_loading_prev$prevalence*21/100+z4_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_3_log_red_wet_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_wet_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_wet_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_dry_prev <- as.data.frame(z4_load_3_log_red_sorting_prev$prevalence*20/100+z4_load_3_log_red_reject_prev$prevalence*23/100+z4_load_3_log_red_tray_packing_prev$prevalence*123/100+z4_load_3_log_red_other_prev$prevalence*10/100)/176*100
z4_load_3_log_red_dry_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_dry_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_dry_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_recombined_prev <- rbind(z4_load_3_log_red_wet_prev, z4_load_3_log_red_dry_prev)

z4_load_3_log_red_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(z4_load_3_log_red_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('LZ_03'),
  as.factor(baseline_recombined_prev$water)
)
colnames(z4_load_3_log_red_eff_prev)<- c('prevalence', 'scenario', 'water')

z4_load_3_log_red_z1_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$z1_w2wed_prev)
z4_load_3_log_red_z1_prev$zone <- as.factor('Z1')
z4_load_3_log_red_z1_prev$scenario <- as.factor('LZ_03')
names(z4_load_3_log_red_z1_prev) <- c('prevalence','zone','scenario')

z4_load_3_log_red_z2_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$z2_w2wed_prev)
z4_load_3_log_red_z2_prev$zone <- as.factor('Z2')
z4_load_3_log_red_z2_prev$scenario <- as.factor('LZ_03')
names(z4_load_3_log_red_z2_prev) <- c('prevalence','zone','scenario')

z4_load_3_log_red_z3_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$z2_w2wed_prev)
z4_load_3_log_red_z3_prev$zone <- as.factor('Z3')
z4_load_3_log_red_z3_prev$scenario <- as.factor('LZ_03')
names(z4_load_3_log_red_z3_prev) <- c('prevalence','zone','scenario')

z4_load_3_log_red_zone_prev <- rbind(z4_load_3_log_red_z1_prev,z4_load_3_log_red_z2_prev,z4_load_3_log_red_z3_prev)
```

```{r import Z4 Load 0%}
NL_table_Z4_Load_0pc <- fread(paste0(getwd(),'/BehaviorSpace/2020-10-24-21-02 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Z4_Load_Intervention-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Load_0pc <- NL_table_Z4_Load_0pc[NL_table_Z4_Load_0pc$scenario==7,]

while (any(grepl('-', names(NL_table_Z4_Load_0pc), fixed = TRUE))) {
  NL_table_Z4_Load_0pc <- NL_table_Z4_Load_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Load_0pc), fixed = TRUE))) {
  NL_table_Z4_Load_0pc <- NL_table_Z4_Load_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Load_0pc), fixed = TRUE))) {
  NL_table_Z4_Load_0pc <- NL_table_Z4_Load_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Load_0pc), fixed = TRUE))) {
  NL_table_Z4_Load_0pc <- NL_table_Z4_Load_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Load_0pc[ , ..list_columns]

NL_table_Z4_Load_0pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Load_0pc <- as.data.frame(NL_table_Z4_Load_0pc)

NL_table_Z4_Load_0pc[NL_table_Z4_Load_0pc==-1] <- NA

NL_table_Z4_Load_0pc <- subset(NL_table_Z4_Load_0pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Load_0pc)[names(NL_table_Z4_Load_0pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Load_0pc)[names(NL_table_Z4_Load_0pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Z4_Load_0pc$loading_w2wed_conc_list[order(NL_table_Z4_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_load_0pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_0pc_loading_w2wed_conc_list <- append(z4_load_0pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_0pc$cleaning_w2wed_conc_list[order(NL_table_Z4_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_load_0pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_0pc_cleaning_w2wed_conc_list <- append(z4_load_0pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_0pc$drying_w2wed_conc_list[order(NL_table_Z4_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_load_0pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_0pc_drying_w2wed_conc_list <- append(z4_load_0pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_0pc$sorting_w2wed_conc_list[order(NL_table_Z4_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_load_0pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_0pc_sorting_w2wed_conc_list <- append(z4_load_0pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_0pc$reject_w2wed_conc_list[order(NL_table_Z4_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_load_0pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_0pc_reject_w2wed_conc_list <- append(z4_load_0pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_0pc$tray_packing_w2wed_conc_list[order(NL_table_Z4_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_load_0pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_0pc_tray_packing_w2wed_conc_list <- append(z4_load_0pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Load_0pc$other_w2wed_conc_list[order(NL_table_Z4_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_load_0pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_0pc_other_w2wed_conc_list <- append(z4_load_0pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

z4_load_0pc_loading_concs <- as.data.frame(z4_load_0pc_loading_w2wed_conc_list)
z4_load_0pc_loading_concs$area <- as.factor('loading')
z4_load_0pc_loading_concs$scenario <- as.factor('Z4 Load 0%')
z4_load_0pc_loading_concs$water <- as.factor('Wet')
names(z4_load_0pc_loading_concs) <- c('concentration','area','scenario','water')

z4_load_0pc_cleaning_concs <- as.data.frame(z4_load_0pc_cleaning_w2wed_conc_list)
z4_load_0pc_cleaning_concs$area <- as.factor('cleaning')
z4_load_0pc_cleaning_concs$scenario <- as.factor('Z4 Load 0%')
z4_load_0pc_cleaning_concs$water <- as.factor('Wet')
names(z4_load_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_0pc_sorting_concs <- as.data.frame(z4_load_0pc_sorting_w2wed_conc_list)
z4_load_0pc_sorting_concs$area <- as.factor('sorting')
z4_load_0pc_sorting_concs$scenario <- as.factor('Z4 Load 0%')
z4_load_0pc_sorting_concs$water <- as.factor('Dry')
names(z4_load_0pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_0pc_reject_concs <- as.data.frame(z4_load_0pc_reject_w2wed_conc_list)
z4_load_0pc_reject_concs$area <- as.factor('reject')
z4_load_0pc_reject_concs$scenario <- as.factor('Z4 Load 0%')
z4_load_0pc_reject_concs$water <- as.factor('Dry')
names(z4_load_0pc_reject_concs) <- c('concentration','area','scenario','water')

z4_load_0pc_tray_packing_concs <- as.data.frame(z4_load_0pc_tray_packing_w2wed_conc_list)
z4_load_0pc_tray_packing_concs$area <- as.factor('tray packing')
z4_load_0pc_tray_packing_concs$scenario <- as.factor('Z4 Load 0%')
z4_load_0pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_0pc_other_concs <- as.data.frame(z4_load_0pc_other_w2wed_conc_list)
z4_load_0pc_other_concs$area <- as.factor('other')
z4_load_0pc_other_concs$scenario <- as.factor('Z4 Load 0%')
z4_load_0pc_other_concs$water <- as.factor('Dry')
names(z4_load_0pc_other_concs) <- c('concentration','area','scenario','water')

z4_load_0pc_concs <- rbind(z4_load_0pc_loading_concs,z4_load_0pc_cleaning_concs,z4_load_0pc_sorting_concs,z4_load_0pc_tray_packing_concs,z4_load_0pc_reject_concs,z4_load_0pc_other_concs)

z4_load_0pc_loading_prev <- as.data.frame(NL_table_Z4_Load_0pc$loading_w2wed_prev[order(NL_table_Z4_Load_0pc$local_seed)])
z4_load_0pc_loading_prev$area <- as.factor('loading')
z4_load_0pc_loading_prev$scenario <- as.factor('Z4 Load 0%')
z4_load_0pc_loading_prev$water <- as.factor('Wet')
names(z4_load_0pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_0pc_cleaning_prev <- as.data.frame(NL_table_Z4_Load_0pc$cleaning_w2wed_prev[order(NL_table_Z4_Load_0pc$local_seed)])
z4_load_0pc_cleaning_prev$area <- as.factor('cleaning')
z4_load_0pc_cleaning_prev$scenario <- as.factor('Z4 Load 0%')
z4_load_0pc_cleaning_prev$water <- as.factor('Wet')
names(z4_load_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_0pc_sorting_prev <- as.data.frame(NL_table_Z4_Load_0pc$sorting_w2wed_prev[order(NL_table_Z4_Load_0pc$local_seed)])
z4_load_0pc_sorting_prev$area <- as.factor('sorting')
z4_load_0pc_sorting_prev$scenario <- as.factor('Z4 Load 0%')
z4_load_0pc_sorting_prev$water <- as.factor('Dry')
names(z4_load_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_0pc_reject_prev <- as.data.frame(NL_table_Z4_Load_0pc$reject_w2wed_prev[order(NL_table_Z4_Load_0pc$local_seed)])
z4_load_0pc_reject_prev$area <- as.factor('reject')
z4_load_0pc_reject_prev$scenario <- as.factor('Z4 Load 0%')
z4_load_0pc_reject_prev$water <- as.factor('Dry')
names(z4_load_0pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_0pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_0pc$tray_packing_w2wed_prev[order(NL_table_Z4_Load_0pc$local_seed)])
z4_load_0pc_tray_packing_prev$area <- as.factor('tray packing')
z4_load_0pc_tray_packing_prev$scenario <- as.factor('Z4 Load 0%')
z4_load_0pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_0pc_other_prev <- as.data.frame(NL_table_Z4_Load_0pc$other_w2wed_prev[order(NL_table_Z4_Load_0pc$local_seed)])
z4_load_0pc_other_prev$area <- as.factor('other')
z4_load_0pc_other_prev$scenario <- as.factor('Z4 Load 0%')
z4_load_0pc_other_prev$water <- as.factor('Dry')
names(z4_load_0pc_other_prev) <- c('prevalence','area','scenario','water')

z4_load_0pc_prev <- rbind(z4_load_0pc_loading_prev,z4_load_0pc_cleaning_prev,z4_load_0pc_sorting_prev,z4_load_0pc_tray_packing_prev,z4_load_0pc_reject_prev,z4_load_0pc_other_prev)
```

```{r import Random Load 1 Log Reduction}
NL_table_Random_Load_1_Log_Red <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-14-14-03 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Random_Load_Interventions_12-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Load_1_Log_Red <- NL_table_Random_Load_1_Log_Red[NL_table_Random_Load_1_Log_Red$scenario==12,]

while (any(grepl('-', names(NL_table_Random_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_1_Log_Red <- NL_table_Random_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_1_Log_Red <- NL_table_Random_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_1_Log_Red <- NL_table_Random_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_1_Log_Red <- NL_table_Random_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Load_1_Log_Red[ , ..list_columns]

NL_table_Random_Load_1_Log_Red[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Load_1_Log_Red <- as.data.frame(NL_table_Random_Load_1_Log_Red)

NL_table_Random_Load_1_Log_Red[NL_table_Random_Load_1_Log_Red==-1] <- NA

NL_table_Random_Load_1_Log_Red <- subset(NL_table_Random_Load_1_Log_Red, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Load_1_Log_Red)[names(NL_table_Random_Load_1_Log_Red)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Load_1_Log_Red)[names(NL_table_Random_Load_1_Log_Red)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Random_Load_1_Log_Red$loading_w2wed_conc_list[order(NL_table_Random_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_1_log_red_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_loading_w2wed_conc_list <- append(random_load_1_log_red_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_1_Log_Red$cleaning_w2wed_conc_list[order(NL_table_Random_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_1_log_red_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_cleaning_w2wed_conc_list <- append(random_load_1_log_red_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_1_Log_Red$drying_w2wed_conc_list[order(NL_table_Random_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_1_log_red_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_drying_w2wed_conc_list <- append(random_load_1_log_red_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_1_Log_Red$sorting_w2wed_conc_list[order(NL_table_Random_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_1_log_red_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_sorting_w2wed_conc_list <- append(random_load_1_log_red_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_1_Log_Red$tray_packing_w2wed_conc_list[order(NL_table_Random_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_1_log_red_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_tray_packing_w2wed_conc_list <- append(random_load_1_log_red_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_1_Log_Red$reject_w2wed_conc_list[order(NL_table_Random_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_1_log_red_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_reject_w2wed_conc_list <- append(random_load_1_log_red_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_1_Log_Red$other_w2wed_conc_list[order(NL_table_Random_Load_1_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_1_log_red_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_other_w2wed_conc_list <- append(random_load_1_log_red_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

random_load_1_log_red_loading_concs <- as.data.frame(random_load_1_log_red_loading_w2wed_conc_list)
random_load_1_log_red_loading_concs$area <- as.factor('loading')
random_load_1_log_red_loading_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_cleaning_concs <- as.data.frame(random_load_1_log_red_cleaning_w2wed_conc_list)
random_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_sorting_concs <- as.data.frame(random_load_1_log_red_sorting_w2wed_conc_list)
random_load_1_log_red_sorting_concs$area <- as.factor('sorting')
random_load_1_log_red_sorting_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_reject_concs <- as.data.frame(random_load_1_log_red_reject_w2wed_conc_list)
random_load_1_log_red_reject_concs$area <- as.factor('reject')
random_load_1_log_red_reject_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_tray_packing_concs <- as.data.frame(random_load_1_log_red_tray_packing_w2wed_conc_list)
random_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_other_concs <- as.data.frame(random_load_1_log_red_other_w2wed_conc_list)
random_load_1_log_red_other_concs$area <- as.factor('other')
random_load_1_log_red_other_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_other_concs$water <- as.factor('Dry')
names(random_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_concs <- rbind(random_load_1_log_red_loading_concs,random_load_1_log_red_cleaning_concs,random_load_1_log_red_sorting_concs,random_load_1_log_red_tray_packing_concs,random_load_1_log_red_reject_concs,random_load_1_log_red_other_concs)

random_load_1_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$loading_w2wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_loading_prev$area <- as.factor('loading')
random_load_1_log_red_loading_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$cleaning_w2wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$sorting_w2wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_sorting_prev$area <- as.factor('sorting')
random_load_1_log_red_sorting_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$reject_w2wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_reject_prev$area <- as.factor('reject')
random_load_1_log_red_reject_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$tray_packing_w2wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_other_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$other_w2wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_other_prev$area <- as.factor('other')
random_load_1_log_red_other_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_other_prev$water <- as.factor('Dry')
names(random_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_prev <- rbind(random_load_1_log_red_loading_prev,random_load_1_log_red_cleaning_prev,random_load_1_log_red_sorting_prev,random_load_1_log_red_tray_packing_prev,random_load_1_log_red_reject_prev,random_load_1_log_red_other_prev)

random_load_1_log_red_wet_prev <- as.data.frame(random_load_1_log_red_loading_prev$prevalence*21/100+random_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_1_log_red_wet_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_wet_prev$water <- as.factor('Wet')
names(random_load_1_log_red_wet_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_dry_prev <- as.data.frame(random_load_1_log_red_sorting_prev$prevalence*20/100+random_load_1_log_red_reject_prev$prevalence*23/100+random_load_1_log_red_tray_packing_prev$prevalence*123/100+random_load_1_log_red_other_prev$prevalence*10/100)/176*100
random_load_1_log_red_dry_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_dry_prev$water <- as.factor('Dry')
names(random_load_1_log_red_dry_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_recombined_prev <- rbind(random_load_1_log_red_wet_prev, random_load_1_log_red_dry_prev)

random_load_1_log_red_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(random_load_1_log_red_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('LR_01'),
  as.factor(baseline_recombined_prev$water)
)
colnames(random_load_1_log_red_eff_prev)<- c('prevalence', 'scenario', 'water')

random_load_1_log_red_z1_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$z1_w2wed_prev)
random_load_1_log_red_z1_prev$zone <- as.factor('Z1')
random_load_1_log_red_z1_prev$scenario <- as.factor('LR_01')
names(random_load_1_log_red_z1_prev) <- c('prevalence','zone','scenario')

random_load_1_log_red_z2_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$z2_w2wed_prev)
random_load_1_log_red_z2_prev$zone <- as.factor('Z2')
random_load_1_log_red_z2_prev$scenario <- as.factor('LR_01')
names(random_load_1_log_red_z2_prev) <- c('prevalence','zone','scenario')

random_load_1_log_red_z3_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$z2_w2wed_prev)
random_load_1_log_red_z3_prev$zone <- as.factor('Z3')
random_load_1_log_red_z3_prev$scenario <- as.factor('LR_01')
names(random_load_1_log_red_z3_prev) <- c('prevalence','zone','scenario')

random_load_1_log_red_zone_prev <- rbind(random_load_1_log_red_z1_prev,random_load_1_log_red_z2_prev,random_load_1_log_red_z3_prev)
```

```{r import Random Load 2 Log Reduction}
NL_table_Random_Load_2_Log_Red <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-14-14-03 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Random_Load_Interventions_13-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Load_2_Log_Red <- NL_table_Random_Load_2_Log_Red[NL_table_Random_Load_2_Log_Red$scenario==13,]

while (any(grepl('-', names(NL_table_Random_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_2_Log_Red <- NL_table_Random_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_2_Log_Red <- NL_table_Random_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_2_Log_Red <- NL_table_Random_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_2_Log_Red <- NL_table_Random_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Load_2_Log_Red[ , ..list_columns]

NL_table_Random_Load_2_Log_Red[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Load_2_Log_Red <- as.data.frame(NL_table_Random_Load_2_Log_Red)

NL_table_Random_Load_2_Log_Red[NL_table_Random_Load_2_Log_Red==-1] <- NA

NL_table_Random_Load_2_Log_Red <- subset(NL_table_Random_Load_2_Log_Red, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Load_2_Log_Red)[names(NL_table_Random_Load_2_Log_Red)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Load_2_Log_Red)[names(NL_table_Random_Load_2_Log_Red)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Random_Load_2_Log_Red$loading_w2wed_conc_list[order(NL_table_Random_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_2_log_red_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_loading_w2wed_conc_list <- append(random_load_2_log_red_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_2_Log_Red$cleaning_w2wed_conc_list[order(NL_table_Random_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_2_log_red_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_cleaning_w2wed_conc_list <- append(random_load_2_log_red_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_2_Log_Red$drying_w2wed_conc_list[order(NL_table_Random_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_2_log_red_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_drying_w2wed_conc_list <- append(random_load_2_log_red_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_2_Log_Red$sorting_w2wed_conc_list[order(NL_table_Random_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_2_log_red_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_sorting_w2wed_conc_list <- append(random_load_2_log_red_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_2_Log_Red$tray_packing_w2wed_conc_list[order(NL_table_Random_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_2_log_red_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_tray_packing_w2wed_conc_list <- append(random_load_2_log_red_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_2_Log_Red$reject_w2wed_conc_list[order(NL_table_Random_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_2_log_red_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_reject_w2wed_conc_list <- append(random_load_2_log_red_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_2_Log_Red$other_w2wed_conc_list[order(NL_table_Random_Load_2_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_2_log_red_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_other_w2wed_conc_list <- append(random_load_2_log_red_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

random_load_2_log_red_loading_concs <- as.data.frame(random_load_2_log_red_loading_w2wed_conc_list)
random_load_2_log_red_loading_concs$area <- as.factor('loading')
random_load_2_log_red_loading_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_cleaning_concs <- as.data.frame(random_load_2_log_red_cleaning_w2wed_conc_list)
random_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_sorting_concs <- as.data.frame(random_load_2_log_red_sorting_w2wed_conc_list)
random_load_2_log_red_sorting_concs$area <- as.factor('sorting')
random_load_2_log_red_sorting_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_reject_concs <- as.data.frame(random_load_2_log_red_reject_w2wed_conc_list)
random_load_2_log_red_reject_concs$area <- as.factor('reject')
random_load_2_log_red_reject_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_tray_packing_concs <- as.data.frame(random_load_2_log_red_tray_packing_w2wed_conc_list)
random_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_other_concs <- as.data.frame(random_load_2_log_red_other_w2wed_conc_list)
random_load_2_log_red_other_concs$area <- as.factor('other')
random_load_2_log_red_other_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_other_concs$water <- as.factor('Dry')
names(random_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_concs <- rbind(random_load_2_log_red_loading_concs,random_load_2_log_red_cleaning_concs,random_load_2_log_red_sorting_concs,random_load_2_log_red_tray_packing_concs,random_load_2_log_red_reject_concs,random_load_2_log_red_other_concs)

random_load_2_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$loading_w2wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_loading_prev$area <- as.factor('loading')
random_load_2_log_red_loading_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$cleaning_w2wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$sorting_w2wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_sorting_prev$area <- as.factor('sorting')
random_load_2_log_red_sorting_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$reject_w2wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_reject_prev$area <- as.factor('reject')
random_load_2_log_red_reject_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$tray_packing_w2wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_other_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$other_w2wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_other_prev$area <- as.factor('other')
random_load_2_log_red_other_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_other_prev$water <- as.factor('Dry')
names(random_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_prev <- rbind(random_load_2_log_red_loading_prev,random_load_2_log_red_cleaning_prev,random_load_2_log_red_sorting_prev,random_load_2_log_red_tray_packing_prev,random_load_2_log_red_reject_prev,random_load_2_log_red_other_prev)

random_load_2_log_red_wet_prev <- as.data.frame(random_load_2_log_red_loading_prev$prevalence*21/100+random_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_2_log_red_wet_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_wet_prev$water <- as.factor('Wet')
names(random_load_2_log_red_wet_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_dry_prev <- as.data.frame(random_load_2_log_red_sorting_prev$prevalence*20/100+random_load_2_log_red_reject_prev$prevalence*23/100+random_load_2_log_red_tray_packing_prev$prevalence*123/100+random_load_2_log_red_other_prev$prevalence*10/100)/176*100
random_load_2_log_red_dry_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_dry_prev$water <- as.factor('Dry')
names(random_load_2_log_red_dry_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_recombined_prev <- rbind(random_load_2_log_red_wet_prev, random_load_2_log_red_dry_prev)

random_load_2_log_red_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(random_load_2_log_red_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('LR_02'),
  as.factor(baseline_recombined_prev$water)
)
colnames(random_load_2_log_red_eff_prev)<- c('prevalence', 'scenario', 'water')

random_load_2_log_red_z1_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$z1_w2wed_prev)
random_load_2_log_red_z1_prev$zone <- as.factor('Z1')
random_load_2_log_red_z1_prev$scenario <- as.factor('LR_02')
names(random_load_2_log_red_z1_prev) <- c('prevalence','zone','scenario')

random_load_2_log_red_z2_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$z2_w2wed_prev)
random_load_2_log_red_z2_prev$zone <- as.factor('Z2')
random_load_2_log_red_z2_prev$scenario <- as.factor('LR_02')
names(random_load_2_log_red_z2_prev) <- c('prevalence','zone','scenario')

random_load_2_log_red_z3_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$z2_w2wed_prev)
random_load_2_log_red_z3_prev$zone <- as.factor('Z3')
random_load_2_log_red_z3_prev$scenario <- as.factor('LR_02')
names(random_load_2_log_red_z3_prev) <- c('prevalence','zone','scenario')

random_load_2_log_red_zone_prev <- rbind(random_load_2_log_red_z1_prev,random_load_2_log_red_z2_prev,random_load_2_log_red_z3_prev)
```

```{r import Random Load 3 Log Reduction}
NL_table_Random_Load_3_Log_Red <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-14-14-03 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Random_Load_Interventions_14-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Load_3_Log_Red <- NL_table_Random_Load_3_Log_Red[NL_table_Random_Load_3_Log_Red$scenario==14,]

while (any(grepl('-', names(NL_table_Random_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_3_Log_Red <- NL_table_Random_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_3_Log_Red <- NL_table_Random_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_3_Log_Red <- NL_table_Random_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_3_Log_Red <- NL_table_Random_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Load_3_Log_Red[ , ..list_columns]

NL_table_Random_Load_3_Log_Red[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Load_3_Log_Red <- as.data.frame(NL_table_Random_Load_3_Log_Red)

NL_table_Random_Load_3_Log_Red[NL_table_Random_Load_3_Log_Red==-1] <- NA

NL_table_Random_Load_3_Log_Red <- subset(NL_table_Random_Load_3_Log_Red, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Load_3_Log_Red)[names(NL_table_Random_Load_3_Log_Red)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Load_3_Log_Red)[names(NL_table_Random_Load_3_Log_Red)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Random_Load_3_Log_Red$loading_w2wed_conc_list[order(NL_table_Random_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_3_log_red_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_loading_w2wed_conc_list <- append(random_load_3_log_red_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_3_Log_Red$cleaning_w2wed_conc_list[order(NL_table_Random_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_3_log_red_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_cleaning_w2wed_conc_list <- append(random_load_3_log_red_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_3_Log_Red$drying_w2wed_conc_list[order(NL_table_Random_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_3_log_red_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_drying_w2wed_conc_list <- append(random_load_3_log_red_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_3_Log_Red$sorting_w2wed_conc_list[order(NL_table_Random_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_3_log_red_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_sorting_w2wed_conc_list <- append(random_load_3_log_red_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_3_Log_Red$tray_packing_w2wed_conc_list[order(NL_table_Random_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_3_log_red_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_tray_packing_w2wed_conc_list <- append(random_load_3_log_red_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_3_Log_Red$reject_w2wed_conc_list[order(NL_table_Random_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_3_log_red_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_reject_w2wed_conc_list <- append(random_load_3_log_red_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_3_Log_Red$other_w2wed_conc_list[order(NL_table_Random_Load_3_Log_Red$local_seed)]
vector <- vector[vector!='[]']
random_load_3_log_red_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_other_w2wed_conc_list <- append(random_load_3_log_red_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

random_load_3_log_red_loading_concs <- as.data.frame(random_load_3_log_red_loading_w2wed_conc_list)
random_load_3_log_red_loading_concs$area <- as.factor('loading')
random_load_3_log_red_loading_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_cleaning_concs <- as.data.frame(random_load_3_log_red_cleaning_w2wed_conc_list)
random_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_sorting_concs <- as.data.frame(random_load_3_log_red_sorting_w2wed_conc_list)
random_load_3_log_red_sorting_concs$area <- as.factor('sorting')
random_load_3_log_red_sorting_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_reject_concs <- as.data.frame(random_load_3_log_red_reject_w2wed_conc_list)
random_load_3_log_red_reject_concs$area <- as.factor('reject')
random_load_3_log_red_reject_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_tray_packing_concs <- as.data.frame(random_load_3_log_red_tray_packing_w2wed_conc_list)
random_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_other_concs <- as.data.frame(random_load_3_log_red_other_w2wed_conc_list)
random_load_3_log_red_other_concs$area <- as.factor('other')
random_load_3_log_red_other_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_other_concs$water <- as.factor('Dry')
names(random_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_concs <- rbind(random_load_3_log_red_loading_concs,random_load_3_log_red_cleaning_concs,random_load_3_log_red_sorting_concs,random_load_3_log_red_tray_packing_concs,random_load_3_log_red_reject_concs,random_load_3_log_red_other_concs)

random_load_3_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$loading_w2wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_loading_prev$area <- as.factor('loading')
random_load_3_log_red_loading_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$cleaning_w2wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$sorting_w2wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_sorting_prev$area <- as.factor('sorting')
random_load_3_log_red_sorting_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$reject_w2wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_reject_prev$area <- as.factor('reject')
random_load_3_log_red_reject_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$tray_packing_w2wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_other_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$other_w2wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_other_prev$area <- as.factor('other')
random_load_3_log_red_other_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_other_prev$water <- as.factor('Dry')
names(random_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_prev <- rbind(random_load_3_log_red_loading_prev,random_load_3_log_red_cleaning_prev,random_load_3_log_red_sorting_prev,random_load_3_log_red_tray_packing_prev,random_load_3_log_red_reject_prev,random_load_3_log_red_other_prev)

random_load_3_log_red_wet_prev <- as.data.frame(random_load_3_log_red_loading_prev$prevalence*21/100+random_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_3_log_red_wet_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_wet_prev$water <- as.factor('Wet')
names(random_load_3_log_red_wet_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_dry_prev <- as.data.frame(random_load_3_log_red_sorting_prev$prevalence*20/100+random_load_3_log_red_reject_prev$prevalence*23/100+random_load_3_log_red_tray_packing_prev$prevalence*123/100+random_load_3_log_red_other_prev$prevalence*10/100)/176*100
random_load_3_log_red_dry_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_dry_prev$water <- as.factor('Dry')
names(random_load_3_log_red_dry_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_recombined_prev <- rbind(random_load_3_log_red_wet_prev, random_load_3_log_red_dry_prev)

random_load_3_log_red_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(random_load_3_log_red_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('LR_03'),
  as.factor(baseline_recombined_prev$water)
)
colnames(random_load_3_log_red_eff_prev)<- c('prevalence', 'scenario', 'water')

random_load_3_log_red_z1_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$z1_w2wed_prev)
random_load_3_log_red_z1_prev$zone <- as.factor('Z1')
random_load_3_log_red_z1_prev$scenario <- as.factor('LR_03')
names(random_load_3_log_red_z1_prev) <- c('prevalence','zone','scenario')

random_load_3_log_red_z2_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$z2_w2wed_prev)
random_load_3_log_red_z2_prev$zone <- as.factor('Z2')
random_load_3_log_red_z2_prev$scenario <- as.factor('LR_03')
names(random_load_3_log_red_z2_prev) <- c('prevalence','zone','scenario')

random_load_3_log_red_z3_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$z2_w2wed_prev)
random_load_3_log_red_z3_prev$zone <- as.factor('Z3')
random_load_3_log_red_z3_prev$scenario <- as.factor('LR_03')
names(random_load_3_log_red_z3_prev) <- c('prevalence','zone','scenario')

random_load_3_log_red_zone_prev <- rbind(random_load_3_log_red_z1_prev,random_load_3_log_red_z2_prev,random_load_3_log_red_z3_prev)
```

```{r import Random Load 0%}
NL_table_Random_Load_0pc <- fread(paste0(getwd(),'/BehaviorSpace/2020-10-23-15-14 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Random_Load_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Load_0pc <- NL_table_Random_Load_0pc[NL_table_Random_Load_0pc$scenario==6,]

while (any(grepl('-', names(NL_table_Random_Load_0pc), fixed = TRUE))) {
  NL_table_Random_Load_0pc <- NL_table_Random_Load_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Load_0pc), fixed = TRUE))) {
  NL_table_Random_Load_0pc <- NL_table_Random_Load_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Load_0pc), fixed = TRUE))) {
  NL_table_Random_Load_0pc <- NL_table_Random_Load_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Load_0pc), fixed = TRUE))) {
  NL_table_Random_Load_0pc <- NL_table_Random_Load_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Load_0pc[ , ..list_columns]

NL_table_Random_Load_0pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Load_0pc <- as.data.frame(NL_table_Random_Load_0pc)

NL_table_Random_Load_0pc[NL_table_Random_Load_0pc==-1] <- NA

NL_table_Random_Load_0pc <- subset(NL_table_Random_Load_0pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Load_0pc)[names(NL_table_Random_Load_0pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Load_0pc)[names(NL_table_Random_Load_0pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Random_Load_0pc$loading_w2wed_conc_list[order(NL_table_Random_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
random_load_0pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_0pc_loading_w2wed_conc_list <- append(random_load_0pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_0pc$cleaning_w2wed_conc_list[order(NL_table_Random_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
random_load_0pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_0pc_cleaning_w2wed_conc_list <- append(random_load_0pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_0pc$drying_w2wed_conc_list[order(NL_table_Random_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
random_load_0pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_0pc_drying_w2wed_conc_list <- append(random_load_0pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_0pc$sorting_w2wed_conc_list[order(NL_table_Random_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
random_load_0pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_0pc_sorting_w2wed_conc_list <- append(random_load_0pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_0pc$tray_packing_w2wed_conc_list[order(NL_table_Random_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
random_load_0pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_0pc_tray_packing_w2wed_conc_list <- append(random_load_0pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_0pc$reject_w2wed_conc_list[order(NL_table_Random_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
random_load_0pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_0pc_reject_w2wed_conc_list <- append(random_load_0pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Load_0pc$other_w2wed_conc_list[order(NL_table_Random_Load_0pc$local_seed)]
vector <- vector[vector!='[]']
random_load_0pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_0pc_other_w2wed_conc_list <- append(random_load_0pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

random_load_0pc_loading_concs <- as.data.frame(random_load_0pc_loading_w2wed_conc_list)
random_load_0pc_loading_concs$area <- as.factor('loading')
random_load_0pc_loading_concs$scenario <- as.factor('Random Load 0%')
random_load_0pc_loading_concs$water <- as.factor('Wet')
names(random_load_0pc_loading_concs) <- c('concentration','area','scenario','water')

random_load_0pc_cleaning_concs <- as.data.frame(random_load_0pc_cleaning_w2wed_conc_list)
random_load_0pc_cleaning_concs$area <- as.factor('cleaning')
random_load_0pc_cleaning_concs$scenario <- as.factor('Random Load 0%')
random_load_0pc_cleaning_concs$water <- as.factor('Wet')
names(random_load_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_0pc_sorting_concs <- as.data.frame(random_load_0pc_sorting_w2wed_conc_list)
random_load_0pc_sorting_concs$area <- as.factor('sorting')
random_load_0pc_sorting_concs$scenario <- as.factor('Random Load 0%')
random_load_0pc_sorting_concs$water <- as.factor('Dry')
names(random_load_0pc_sorting_concs) <- c('concentration','area','scenario','water')

random_load_0pc_reject_concs <- as.data.frame(random_load_0pc_reject_w2wed_conc_list)
random_load_0pc_reject_concs$area <- as.factor('reject')
random_load_0pc_reject_concs$scenario <- as.factor('Random Load 0%')
random_load_0pc_reject_concs$water <- as.factor('Dry')
names(random_load_0pc_reject_concs) <- c('concentration','area','scenario','water')

random_load_0pc_tray_packing_concs <- as.data.frame(random_load_0pc_tray_packing_w2wed_conc_list)
random_load_0pc_tray_packing_concs$area <- as.factor('tray packing')
random_load_0pc_tray_packing_concs$scenario <- as.factor('Random Load 0%')
random_load_0pc_tray_packing_concs$water <- as.factor('Dry')
names(random_load_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_0pc_other_concs <- as.data.frame(random_load_0pc_other_w2wed_conc_list)
random_load_0pc_other_concs$area <- as.factor('other')
random_load_0pc_other_concs$scenario <- as.factor('Random Load 0%')
random_load_0pc_other_concs$water <- as.factor('Dry')
names(random_load_0pc_other_concs) <- c('concentration','area','scenario','water')

random_load_0pc_concs <- rbind(random_load_0pc_loading_concs,random_load_0pc_cleaning_concs,random_load_0pc_sorting_concs,random_load_0pc_tray_packing_concs,random_load_0pc_reject_concs,random_load_0pc_other_concs)

random_load_0pc_loading_prev <- as.data.frame(NL_table_Random_Load_0pc$loading_w2wed_prev[order(NL_table_Random_Load_0pc$local_seed)])
random_load_0pc_loading_prev$area <- as.factor('loading')
random_load_0pc_loading_prev$scenario <- as.factor('Random Load 0%')
random_load_0pc_loading_prev$water <- as.factor('Wet')
names(random_load_0pc_loading_prev) <- c('prevalence','area','scenario','water')

random_load_0pc_cleaning_prev <- as.data.frame(NL_table_Random_Load_0pc$cleaning_w2wed_prev[order(NL_table_Random_Load_0pc$local_seed)])
random_load_0pc_cleaning_prev$area <- as.factor('cleaning')
random_load_0pc_cleaning_prev$scenario <- as.factor('Random Load 0%')
random_load_0pc_cleaning_prev$water <- as.factor('Wet')
names(random_load_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_0pc_sorting_prev <- as.data.frame(NL_table_Random_Load_0pc$sorting_w2wed_prev[order(NL_table_Random_Load_0pc$local_seed)])
random_load_0pc_sorting_prev$area <- as.factor('sorting')
random_load_0pc_sorting_prev$scenario <- as.factor('Random Load 0%')
random_load_0pc_sorting_prev$water <- as.factor('Dry')
names(random_load_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_0pc_reject_prev <- as.data.frame(NL_table_Random_Load_0pc$reject_w2wed_prev[order(NL_table_Random_Load_0pc$local_seed)])
random_load_0pc_reject_prev$area <- as.factor('reject')
random_load_0pc_reject_prev$scenario <- as.factor('Random Load 0%')
random_load_0pc_reject_prev$water <- as.factor('Dry')
names(random_load_0pc_reject_prev) <- c('prevalence','area','scenario','water')

random_load_0pc_tray_packing_prev <- as.data.frame(NL_table_Random_Load_0pc$tray_packing_w2wed_prev[order(NL_table_Random_Load_0pc$local_seed)])
random_load_0pc_tray_packing_prev$area <- as.factor('tray packing')
random_load_0pc_tray_packing_prev$scenario <- as.factor('Random Load 0%')
random_load_0pc_tray_packing_prev$water <- as.factor('Dry')
names(random_load_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_0pc_other_prev <- as.data.frame(NL_table_Random_Load_0pc$other_w2wed_prev[order(NL_table_Random_Load_0pc$local_seed)])
random_load_0pc_other_prev$area <- as.factor('other')
random_load_0pc_other_prev$scenario <- as.factor('Random Load 0%')
random_load_0pc_other_prev$water <- as.factor('Dry')
names(random_load_0pc_other_prev) <- c('prevalence','area','scenario','water')

random_load_0pc_prev <- rbind(random_load_0pc_loading_prev,random_load_0pc_cleaning_prev,random_load_0pc_sorting_prev,random_load_0pc_tray_packing_prev,random_load_0pc_reject_prev,random_load_0pc_other_prev)
```

```{r import Crate Prevalence 75%}
NL_table_Crate_Prev_75pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-18-14-08 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Crate_Prevalence_Reduction_9-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Crate_Prev_75pc <- NL_table_Crate_Prev_75pc[NL_table_Crate_Prev_75pc$scenario==9,]

while (any(grepl('-', names(NL_table_Crate_Prev_75pc), fixed = TRUE))) {
  NL_table_Crate_Prev_75pc <- NL_table_Crate_Prev_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Crate_Prev_75pc), fixed = TRUE))) {
  NL_table_Crate_Prev_75pc <- NL_table_Crate_Prev_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Crate_Prev_75pc), fixed = TRUE))) {
  NL_table_Crate_Prev_75pc <- NL_table_Crate_Prev_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Crate_Prev_75pc), fixed = TRUE))) {
  NL_table_Crate_Prev_75pc <- NL_table_Crate_Prev_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Crate_Prev_75pc[ , ..list_columns]

NL_table_Crate_Prev_75pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Crate_Prev_75pc <- as.data.frame(NL_table_Crate_Prev_75pc)

NL_table_Crate_Prev_75pc[NL_table_Crate_Prev_75pc==-1] <- NA

NL_table_Crate_Prev_75pc <- subset(NL_table_Crate_Prev_75pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Crate_Prev_75pc)[names(NL_table_Crate_Prev_75pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Crate_Prev_75pc)[names(NL_table_Crate_Prev_75pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Crate_Prev_75pc$loading_w2wed_conc_list[order(NL_table_Crate_Prev_75pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_75pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_loading_w2wed_conc_list <- append(crate_prev_75pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_75pc$cleaning_w2wed_conc_list[order(NL_table_Crate_Prev_75pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_75pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_cleaning_w2wed_conc_list <- append(crate_prev_75pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_75pc$drying_w2wed_conc_list[order(NL_table_Crate_Prev_75pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_75pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_drying_w2wed_conc_list <- append(crate_prev_75pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_75pc$sorting_w2wed_conc_list[order(NL_table_Crate_Prev_75pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_75pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_sorting_w2wed_conc_list <- append(crate_prev_75pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_75pc$tray_packing_w2wed_conc_list[order(NL_table_Crate_Prev_75pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_75pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_tray_packing_w2wed_conc_list <- append(crate_prev_75pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_75pc$reject_w2wed_conc_list[order(NL_table_Crate_Prev_75pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_75pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_reject_w2wed_conc_list <- append(crate_prev_75pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_75pc$other_w2wed_conc_list[order(NL_table_Crate_Prev_75pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_75pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_other_w2wed_conc_list <- append(crate_prev_75pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

crate_prev_75pc_loading_concs <- as.data.frame(crate_prev_75pc_loading_w2wed_conc_list)
crate_prev_75pc_loading_concs$area <- as.factor('loading')
crate_prev_75pc_loading_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_75pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_cleaning_concs <- as.data.frame(crate_prev_75pc_cleaning_w2wed_conc_list)
crate_prev_75pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_sorting_concs <- as.data.frame(crate_prev_75pc_sorting_w2wed_conc_list)
crate_prev_75pc_sorting_concs$area <- as.factor('sorting')
crate_prev_75pc_sorting_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_tray_packing_concs <- as.data.frame(crate_prev_75pc_tray_packing_w2wed_conc_list)
crate_prev_75pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_reject_concs <- as.data.frame(crate_prev_75pc_reject_w2wed_conc_list)
crate_prev_75pc_reject_concs$area <- as.factor('reject')
crate_prev_75pc_reject_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_75pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_other_concs <- as.data.frame(crate_prev_75pc_other_w2wed_conc_list)
crate_prev_75pc_other_concs$area <- as.factor('other')
crate_prev_75pc_other_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_other_concs$water <- as.factor('Dry')
names(crate_prev_75pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_concs <- rbind(crate_prev_75pc_loading_concs,crate_prev_75pc_cleaning_concs,crate_prev_75pc_sorting_concs,crate_prev_75pc_tray_packing_concs,crate_prev_75pc_reject_concs,crate_prev_75pc_other_concs)

crate_prev_75pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_75pc$loading_w2wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_loading_prev$area <- as.factor('loading')
crate_prev_75pc_loading_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_75pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_75pc$cleaning_w2wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_75pc$sorting_w2wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_sorting_prev$area <- as.factor('sorting')
crate_prev_75pc_sorting_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_75pc$reject_w2wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_reject_prev$area <- as.factor('reject')
crate_prev_75pc_reject_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_75pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_75pc$tray_packing_w2wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_other_prev <- as.data.frame(NL_table_Crate_Prev_75pc$other_w2wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_other_prev$area <- as.factor('other')
crate_prev_75pc_other_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_other_prev$water <- as.factor('Dry')
names(crate_prev_75pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_prev <- rbind(crate_prev_75pc_loading_prev,crate_prev_75pc_cleaning_prev,crate_prev_75pc_sorting_prev,crate_prev_75pc_tray_packing_prev,crate_prev_75pc_reject_prev,crate_prev_75pc_other_prev)

crate_prev_75pc_wet_prev <- as.data.frame(crate_prev_75pc_loading_prev$prevalence*21/100+crate_prev_75pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_75pc_wet_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_wet_prev$water <- as.factor('Wet')
names(crate_prev_75pc_wet_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_dry_prev <- as.data.frame(crate_prev_75pc_sorting_prev$prevalence*20/100+crate_prev_75pc_reject_prev$prevalence*23/100+crate_prev_75pc_tray_packing_prev$prevalence*123/100+crate_prev_75pc_other_prev$prevalence*10/100)/176*100
crate_prev_75pc_dry_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_dry_prev$water <- as.factor('Dry')
names(crate_prev_75pc_dry_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_recombined_prev <- rbind(crate_prev_75pc_wet_prev, crate_prev_75pc_dry_prev)

crate_prev_75pc_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(crate_prev_75pc_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('EC_01'),
  as.factor(baseline_recombined_prev$water)
)
colnames(crate_prev_75pc_eff_prev)<- c('prevalence', 'scenario', 'water')

crate_prev_75pc_z1_prev <- as.data.frame(NL_table_Crate_Prev_75pc$z1_w2wed_prev)
crate_prev_75pc_z1_prev$zone <- as.factor('Z1')
crate_prev_75pc_z1_prev$scenario <- as.factor('EC_01')
names(crate_prev_75pc_z1_prev) <- c('prevalence','zone','scenario')

crate_prev_75pc_z2_prev <- as.data.frame(NL_table_Crate_Prev_75pc$z2_w2wed_prev)
crate_prev_75pc_z2_prev$zone <- as.factor('Z2')
crate_prev_75pc_z2_prev$scenario <- as.factor('EC_01')
names(crate_prev_75pc_z2_prev) <- c('prevalence','zone','scenario')

crate_prev_75pc_z3_prev <- as.data.frame(NL_table_Crate_Prev_75pc$z2_w2wed_prev)
crate_prev_75pc_z3_prev$zone <- as.factor('Z3')
crate_prev_75pc_z3_prev$scenario <- as.factor('EC_01')
names(crate_prev_75pc_z3_prev) <- c('prevalence','zone','scenario')

crate_prev_75pc_zone_prev <- rbind(crate_prev_75pc_z1_prev,crate_prev_75pc_z2_prev,crate_prev_75pc_z3_prev)
```

```{r import Crate Prevalence 50%}
NL_table_Crate_Prev_50pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-18-14-08 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Crate_Prevalence_Reduction_10-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Crate_Prev_50pc <- NL_table_Crate_Prev_50pc[NL_table_Crate_Prev_50pc$scenario==10,]

while (any(grepl('-', names(NL_table_Crate_Prev_50pc), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc <- NL_table_Crate_Prev_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Crate_Prev_50pc), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc <- NL_table_Crate_Prev_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Crate_Prev_50pc), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc <- NL_table_Crate_Prev_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Crate_Prev_50pc), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc <- NL_table_Crate_Prev_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Crate_Prev_50pc[ , ..list_columns]

NL_table_Crate_Prev_50pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Crate_Prev_50pc <- as.data.frame(NL_table_Crate_Prev_50pc)

NL_table_Crate_Prev_50pc[NL_table_Crate_Prev_50pc==-1] <- NA

NL_table_Crate_Prev_50pc <- subset(NL_table_Crate_Prev_50pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Crate_Prev_50pc)[names(NL_table_Crate_Prev_50pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Crate_Prev_50pc)[names(NL_table_Crate_Prev_50pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Crate_Prev_50pc$loading_w2wed_conc_list[order(NL_table_Crate_Prev_50pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_loading_w2wed_conc_list <- append(crate_prev_50pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc$cleaning_w2wed_conc_list[order(NL_table_Crate_Prev_50pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_cleaning_w2wed_conc_list <- append(crate_prev_50pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc$drying_w2wed_conc_list[order(NL_table_Crate_Prev_50pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_drying_w2wed_conc_list <- append(crate_prev_50pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc$sorting_w2wed_conc_list[order(NL_table_Crate_Prev_50pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_sorting_w2wed_conc_list <- append(crate_prev_50pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc$tray_packing_w2wed_conc_list[order(NL_table_Crate_Prev_50pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_tray_packing_w2wed_conc_list <- append(crate_prev_50pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc$reject_w2wed_conc_list[order(NL_table_Crate_Prev_50pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_reject_w2wed_conc_list <- append(crate_prev_50pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc$other_w2wed_conc_list[order(NL_table_Crate_Prev_50pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_other_w2wed_conc_list <- append(crate_prev_50pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

crate_prev_50pc_loading_concs <- as.data.frame(crate_prev_50pc_loading_w2wed_conc_list)
crate_prev_50pc_loading_concs$area <- as.factor('loading')
crate_prev_50pc_loading_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_50pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_cleaning_concs <- as.data.frame(crate_prev_50pc_cleaning_w2wed_conc_list)
crate_prev_50pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_sorting_concs <- as.data.frame(crate_prev_50pc_sorting_w2wed_conc_list)
crate_prev_50pc_sorting_concs$area <- as.factor('sorting')
crate_prev_50pc_sorting_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_tray_packing_concs <- as.data.frame(crate_prev_50pc_tray_packing_w2wed_conc_list)
crate_prev_50pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_reject_concs <- as.data.frame(crate_prev_50pc_reject_w2wed_conc_list)
crate_prev_50pc_reject_concs$area <- as.factor('reject')
crate_prev_50pc_reject_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_50pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_other_concs <- as.data.frame(crate_prev_50pc_other_w2wed_conc_list)
crate_prev_50pc_other_concs$area <- as.factor('other')
crate_prev_50pc_other_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_other_concs$water <- as.factor('Dry')
names(crate_prev_50pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_concs <- rbind(crate_prev_50pc_loading_concs,crate_prev_50pc_cleaning_concs,crate_prev_50pc_sorting_concs,crate_prev_50pc_tray_packing_concs,crate_prev_50pc_reject_concs,crate_prev_50pc_other_concs)

crate_prev_50pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_50pc$loading_w2wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_loading_prev$area <- as.factor('loading')
crate_prev_50pc_loading_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_50pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_50pc$cleaning_w2wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_50pc$sorting_w2wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_sorting_prev$area <- as.factor('sorting')
crate_prev_50pc_sorting_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_50pc$reject_w2wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_reject_prev$area <- as.factor('reject')
crate_prev_50pc_reject_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_50pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_50pc$tray_packing_w2wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_other_prev <- as.data.frame(NL_table_Crate_Prev_50pc$other_w2wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_other_prev$area <- as.factor('other')
crate_prev_50pc_other_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_other_prev$water <- as.factor('Dry')
names(crate_prev_50pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_prev <- rbind(crate_prev_50pc_loading_prev,crate_prev_50pc_cleaning_prev,crate_prev_50pc_sorting_prev,crate_prev_50pc_tray_packing_prev,crate_prev_50pc_reject_prev,crate_prev_50pc_other_prev)

crate_prev_50pc_wet_prev <- as.data.frame(crate_prev_50pc_loading_prev$prevalence*21/100+crate_prev_50pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_50pc_wet_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_wet_prev$water <- as.factor('Wet')
names(crate_prev_50pc_wet_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_dry_prev <- as.data.frame(crate_prev_50pc_sorting_prev$prevalence*20/100+crate_prev_50pc_reject_prev$prevalence*23/100+crate_prev_50pc_tray_packing_prev$prevalence*123/100+crate_prev_50pc_other_prev$prevalence*10/100)/176*100
crate_prev_50pc_dry_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_dry_prev$water <- as.factor('Dry')
names(crate_prev_50pc_dry_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_recombined_prev <- rbind(crate_prev_50pc_wet_prev, crate_prev_50pc_dry_prev)

crate_prev_50pc_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(crate_prev_50pc_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('EC_02'),
  as.factor(baseline_recombined_prev$water)
)
colnames(crate_prev_50pc_eff_prev)<- c('prevalence', 'scenario', 'water')

crate_prev_50pc_z1_prev <- as.data.frame(NL_table_Crate_Prev_50pc$z1_w2wed_prev)
crate_prev_50pc_z1_prev$zone <- as.factor('Z1')
crate_prev_50pc_z1_prev$scenario <- as.factor('EC_02')
names(crate_prev_50pc_z1_prev) <- c('prevalence','zone','scenario')

crate_prev_50pc_z2_prev <- as.data.frame(NL_table_Crate_Prev_50pc$z2_w2wed_prev)
crate_prev_50pc_z2_prev$zone <- as.factor('Z2')
crate_prev_50pc_z2_prev$scenario <- as.factor('EC_02')
names(crate_prev_50pc_z2_prev) <- c('prevalence','zone','scenario')

crate_prev_50pc_z3_prev <- as.data.frame(NL_table_Crate_Prev_50pc$z2_w2wed_prev)
crate_prev_50pc_z3_prev$zone <- as.factor('Z3')
crate_prev_50pc_z3_prev$scenario <- as.factor('EC_02')
names(crate_prev_50pc_z3_prev) <- c('prevalence','zone','scenario')

crate_prev_50pc_zone_prev <- rbind(crate_prev_50pc_z1_prev,crate_prev_50pc_z2_prev,crate_prev_50pc_z3_prev)
```

```{r import Crate Prevalence 25%}
NL_table_Crate_Prev_25pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-18-14-08 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Crate_Prevalence_Reduction_11-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Crate_Prev_25pc <- NL_table_Crate_Prev_25pc[NL_table_Crate_Prev_25pc$scenario==11,]

while (any(grepl('-', names(NL_table_Crate_Prev_25pc), fixed = TRUE))) {
  NL_table_Crate_Prev_25pc <- NL_table_Crate_Prev_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Crate_Prev_25pc), fixed = TRUE))) {
  NL_table_Crate_Prev_25pc <- NL_table_Crate_Prev_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Crate_Prev_25pc), fixed = TRUE))) {
  NL_table_Crate_Prev_25pc <- NL_table_Crate_Prev_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Crate_Prev_25pc), fixed = TRUE))) {
  NL_table_Crate_Prev_25pc <- NL_table_Crate_Prev_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Crate_Prev_25pc[ , ..list_columns]

NL_table_Crate_Prev_25pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Crate_Prev_25pc <- as.data.frame(NL_table_Crate_Prev_25pc)

NL_table_Crate_Prev_25pc[NL_table_Crate_Prev_25pc==-1] <- NA

NL_table_Crate_Prev_25pc <- subset(NL_table_Crate_Prev_25pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Crate_Prev_25pc)[names(NL_table_Crate_Prev_25pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Crate_Prev_25pc)[names(NL_table_Crate_Prev_25pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Crate_Prev_25pc$loading_w2wed_conc_list[order(NL_table_Crate_Prev_25pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_25pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_loading_w2wed_conc_list <- append(crate_prev_25pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_25pc$cleaning_w2wed_conc_list[order(NL_table_Crate_Prev_25pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_25pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_cleaning_w2wed_conc_list <- append(crate_prev_25pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_25pc$drying_w2wed_conc_list[order(NL_table_Crate_Prev_25pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_25pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_drying_w2wed_conc_list <- append(crate_prev_25pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_25pc$sorting_w2wed_conc_list[order(NL_table_Crate_Prev_25pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_25pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_sorting_w2wed_conc_list <- append(crate_prev_25pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_25pc$tray_packing_w2wed_conc_list[order(NL_table_Crate_Prev_25pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_25pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_tray_packing_w2wed_conc_list <- append(crate_prev_25pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_25pc$reject_w2wed_conc_list[order(NL_table_Crate_Prev_25pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_25pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_reject_w2wed_conc_list <- append(crate_prev_25pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_25pc$other_w2wed_conc_list[order(NL_table_Crate_Prev_25pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_25pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_other_w2wed_conc_list <- append(crate_prev_25pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

crate_prev_25pc_loading_concs <- as.data.frame(crate_prev_25pc_loading_w2wed_conc_list)
crate_prev_25pc_loading_concs$area <- as.factor('loading')
crate_prev_25pc_loading_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_25pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_cleaning_concs <- as.data.frame(crate_prev_25pc_cleaning_w2wed_conc_list)
crate_prev_25pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_sorting_concs <- as.data.frame(crate_prev_25pc_sorting_w2wed_conc_list)
crate_prev_25pc_sorting_concs$area <- as.factor('sorting')
crate_prev_25pc_sorting_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_tray_packing_concs <- as.data.frame(crate_prev_25pc_tray_packing_w2wed_conc_list)
crate_prev_25pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_reject_concs <- as.data.frame(crate_prev_25pc_reject_w2wed_conc_list)
crate_prev_25pc_reject_concs$area <- as.factor('reject')
crate_prev_25pc_reject_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_25pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_other_concs <- as.data.frame(crate_prev_25pc_other_w2wed_conc_list)
crate_prev_25pc_other_concs$area <- as.factor('other')
crate_prev_25pc_other_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_other_concs$water <- as.factor('Dry')
names(crate_prev_25pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_concs <- rbind(crate_prev_25pc_loading_concs,crate_prev_25pc_cleaning_concs,crate_prev_25pc_sorting_concs,crate_prev_25pc_tray_packing_concs,crate_prev_25pc_reject_concs,crate_prev_25pc_other_concs)

crate_prev_25pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_25pc$loading_w2wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_loading_prev$area <- as.factor('loading')
crate_prev_25pc_loading_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_25pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_25pc$cleaning_w2wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_25pc$sorting_w2wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_sorting_prev$area <- as.factor('sorting')
crate_prev_25pc_sorting_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_25pc$reject_w2wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_reject_prev$area <- as.factor('reject')
crate_prev_25pc_reject_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_25pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_25pc$tray_packing_w2wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_other_prev <- as.data.frame(NL_table_Crate_Prev_25pc$other_w2wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_other_prev$area <- as.factor('other')
crate_prev_25pc_other_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_other_prev$water <- as.factor('Dry')
names(crate_prev_25pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_prev <- rbind(crate_prev_25pc_loading_prev,crate_prev_25pc_cleaning_prev,crate_prev_25pc_sorting_prev,crate_prev_25pc_tray_packing_prev,crate_prev_25pc_reject_prev,crate_prev_25pc_other_prev)

crate_prev_25pc_wet_prev <- as.data.frame(crate_prev_25pc_loading_prev$prevalence*21/100+crate_prev_25pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_25pc_wet_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_wet_prev$water <- as.factor('Wet')
names(crate_prev_25pc_wet_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_dry_prev <- as.data.frame(crate_prev_25pc_sorting_prev$prevalence*20/100+crate_prev_25pc_reject_prev$prevalence*23/100+crate_prev_25pc_tray_packing_prev$prevalence*123/100+crate_prev_25pc_other_prev$prevalence*10/100)/176*100
crate_prev_25pc_dry_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_dry_prev$water <- as.factor('Dry')
names(crate_prev_25pc_dry_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_recombined_prev <- rbind(crate_prev_25pc_wet_prev, crate_prev_25pc_dry_prev)

crate_prev_25pc_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(crate_prev_25pc_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('EC_03'),
  as.factor(baseline_recombined_prev$water)
)
colnames(crate_prev_25pc_eff_prev)<- c('prevalence', 'scenario', 'water')

crate_prev_25pc_z1_prev <- as.data.frame(NL_table_Crate_Prev_25pc$z1_w2wed_prev)
crate_prev_25pc_z1_prev$zone <- as.factor('Z1')
crate_prev_25pc_z1_prev$scenario <- as.factor('EC_03')
names(crate_prev_25pc_z1_prev) <- c('prevalence','zone','scenario')

crate_prev_25pc_z2_prev <- as.data.frame(NL_table_Crate_Prev_25pc$z2_w2wed_prev)
crate_prev_25pc_z2_prev$zone <- as.factor('Z2')
crate_prev_25pc_z2_prev$scenario <- as.factor('EC_03')
names(crate_prev_25pc_z2_prev) <- c('prevalence','zone','scenario')

crate_prev_25pc_z3_prev <- as.data.frame(NL_table_Crate_Prev_25pc$z2_w2wed_prev)
crate_prev_25pc_z3_prev$zone <- as.factor('Z3')
crate_prev_25pc_z3_prev$scenario <- as.factor('EC_03')
names(crate_prev_25pc_z3_prev) <- c('prevalence','zone','scenario')

crate_prev_25pc_zone_prev <- rbind(crate_prev_25pc_z1_prev,crate_prev_25pc_z2_prev,crate_prev_25pc_z3_prev)
```

```{r import Crate Prevalence 0%}
NL_table_Crate_Prev_0pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-18-14-08 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Crate_Prevalence_Reduction_5-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Crate_Prev_0pc <- NL_table_Crate_Prev_0pc[NL_table_Crate_Prev_0pc$scenario==5,]

while (any(grepl('-', names(NL_table_Crate_Prev_0pc), fixed = TRUE))) {
  NL_table_Crate_Prev_0pc <- NL_table_Crate_Prev_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Crate_Prev_0pc), fixed = TRUE))) {
  NL_table_Crate_Prev_0pc <- NL_table_Crate_Prev_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Crate_Prev_0pc), fixed = TRUE))) {
  NL_table_Crate_Prev_0pc <- NL_table_Crate_Prev_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Crate_Prev_0pc), fixed = TRUE))) {
  NL_table_Crate_Prev_0pc <- NL_table_Crate_Prev_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Crate_Prev_0pc[ , ..list_columns]

NL_table_Crate_Prev_0pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Crate_Prev_0pc <- as.data.frame(NL_table_Crate_Prev_0pc)

NL_table_Crate_Prev_0pc[NL_table_Crate_Prev_0pc==-1] <- NA

NL_table_Crate_Prev_0pc <- subset(NL_table_Crate_Prev_0pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Crate_Prev_0pc)[names(NL_table_Crate_Prev_0pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Crate_Prev_0pc)[names(NL_table_Crate_Prev_0pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Crate_Prev_0pc$loading_w2wed_conc_list[order(NL_table_Crate_Prev_0pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_0pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_loading_w2wed_conc_list <- append(crate_prev_0pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_0pc$cleaning_w2wed_conc_list[order(NL_table_Crate_Prev_0pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_0pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_cleaning_w2wed_conc_list <- append(crate_prev_0pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_0pc$drying_w2wed_conc_list[order(NL_table_Crate_Prev_0pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_0pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_drying_w2wed_conc_list <- append(crate_prev_0pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_0pc$sorting_w2wed_conc_list[order(NL_table_Crate_Prev_0pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_0pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_sorting_w2wed_conc_list <- append(crate_prev_0pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_0pc$tray_packing_w2wed_conc_list[order(NL_table_Crate_Prev_0pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_0pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_tray_packing_w2wed_conc_list <- append(crate_prev_0pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_0pc$reject_w2wed_conc_list[order(NL_table_Crate_Prev_0pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_0pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_reject_w2wed_conc_list <- append(crate_prev_0pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_0pc$other_w2wed_conc_list[order(NL_table_Crate_Prev_0pc$local_seed)]
vector <- vector[vector!='[]']
crate_prev_0pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_other_w2wed_conc_list <- append(crate_prev_0pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

crate_prev_0pc_loading_concs <- as.data.frame(crate_prev_0pc_loading_w2wed_conc_list)
crate_prev_0pc_loading_concs$area <- as.factor('loading')
crate_prev_0pc_loading_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_0pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_cleaning_concs <- as.data.frame(crate_prev_0pc_cleaning_w2wed_conc_list)
crate_prev_0pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_sorting_concs <- as.data.frame(crate_prev_0pc_sorting_w2wed_conc_list)
crate_prev_0pc_sorting_concs$area <- as.factor('sorting')
crate_prev_0pc_sorting_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_tray_packing_concs <- as.data.frame(crate_prev_0pc_tray_packing_w2wed_conc_list)
crate_prev_0pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_reject_concs <- as.data.frame(crate_prev_0pc_reject_w2wed_conc_list)
crate_prev_0pc_reject_concs$area <- as.factor('reject')
crate_prev_0pc_reject_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_0pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_other_concs <- as.data.frame(crate_prev_0pc_other_w2wed_conc_list)
crate_prev_0pc_other_concs$area <- as.factor('other')
crate_prev_0pc_other_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_other_concs$water <- as.factor('Dry')
names(crate_prev_0pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_concs <- rbind(crate_prev_0pc_loading_concs,crate_prev_0pc_cleaning_concs,crate_prev_0pc_sorting_concs,crate_prev_0pc_tray_packing_concs,crate_prev_0pc_reject_concs,crate_prev_0pc_other_concs)

crate_prev_0pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_0pc$loading_w2wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_loading_prev$area <- as.factor('loading')
crate_prev_0pc_loading_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_0pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_0pc$cleaning_w2wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_0pc$sorting_w2wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_sorting_prev$area <- as.factor('sorting')
crate_prev_0pc_sorting_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_0pc$reject_w2wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_reject_prev$area <- as.factor('reject')
crate_prev_0pc_reject_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_0pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_0pc$tray_packing_w2wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_other_prev <- as.data.frame(NL_table_Crate_Prev_0pc$other_w2wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_other_prev$area <- as.factor('other')
crate_prev_0pc_other_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_other_prev$water <- as.factor('Dry')
names(crate_prev_0pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_prev <- rbind(crate_prev_0pc_loading_prev,crate_prev_0pc_cleaning_prev,crate_prev_0pc_sorting_prev,crate_prev_0pc_tray_packing_prev,crate_prev_0pc_reject_prev,crate_prev_0pc_other_prev)

crate_prev_0pc_wet_prev <- as.data.frame(crate_prev_0pc_loading_prev$prevalence*21/100+crate_prev_0pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_0pc_wet_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_wet_prev$water <- as.factor('Wet')
names(crate_prev_0pc_wet_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_dry_prev <- as.data.frame(crate_prev_0pc_sorting_prev$prevalence*20/100+crate_prev_0pc_reject_prev$prevalence*23/100+crate_prev_0pc_tray_packing_prev$prevalence*123/100+crate_prev_0pc_other_prev$prevalence*10/100)/176*100
crate_prev_0pc_dry_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_dry_prev$water <- as.factor('Dry')
names(crate_prev_0pc_dry_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_recombined_prev <- rbind(crate_prev_0pc_wet_prev, crate_prev_0pc_dry_prev)

crate_prev_0pc_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(crate_prev_0pc_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('EC_04'),
  as.factor(baseline_recombined_prev$water)
)
colnames(crate_prev_0pc_eff_prev)<- c('prevalence', 'scenario', 'water')

crate_prev_0pc_z1_prev <- as.data.frame(NL_table_Crate_Prev_0pc$z1_w2wed_prev)
crate_prev_0pc_z1_prev$zone <- as.factor('Z1')
crate_prev_0pc_z1_prev$scenario <- as.factor('EC_04')
names(crate_prev_0pc_z1_prev) <- c('prevalence','zone','scenario')

crate_prev_0pc_z2_prev <- as.data.frame(NL_table_Crate_Prev_0pc$z2_w2wed_prev)
crate_prev_0pc_z2_prev$zone <- as.factor('Z2')
crate_prev_0pc_z2_prev$scenario <- as.factor('EC_04')
names(crate_prev_0pc_z2_prev) <- c('prevalence','zone','scenario')

crate_prev_0pc_z3_prev <- as.data.frame(NL_table_Crate_Prev_0pc$z2_w2wed_prev)
crate_prev_0pc_z3_prev$zone <- as.factor('Z3')
crate_prev_0pc_z3_prev$scenario <- as.factor('EC_04')
names(crate_prev_0pc_z3_prev) <- c('prevalence','zone','scenario')

crate_prev_0pc_zone_prev <- rbind(crate_prev_0pc_z1_prev,crate_prev_0pc_z2_prev,crate_prev_0pc_z3_prev)
```

```{r import No Reduction}
NL_table_No_Red <- fread(paste0(getwd(),'/BehaviorSpace/2020-10-27-14-29 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Basic_Cleaning_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_No_Red <- NL_table_No_Red[NL_table_No_Red$scenario==8,]

while (any(grepl('-', names(NL_table_No_Red), fixed = TRUE))) {
  NL_table_No_Red <- NL_table_No_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_No_Red), fixed = TRUE))) {
  NL_table_No_Red <- NL_table_No_Red %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_No_Red), fixed = TRUE))) {
  NL_table_No_Red <- NL_table_No_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_No_Red), fixed = TRUE))) {
  NL_table_No_Red <- NL_table_No_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_No_Red[ , ..list_columns]

NL_table_No_Red[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_No_Red <- as.data.frame(NL_table_No_Red)

NL_table_No_Red[NL_table_No_Red==-1] <- NA

NL_table_No_Red <- subset(NL_table_No_Red, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_No_Red)[names(NL_table_No_Red)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_No_Red)[names(NL_table_No_Red)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_No_Red$loading_w2wed_conc_list[order(NL_table_No_Red$local_seed)]
vector <- vector[vector!='[]']
red_0_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_0_loading_w2wed_conc_list <- append(red_0_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_No_Red$cleaning_w2wed_conc_list[order(NL_table_No_Red$local_seed)]
vector <- vector[vector!='[]']
red_0_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_0_cleaning_w2wed_conc_list <- append(red_0_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_No_Red$drying_w2wed_conc_list[order(NL_table_No_Red$local_seed)]
vector <- vector[vector!='[]']
red_0_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_0_drying_w2wed_conc_list <- append(red_0_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_No_Red$sorting_w2wed_conc_list[order(NL_table_No_Red$local_seed)]
vector <- vector[vector!='[]']
red_0_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_0_sorting_w2wed_conc_list <- append(red_0_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_No_Red$tray_packing_w2wed_conc_list[order(NL_table_No_Red$local_seed)]
vector <- vector[vector!='[]']
red_0_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_0_tray_packing_w2wed_conc_list <- append(red_0_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_No_Red$reject_w2wed_conc_list[order(NL_table_No_Red$local_seed)]
vector <- vector[vector!='[]']
red_0_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_0_reject_w2wed_conc_list <- append(red_0_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_No_Red$other_w2wed_conc_list[order(NL_table_No_Red$local_seed)]
vector <- vector[vector!='[]']
red_0_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_0_other_w2wed_conc_list <- append(red_0_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

red_0_loading_concs <- as.data.frame(red_0_loading_w2wed_conc_list)
red_0_loading_concs$area <- as.factor('loading')
red_0_loading_concs$scenario <- as.factor('No Reduction')
red_0_loading_concs$water <- as.factor('Wet')
names(red_0_loading_concs) <- c('concentration','area','scenario','water')

red_0_cleaning_concs <- as.data.frame(red_0_cleaning_w2wed_conc_list)
red_0_cleaning_concs$area <- as.factor('cleaning')
red_0_cleaning_concs$scenario <- as.factor('No Reduction')
red_0_cleaning_concs$water <- as.factor('Wet')
names(red_0_cleaning_concs) <- c('concentration','area','scenario','water')

red_0_sorting_concs <- as.data.frame(red_0_sorting_w2wed_conc_list)
red_0_sorting_concs$area <- as.factor('sorting')
red_0_sorting_concs$scenario <- as.factor('No Reduction')
red_0_sorting_concs$water <- as.factor('Dry')
names(red_0_sorting_concs) <- c('concentration','area','scenario','water')

red_0_reject_concs <- as.data.frame(red_0_reject_w2wed_conc_list)
red_0_reject_concs$area <- as.factor('reject')
red_0_reject_concs$scenario <- as.factor('No Reduction')
red_0_reject_concs$water <- as.factor('Dry')
names(red_0_reject_concs) <- c('concentration','area','scenario','water')

red_0_tray_packing_concs <- as.data.frame(red_0_reject_w2wed_conc_list)
red_0_tray_packing_concs$area <- as.factor('tray packing')
red_0_tray_packing_concs$scenario <- as.factor('No Reduction')
red_0_tray_packing_concs$water <- as.factor('Dry')
names(red_0_tray_packing_concs) <- c('concentration','area','scenario','water')

red_0_other_concs <- as.data.frame(red_0_other_w2wed_conc_list)
red_0_other_concs$area <- as.factor('other')
red_0_other_concs$scenario <- as.factor('No Reduction')
red_0_other_concs$water <- as.factor('Dry')
names(red_0_other_concs) <- c('concentration','area','scenario','water')

red_0_concs <- rbind(red_0_loading_concs,red_0_cleaning_concs,red_0_sorting_concs,red_0_tray_packing_concs,red_0_reject_concs,red_0_other_concs)

red_0_loading_prev <- as.data.frame(NL_table_No_Red$loading_w2wed_prev[order(NL_table_No_Red$local_seed)])
red_0_loading_prev$area <- as.factor('loading')
red_0_loading_prev$scenario <- as.factor('No Reduction')
red_0_loading_prev$water <- as.factor('Wet')
names(red_0_loading_prev) <- c('prevalence','area','scenario','water')

red_0_cleaning_prev <- as.data.frame(NL_table_No_Red$cleaning_w2wed_prev[order(NL_table_No_Red$local_seed)])
red_0_cleaning_prev$area <- as.factor('cleaning')
red_0_cleaning_prev$scenario <- as.factor('No Reduction')
red_0_cleaning_prev$water <- as.factor('Wet')
names(red_0_cleaning_prev) <- c('prevalence','area','scenario','water')

red_0_sorting_prev <- as.data.frame(NL_table_No_Red$sorting_w2wed_prev[order(NL_table_No_Red$local_seed)])
red_0_sorting_prev$area <- as.factor('sorting')
red_0_sorting_prev$scenario <- as.factor('No Reduction')
red_0_sorting_prev$water <- as.factor('Dry')
names(red_0_sorting_prev) <- c('prevalence','area','scenario','water')

red_0_reject_prev <- as.data.frame(NL_table_No_Red$reject_w2wed_prev[order(NL_table_No_Red$local_seed)])
red_0_reject_prev$area <- as.factor('reject')
red_0_reject_prev$scenario <- as.factor('No Reduction')
red_0_reject_prev$water <- as.factor('Dry')
names(red_0_reject_prev) <- c('prevalence','area','scenario','water')

red_0_tray_packing_prev <- as.data.frame(NL_table_No_Red$tray_packing_w2wed_prev[order(NL_table_No_Red$local_seed)])
red_0_tray_packing_prev$area <- as.factor('tray packing')
red_0_tray_packing_prev$scenario <- as.factor('No Reduction')
red_0_tray_packing_prev$water <- as.factor('Dry')
names(red_0_tray_packing_prev) <- c('prevalence','area','scenario','water')

red_0_other_prev <- as.data.frame(NL_table_No_Red$other_w2wed_prev[order(NL_table_No_Red$local_seed)])
red_0_other_prev$area <- as.factor('other')
red_0_other_prev$scenario <- as.factor('No Reduction')
red_0_other_prev$water <- as.factor('Dry')
names(red_0_other_prev) <- c('prevalence','area','scenario','water')

red_0_prev <- rbind(red_0_loading_prev,red_0_cleaning_prev,red_0_sorting_prev,red_0_tray_packing_prev,red_0_reject_prev,red_0_other_prev)
```

```{r import Reduction 3 Log Improvement}
NL_table_Red_3_Log_Imp <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-20-03-50 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Sanitation_Effectiveness_Improvement-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Red_3_Log_Imp <- NL_table_Red_3_Log_Imp[NL_table_Red_3_Log_Imp$scenario==18,]

while (any(grepl('-', names(NL_table_Red_3_Log_Imp), fixed = TRUE))) {
  NL_table_Red_3_Log_Imp <- NL_table_Red_3_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Red_3_Log_Imp), fixed = TRUE))) {
  NL_table_Red_3_Log_Imp <- NL_table_Red_3_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Red_3_Log_Imp), fixed = TRUE))) {
  NL_table_Red_3_Log_Imp <- NL_table_Red_3_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Red_3_Log_Imp), fixed = TRUE))) {
  NL_table_Red_3_Log_Imp <- NL_table_Red_3_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Red_3_Log_Imp[ , ..list_columns]

NL_table_Red_3_Log_Imp[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Red_3_Log_Imp <- as.data.frame(NL_table_Red_3_Log_Imp)

NL_table_Red_3_Log_Imp[NL_table_Red_3_Log_Imp==-1] <- NA

NL_table_Red_3_Log_Imp <- subset(NL_table_Red_3_Log_Imp, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Red_3_Log_Imp)[names(NL_table_Red_3_Log_Imp)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Red_3_Log_Imp)[names(NL_table_Red_3_Log_Imp)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Red_3_Log_Imp$loading_w2wed_conc_list[order(NL_table_Red_3_Log_Imp$local_seed)]
vector <- vector[vector!='[]']
red_3_log_imp_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_3_log_imp_loading_w2wed_conc_list <- append(red_3_log_imp_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_3_Log_Imp$cleaning_w2wed_conc_list[order(NL_table_Red_3_Log_Imp$local_seed)]
vector <- vector[vector!='[]']
red_3_log_imp_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_3_log_imp_cleaning_w2wed_conc_list <- append(red_3_log_imp_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_3_Log_Imp$drying_w2wed_conc_list[order(NL_table_Red_3_Log_Imp$local_seed)]
vector <- vector[vector!='[]']
red_3_log_imp_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_3_log_imp_drying_w2wed_conc_list <- append(red_3_log_imp_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_3_Log_Imp$sorting_w2wed_conc_list[order(NL_table_Red_3_Log_Imp$local_seed)]
vector <- vector[vector!='[]']
red_3_log_imp_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_3_log_imp_sorting_w2wed_conc_list <- append(red_3_log_imp_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_3_Log_Imp$tray_packing_w2wed_conc_list[order(NL_table_Red_3_Log_Imp$local_seed)]
vector <- vector[vector!='[]']
red_3_log_imp_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_3_log_imp_tray_packing_w2wed_conc_list <- append(red_3_log_imp_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_3_Log_Imp$reject_w2wed_conc_list[order(NL_table_Red_3_Log_Imp$local_seed)]
vector <- vector[vector!='[]']
red_3_log_imp_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_3_log_imp_reject_w2wed_conc_list <- append(red_3_log_imp_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_3_Log_Imp$other_w2wed_conc_list[order(NL_table_Red_3_Log_Imp$local_seed)]
vector <- vector[vector!='[]']
red_3_log_imp_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_3_log_imp_other_w2wed_conc_list <- append(red_3_log_imp_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

red_3_log_imp_loading_concs <- as.data.frame(red_3_log_imp_loading_w2wed_conc_list)
red_3_log_imp_loading_concs$area <- as.factor('loading')
red_3_log_imp_loading_concs$scenario <- as.factor('MI_01')
red_3_log_imp_loading_concs$water <- as.factor('Wet')
names(red_3_log_imp_loading_concs) <- c('concentration','area','scenario','water')

red_3_log_imp_cleaning_concs <- as.data.frame(red_3_log_imp_cleaning_w2wed_conc_list)
red_3_log_imp_cleaning_concs$area <- as.factor('cleaning')
red_3_log_imp_cleaning_concs$scenario <- as.factor('MI_01')
red_3_log_imp_cleaning_concs$water <- as.factor('Wet')
names(red_3_log_imp_cleaning_concs) <- c('concentration','area','scenario','water')

red_3_log_imp_sorting_concs <- as.data.frame(red_3_log_imp_sorting_w2wed_conc_list)
red_3_log_imp_sorting_concs$area <- as.factor('sorting')
red_3_log_imp_sorting_concs$scenario <- as.factor('MI_01')
red_3_log_imp_sorting_concs$water <- as.factor('Dry')
names(red_3_log_imp_sorting_concs) <- c('concentration','area','scenario','water')

red_3_log_imp_reject_concs <- as.data.frame(red_3_log_imp_reject_w2wed_conc_list)
red_3_log_imp_reject_concs$area <- as.factor('reject')
red_3_log_imp_reject_concs$scenario <- as.factor('MI_01')
red_3_log_imp_reject_concs$water <- as.factor('Dry')
names(red_3_log_imp_reject_concs) <- c('concentration','area','scenario','water')

red_3_log_imp_tray_packing_concs <- as.data.frame(red_3_log_imp_tray_packing_w2wed_conc_list)
red_3_log_imp_tray_packing_concs$area <- as.factor('tray packing')
red_3_log_imp_tray_packing_concs$scenario <- as.factor('MI_01')
red_3_log_imp_tray_packing_concs$water <- as.factor('Dry')
names(red_3_log_imp_tray_packing_concs) <- c('concentration','area','scenario','water')

red_3_log_imp_other_concs <- as.data.frame(red_3_log_imp_other_w2wed_conc_list)
red_3_log_imp_other_concs$area <- as.factor('other')
red_3_log_imp_other_concs$scenario <- as.factor('MI_01')
red_3_log_imp_other_concs$water <- as.factor('Dry')
names(red_3_log_imp_other_concs) <- c('concentration','area','scenario','water')

red_3_log_imp_concs <- rbind(red_3_log_imp_loading_concs,red_3_log_imp_cleaning_concs,red_3_log_imp_sorting_concs,red_3_log_imp_tray_packing_concs,red_3_log_imp_reject_concs,red_3_log_imp_other_concs)

red_3_log_imp_loading_prev <- as.data.frame(NL_table_Red_3_Log_Imp$loading_w2wed_prev[order(NL_table_Red_3_Log_Imp$local_seed)])
red_3_log_imp_loading_prev$area <- as.factor('loading')
red_3_log_imp_loading_prev$scenario <- as.factor('MI_01')
red_3_log_imp_loading_prev$water <- as.factor('Wet')
names(red_3_log_imp_loading_prev) <- c('prevalence','area','scenario','water')

red_3_log_imp_cleaning_prev <- as.data.frame(NL_table_Red_3_Log_Imp$cleaning_w2wed_prev[order(NL_table_Red_3_Log_Imp$local_seed)])
red_3_log_imp_cleaning_prev$area <- as.factor('cleaning')
red_3_log_imp_cleaning_prev$scenario <- as.factor('MI_01')
red_3_log_imp_cleaning_prev$water <- as.factor('Wet')
names(red_3_log_imp_cleaning_prev) <- c('prevalence','area','scenario','water')

red_3_log_imp_sorting_prev <- as.data.frame(NL_table_Red_3_Log_Imp$sorting_w2wed_prev[order(NL_table_Red_3_Log_Imp$local_seed)])
red_3_log_imp_sorting_prev$area <- as.factor('sorting')
red_3_log_imp_sorting_prev$scenario <- as.factor('MI_01')
red_3_log_imp_sorting_prev$water <- as.factor('Dry')
names(red_3_log_imp_sorting_prev) <- c('prevalence','area','scenario','water')

red_3_log_imp_reject_prev <- as.data.frame(NL_table_Red_3_Log_Imp$reject_w2wed_prev[order(NL_table_Red_3_Log_Imp$local_seed)])
red_3_log_imp_reject_prev$area <- as.factor('reject')
red_3_log_imp_reject_prev$scenario <- as.factor('MI_01')
red_3_log_imp_reject_prev$water <- as.factor('Dry')
names(red_3_log_imp_reject_prev) <- c('prevalence','area','scenario','water')

red_3_log_imp_tray_packing_prev <- as.data.frame(NL_table_Red_3_Log_Imp$tray_packing_w2wed_prev[order(NL_table_Red_3_Log_Imp$local_seed)])
red_3_log_imp_tray_packing_prev$area <- as.factor('tray packing')
red_3_log_imp_tray_packing_prev$scenario <- as.factor('MI_01')
red_3_log_imp_tray_packing_prev$water <- as.factor('Dry')
names(red_3_log_imp_tray_packing_prev) <- c('prevalence','area','scenario','water')

red_3_log_imp_other_prev <- as.data.frame(NL_table_Red_3_Log_Imp$other_w2wed_prev[order(NL_table_Red_3_Log_Imp$local_seed)])
red_3_log_imp_other_prev$area <- as.factor('other')
red_3_log_imp_other_prev$scenario <- as.factor('MI_01')
red_3_log_imp_other_prev$water <- as.factor('Dry')
names(red_3_log_imp_other_prev) <- c('prevalence','area','scenario','water')

red_3_log_imp_prev <- rbind(red_3_log_imp_loading_prev,red_3_log_imp_cleaning_prev,red_3_log_imp_sorting_prev,red_3_log_imp_tray_packing_prev,red_3_log_imp_reject_prev,red_3_log_imp_other_prev)

red_3_log_imp_wet_prev <- as.data.frame(red_3_log_imp_loading_prev$prevalence*21/100+red_3_log_imp_cleaning_prev$prevalence*28/100)/49*100
red_3_log_imp_wet_prev$scenario <- as.factor('MI_01')
red_3_log_imp_wet_prev$water <- as.factor('Wet')
names(red_3_log_imp_wet_prev) <- c('prevalence','scenario','water')

red_3_log_imp_dry_prev <- as.data.frame(red_3_log_imp_sorting_prev$prevalence*20/100+red_3_log_imp_reject_prev$prevalence*23/100+red_3_log_imp_tray_packing_prev$prevalence*123/100+red_3_log_imp_other_prev$prevalence*10/100)/176*100
red_3_log_imp_dry_prev$scenario <- as.factor('MI_01')
red_3_log_imp_dry_prev$water <- as.factor('Dry')
names(red_3_log_imp_dry_prev) <- c('prevalence','scenario','water')

red_3_log_imp_recombined_prev <- rbind(red_3_log_imp_wet_prev, red_3_log_imp_dry_prev)

red_3_log_imp_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(red_3_log_imp_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('MI_01'),
  as.factor(baseline_recombined_prev$water)
)
colnames(red_3_log_imp_eff_prev)<- c('prevalence', 'scenario', 'water')

red_3_log_imp_z1_prev <- as.data.frame(NL_table_Red_3_Log_Imp$z1_w2wed_prev)
red_3_log_imp_z1_prev$zone <- as.factor('Z1')
red_3_log_imp_z1_prev$scenario <- as.factor('MI_01')
names(red_3_log_imp_z1_prev) <- c('prevalence','zone','scenario')

red_3_log_imp_z2_prev <- as.data.frame(NL_table_Red_3_Log_Imp$z2_w2wed_prev)
red_3_log_imp_z2_prev$zone <- as.factor('Z2')
red_3_log_imp_z2_prev$scenario <- as.factor('MI_01')
names(red_3_log_imp_z2_prev) <- c('prevalence','zone','scenario')

red_3_log_imp_z3_prev <- as.data.frame(NL_table_Red_3_Log_Imp$z2_w2wed_prev)
red_3_log_imp_z3_prev$zone <- as.factor('Z3')
red_3_log_imp_z3_prev$scenario <- as.factor('MI_01')
names(red_3_log_imp_z3_prev) <- c('prevalence','zone','scenario')

red_3_log_imp_zone_prev <- rbind(red_3_log_imp_z1_prev,red_3_log_imp_z2_prev,red_3_log_imp_z3_prev)
```

```{r import Reduction 4 Log Improvement}
NL_table_Red_4_Log_Imp <- fread(paste0(getwd(),'/BehaviorSpace/2020-07-23-04-38 ENABLE-Facility_B-50cm_05-Custom 100_Runs_Local_Seed_Controlled_Specific_Scenarios-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Red_4_Log_Imp <- NL_table_Red_4_Log_Imp[NL_table_Red_4_Log_Imp$scenario==19,]

while (any(grepl('-', names(NL_table_Red_4_Log_Imp), fixed = TRUE))) {
  NL_table_Red_4_Log_Imp <- NL_table_Red_4_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Red_4_Log_Imp), fixed = TRUE))) {
  NL_table_Red_4_Log_Imp <- NL_table_Red_4_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Red_4_Log_Imp), fixed = TRUE))) {
  NL_table_Red_4_Log_Imp <- NL_table_Red_4_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Red_4_Log_Imp), fixed = TRUE))) {
  NL_table_Red_4_Log_Imp <- NL_table_Red_4_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Red_4_Log_Imp[ , ..list_columns]

NL_table_Red_4_Log_Imp[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Red_4_Log_Imp <- as.data.frame(NL_table_Red_4_Log_Imp)

NL_table_Red_4_Log_Imp[NL_table_Red_4_Log_Imp==-1] <- NA

NL_table_Red_4_Log_Imp <- subset(NL_table_Red_4_Log_Imp, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Red_4_Log_Imp)[names(NL_table_Red_4_Log_Imp)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Red_4_Log_Imp)[names(NL_table_Red_4_Log_Imp)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Red_4_Log_Imp$loading_w2wed_conc_list[order(NL_table_Red_4_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_4_log_imp_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_4_log_imp_loading_w2wed_conc_list <- append(red_4_log_imp_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_4_Log_Imp$cleaning_w2wed_conc_list[order(NL_table_Red_4_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_4_log_imp_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_4_log_imp_cleaning_w2wed_conc_list <- append(red_4_log_imp_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_4_Log_Imp$drying_w2wed_conc_list[order(NL_table_Red_4_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_4_log_imp_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_4_log_imp_drying_w2wed_conc_list <- append(red_4_log_imp_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_4_Log_Imp$sorting_w2wed_conc_list[order(NL_table_Red_4_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_4_log_imp_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_4_log_imp_sorting_w2wed_conc_list <- append(red_4_log_imp_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_4_Log_Imp$tray_packing_w2wed_conc_list[order(NL_table_No_Red$local_seed)])
vector <- vector[vector!='[]']
red_4_log_imp_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_4_log_imp_tray_packing_w2wed_conc_list <- append(red_4_log_imp_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_4_Log_Imp$reject_w2wed_conc_list[order(NL_table_Red_4_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_4_log_imp_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_4_log_imp_reject_w2wed_conc_list <- append(red_4_log_imp_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_4_Log_Imp$other_w2wed_conc_list[order(NL_table_Red_4_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_4_log_imp_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_4_log_imp_other_w2wed_conc_list <- append(red_4_log_imp_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

red_4_log_imp_loading_concs <- as.data.frame(red_4_log_imp_loading_w2wed_conc_list)
red_4_log_imp_loading_concs$area <- as.factor('loading')
red_4_log_imp_loading_concs$scenario <- as.factor('Reduction 4 Log Improvement')
red_4_log_imp_loading_concs$water <- as.factor('Wet')
names(red_4_log_imp_loading_concs) <- c('concentration','area','scenario','water')

red_4_log_imp_cleaning_concs <- as.data.frame(red_4_log_imp_cleaning_w2wed_conc_list)
red_4_log_imp_cleaning_concs$area <- as.factor('cleaning')
red_4_log_imp_cleaning_concs$scenario <- as.factor('Reduction 4 Log Improvement')
red_4_log_imp_cleaning_concs$water <- as.factor('Wet')
names(red_4_log_imp_cleaning_concs) <- c('concentration','area','scenario','water')

red_4_log_imp_sorting_concs <- as.data.frame(red_4_log_imp_sorting_w2wed_conc_list)
red_4_log_imp_sorting_concs$area <- as.factor('sorting')
red_4_log_imp_sorting_concs$scenario <- as.factor('Reduction 4 Log Improvement')
red_4_log_imp_sorting_concs$water <- as.factor('Dry')
names(red_4_log_imp_sorting_concs) <- c('concentration','area','scenario','water')

red_4_log_imp_reject_concs <- as.data.frame(red_4_log_imp_reject_w2wed_conc_list)
red_4_log_imp_reject_concs$area <- as.factor('reject')
red_4_log_imp_reject_concs$scenario <- as.factor('Reduction 4 Log Improvement')
red_4_log_imp_reject_concs$water <- as.factor('Dry')
names(red_4_log_imp_reject_concs) <- c('concentration','area','scenario','water')

red_4_log_imp_tray_packing_concs <- as.data.frame(red_4_log_imp_tray_packing_w2wed_conc_list)
red_4_log_imp_tray_packing_concs$area <- as.factor('tray packing')
red_4_log_imp_tray_packing_concs$scenario <- as.factor('Reduction 4 Log Improvement')
red_4_log_imp_tray_packing_concs$water <- as.factor('Dry')
names(red_4_log_imp_tray_packing_concs) <- c('concentration','area','scenario','water')

red_4_log_imp_other_concs <- as.data.frame(red_4_log_imp_other_w2wed_conc_list)
red_4_log_imp_other_concs$area <- as.factor('other')
red_4_log_imp_other_concs$scenario <- as.factor('Reduction 4 Log Improvement')
red_4_log_imp_other_concs$water <- as.factor('Dry')
names(red_4_log_imp_other_concs) <- c('concentration','area','scenario','water')

red_4_log_imp_concs <- rbind(red_4_log_imp_loading_concs,red_4_log_imp_cleaning_concs,red_4_log_imp_sorting_concs,red_4_log_imp_tray_packing_concs,red_4_log_imp_reject_concs,red_4_log_imp_other_concs)

red_4_log_imp_loading_prev <- as.data.frame(NL_table_Red_4_Log_Imp$loading_w2wed_prev[order(NL_table_Red_4_Log_Imp$local_seed)])
red_4_log_imp_loading_prev$area <- as.factor('loading')
red_4_log_imp_loading_prev$scenario <- as.factor('Reduction 4 Log Improvement')
red_4_log_imp_loading_prev$water <- as.factor('Wet')
names(red_4_log_imp_loading_prev) <- c('prevalence','area','scenario','water')

red_4_log_imp_cleaning_prev <- as.data.frame(NL_table_Red_4_Log_Imp$cleaning_w2wed_prev[order(NL_table_Red_4_Log_Imp$local_seed)])
red_4_log_imp_cleaning_prev$area <- as.factor('cleaning')
red_4_log_imp_cleaning_prev$scenario <- as.factor('Reduction 4 Log Improvement')
red_4_log_imp_cleaning_prev$water <- as.factor('Wet')
names(red_4_log_imp_cleaning_prev) <- c('prevalence','area','scenario','water')

red_4_log_imp_sorting_prev <- as.data.frame(NL_table_Red_4_Log_Imp$sorting_w2wed_prev[order(NL_table_Red_4_Log_Imp$local_seed)])
red_4_log_imp_sorting_prev$area <- as.factor('sorting')
red_4_log_imp_sorting_prev$scenario <- as.factor('Reduction 4 Log Improvement')
red_4_log_imp_sorting_prev$water <- as.factor('Dry')
names(red_4_log_imp_sorting_prev) <- c('prevalence','area','scenario','water')

red_4_log_imp_reject_prev <- as.data.frame(NL_table_Red_4_Log_Imp$reject_w2wed_prev[order(NL_table_Red_4_Log_Imp$local_seed)])
red_4_log_imp_reject_prev$area <- as.factor('reject')
red_4_log_imp_reject_prev$scenario <- as.factor('Reduction 4 Log Improvement')
red_4_log_imp_reject_prev$water <- as.factor('Dry')
names(red_4_log_imp_reject_prev) <- c('prevalence','area','scenario','water')

red_4_log_imp_tray_packing_prev <- as.data.frame(NL_table_Red_4_Log_Imp$tray_packing_w2wed_prev[order(NL_table_Red_4_Log_Imp$local_seed)])
red_4_log_imp_tray_packing_prev$area <- as.factor('tray packing')
red_4_log_imp_tray_packing_prev$scenario <- as.factor('Reduction 4 Log Improvement')
red_4_log_imp_tray_packing_prev$water <- as.factor('Dry')
names(red_4_log_imp_tray_packing_prev) <- c('prevalence','area','scenario','water')

red_4_log_imp_other_prev <- as.data.frame(NL_table_Red_4_Log_Imp$other_w2wed_prev[order(NL_table_Red_4_Log_Imp$local_seed)])
red_4_log_imp_other_prev$area <- as.factor('other')
red_4_log_imp_other_prev$scenario <- as.factor('Reduction 4 Log Improvement')
red_4_log_imp_other_prev$water <- as.factor('Dry')
names(red_4_log_imp_other_prev) <- c('prevalence','area','scenario','water')

red_4_log_imp_prev <- rbind(red_4_log_imp_loading_prev,red_4_log_imp_cleaning_prev,red_4_log_imp_sorting_prev,red_4_log_imp_tray_packing_prev,red_4_log_imp_reject_prev,red_4_log_imp_other_prev)
```

```{r import Reduction 5 Log Improvement}
NL_table_Red_5_Log_Imp <- fread(paste0(getwd(),'/BehaviorSpace/2020-07-23-04-38 ENABLE-Facility_B-50cm_05-Custom 100_Runs_Local_Seed_Controlled_Specific_Scenarios-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Red_5_Log_Imp <- NL_table_Red_5_Log_Imp[NL_table_Red_5_Log_Imp$scenario==20,]

while (any(grepl('-', names(NL_table_Red_5_Log_Imp), fixed = TRUE))) {
  NL_table_Red_5_Log_Imp <- NL_table_Red_5_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Red_5_Log_Imp), fixed = TRUE))) {
  NL_table_Red_5_Log_Imp <- NL_table_Red_5_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Red_5_Log_Imp), fixed = TRUE))) {
  NL_table_Red_5_Log_Imp <- NL_table_Red_5_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Red_5_Log_Imp), fixed = TRUE))) {
  NL_table_Red_5_Log_Imp <- NL_table_Red_5_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Red_5_Log_Imp[ , ..list_columns]

NL_table_Red_5_Log_Imp[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Red_5_Log_Imp <- as.data.frame(NL_table_Red_5_Log_Imp)

NL_table_Red_5_Log_Imp[NL_table_Red_5_Log_Imp==-1] <- NA

NL_table_Red_5_Log_Imp <- subset(NL_table_Red_5_Log_Imp, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Red_5_Log_Imp)[names(NL_table_Red_5_Log_Imp)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Red_5_Log_Imp)[names(NL_table_Red_5_Log_Imp)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Red_5_Log_Imp$loading_w2wed_conc_list[order(NL_table_Red_5_Log_Imp$local_seed)]
vector <- vector[vector!='[]']
red_5_log_imp_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_5_log_imp_loading_w2wed_conc_list <- append(red_5_log_imp_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_5_Log_Imp$cleaning_w2wed_conc_list[order(NL_table_Red_5_Log_Imp$local_seed)]
vector <- vector[vector!='[]']
red_5_log_imp_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_5_log_imp_cleaning_w2wed_conc_list <- append(red_5_log_imp_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_5_Log_Imp$drying_w2wed_conc_list[order(NL_table_Red_5_Log_Imp$local_seed)]
vector <- vector[vector!='[]']
red_5_log_imp_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_5_log_imp_drying_w2wed_conc_list <- append(red_5_log_imp_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_5_Log_Imp$sorting_w2wed_conc_list[order(NL_table_Red_5_Log_Imp$local_seed)]
vector <- vector[vector!='[]']
red_5_log_imp_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_5_log_imp_sorting_w2wed_conc_list <- append(red_5_log_imp_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_5_Log_Imp$tray_packing_w2wed_conc_list[order(NL_table_No_Red$local_seed)]
vector <- vector[vector!='[]']
red_5_log_imp_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_5_log_imp_tray_packing_w2wed_conc_list <- append(red_5_log_imp_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_5_Log_Imp$reject_w2wed_conc_list[order(NL_table_Red_5_Log_Imp$local_seed)]
vector <- vector[vector!='[]']
red_5_log_imp_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_5_log_imp_reject_w2wed_conc_list <- append(red_5_log_imp_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_5_Log_Imp$other_w2wed_conc_list[order(NL_table_Red_5_Log_Imp$local_seed)]
vector <- vector[vector!='[]']
red_5_log_imp_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_5_log_imp_other_w2wed_conc_list <- append(red_5_log_imp_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

red_5_log_imp_loading_concs <- as.data.frame(red_5_log_imp_loading_w2wed_conc_list)
red_5_log_imp_loading_concs$area <- as.factor('loading')
red_5_log_imp_loading_concs$scenario <- as.factor('Reduction 5 Log Improvement')
red_5_log_imp_loading_concs$water <- as.factor('Wet')
names(red_5_log_imp_loading_concs) <- c('concentration','area','scenario','water')

red_5_log_imp_cleaning_concs <- as.data.frame(red_5_log_imp_cleaning_w2wed_conc_list)
red_5_log_imp_cleaning_concs$area <- as.factor('cleaning')
red_5_log_imp_cleaning_concs$scenario <- as.factor('Reduction 5 Log Improvement')
red_5_log_imp_cleaning_concs$water <- as.factor('Wet')
names(red_5_log_imp_cleaning_concs) <- c('concentration','area','scenario','water')

red_5_log_imp_sorting_concs <- as.data.frame(red_5_log_imp_sorting_w2wed_conc_list)
red_5_log_imp_sorting_concs$area <- as.factor('sorting')
red_5_log_imp_sorting_concs$scenario <- as.factor('Reduction 5 Log Improvement')
red_5_log_imp_sorting_concs$water <- as.factor('Dry')
names(red_5_log_imp_sorting_concs) <- c('concentration','area','scenario','water')

red_5_log_imp_reject_concs <- as.data.frame(red_5_log_imp_reject_w2wed_conc_list)
red_5_log_imp_reject_concs$area <- as.factor('reject')
red_5_log_imp_reject_concs$scenario <- as.factor('Reduction 5 Log Improvement')
red_5_log_imp_reject_concs$water <- as.factor('Dry')
names(red_5_log_imp_reject_concs) <- c('concentration','area','scenario','water')

red_5_log_imp_tray_packing_concs <- as.data.frame(red_5_log_imp_tray_packing_w2wed_conc_list)
red_5_log_imp_tray_packing_concs$area <- as.factor('tray packing')
red_5_log_imp_tray_packing_concs$scenario <- as.factor('Reduction 5 Log Improvement')
red_5_log_imp_tray_packing_concs$water <- as.factor('Dry')
names(red_5_log_imp_tray_packing_concs) <- c('concentration','area','scenario','water')

red_5_log_imp_other_concs <- as.data.frame(red_5_log_imp_other_w2wed_conc_list)
red_5_log_imp_other_concs$area <- as.factor('other')
red_5_log_imp_other_concs$scenario <- as.factor('Reduction 5 Log Improvement')
red_5_log_imp_other_concs$water <- as.factor('Dry')
names(red_5_log_imp_other_concs) <- c('concentration','area','scenario','water')

red_5_log_imp_concs <- rbind(red_5_log_imp_loading_concs,red_5_log_imp_cleaning_concs,red_5_log_imp_sorting_concs,red_5_log_imp_tray_packing_concs,red_5_log_imp_reject_concs,red_5_log_imp_other_concs)

red_5_log_imp_loading_prev <- as.data.frame(NL_table_Red_5_Log_Imp$loading_w2wed_prev[order(NL_table_Red_5_Log_Imp$local_seed)])
red_5_log_imp_loading_prev$area <- as.factor('loading')
red_5_log_imp_loading_prev$scenario <- as.factor('Reduction 5 Log Improvement')
red_5_log_imp_loading_prev$water <- as.factor('Wet')
names(red_5_log_imp_loading_prev) <- c('prevalence','area','scenario','water')

red_5_log_imp_cleaning_prev <- as.data.frame(NL_table_Red_5_Log_Imp$cleaning_w2wed_prev[order(NL_table_Red_5_Log_Imp$local_seed)])
red_5_log_imp_cleaning_prev$area <- as.factor('cleaning')
red_5_log_imp_cleaning_prev$scenario <- as.factor('Reduction 5 Log Improvement')
red_5_log_imp_cleaning_prev$water <- as.factor('Wet')
names(red_5_log_imp_cleaning_prev) <- c('prevalence','area','scenario','water')

red_5_log_imp_sorting_prev <- as.data.frame(NL_table_Red_5_Log_Imp$sorting_w2wed_prev[order(NL_table_Red_5_Log_Imp$local_seed)])
red_5_log_imp_sorting_prev$area <- as.factor('sorting')
red_5_log_imp_sorting_prev$scenario <- as.factor('Reduction 5 Log Improvement')
red_5_log_imp_sorting_prev$water <- as.factor('Dry')
names(red_5_log_imp_sorting_prev) <- c('prevalence','area','scenario','water')

red_5_log_imp_reject_prev <- as.data.frame(NL_table_Red_5_Log_Imp$reject_w2wed_prev[order(NL_table_Red_5_Log_Imp$local_seed)])
red_5_log_imp_reject_prev$area <- as.factor('reject')
red_5_log_imp_reject_prev$scenario <- as.factor('Reduction 5 Log Improvement')
red_5_log_imp_reject_prev$water <- as.factor('Dry')
names(red_5_log_imp_reject_prev) <- c('prevalence','area','scenario','water')

red_5_log_imp_tray_packing_prev <- as.data.frame(NL_table_Red_5_Log_Imp$tray_packing_w2wed_prev[order(NL_table_Red_5_Log_Imp$local_seed)])
red_5_log_imp_tray_packing_prev$area <- as.factor('tray packing')
red_5_log_imp_tray_packing_prev$scenario <- as.factor('Reduction 5 Log Improvement')
red_5_log_imp_tray_packing_prev$water <- as.factor('Dry')
names(red_5_log_imp_tray_packing_prev) <- c('prevalence','area','scenario','water')

red_5_log_imp_other_prev <- as.data.frame(NL_table_Red_5_Log_Imp$other_w2wed_prev[order(NL_table_Red_5_Log_Imp$local_seed)])
red_5_log_imp_other_prev$area <- as.factor('other')
red_5_log_imp_other_prev$scenario <- as.factor('Reduction 5 Log Improvement')
red_5_log_imp_other_prev$water <- as.factor('Dry')
names(red_5_log_imp_other_prev) <- c('prevalence','area','scenario','water')

red_5_log_imp_prev <- rbind(red_5_log_imp_loading_prev,red_5_log_imp_cleaning_prev,red_5_log_imp_sorting_prev,red_5_log_imp_tray_packing_prev,red_5_log_imp_reject_prev,red_5_log_imp_other_prev)
```

```{r import Reduction 6 Log Improvement}
NL_table_Red_6_Log_Imp <- fread(paste0(getwd(),'/BehaviorSpace/2020-07-23-04-38 ENABLE-Facility_B-50cm_05-Custom 100_Runs_Local_Seed_Controlled_Specific_Scenarios-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Red_6_Log_Imp <- NL_table_Red_6_Log_Imp[NL_table_Red_6_Log_Imp$scenario==21,]

while (any(grepl('-', names(NL_table_Red_6_Log_Imp), fixed = TRUE))) {
  NL_table_Red_6_Log_Imp <- NL_table_Red_6_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Red_6_Log_Imp), fixed = TRUE))) {
  NL_table_Red_6_Log_Imp <- NL_table_Red_6_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Red_6_Log_Imp), fixed = TRUE))) {
  NL_table_Red_6_Log_Imp <- NL_table_Red_6_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Red_6_Log_Imp), fixed = TRUE))) {
  NL_table_Red_6_Log_Imp <- NL_table_Red_6_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Red_6_Log_Imp[ , ..list_columns]

NL_table_Red_6_Log_Imp[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Red_6_Log_Imp <- as.data.frame(NL_table_Red_6_Log_Imp)

NL_table_Red_6_Log_Imp[NL_table_Red_6_Log_Imp==-1] <- NA

NL_table_Red_6_Log_Imp <- subset(NL_table_Red_6_Log_Imp, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Red_6_Log_Imp)[names(NL_table_Red_6_Log_Imp)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Red_6_Log_Imp)[names(NL_table_Red_6_Log_Imp)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Red_6_Log_Imp$loading_w2wed_conc_list[order(NL_table_Red_6_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_6_log_imp_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_6_log_imp_loading_w2wed_conc_list <- append(red_6_log_imp_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_6_Log_Imp$cleaning_w2wed_conc_list[order(NL_table_Red_6_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_6_log_imp_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_6_log_imp_cleaning_w2wed_conc_list <- append(red_6_log_imp_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_6_Log_Imp$drying_w2wed_conc_list[order(NL_table_Red_6_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_6_log_imp_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_6_log_imp_drying_w2wed_conc_list <- append(red_6_log_imp_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_6_Log_Imp$sorting_w2wed_conc_list[order(NL_table_Red_6_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_6_log_imp_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_6_log_imp_sorting_w2wed_conc_list <- append(red_6_log_imp_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_6_Log_Imp$tray_packing_w2wed_conc_list[order(NL_table_No_Red$local_seed)])
vector <- vector[vector!='[]']
red_6_log_imp_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_6_log_imp_tray_packing_w2wed_conc_list <- append(red_6_log_imp_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_6_Log_Imp$reject_w2wed_conc_list[order(NL_table_Red_6_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_6_log_imp_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_6_log_imp_reject_w2wed_conc_list <- append(red_6_log_imp_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_6_Log_Imp$other_w2wed_conc_list[order(NL_table_Red_6_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_6_log_imp_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_6_log_imp_other_w2wed_conc_list <- append(red_6_log_imp_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

red_6_log_imp_loading_concs <- as.data.frame(red_6_log_imp_loading_w2wed_conc_list)
red_6_log_imp_loading_concs$area <- as.factor('loading')
red_6_log_imp_loading_concs$scenario <- as.factor('Reduction 6 Log Improvement')
red_6_log_imp_loading_concs$water <- as.factor('Wet')
names(red_6_log_imp_loading_concs) <- c('concentration','area','scenario','water')

red_6_log_imp_cleaning_concs <- as.data.frame(red_6_log_imp_cleaning_w2wed_conc_list)
red_6_log_imp_cleaning_concs$area <- as.factor('cleaning')
red_6_log_imp_cleaning_concs$scenario <- as.factor('Reduction 6 Log Improvement')
red_6_log_imp_cleaning_concs$water <- as.factor('Wet')
names(red_6_log_imp_cleaning_concs) <- c('concentration','area','scenario','water')

red_6_log_imp_sorting_concs <- as.data.frame(red_6_log_imp_sorting_w2wed_conc_list)
red_6_log_imp_sorting_concs$area <- as.factor('sorting')
red_6_log_imp_sorting_concs$scenario <- as.factor('Reduction 6 Log Improvement')
red_6_log_imp_sorting_concs$water <- as.factor('Dry')
names(red_6_log_imp_sorting_concs) <- c('concentration','area','scenario','water')

red_6_log_imp_reject_concs <- as.data.frame(red_6_log_imp_reject_w2wed_conc_list)
red_6_log_imp_reject_concs$area <- as.factor('reject')
red_6_log_imp_reject_concs$scenario <- as.factor('Reduction 6 Log Improvement')
red_6_log_imp_reject_concs$water <- as.factor('Dry')
names(red_6_log_imp_reject_concs) <- c('concentration','area','scenario','water')

red_6_log_imp_tray_packing_concs <- as.data.frame(red_6_log_imp_tray_packing_w2wed_conc_list)
red_6_log_imp_tray_packing_concs$area <- as.factor('tray packing')
red_6_log_imp_tray_packing_concs$scenario <- as.factor('Reduction 6 Log Improvement')
red_6_log_imp_tray_packing_concs$water <- as.factor('Dry')
names(red_6_log_imp_tray_packing_concs) <- c('concentration','area','scenario','water')

red_6_log_imp_other_concs <- as.data.frame(red_6_log_imp_other_w2wed_conc_list)
red_6_log_imp_other_concs$area <- as.factor('other')
red_6_log_imp_other_concs$scenario <- as.factor('Reduction 6 Log Improvement')
red_6_log_imp_other_concs$water <- as.factor('Dry')
names(red_6_log_imp_other_concs) <- c('concentration','area','scenario','water')

red_6_log_imp_concs <- rbind(red_6_log_imp_loading_concs,red_6_log_imp_cleaning_concs,red_6_log_imp_sorting_concs,red_6_log_imp_tray_packing_concs,red_6_log_imp_reject_concs,red_6_log_imp_other_concs)

red_6_log_imp_loading_prev <- as.data.frame(NL_table_Red_6_Log_Imp$loading_w2wed_prev[order(NL_table_Red_6_Log_Imp$local_seed)])
red_6_log_imp_loading_prev$area <- as.factor('loading')
red_6_log_imp_loading_prev$scenario <- as.factor('Reduction 6 Log Improvement')
red_6_log_imp_loading_prev$water <- as.factor('Wet')
names(red_6_log_imp_loading_prev) <- c('prevalence','area','scenario','water')

red_6_log_imp_cleaning_prev <- as.data.frame(NL_table_Red_6_Log_Imp$cleaning_w2wed_prev[order(NL_table_Red_6_Log_Imp$local_seed)])
red_6_log_imp_cleaning_prev$area <- as.factor('cleaning')
red_6_log_imp_cleaning_prev$scenario <- as.factor('Reduction 6 Log Improvement')
red_6_log_imp_cleaning_prev$water <- as.factor('Wet')
names(red_6_log_imp_cleaning_prev) <- c('prevalence','area','scenario','water')

red_6_log_imp_sorting_prev <- as.data.frame(NL_table_Red_6_Log_Imp$sorting_w2wed_prev[order(NL_table_Red_6_Log_Imp$local_seed)])
red_6_log_imp_sorting_prev$area <- as.factor('sorting')
red_6_log_imp_sorting_prev$scenario <- as.factor('Reduction 6 Log Improvement')
red_6_log_imp_sorting_prev$water <- as.factor('Dry')
names(red_6_log_imp_sorting_prev) <- c('prevalence','area','scenario','water')

red_6_log_imp_reject_prev <- as.data.frame(NL_table_Red_6_Log_Imp$reject_w2wed_prev[order(NL_table_Red_6_Log_Imp$local_seed)])
red_6_log_imp_reject_prev$area <- as.factor('reject')
red_6_log_imp_reject_prev$scenario <- as.factor('Reduction 6 Log Improvement')
red_6_log_imp_reject_prev$water <- as.factor('Dry')
names(red_6_log_imp_reject_prev) <- c('prevalence','area','scenario','water')

red_6_log_imp_tray_packing_prev <- as.data.frame(NL_table_Red_6_Log_Imp$tray_packing_w2wed_prev[order(NL_table_Red_6_Log_Imp$local_seed)])
red_6_log_imp_tray_packing_prev$area <- as.factor('tray packing')
red_6_log_imp_tray_packing_prev$scenario <- as.factor('Reduction 6 Log Improvement')
red_6_log_imp_tray_packing_prev$water <- as.factor('Dry')
names(red_6_log_imp_tray_packing_prev) <- c('prevalence','area','scenario','water')

red_6_log_imp_other_prev <- as.data.frame(NL_table_Red_6_Log_Imp$other_w2wed_prev[order(NL_table_Red_6_Log_Imp$local_seed)])
red_6_log_imp_other_prev$area <- as.factor('other')
red_6_log_imp_other_prev$scenario <- as.factor('Reduction 6 Log Improvement')
red_6_log_imp_other_prev$water <- as.factor('Dry')
names(red_6_log_imp_other_prev) <- c('prevalence','area','scenario','water')

red_6_log_imp_prev <- rbind(red_6_log_imp_loading_prev,red_6_log_imp_cleaning_prev,red_6_log_imp_sorting_prev,red_6_log_imp_tray_packing_prev,red_6_log_imp_reject_prev,red_6_log_imp_other_prev)
```

```{r import Reduction 7 Log Improvement}
NL_table_Red_7_Log_Imp <- fread(paste0(getwd(),'/BehaviorSpace/2020-07-23-04-38 ENABLE-Facility_B-50cm_05-Custom 100_Runs_Local_Seed_Controlled_Specific_Scenarios-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Red_7_Log_Imp <- NL_table_Red_7_Log_Imp[NL_table_Red_7_Log_Imp$scenario==22,]

while (any(grepl('-', names(NL_table_Red_7_Log_Imp), fixed = TRUE))) {
  NL_table_Red_7_Log_Imp <- NL_table_Red_7_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Red_7_Log_Imp), fixed = TRUE))) {
  NL_table_Red_7_Log_Imp <- NL_table_Red_7_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Red_7_Log_Imp), fixed = TRUE))) {
  NL_table_Red_7_Log_Imp <- NL_table_Red_7_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Red_7_Log_Imp), fixed = TRUE))) {
  NL_table_Red_7_Log_Imp <- NL_table_Red_7_Log_Imp %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Red_7_Log_Imp[ , ..list_columns]

NL_table_Red_7_Log_Imp[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Red_7_Log_Imp <- as.data.frame(NL_table_Red_7_Log_Imp)

NL_table_Red_7_Log_Imp[NL_table_Red_7_Log_Imp==-1] <- NA

NL_table_Red_7_Log_Imp <- subset(NL_table_Red_7_Log_Imp, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Red_7_Log_Imp)[names(NL_table_Red_7_Log_Imp)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Red_7_Log_Imp)[names(NL_table_Red_7_Log_Imp)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Red_7_Log_Imp$loading_w2wed_conc_list[order(NL_table_Red_7_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_7_log_imp_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_7_log_imp_loading_w2wed_conc_list <- append(red_7_log_imp_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_7_Log_Imp$cleaning_w2wed_conc_list[order(NL_table_Red_7_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_7_log_imp_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_7_log_imp_cleaning_w2wed_conc_list <- append(red_7_log_imp_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_7_Log_Imp$drying_w2wed_conc_list[order(NL_table_Red_7_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_7_log_imp_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_7_log_imp_drying_w2wed_conc_list <- append(red_7_log_imp_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_7_Log_Imp$sorting_w2wed_conc_list[order(NL_table_Red_7_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_7_log_imp_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_7_log_imp_sorting_w2wed_conc_list <- append(red_7_log_imp_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_7_Log_Imp$tray_packing_w2wed_conc_list[order(NL_table_Red_7_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_7_log_imp_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_7_log_imp_tray_packing_w2wed_conc_list <- append(red_7_log_imp_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_7_Log_Imp$reject_w2wed_conc_list[order(NL_table_Red_7_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_7_log_imp_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_7_log_imp_reject_w2wed_conc_list <- append(red_7_log_imp_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Red_7_Log_Imp$other_w2wed_conc_list[order(NL_table_Red_7_Log_Imp$local_seed)])
vector <- vector[vector!='[]']
red_7_log_imp_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  red_7_log_imp_other_w2wed_conc_list <- append(red_7_log_imp_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

red_7_log_imp_loading_concs <- as.data.frame(red_7_log_imp_loading_w2wed_conc_list)
red_7_log_imp_loading_concs$area <- as.factor('loading')
red_7_log_imp_loading_concs$scenario <- as.factor('Reduction 7 Log Improvement')
red_7_log_imp_loading_concs$water <- as.factor('Wet')
names(red_7_log_imp_loading_concs) <- c('concentration','area','scenario','water')

red_7_log_imp_cleaning_concs <- as.data.frame(red_7_log_imp_cleaning_w2wed_conc_list)
red_7_log_imp_cleaning_concs$area <- as.factor('cleaning')
red_7_log_imp_cleaning_concs$scenario <- as.factor('Reduction 7 Log Improvement')
red_7_log_imp_cleaning_concs$water <- as.factor('Wet')
names(red_7_log_imp_cleaning_concs) <- c('concentration','area','scenario','water')

red_7_log_imp_sorting_concs <- as.data.frame(red_7_log_imp_sorting_w2wed_conc_list)
red_7_log_imp_sorting_concs$area <- as.factor('sorting')
red_7_log_imp_sorting_concs$scenario <- as.factor('Reduction 7 Log Improvement')
red_7_log_imp_sorting_concs$water <- as.factor('Dry')
names(red_7_log_imp_sorting_concs) <- c('concentration','area','scenario','water')

red_7_log_imp_reject_concs <- as.data.frame(red_7_log_imp_reject_w2wed_conc_list)
red_7_log_imp_reject_concs$area <- as.factor('reject')
red_7_log_imp_reject_concs$scenario <- as.factor('Reduction 7 Log Improvement')
red_7_log_imp_reject_concs$water <- as.factor('Dry')
names(red_7_log_imp_reject_concs) <- c('concentration','area','scenario','water')

red_7_log_imp_tray_packing_concs <- as.data.frame(red_7_log_imp_tray_packing_w2wed_conc_list)
red_7_log_imp_tray_packing_concs$area <- as.factor('tray packing')
red_7_log_imp_tray_packing_concs$scenario <- as.factor('Reduction 7 Log Improvement')
red_7_log_imp_tray_packing_concs$water <- as.factor('Dry')
names(red_7_log_imp_tray_packing_concs) <- c('concentration','area','scenario','water')

red_7_log_imp_other_concs <- as.data.frame(red_7_log_imp_other_w2wed_conc_list)
red_7_log_imp_other_concs$area <- as.factor('other')
red_7_log_imp_other_concs$scenario <- as.factor('Reduction 7 Log Improvement')
red_7_log_imp_other_concs$water <- as.factor('Dry')
names(red_7_log_imp_other_concs) <- c('concentration','area','scenario','water')

red_7_log_imp_concs <- rbind(red_7_log_imp_loading_concs,red_7_log_imp_cleaning_concs,red_7_log_imp_sorting_concs,red_7_log_imp_tray_packing_concs,red_7_log_imp_reject_concs,red_7_log_imp_other_concs)

red_7_log_imp_loading_prev <- as.data.frame(NL_table_Red_7_Log_Imp$loading_w2wed_prev[order(NL_table_Red_7_Log_Imp$local_seed)])
red_7_log_imp_loading_prev$area <- as.factor('loading')
red_7_log_imp_loading_prev$scenario <- as.factor('Reduction 7 Log Improvement')
red_7_log_imp_loading_prev$water <- as.factor('Wet')
names(red_7_log_imp_loading_prev) <- c('prevalence','area','scenario','water')

red_7_log_imp_cleaning_prev <- as.data.frame(NL_table_Red_7_Log_Imp$cleaning_w2wed_prev[order(NL_table_Red_7_Log_Imp$local_seed)])
red_7_log_imp_cleaning_prev$area <- as.factor('cleaning')
red_7_log_imp_cleaning_prev$scenario <- as.factor('Reduction 7 Log Improvement')
red_7_log_imp_cleaning_prev$water <- as.factor('Wet')
names(red_7_log_imp_cleaning_prev) <- c('prevalence','area','scenario','water')

red_7_log_imp_sorting_prev <- as.data.frame(NL_table_Red_7_Log_Imp$sorting_w2wed_prev[order(NL_table_Red_7_Log_Imp$local_seed)])
red_7_log_imp_sorting_prev$area <- as.factor('sorting')
red_7_log_imp_sorting_prev$scenario <- as.factor('Reduction 7 Log Improvement')
red_7_log_imp_sorting_prev$water <- as.factor('Dry')
names(red_7_log_imp_sorting_prev) <- c('prevalence','area','scenario','water')

red_7_log_imp_reject_prev <- as.data.frame(NL_table_Red_7_Log_Imp$reject_w2wed_prev[order(NL_table_Red_7_Log_Imp$local_seed)])
red_7_log_imp_reject_prev$area <- as.factor('reject')
red_7_log_imp_reject_prev$scenario <- as.factor('Reduction 7 Log Improvement')
red_7_log_imp_reject_prev$water <- as.factor('Dry')
names(red_7_log_imp_reject_prev) <- c('prevalence','area','scenario','water')

red_7_log_imp_tray_packing_prev <- as.data.frame(NL_table_Red_7_Log_Imp$tray_packing_w2wed_prev[order(NL_table_Red_7_Log_Imp$local_seed)])
red_7_log_imp_tray_packing_prev$area <- as.factor('tray packing')
red_7_log_imp_tray_packing_prev$scenario <- as.factor('Reduction 7 Log Improvement')
red_7_log_imp_tray_packing_prev$water <- as.factor('Dry')
names(red_7_log_imp_tray_packing_prev) <- c('prevalence','area','scenario','water')

red_7_log_imp_other_prev <- as.data.frame(NL_table_Red_7_Log_Imp$other_w2wed_prev[order(NL_table_Red_7_Log_Imp$local_seed)])
red_7_log_imp_other_prev$area <- as.factor('other')
red_7_log_imp_other_prev$scenario <- as.factor('Reduction 7 Log Improvement')
red_7_log_imp_other_prev$water <- as.factor('Dry')
names(red_7_log_imp_other_prev) <- c('prevalence','area','scenario','water')

red_7_log_imp_prev <- rbind(red_7_log_imp_loading_prev,red_7_log_imp_cleaning_prev,red_7_log_imp_sorting_prev,red_7_log_imp_tray_packing_prev,red_7_log_imp_reject_prev,red_7_log_imp_other_prev)
```

```{r import FAMD Intervention}
NL_table_FAMD_Intervention <- fread(paste0(getwd(),'/BehaviorSpace/2020-07-23-04-38 ENABLE-Facility_B-50cm_05-Custom 100_Runs_Local_Seed_Controlled_Specific_Scenarios-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_FAMD_Intervention <- NL_table_FAMD_Intervention[NL_table_FAMD_Intervention$scenario==23,]

while (any(grepl('-', names(NL_table_FAMD_Intervention), fixed = TRUE))) {
  NL_table_FAMD_Intervention <- NL_table_FAMD_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_FAMD_Intervention), fixed = TRUE))) {
  NL_table_FAMD_Intervention <- NL_table_FAMD_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_FAMD_Intervention), fixed = TRUE))) {
  NL_table_FAMD_Intervention <- NL_table_FAMD_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_FAMD_Intervention), fixed = TRUE))) {
  NL_table_FAMD_Intervention <- NL_table_FAMD_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_FAMD_Intervention[ , ..list_columns]

NL_table_FAMD_Intervention[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_FAMD_Intervention <- as.data.frame(NL_table_FAMD_Intervention)

NL_table_FAMD_Intervention[NL_table_FAMD_Intervention==-1] <- NA

NL_table_FAMD_Intervention <- subset(NL_table_FAMD_Intervention, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_FAMD_Intervention)[names(NL_table_FAMD_Intervention)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_FAMD_Intervention)[names(NL_table_FAMD_Intervention)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_FAMD_Intervention$loading_w2wed_conc_list[order(NL_table_FAMD_Intervention$local_seed)]
vector <- vector[vector!='[]']
famd_intervention_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  famd_intervention_loading_w2wed_conc_list <- append(famd_intervention_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_FAMD_Intervention$cleaning_w2wed_conc_list[order(NL_table_FAMD_Intervention$local_seed)]
vector <- vector[vector!='[]']
famd_intervention_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  famd_intervention_cleaning_w2wed_conc_list <- append(famd_intervention_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_FAMD_Intervention$drying_w2wed_conc_list[order(NL_table_FAMD_Intervention$local_seed)]
vector <- vector[vector!='[]']
famd_intervention_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  famd_intervention_drying_w2wed_conc_list <- append(famd_intervention_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_FAMD_Intervention$sorting_w2wed_conc_list[order(NL_table_FAMD_Intervention$local_seed)]
vector <- vector[vector!='[]']
famd_intervention_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  famd_intervention_sorting_w2wed_conc_list <- append(famd_intervention_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_FAMD_Intervention$tray_packing_w2wed_conc_list[order(NL_table_FAMD_Intervention$local_seed)]
vector <- vector[vector!='[]']
famd_intervention_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  famd_intervention_tray_packing_w2wed_conc_list <- append(famd_intervention_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_FAMD_Intervention$reject_w2wed_conc_list[order(NL_table_FAMD_Intervention$local_seed)]
vector <- vector[vector!='[]']
famd_intervention_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  famd_intervention_reject_w2wed_conc_list <- append(famd_intervention_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_FAMD_Intervention$other_w2wed_conc_list[order(NL_table_FAMD_Intervention$local_seed)]
vector <- vector[vector!='[]']
famd_intervention_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  famd_intervention_other_w2wed_conc_list <- append(famd_intervention_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

famd_intervention_loading_concs <- as.data.frame(famd_intervention_loading_w2wed_conc_list)
famd_intervention_loading_concs$area <- as.factor('loading')
famd_intervention_loading_concs$scenario <- as.factor('FAMD Intervention')
famd_intervention_loading_concs$water <- as.factor('Wet')
names(famd_intervention_loading_concs) <- c('concentration','area','scenario','water')

famd_intervention_cleaning_concs <- as.data.frame(famd_intervention_cleaning_w2wed_conc_list)
famd_intervention_cleaning_concs$area <- as.factor('cleaning')
famd_intervention_cleaning_concs$scenario <- as.factor('FAMD Intervention')
famd_intervention_cleaning_concs$water <- as.factor('Wet')
names(famd_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

famd_intervention_sorting_concs <- as.data.frame(famd_intervention_sorting_w2wed_conc_list)
famd_intervention_sorting_concs$area <- as.factor('sorting')
famd_intervention_sorting_concs$scenario <- as.factor('FAMD Intervention')
famd_intervention_sorting_concs$water <- as.factor('Dry')
names(famd_intervention_sorting_concs) <- c('concentration','area','scenario','water')

famd_intervention_tray_packing_concs <- as.data.frame(famd_intervention_tray_packing_w2wed_conc_list)
famd_intervention_tray_packing_concs$area <- as.factor('tray packing')
famd_intervention_tray_packing_concs$scenario <- as.factor('FAMD Intervention')
famd_intervention_tray_packing_concs$water <- as.factor('Dry')
names(famd_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

famd_intervention_reject_concs <- as.data.frame(famd_intervention_reject_w2wed_conc_list)
famd_intervention_reject_concs$area <- as.factor('reject')
famd_intervention_reject_concs$scenario <- as.factor('FAMD Intervention')
famd_intervention_reject_concs$water <- as.factor('Dry')
names(famd_intervention_reject_concs) <- c('concentration','area','scenario','water')

famd_intervention_other_concs <- as.data.frame(famd_intervention_other_w2wed_conc_list)
famd_intervention_other_concs$area <- as.factor('other')
famd_intervention_other_concs$scenario <- as.factor('FAMD Intervention')
famd_intervention_other_concs$water <- as.factor('Dry')
names(famd_intervention_other_concs) <- c('concentration','area','scenario','water')

famd_intervention_concs <- rbind(famd_intervention_loading_concs,famd_intervention_cleaning_concs,famd_intervention_sorting_concs,famd_intervention_tray_packing_concs,famd_intervention_reject_concs,famd_intervention_other_concs)

famd_intervention_loading_prev <- as.data.frame(NL_table_FAMD_Intervention$loading_w2wed_prev[order(NL_table_FAMD_Intervention$local_seed)])
famd_intervention_loading_prev$area <- as.factor('loading')
famd_intervention_loading_prev$scenario <- as.factor('FAMD Intervention')
famd_intervention_loading_prev$water <- as.factor('Wet')
names(famd_intervention_loading_prev) <- c('prevalence','area','scenario','water')

famd_intervention_cleaning_prev <- as.data.frame(NL_table_FAMD_Intervention$cleaning_w2wed_prev[order(NL_table_FAMD_Intervention$local_seed)])
famd_intervention_cleaning_prev$area <- as.factor('cleaning')
famd_intervention_cleaning_prev$scenario <- as.factor('FAMD Intervention')
famd_intervention_cleaning_prev$water <- as.factor('Wet')
names(famd_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

famd_intervention_sorting_prev <- as.data.frame(NL_table_FAMD_Intervention$sorting_w2wed_prev[order(NL_table_FAMD_Intervention$local_seed)])
famd_intervention_sorting_prev$area <- as.factor('sorting')
famd_intervention_sorting_prev$scenario <- as.factor('FAMD Intervention')
famd_intervention_sorting_prev$water <- as.factor('Dry')
names(famd_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

famd_intervention_reject_prev <- as.data.frame(NL_table_FAMD_Intervention$reject_w2wed_prev[order(NL_table_FAMD_Intervention$local_seed)])
famd_intervention_reject_prev$area <- as.factor('reject')
famd_intervention_reject_prev$scenario <- as.factor('FAMD Intervention')
famd_intervention_reject_prev$water <- as.factor('Dry')
names(famd_intervention_reject_prev) <- c('prevalence','area','scenario','water')

famd_intervention_tray_packing_prev <- as.data.frame(NL_table_FAMD_Intervention$tray_packing_w2wed_prev[order(NL_table_FAMD_Intervention$local_seed)])
famd_intervention_tray_packing_prev$area <- as.factor('tray packing')
famd_intervention_tray_packing_prev$scenario <- as.factor('FAMD Intervention')
famd_intervention_tray_packing_prev$water <- as.factor('Dry')
names(famd_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

famd_intervention_other_prev <- as.data.frame(NL_table_FAMD_Intervention$other_w2wed_prev[order(NL_table_FAMD_Intervention$local_seed)])
famd_intervention_other_prev$area <- as.factor('other')
famd_intervention_other_prev$scenario <- as.factor('FAMD Intervention')
famd_intervention_other_prev$water <- as.factor('Dry')
names(famd_intervention_other_prev) <- c('prevalence','area','scenario','water')

famd_intervention_prev <- rbind(famd_intervention_loading_prev,famd_intervention_cleaning_prev,famd_intervention_sorting_prev,famd_intervention_tray_packing_prev,famd_intervention_reject_prev,famd_intervention_other_prev)
```

```{r import PCA Intervention}
NL_table_PCA_Intervention <- fread(paste0(getwd(),'/BehaviorSpace/2020-07-23-04-38 ENABLE-Facility_B-50cm_05-Custom 100_Runs_Local_Seed_Controlled_Specific_Scenarios-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_PCA_Intervention <- NL_table_PCA_Intervention[NL_table_PCA_Intervention$scenario==24,]

while (any(grepl('-', names(NL_table_PCA_Intervention), fixed = TRUE))) {
  NL_table_PCA_Intervention <- NL_table_PCA_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_PCA_Intervention), fixed = TRUE))) {
  NL_table_PCA_Intervention <- NL_table_PCA_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_PCA_Intervention), fixed = TRUE))) {
  NL_table_PCA_Intervention <- NL_table_PCA_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_PCA_Intervention), fixed = TRUE))) {
  NL_table_PCA_Intervention <- NL_table_PCA_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_PCA_Intervention[ , ..list_columns]

NL_table_PCA_Intervention[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_PCA_Intervention <- as.data.frame(NL_table_PCA_Intervention)

NL_table_PCA_Intervention[NL_table_PCA_Intervention==-1] <- NA

NL_table_PCA_Intervention <- subset(NL_table_PCA_Intervention, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_PCA_Intervention)[names(NL_table_PCA_Intervention)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_PCA_Intervention)[names(NL_table_PCA_Intervention)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_PCA_Intervention$loading_w2wed_conc_list[order(NL_table_PCA_Intervention$local_seed)]
vector <- vector[vector!='[]']
pca_intervention_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  pca_intervention_loading_w2wed_conc_list <- append(pca_intervention_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_PCA_Intervention$cleaning_w2wed_conc_list[order(NL_table_PCA_Intervention$local_seed)]
vector <- vector[vector!='[]']
pca_intervention_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  pca_intervention_cleaning_w2wed_conc_list <- append(pca_intervention_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_PCA_Intervention$drying_w2wed_conc_list[order(NL_table_PCA_Intervention$local_seed)]
vector <- vector[vector!='[]']
pca_intervention_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  pca_intervention_drying_w2wed_conc_list <- append(pca_intervention_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_PCA_Intervention$sorting_w2wed_conc_list[order(NL_table_PCA_Intervention$local_seed)]
vector <- vector[vector!='[]']
pca_intervention_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  pca_intervention_sorting_w2wed_conc_list <- append(pca_intervention_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_PCA_Intervention$tray_packing_w2wed_conc_list[order(NL_table_PCA_Intervention$local_seed)]
vector <- vector[vector!='[]']
pca_intervention_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  pca_intervention_tray_packing_w2wed_conc_list <- append(pca_intervention_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_PCA_Intervention$reject_w2wed_conc_list[order(NL_table_PCA_Intervention$local_seed)]
vector <- vector[vector!='[]']
pca_intervention_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  pca_intervention_reject_w2wed_conc_list <- append(pca_intervention_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_PCA_Intervention$other_w2wed_conc_list[order(NL_table_PCA_Intervention$local_seed)]
vector <- vector[vector!='[]']
pca_intervention_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  pca_intervention_other_w2wed_conc_list <- append(pca_intervention_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

pca_intervention_loading_concs <- as.data.frame(pca_intervention_loading_w2wed_conc_list)
pca_intervention_loading_concs$area <- as.factor('loading')
pca_intervention_loading_concs$scenario <- as.factor('PCA Intervention')
pca_intervention_loading_concs$water <- as.factor('Wet')
names(pca_intervention_loading_concs) <- c('concentration','area','scenario','water')

pca_intervention_cleaning_concs <- as.data.frame(pca_intervention_cleaning_w2wed_conc_list)
pca_intervention_cleaning_concs$area <- as.factor('cleaning')
pca_intervention_cleaning_concs$scenario <- as.factor('PCA Intervention')
pca_intervention_cleaning_concs$water <- as.factor('Wet')
names(pca_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

pca_intervention_sorting_concs <- as.data.frame(pca_intervention_sorting_w2wed_conc_list)
pca_intervention_sorting_concs$area <- as.factor('sorting')
pca_intervention_sorting_concs$scenario <- as.factor('PCA Intervention')
pca_intervention_sorting_concs$water <- as.factor('Dry')
names(pca_intervention_sorting_concs) <- c('concentration','area','scenario','water')

pca_intervention_tray_packing_concs <- as.data.frame(pca_intervention_tray_packing_w2wed_conc_list)
pca_intervention_tray_packing_concs$area <- as.factor('tray packing')
pca_intervention_tray_packing_concs$scenario <- as.factor('PCA Intervention')
pca_intervention_tray_packing_concs$water <- as.factor('Dry')
names(pca_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

pca_intervention_reject_concs <- as.data.frame(pca_intervention_reject_w2wed_conc_list)
pca_intervention_reject_concs$area <- as.factor('reject')
pca_intervention_reject_concs$scenario <- as.factor('PCA Intervention')
pca_intervention_reject_concs$water <- as.factor('Dry')
names(pca_intervention_reject_concs) <- c('concentration','area','scenario','water')

pca_intervention_other_concs <- as.data.frame(pca_intervention_other_w2wed_conc_list)
pca_intervention_other_concs$area <- as.factor('other')
pca_intervention_other_concs$scenario <- as.factor('PCA Intervention')
pca_intervention_other_concs$water <- as.factor('Dry')
names(pca_intervention_other_concs) <- c('concentration','area','scenario','water')

pca_intervention_concs <- rbind(pca_intervention_loading_concs,pca_intervention_cleaning_concs,pca_intervention_sorting_concs,pca_intervention_tray_packing_concs,pca_intervention_reject_concs,pca_intervention_other_concs)

pca_intervention_loading_prev <- as.data.frame(NL_table_PCA_Intervention$loading_w2wed_prev[order(NL_table_PCA_Intervention$local_seed)])
pca_intervention_loading_prev$area <- as.factor('loading')
pca_intervention_loading_prev$scenario <- as.factor('PCA Intervention')
pca_intervention_loading_prev$water <- as.factor('Wet')
names(pca_intervention_loading_prev) <- c('prevalence','area','scenario','water')

pca_intervention_cleaning_prev <- as.data.frame(NL_table_PCA_Intervention$cleaning_w2wed_prev[order(NL_table_PCA_Intervention$local_seed)])
pca_intervention_cleaning_prev$area <- as.factor('cleaning')
pca_intervention_cleaning_prev$scenario <- as.factor('PCA Intervention')
pca_intervention_cleaning_prev$water <- as.factor('Wet')
names(pca_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

pca_intervention_sorting_prev <- as.data.frame(NL_table_PCA_Intervention$sorting_w2wed_prev[order(NL_table_PCA_Intervention$local_seed)])
pca_intervention_sorting_prev$area <- as.factor('sorting')
pca_intervention_sorting_prev$scenario <- as.factor('PCA Intervention')
pca_intervention_sorting_prev$water <- as.factor('Dry')
names(pca_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

pca_intervention_reject_prev <- as.data.frame(NL_table_PCA_Intervention$reject_w2wed_prev[order(NL_table_PCA_Intervention$local_seed)])
pca_intervention_reject_prev$area <- as.factor('reject')
pca_intervention_reject_prev$scenario <- as.factor('PCA Intervention')
pca_intervention_reject_prev$water <- as.factor('Dry')
names(pca_intervention_reject_prev) <- c('prevalence','area','scenario','water')

pca_intervention_tray_packing_prev <- as.data.frame(NL_table_PCA_Intervention$tray_packing_w2wed_prev[order(NL_table_PCA_Intervention$local_seed)])
pca_intervention_tray_packing_prev$area <- as.factor('tray packing')
pca_intervention_tray_packing_prev$scenario <- as.factor('PCA Intervention')
pca_intervention_tray_packing_prev$water <- as.factor('Dry')
names(pca_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

pca_intervention_other_prev <- as.data.frame(NL_table_PCA_Intervention$other_w2wed_prev[order(NL_table_PCA_Intervention$local_seed)])
pca_intervention_other_prev$area <- as.factor('other')
pca_intervention_other_prev$scenario <- as.factor('PCA Intervention')
pca_intervention_other_prev$water <- as.factor('Dry')
names(pca_intervention_other_prev) <- c('prevalence','area','scenario','water')

pca_intervention_prev <- rbind(pca_intervention_loading_prev,pca_intervention_cleaning_prev,pca_intervention_sorting_prev,pca_intervention_tray_packing_prev,pca_intervention_reject_prev,pca_intervention_other_prev)
```

```{r import Uncleanable Agents}
NL_table_Uncleanable_Agents <- fread(paste0(getwd(),'/BehaviorSpace/2020-08-07-00-21 ENABLE-Facility_B-50cm_05-Custom 100_Runs_Local_Seed_Controlled_Specific_Scenarios-table+Uncleanable Agents.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Uncleanable_Agents <- NL_table_Uncleanable_Agents[NL_table_Uncleanable_Agents$scenario==25,]

while (any(grepl('-', names(NL_table_Uncleanable_Agents), fixed = TRUE))) {
  NL_table_Uncleanable_Agents <- NL_table_Uncleanable_Agents %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Uncleanable_Agents), fixed = TRUE))) {
  NL_table_Uncleanable_Agents <- NL_table_Uncleanable_Agents %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Uncleanable_Agents), fixed = TRUE))) {
  NL_table_Uncleanable_Agents <- NL_table_Uncleanable_Agents %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Uncleanable_Agents), fixed = TRUE))) {
  NL_table_Uncleanable_Agents <- NL_table_Uncleanable_Agents %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Uncleanable_Agents[ , ..list_columns]

NL_table_Uncleanable_Agents[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Uncleanable_Agents <- as.data.frame(NL_table_Uncleanable_Agents)

NL_table_Uncleanable_Agents[NL_table_Uncleanable_Agents==-1] <- NA

NL_table_Uncleanable_Agents <- subset(NL_table_Uncleanable_Agents, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Uncleanable_Agents)[names(NL_table_Uncleanable_Agents)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Uncleanable_Agents)[names(NL_table_Uncleanable_Agents)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Uncleanable_Agents$loading_w2wed_conc_list[order(NL_table_Uncleanable_Agents$local_seed)])
vector <- vector[vector!='[]']
uncleanable_agents_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  uncleanable_agents_loading_w2wed_conc_list <- append(uncleanable_agents_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Uncleanable_Agents$cleaning_w2wed_conc_list[order(NL_table_Uncleanable_Agents$local_seed)])
vector <- vector[vector!='[]']
uncleanable_agents_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  uncleanable_agents_cleaning_w2wed_conc_list <- append(uncleanable_agents_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Uncleanable_Agents$drying_w2wed_conc_list[order(NL_table_Uncleanable_Agents$local_seed)])
vector <- vector[vector!='[]']
uncleanable_agents_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  uncleanable_agents_drying_w2wed_conc_list <- append(uncleanable_agents_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Uncleanable_Agents$sorting_w2wed_conc_list[order(NL_table_Uncleanable_Agents$local_seed)])
vector <- vector[vector!='[]']
uncleanable_agents_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  uncleanable_agents_sorting_w2wed_conc_list <- append(uncleanable_agents_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Uncleanable_Agents$tray_packing_w2wed_conc_list[order(NL_table_Uncleanable_Agents$local_seed)])
vector <- vector[vector!='[]']
uncleanable_agents_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  uncleanable_agents_tray_packing_w2wed_conc_list <- append(uncleanable_agents_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Uncleanable_Agents$reject_w2wed_conc_list[order(NL_table_Uncleanable_Agents$local_seed)])
vector <- vector[vector!='[]']
uncleanable_agents_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  uncleanable_agents_reject_w2wed_conc_list <- append(uncleanable_agents_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Uncleanable_Agents$other_w2wed_conc_list[order(NL_table_Uncleanable_Agents$local_seed)])
vector <- vector[vector!='[]']
uncleanable_agents_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  uncleanable_agents_other_w2wed_conc_list <- append(uncleanable_agents_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

uncleanable_agents_loading_concs <- as.data.frame(uncleanable_agents_loading_w2wed_conc_list)
uncleanable_agents_loading_concs$area <- as.factor('loading')
uncleanable_agents_loading_concs$scenario <- as.factor('Uncleanable Agents')
uncleanable_agents_loading_concs$water <- as.factor('Wet')
names(uncleanable_agents_loading_concs) <- c('concentration','area','scenario','water')

uncleanable_agents_cleaning_concs <- as.data.frame(uncleanable_agents_cleaning_w2wed_conc_list)
uncleanable_agents_cleaning_concs$area <- as.factor('cleaning')
uncleanable_agents_cleaning_concs$scenario <- as.factor('Uncleanable Agents')
uncleanable_agents_cleaning_concs$water <- as.factor('Wet')
names(uncleanable_agents_cleaning_concs) <- c('concentration','area','scenario','water')

uncleanable_agents_sorting_concs <- as.data.frame(uncleanable_agents_sorting_w2wed_conc_list)
uncleanable_agents_sorting_concs$area <- as.factor('sorting')
uncleanable_agents_sorting_concs$scenario <- as.factor('Uncleanable Agents')
uncleanable_agents_sorting_concs$water <- as.factor('Dry')
names(uncleanable_agents_sorting_concs) <- c('concentration','area','scenario','water')

uncleanable_agents_reject_concs <- as.data.frame(uncleanable_agents_reject_w2wed_conc_list)
uncleanable_agents_reject_concs$area <- as.factor('reject')
uncleanable_agents_reject_concs$scenario <- as.factor('Uncleanable Agents')
uncleanable_agents_reject_concs$water <- as.factor('Dry')
names(uncleanable_agents_reject_concs) <- c('concentration','area','scenario','water')

uncleanable_agents_tray_packing_concs <- as.data.frame(uncleanable_agents_tray_packing_w2wed_conc_list)
uncleanable_agents_tray_packing_concs$area <- as.factor('tray packing')
uncleanable_agents_tray_packing_concs$scenario <- as.factor('Uncleanable Agents')
uncleanable_agents_tray_packing_concs$water <- as.factor('Dry')
names(uncleanable_agents_tray_packing_concs) <- c('concentration','area','scenario','water')

uncleanable_agents_other_concs <- as.data.frame(uncleanable_agents_other_w2wed_conc_list)
uncleanable_agents_other_concs$area <- as.factor('other')
uncleanable_agents_other_concs$scenario <- as.factor('Uncleanable Agents')
uncleanable_agents_other_concs$water <- as.factor('Dry')
names(uncleanable_agents_other_concs) <- c('concentration','area','scenario','water')

uncleanable_agents_concs <- rbind(uncleanable_agents_loading_concs,uncleanable_agents_cleaning_concs,uncleanable_agents_sorting_concs,uncleanable_agents_tray_packing_concs,uncleanable_agents_reject_concs,uncleanable_agents_other_concs)

uncleanable_agents_loading_prev <- as.data.frame(NL_table_Uncleanable_Agents$loading_w2wed_prev)
uncleanable_agents_loading_prev$area <- as.factor('loading')
uncleanable_agents_loading_prev$scenario <- as.factor('Uncleanable Agents')
uncleanable_agents_loading_prev$water <- as.factor('Wet')
names(uncleanable_agents_loading_prev) <- c('prevalence','area','scenario','water')

uncleanable_agents_cleaning_prev <- as.data.frame(NL_table_Uncleanable_Agents$cleaning_w2wed_prev)
uncleanable_agents_cleaning_prev$area <- as.factor('cleaning')
uncleanable_agents_cleaning_prev$scenario <- as.factor('Uncleanable Agents')
uncleanable_agents_cleaning_prev$water <- as.factor('Wet')
names(uncleanable_agents_cleaning_prev) <- c('prevalence','area','scenario','water')

uncleanable_agents_sorting_prev <- as.data.frame(NL_table_Uncleanable_Agents$sorting_w2wed_prev)
uncleanable_agents_sorting_prev$area <- as.factor('sorting')
uncleanable_agents_sorting_prev$scenario <- as.factor('Uncleanable Agents')
uncleanable_agents_sorting_prev$water <- as.factor('Dry')
names(uncleanable_agents_sorting_prev) <- c('prevalence','area','scenario','water')

uncleanable_agents_reject_prev <- as.data.frame(NL_table_Uncleanable_Agents$reject_w2wed_prev)
uncleanable_agents_reject_prev$area <- as.factor('reject')
uncleanable_agents_reject_prev$scenario <- as.factor('Uncleanable Agents')
uncleanable_agents_reject_prev$water <- as.factor('Dry')
names(uncleanable_agents_reject_prev) <- c('prevalence','area','scenario','water')

uncleanable_agents_tray_packing_prev <- as.data.frame(NL_table_Uncleanable_Agents$tray_packing_w2wed_prev)
uncleanable_agents_tray_packing_prev$area <- as.factor('tray packing')
uncleanable_agents_tray_packing_prev$scenario <- as.factor('Uncleanable Agents')
uncleanable_agents_tray_packing_prev$water <- as.factor('Dry')
names(uncleanable_agents_tray_packing_prev) <- c('prevalence','area','scenario','water')

uncleanable_agents_other_prev <- as.data.frame(NL_table_Uncleanable_Agents$other_w2wed_prev)
uncleanable_agents_other_prev$area <- as.factor('other')
uncleanable_agents_other_prev$scenario <- as.factor('Uncleanable Agents')
uncleanable_agents_other_prev$water <- as.factor('Dry')
names(uncleanable_agents_other_prev) <- c('prevalence','area','scenario','water')

uncleanable_agents_prev <- rbind(uncleanable_agents_loading_prev,uncleanable_agents_cleaning_prev,uncleanable_agents_sorting_prev,uncleanable_agents_tray_packing_prev,uncleanable_agents_reject_prev,uncleanable_agents_other_prev)
```

```{r import Flume Intervention}
NL_table_Flume_Intervention <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-18-00-37 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Flume_Intervention-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Flume_Intervention <- NL_table_Flume_Intervention[NL_table_Flume_Intervention$scenario==27,]

while (any(grepl('-', names(NL_table_Flume_Intervention), fixed = TRUE))) {
  NL_table_Flume_Intervention <- NL_table_Flume_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Flume_Intervention), fixed = TRUE))) {
  NL_table_Flume_Intervention <- NL_table_Flume_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Flume_Intervention), fixed = TRUE))) {
  NL_table_Flume_Intervention <- NL_table_Flume_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Flume_Intervention), fixed = TRUE))) {
  NL_table_Flume_Intervention <- NL_table_Flume_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Flume_Intervention[ , ..list_columns]

NL_table_Flume_Intervention[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Flume_Intervention <- as.data.frame(NL_table_Flume_Intervention)

NL_table_Flume_Intervention[NL_table_Flume_Intervention==-1] <- NA

NL_table_Flume_Intervention <- subset(NL_table_Flume_Intervention, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Flume_Intervention)[names(NL_table_Flume_Intervention)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Flume_Intervention)[names(NL_table_Flume_Intervention)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Flume_Intervention$loading_w2wed_conc_list[order(NL_table_Flume_Intervention$local_seed)]
vector <- vector[vector!='[]']
flume_intervention_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  flume_intervention_loading_w2wed_conc_list <- append(flume_intervention_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Flume_Intervention$cleaning_w2wed_conc_list[order(NL_table_Flume_Intervention$local_seed)]
vector <- vector[vector!='[]']
flume_intervention_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  flume_intervention_cleaning_w2wed_conc_list <- append(flume_intervention_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Flume_Intervention$drying_w2wed_conc_list[order(NL_table_Flume_Intervention$local_seed)]
vector <- vector[vector!='[]']
flume_intervention_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  flume_intervention_drying_w2wed_conc_list <- append(flume_intervention_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Flume_Intervention$sorting_w2wed_conc_list[order(NL_table_Flume_Intervention$local_seed)]
vector <- vector[vector!='[]']
flume_intervention_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  flume_intervention_sorting_w2wed_conc_list <- append(flume_intervention_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Flume_Intervention$tray_packing_w2wed_conc_list[order(NL_table_Flume_Intervention$local_seed)]
vector <- vector[vector!='[]']
flume_intervention_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  flume_intervention_tray_packing_w2wed_conc_list <- append(flume_intervention_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Flume_Intervention$reject_w2wed_conc_list[order(NL_table_Flume_Intervention$local_seed)]
vector <- vector[vector!='[]']
flume_intervention_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  flume_intervention_reject_w2wed_conc_list <- append(flume_intervention_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Flume_Intervention$other_w2wed_conc_list[order(NL_table_Flume_Intervention$local_seed)]
vector <- vector[vector!='[]']
flume_intervention_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  flume_intervention_other_w2wed_conc_list <- append(flume_intervention_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

flume_intervention_loading_concs <- as.data.frame(flume_intervention_loading_w2wed_conc_list)
flume_intervention_loading_concs$area <- as.factor('loading')
flume_intervention_loading_concs$scenario <- as.factor('AI_01')
flume_intervention_loading_concs$water <- as.factor('Wet')
names(flume_intervention_loading_concs) <- c('concentration','area','scenario','water')

flume_intervention_cleaning_concs <- as.data.frame(flume_intervention_cleaning_w2wed_conc_list)
flume_intervention_cleaning_concs$area <- as.factor('cleaning')
flume_intervention_cleaning_concs$scenario <- as.factor('AI_01')
flume_intervention_cleaning_concs$water <- as.factor('Wet')
names(flume_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

flume_intervention_sorting_concs <- as.data.frame(flume_intervention_sorting_w2wed_conc_list)
flume_intervention_sorting_concs$area <- as.factor('sorting')
flume_intervention_sorting_concs$scenario <- as.factor('AI_01')
flume_intervention_sorting_concs$water <- as.factor('Dry')
names(flume_intervention_sorting_concs) <- c('concentration','area','scenario','water')

flume_intervention_reject_concs <- as.data.frame(flume_intervention_reject_w2wed_conc_list)
flume_intervention_reject_concs$area <- as.factor('reject')
flume_intervention_reject_concs$scenario <- as.factor('AI_01')
flume_intervention_reject_concs$water <- as.factor('Dry')
names(flume_intervention_reject_concs) <- c('concentration','area','scenario','water')

flume_intervention_tray_packing_concs <- as.data.frame(flume_intervention_tray_packing_w2wed_conc_list)
flume_intervention_tray_packing_concs$area <- as.factor('tray packing')
flume_intervention_tray_packing_concs$scenario <- as.factor('AI_01')
flume_intervention_tray_packing_concs$water <- as.factor('Dry')
names(flume_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

flume_intervention_other_concs <- as.data.frame(flume_intervention_other_w2wed_conc_list)
flume_intervention_other_concs$area <- as.factor('other')
flume_intervention_other_concs$scenario <- as.factor('AI_01')
flume_intervention_other_concs$water <- as.factor('Dry')
names(flume_intervention_other_concs) <- c('concentration','area','scenario','water')

flume_intervention_concs <- rbind(flume_intervention_loading_concs,flume_intervention_cleaning_concs,flume_intervention_sorting_concs,flume_intervention_tray_packing_concs,flume_intervention_reject_concs,flume_intervention_other_concs)

flume_intervention_loading_prev <- as.data.frame(NL_table_Flume_Intervention$loading_w2wed_prev[order(NL_table_Flume_Intervention$local_seed)])
flume_intervention_loading_prev$area <- as.factor('loading')
flume_intervention_loading_prev$scenario <- as.factor('AI_01')
flume_intervention_loading_prev$water <- as.factor('Wet')
names(flume_intervention_loading_prev) <- c('prevalence','area','scenario','water')

flume_intervention_cleaning_prev <- as.data.frame(NL_table_Flume_Intervention$cleaning_w2wed_prev[order(NL_table_Flume_Intervention$local_seed)])
flume_intervention_cleaning_prev$area <- as.factor('cleaning')
flume_intervention_cleaning_prev$scenario <- as.factor('AI_01')
flume_intervention_cleaning_prev$water <- as.factor('Wet')
names(flume_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

flume_intervention_sorting_prev <- as.data.frame(NL_table_Flume_Intervention$sorting_w2wed_prev[order(NL_table_Flume_Intervention$local_seed)])
flume_intervention_sorting_prev$area <- as.factor('sorting')
flume_intervention_sorting_prev$scenario <- as.factor('AI_01')
flume_intervention_sorting_prev$water <- as.factor('Dry')
names(flume_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

flume_intervention_reject_prev <- as.data.frame(NL_table_Flume_Intervention$reject_w2wed_prev[order(NL_table_Flume_Intervention$local_seed)])
flume_intervention_reject_prev$area <- as.factor('reject')
flume_intervention_reject_prev$scenario <- as.factor('AI_01')
flume_intervention_reject_prev$water <- as.factor('Dry')
names(flume_intervention_reject_prev) <- c('prevalence','area','scenario','water')

flume_intervention_tray_packing_prev <- as.data.frame(NL_table_Flume_Intervention$tray_packing_w2wed_prev[order(NL_table_Flume_Intervention$local_seed)])
flume_intervention_tray_packing_prev$area <- as.factor('tray packing')
flume_intervention_tray_packing_prev$scenario <- as.factor('AI_01')
flume_intervention_tray_packing_prev$water <- as.factor('Dry')
names(flume_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

flume_intervention_other_prev <- as.data.frame(NL_table_Flume_Intervention$other_w2wed_prev[order(NL_table_Flume_Intervention$local_seed)])
flume_intervention_other_prev$area <- as.factor('other')
flume_intervention_other_prev$scenario <- as.factor('AI_01')
flume_intervention_other_prev$water <- as.factor('Dry')
names(flume_intervention_other_prev) <- c('prevalence','area','scenario','water')

flume_intervention_prev <- rbind(flume_intervention_loading_prev,flume_intervention_cleaning_prev,flume_intervention_sorting_prev,flume_intervention_tray_packing_prev,flume_intervention_reject_prev,flume_intervention_other_prev)

flume_intervention_wet_prev <- as.data.frame(flume_intervention_loading_prev$prevalence*21/100+flume_intervention_cleaning_prev$prevalence*28/100)/49*100
flume_intervention_wet_prev$scenario <- as.factor('AI_01')
flume_intervention_wet_prev$water <- as.factor('Wet')
names(flume_intervention_wet_prev) <- c('prevalence','scenario','water')

flume_intervention_dry_prev <- as.data.frame(flume_intervention_sorting_prev$prevalence*20/100+flume_intervention_reject_prev$prevalence*23/100+flume_intervention_tray_packing_prev$prevalence*123/100+flume_intervention_other_prev$prevalence*10/100)/176*100
flume_intervention_dry_prev$scenario <- as.factor('AI_01')
flume_intervention_dry_prev$water <- as.factor('Dry')
names(flume_intervention_dry_prev) <- c('prevalence','scenario','water')

flume_intervention_recombined_prev <- rbind(flume_intervention_wet_prev, flume_intervention_dry_prev)

flume_intervention_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(flume_intervention_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('AI_01'),
  as.factor(baseline_recombined_prev$water)
)
colnames(flume_intervention_eff_prev)<- c('prevalence', 'scenario', 'water')

flume_intervention_z1_prev <- as.data.frame(NL_table_Flume_Intervention$z1_w2wed_prev)
flume_intervention_z1_prev$zone <- as.factor('Z1')
flume_intervention_z1_prev$scenario <- as.factor('AI_01')
names(flume_intervention_z1_prev) <- c('prevalence','zone','scenario')

flume_intervention_z2_prev <- as.data.frame(NL_table_Flume_Intervention$z2_w2wed_prev)
flume_intervention_z2_prev$zone <- as.factor('Z2')
flume_intervention_z2_prev$scenario <- as.factor('AI_01')
names(flume_intervention_z2_prev) <- c('prevalence','zone','scenario')

flume_intervention_z3_prev <- as.data.frame(NL_table_Flume_Intervention$z2_w2wed_prev)
flume_intervention_z3_prev$zone <- as.factor('Z3')
flume_intervention_z3_prev$scenario <- as.factor('AI_01')
names(flume_intervention_z3_prev) <- c('prevalence','zone','scenario')

flume_intervention_zone_prev <- rbind(flume_intervention_z1_prev,flume_intervention_z2_prev,flume_intervention_z3_prev)
```

```{r import Deep Clean Intervention}
NL_table_Deep_Clean_Intervention <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-20-03-50 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Sanitation_Effectiveness_Improvement-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Deep_Clean_Intervention <- NL_table_Deep_Clean_Intervention[NL_table_Deep_Clean_Intervention$scenario==28,]

while (any(grepl('-', names(NL_table_Deep_Clean_Intervention), fixed = TRUE))) {
  NL_table_Deep_Clean_Intervention <- NL_table_Deep_Clean_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Deep_Clean_Intervention), fixed = TRUE))) {
  NL_table_Deep_Clean_Intervention <- NL_table_Deep_Clean_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Deep_Clean_Intervention), fixed = TRUE))) {
  NL_table_Deep_Clean_Intervention <- NL_table_Deep_Clean_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Deep_Clean_Intervention), fixed = TRUE))) {
  NL_table_Deep_Clean_Intervention <- NL_table_Deep_Clean_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Deep_Clean_Intervention[ , ..list_columns]

NL_table_Deep_Clean_Intervention[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Deep_Clean_Intervention <- as.data.frame(NL_table_Deep_Clean_Intervention)

NL_table_Deep_Clean_Intervention[NL_table_Deep_Clean_Intervention==-1] <- NA

NL_table_Deep_Clean_Intervention <- subset(NL_table_Deep_Clean_Intervention, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Deep_Clean_Intervention)[names(NL_table_Deep_Clean_Intervention)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Deep_Clean_Intervention)[names(NL_table_Deep_Clean_Intervention)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Deep_Clean_Intervention$loading_w2wed_conc_list[order(NL_table_Deep_Clean_Intervention$local_seed)]
vector <- vector[vector!='[]']
deep_clean_intervention_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  deep_clean_intervention_loading_w2wed_conc_list <- append(deep_clean_intervention_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Deep_Clean_Intervention$cleaning_w2wed_conc_list[order(NL_table_Deep_Clean_Intervention$local_seed)]
vector <- vector[vector!='[]']
deep_clean_intervention_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  deep_clean_intervention_cleaning_w2wed_conc_list <- append(deep_clean_intervention_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Deep_Clean_Intervention$drying_w2wed_conc_list[order(NL_table_Deep_Clean_Intervention$local_seed)]
vector <- vector[vector!='[]']
deep_clean_intervention_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  deep_clean_intervention_drying_w2wed_conc_list <- append(deep_clean_intervention_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Deep_Clean_Intervention$sorting_w2wed_conc_list[order(NL_table_Deep_Clean_Intervention$local_seed)]
vector <- vector[vector!='[]']
deep_clean_intervention_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  deep_clean_intervention_sorting_w2wed_conc_list <- append(deep_clean_intervention_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Deep_Clean_Intervention$tray_packing_w2wed_conc_list[order(NL_table_Deep_Clean_Intervention$local_seed)]
vector <- vector[vector!='[]']
deep_clean_intervention_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  deep_clean_intervention_tray_packing_w2wed_conc_list <- append(deep_clean_intervention_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Deep_Clean_Intervention$reject_w2wed_conc_list[order(NL_table_Deep_Clean_Intervention$local_seed)]
vector <- vector[vector!='[]']
deep_clean_intervention_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  deep_clean_intervention_reject_w2wed_conc_list <- append(deep_clean_intervention_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Deep_Clean_Intervention$other_w2wed_conc_list[order(NL_table_Deep_Clean_Intervention$local_seed)]
vector <- vector[vector!='[]']
deep_clean_intervention_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  deep_clean_intervention_other_w2wed_conc_list <- append(deep_clean_intervention_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

deep_clean_intervention_loading_concs <- as.data.frame(deep_clean_intervention_loading_w2wed_conc_list)
deep_clean_intervention_loading_concs$area <- as.factor('loading')
deep_clean_intervention_loading_concs$scenario <- as.factor('MI_02')
deep_clean_intervention_loading_concs$water <- as.factor('Wet')
names(deep_clean_intervention_loading_concs) <- c('concentration','area','scenario','water')

deep_clean_intervention_cleaning_concs <- as.data.frame(deep_clean_intervention_cleaning_w2wed_conc_list)
deep_clean_intervention_cleaning_concs$area <- as.factor('cleaning')
deep_clean_intervention_cleaning_concs$scenario <- as.factor('MI_02')
deep_clean_intervention_cleaning_concs$water <- as.factor('Wet')
names(deep_clean_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

deep_clean_intervention_sorting_concs <- as.data.frame(deep_clean_intervention_sorting_w2wed_conc_list)
deep_clean_intervention_sorting_concs$area <- as.factor('sorting')
deep_clean_intervention_sorting_concs$scenario <- as.factor('MI_02')
deep_clean_intervention_sorting_concs$water <- as.factor('Dry')
names(deep_clean_intervention_sorting_concs) <- c('concentration','area','scenario','water')

deep_clean_intervention_reject_concs <- as.data.frame(deep_clean_intervention_reject_w2wed_conc_list)
deep_clean_intervention_reject_concs$area <- as.factor('reject')
deep_clean_intervention_reject_concs$scenario <- as.factor('MI_02')
deep_clean_intervention_reject_concs$water <- as.factor('Dry')
names(deep_clean_intervention_reject_concs) <- c('concentration','area','scenario','water')

deep_clean_intervention_tray_packing_concs <- as.data.frame(deep_clean_intervention_tray_packing_w2wed_conc_list)
deep_clean_intervention_tray_packing_concs$area <- as.factor('tray packing')
deep_clean_intervention_tray_packing_concs$scenario <- as.factor('MI_02')
deep_clean_intervention_tray_packing_concs$water <- as.factor('Dry')
names(deep_clean_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

deep_clean_intervention_other_concs <- as.data.frame(deep_clean_intervention_other_w2wed_conc_list)
deep_clean_intervention_other_concs$area <- as.factor('other')
deep_clean_intervention_other_concs$scenario <- as.factor('MI_02')
deep_clean_intervention_other_concs$water <- as.factor('Dry')
names(deep_clean_intervention_other_concs) <- c('concentration','area','scenario','water')

deep_clean_intervention_concs <- rbind(deep_clean_intervention_loading_concs,deep_clean_intervention_cleaning_concs,deep_clean_intervention_sorting_concs,deep_clean_intervention_tray_packing_concs,deep_clean_intervention_reject_concs,deep_clean_intervention_other_concs)

deep_clean_intervention_loading_prev <- as.data.frame(NL_table_Deep_Clean_Intervention$loading_w2wed_prev[order(NL_table_Deep_Clean_Intervention$local_seed)])
deep_clean_intervention_loading_prev$area <- as.factor('loading')
deep_clean_intervention_loading_prev$scenario <- as.factor('MI_02')
deep_clean_intervention_loading_prev$water <- as.factor('Wet')
names(deep_clean_intervention_loading_prev) <- c('prevalence','area','scenario','water')

deep_clean_intervention_cleaning_prev <- as.data.frame(NL_table_Deep_Clean_Intervention$cleaning_w2wed_prev[order(NL_table_Deep_Clean_Intervention$local_seed)])
deep_clean_intervention_cleaning_prev$area <- as.factor('cleaning')
deep_clean_intervention_cleaning_prev$scenario <- as.factor('MI_02')
deep_clean_intervention_cleaning_prev$water <- as.factor('Wet')
names(deep_clean_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

deep_clean_intervention_sorting_prev <- as.data.frame(NL_table_Deep_Clean_Intervention$sorting_w2wed_prev[order(NL_table_Deep_Clean_Intervention$local_seed)])
deep_clean_intervention_sorting_prev$area <- as.factor('sorting')
deep_clean_intervention_sorting_prev$scenario <- as.factor('MI_02')
deep_clean_intervention_sorting_prev$water <- as.factor('Dry')
names(deep_clean_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

deep_clean_intervention_reject_prev <- as.data.frame(NL_table_Deep_Clean_Intervention$reject_w2wed_prev[order(NL_table_Deep_Clean_Intervention$local_seed)])
deep_clean_intervention_reject_prev$area <- as.factor('reject')
deep_clean_intervention_reject_prev$scenario <- as.factor('MI_02')
deep_clean_intervention_reject_prev$water <- as.factor('Dry')
names(deep_clean_intervention_reject_prev) <- c('prevalence','area','scenario','water')

deep_clean_intervention_tray_packing_prev <- as.data.frame(NL_table_Deep_Clean_Intervention$tray_packing_w2wed_prev[order(NL_table_Deep_Clean_Intervention$local_seed)])
deep_clean_intervention_tray_packing_prev$area <- as.factor('tray packing')
deep_clean_intervention_tray_packing_prev$scenario <- as.factor('MI_02')
deep_clean_intervention_tray_packing_prev$water <- as.factor('Dry')
names(deep_clean_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

deep_clean_intervention_other_prev <- as.data.frame(NL_table_Deep_Clean_Intervention$other_w2wed_prev[order(NL_table_Deep_Clean_Intervention$local_seed)])
deep_clean_intervention_other_prev$area <- as.factor('other')
deep_clean_intervention_other_prev$scenario <- as.factor('MI_02')
deep_clean_intervention_other_prev$water <- as.factor('Dry')
names(deep_clean_intervention_other_prev) <- c('prevalence','area','scenario','water')

deep_clean_intervention_prev <- rbind(deep_clean_intervention_loading_prev,deep_clean_intervention_cleaning_prev,deep_clean_intervention_sorting_prev,deep_clean_intervention_tray_packing_prev,deep_clean_intervention_reject_prev,deep_clean_intervention_other_prev)

deep_clean_intervention_wet_prev <- as.data.frame(deep_clean_intervention_loading_prev$prevalence*21/100+deep_clean_intervention_cleaning_prev$prevalence*28/100)/49*100
deep_clean_intervention_wet_prev$scenario <- as.factor('MI_02')
deep_clean_intervention_wet_prev$water <- as.factor('Wet')
names(deep_clean_intervention_wet_prev) <- c('prevalence','scenario','water')

deep_clean_intervention_dry_prev <- as.data.frame(deep_clean_intervention_sorting_prev$prevalence*20/100+deep_clean_intervention_reject_prev$prevalence*23/100+deep_clean_intervention_tray_packing_prev$prevalence*123/100+deep_clean_intervention_other_prev$prevalence*10/100)/176*100
deep_clean_intervention_dry_prev$scenario <- as.factor('MI_02')
deep_clean_intervention_dry_prev$water <- as.factor('Dry')
names(deep_clean_intervention_dry_prev) <- c('prevalence','scenario','water')

deep_clean_intervention_recombined_prev <- rbind(deep_clean_intervention_wet_prev, deep_clean_intervention_dry_prev)

deep_clean_intervention_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(deep_clean_intervention_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('MI_02'),
  as.factor(baseline_recombined_prev$water)
)
colnames(deep_clean_intervention_eff_prev)<- c('prevalence', 'scenario', 'water')

deep_clean_intervention_z1_prev <- as.data.frame(NL_table_Deep_Clean_Intervention$z1_w2wed_prev)
deep_clean_intervention_z1_prev$zone <- as.factor('Z1')
deep_clean_intervention_z1_prev$scenario <- as.factor('MI_02')
names(deep_clean_intervention_z1_prev) <- c('prevalence','zone','scenario')

deep_clean_intervention_z2_prev <- as.data.frame(NL_table_Deep_Clean_Intervention$z2_w2wed_prev)
deep_clean_intervention_z2_prev$zone <- as.factor('Z2')
deep_clean_intervention_z2_prev$scenario <- as.factor('MI_02')
names(deep_clean_intervention_z2_prev) <- c('prevalence','zone','scenario')

deep_clean_intervention_z3_prev <- as.data.frame(NL_table_Deep_Clean_Intervention$z2_w2wed_prev)
deep_clean_intervention_z3_prev$zone <- as.factor('Z3')
deep_clean_intervention_z3_prev$scenario <- as.factor('MI_02')
names(deep_clean_intervention_z3_prev) <- c('prevalence','zone','scenario')

deep_clean_intervention_zone_prev <- rbind(deep_clean_intervention_z1_prev,deep_clean_intervention_z2_prev,deep_clean_intervention_z3_prev)
```

```{r import Full Risk-Based Intervention with Washing & Sanitation Intervention}
NL_table_Prob_Intervention <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-18-21-26 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Risk-Based_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Prob_Intervention <- NL_table_Prob_Intervention[NL_table_Prob_Intervention$scenario==25,]

while (any(grepl('-', names(NL_table_Prob_Intervention), fixed = TRUE))) {
  NL_table_Prob_Intervention <- NL_table_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Prob_Intervention), fixed = TRUE))) {
  NL_table_Prob_Intervention <- NL_table_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Prob_Intervention), fixed = TRUE))) {
  NL_table_Prob_Intervention <- NL_table_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Prob_Intervention), fixed = TRUE))) {
  NL_table_Prob_Intervention <- NL_table_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Prob_Intervention[ , ..list_columns]

NL_table_Prob_Intervention[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Prob_Intervention <- as.data.frame(NL_table_Prob_Intervention)

NL_table_Prob_Intervention[NL_table_Prob_Intervention==-1] <- NA

NL_table_Prob_Intervention <- subset(NL_table_Prob_Intervention, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Prob_Intervention)[names(NL_table_Prob_Intervention)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Prob_Intervention)[names(NL_table_Prob_Intervention)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Prob_Intervention$loading_w2wed_conc_list[order(NL_table_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
prob_intervention_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_loading_w2wed_conc_list <- append(prob_intervention_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Prob_Intervention$cleaning_w2wed_conc_list[order(NL_table_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
prob_intervention_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_cleaning_w2wed_conc_list <- append(prob_intervention_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Prob_Intervention$drying_w2wed_conc_list[order(NL_table_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
prob_intervention_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_drying_w2wed_conc_list <- append(prob_intervention_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Prob_Intervention$sorting_w2wed_conc_list[order(NL_table_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
prob_intervention_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_sorting_w2wed_conc_list <- append(prob_intervention_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Prob_Intervention$tray_packing_w2wed_conc_list[order(NL_table_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
prob_intervention_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_tray_packing_w2wed_conc_list <- append(prob_intervention_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Prob_Intervention$reject_w2wed_conc_list[order(NL_table_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
prob_intervention_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_reject_w2wed_conc_list <- append(prob_intervention_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Prob_Intervention$other_w2wed_conc_list[order(NL_table_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
prob_intervention_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_other_w2wed_conc_list <- append(prob_intervention_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

prob_intervention_loading_concs <- as.data.frame(prob_intervention_loading_w2wed_conc_list)
prob_intervention_loading_concs$area <- as.factor('loading')
prob_intervention_loading_concs$scenario <- as.factor('AI_02')
prob_intervention_loading_concs$water <- as.factor('Wet')
names(prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

prob_intervention_cleaning_concs <- as.data.frame(prob_intervention_cleaning_w2wed_conc_list)
prob_intervention_cleaning_concs$area <- as.factor('cleaning')
prob_intervention_cleaning_concs$scenario <- as.factor('AI_02')
prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

prob_intervention_sorting_concs <- as.data.frame(prob_intervention_sorting_w2wed_conc_list)
prob_intervention_sorting_concs$area <- as.factor('sorting')
prob_intervention_sorting_concs$scenario <- as.factor('AI_02')
prob_intervention_sorting_concs$water <- as.factor('Dry')
names(prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

prob_intervention_reject_concs <- as.data.frame(prob_intervention_reject_w2wed_conc_list)
prob_intervention_reject_concs$area <- as.factor('reject')
prob_intervention_reject_concs$scenario <- as.factor('AI_02')
prob_intervention_reject_concs$water <- as.factor('Dry')
names(prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

prob_intervention_tray_packing_concs <- as.data.frame(prob_intervention_tray_packing_w2wed_conc_list)
prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
prob_intervention_tray_packing_concs$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

prob_intervention_other_concs <- as.data.frame(prob_intervention_other_w2wed_conc_list)
prob_intervention_other_concs$area <- as.factor('other')
prob_intervention_other_concs$scenario <- as.factor('AI_02')
prob_intervention_other_concs$water <- as.factor('Dry')
names(prob_intervention_other_concs) <- c('concentration','area','scenario','water')

prob_intervention_concs <- rbind(prob_intervention_loading_concs,prob_intervention_cleaning_concs,prob_intervention_sorting_concs,prob_intervention_tray_packing_concs,prob_intervention_reject_concs,prob_intervention_other_concs)

prob_intervention_loading_prev <- as.data.frame(NL_table_Prob_Intervention$loading_w2wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_loading_prev$area <- as.factor('loading')
prob_intervention_loading_prev$scenario <- as.factor('AI_02')
prob_intervention_loading_prev$water <- as.factor('Wet')
names(prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

prob_intervention_cleaning_prev <- as.data.frame(NL_table_Prob_Intervention$cleaning_w2wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_cleaning_prev$area <- as.factor('cleaning')
prob_intervention_cleaning_prev$scenario <- as.factor('AI_02')
prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

prob_intervention_sorting_prev <- as.data.frame(NL_table_Prob_Intervention$sorting_w2wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_sorting_prev$area <- as.factor('sorting')
prob_intervention_sorting_prev$scenario <- as.factor('AI_02')
prob_intervention_sorting_prev$water <- as.factor('Dry')
names(prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

prob_intervention_reject_prev <- as.data.frame(NL_table_Prob_Intervention$reject_w2wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_reject_prev$area <- as.factor('reject')
prob_intervention_reject_prev$scenario <- as.factor('AI_02')
prob_intervention_reject_prev$water <- as.factor('Dry')
names(prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Prob_Intervention$tray_packing_w2wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
prob_intervention_tray_packing_prev$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

prob_intervention_other_prev <- as.data.frame(NL_table_Prob_Intervention$other_w2wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_other_prev$area <- as.factor('other')
prob_intervention_other_prev$scenario <- as.factor('AI_02')
prob_intervention_other_prev$water <- as.factor('Dry')
names(prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

prob_intervention_prev <- rbind(prob_intervention_loading_prev,prob_intervention_cleaning_prev,prob_intervention_sorting_prev,prob_intervention_tray_packing_prev,prob_intervention_reject_prev,prob_intervention_other_prev)

prob_intervention_wet_prev <- as.data.frame(prob_intervention_loading_prev$prevalence*21/100+prob_intervention_cleaning_prev$prevalence*28/100)/49*100
prob_intervention_wet_prev$scenario <- as.factor('AI_02')
prob_intervention_wet_prev$water <- as.factor('Wet')
names(prob_intervention_wet_prev) <- c('prevalence','scenario','water')

prob_intervention_dry_prev <- as.data.frame(prob_intervention_sorting_prev$prevalence*20/100+prob_intervention_reject_prev$prevalence*23/100+prob_intervention_tray_packing_prev$prevalence*123/100+prob_intervention_other_prev$prevalence*10/100)/176*100
prob_intervention_dry_prev$scenario <- as.factor('AI_02')
prob_intervention_dry_prev$water <- as.factor('Dry')
names(prob_intervention_dry_prev) <- c('prevalence','scenario','water')

prob_intervention_recombined_prev <- rbind(prob_intervention_wet_prev, prob_intervention_dry_prev)

prob_intervention_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(prob_intervention_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('AI_02'),
  as.factor(baseline_recombined_prev$water)
)
colnames(prob_intervention_eff_prev)<- c('prevalence', 'scenario', 'water')

prob_intervention_z1_prev <- as.data.frame(NL_table_Prob_Intervention$z1_w2wed_prev)
prob_intervention_z1_prev$zone <- as.factor('Z1')
prob_intervention_z1_prev$scenario <- as.factor('AI_02')
names(prob_intervention_z1_prev) <- c('prevalence','zone','scenario')

prob_intervention_z2_prev <- as.data.frame(NL_table_Prob_Intervention$z2_w2wed_prev)
prob_intervention_z2_prev$zone <- as.factor('Z2')
prob_intervention_z2_prev$scenario <- as.factor('AI_02')
names(prob_intervention_z2_prev) <- c('prevalence','zone','scenario')

prob_intervention_z3_prev <- as.data.frame(NL_table_Prob_Intervention$z2_w2wed_prev)
prob_intervention_z3_prev$zone <- as.factor('Z3')
prob_intervention_z3_prev$scenario <- as.factor('AI_02')
names(prob_intervention_z3_prev) <- c('prevalence','zone','scenario')

prob_intervention_zone_prev <- rbind(prob_intervention_z1_prev,prob_intervention_z2_prev,prob_intervention_z3_prev)
```

```{r import Partial Risk-Based Intervention with Washing & Sanitation}
NL_table_Partial_Prob_Intervention <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-18-21-26 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Risk-Based_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Partial_Prob_Intervention <- NL_table_Partial_Prob_Intervention[NL_table_Partial_Prob_Intervention$scenario==29,]

while (any(grepl('-', names(NL_table_Partial_Prob_Intervention), fixed = TRUE))) {
  NL_table_Partial_Prob_Intervention <- NL_table_Partial_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Partial_Prob_Intervention), fixed = TRUE))) {
  NL_table_Partial_Prob_Intervention <- NL_table_Partial_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Partial_Prob_Intervention), fixed = TRUE))) {
  NL_table_Partial_Prob_Intervention <- NL_table_Partial_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Partial_Prob_Intervention), fixed = TRUE))) {
  NL_table_Partial_Prob_Intervention <- NL_table_Partial_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Partial_Prob_Intervention[ , ..list_columns]

NL_table_Partial_Prob_Intervention[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Partial_Prob_Intervention <- as.data.frame(NL_table_Partial_Prob_Intervention)

NL_table_Partial_Prob_Intervention[NL_table_Partial_Prob_Intervention==-1] <- NA

NL_table_Partial_Prob_Intervention <- subset(NL_table_Partial_Prob_Intervention, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Partial_Prob_Intervention)[names(NL_table_Partial_Prob_Intervention)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Partial_Prob_Intervention)[names(NL_table_Partial_Prob_Intervention)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Partial_Prob_Intervention$loading_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_loading_w2wed_conc_list <- append(partial_prob_intervention_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Partial_Prob_Intervention$cleaning_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_cleaning_w2wed_conc_list <- append(partial_prob_intervention_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Partial_Prob_Intervention$drying_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_drying_w2wed_conc_list <- append(partial_prob_intervention_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Partial_Prob_Intervention$sorting_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_sorting_w2wed_conc_list <- append(partial_prob_intervention_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Partial_Prob_Intervention$tray_packing_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_tray_packing_w2wed_conc_list <- append(partial_prob_intervention_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Partial_Prob_Intervention$reject_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_reject_w2wed_conc_list <- append(partial_prob_intervention_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Partial_Prob_Intervention$other_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_other_w2wed_conc_list <- append(partial_prob_intervention_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

partial_prob_intervention_loading_concs <- as.data.frame(partial_prob_intervention_loading_w2wed_conc_list)
partial_prob_intervention_loading_concs$area <- as.factor('loading')
partial_prob_intervention_loading_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_concs$water <- as.factor('Wet')
names(partial_prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_cleaning_concs <- as.data.frame(partial_prob_intervention_cleaning_w2wed_conc_list)
partial_prob_intervention_cleaning_concs$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_sorting_concs <- as.data.frame(partial_prob_intervention_sorting_w2wed_conc_list)
partial_prob_intervention_sorting_concs$area <- as.factor('sorting')
partial_prob_intervention_sorting_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_concs$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_reject_concs <- as.data.frame(partial_prob_intervention_reject_w2wed_conc_list)
partial_prob_intervention_reject_concs$area <- as.factor('reject')
partial_prob_intervention_reject_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_concs$water <- as.factor('Dry')
names(partial_prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_tray_packing_concs <- as.data.frame(partial_prob_intervention_tray_packing_w2wed_conc_list)
partial_prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_other_concs <- as.data.frame(partial_prob_intervention_other_w2wed_conc_list)
partial_prob_intervention_other_concs$area <- as.factor('other')
partial_prob_intervention_other_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_other_concs$water <- as.factor('Dry')
names(partial_prob_intervention_other_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_concs <- rbind(partial_prob_intervention_loading_concs,partial_prob_intervention_cleaning_concs,partial_prob_intervention_sorting_concs,partial_prob_intervention_tray_packing_concs,partial_prob_intervention_reject_concs,partial_prob_intervention_other_concs)

partial_prob_intervention_loading_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$loading_w2wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_loading_prev$area <- as.factor('loading')
partial_prob_intervention_loading_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_prev$water <- as.factor('Wet')
names(partial_prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_cleaning_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$cleaning_w2wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_cleaning_prev$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_sorting_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$sorting_w2wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_sorting_prev$area <- as.factor('sorting')
partial_prob_intervention_sorting_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_prev$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_reject_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$reject_w2wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_reject_prev$area <- as.factor('reject')
partial_prob_intervention_reject_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_prev$water <- as.factor('Dry')
names(partial_prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$tray_packing_w2wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_other_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$other_w2wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_other_prev$area <- as.factor('other')
partial_prob_intervention_other_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_other_prev$water <- as.factor('Dry')
names(partial_prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_prev <- rbind(partial_prob_intervention_loading_prev,partial_prob_intervention_cleaning_prev,partial_prob_intervention_sorting_prev,partial_prob_intervention_tray_packing_prev,partial_prob_intervention_reject_prev,partial_prob_intervention_other_prev)

partial_prob_intervention_wet_prev <- as.data.frame(partial_prob_intervention_loading_prev$prevalence*21/100+partial_prob_intervention_cleaning_prev$prevalence*28/100)/49*100
partial_prob_intervention_wet_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_wet_prev$water <- as.factor('Wet')
names(partial_prob_intervention_wet_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_dry_prev <- as.data.frame(partial_prob_intervention_sorting_prev$prevalence*20/100+partial_prob_intervention_reject_prev$prevalence*23/100+partial_prob_intervention_tray_packing_prev$prevalence*123/100+partial_prob_intervention_other_prev$prevalence*10/100)/176*100
partial_prob_intervention_dry_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_dry_prev$water <- as.factor('Dry')
names(partial_prob_intervention_dry_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_recombined_prev <- rbind(partial_prob_intervention_wet_prev, partial_prob_intervention_dry_prev)

partial_prob_intervention_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(partial_prob_intervention_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('AI_03'),
  as.factor(baseline_recombined_prev$water)
)
colnames(partial_prob_intervention_eff_prev)<- c('prevalence', 'scenario', 'water')

partial_prob_intervention_z1_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$z1_w2wed_prev)
partial_prob_intervention_z1_prev$zone <- as.factor('Z1')
partial_prob_intervention_z1_prev$scenario <- as.factor('AI_03')
names(partial_prob_intervention_z1_prev) <- c('prevalence','zone','scenario')

partial_prob_intervention_z2_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$z2_w2wed_prev)
partial_prob_intervention_z2_prev$zone <- as.factor('Z2')
partial_prob_intervention_z2_prev$scenario <- as.factor('AI_03')
names(partial_prob_intervention_z2_prev) <- c('prevalence','zone','scenario')

partial_prob_intervention_z3_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$z2_w2wed_prev)
partial_prob_intervention_z3_prev$zone <- as.factor('Z3')
partial_prob_intervention_z3_prev$scenario <- as.factor('AI_03')
names(partial_prob_intervention_z3_prev) <- c('prevalence','zone','scenario')

partial_prob_intervention_zone_prev <- rbind(partial_prob_intervention_z1_prev,partial_prob_intervention_z2_prev,partial_prob_intervention_z3_prev)
```

```{r import Random Event Occurences 150% Delay Period}
NL_table_Random_Prob_150pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-14-01-23 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_P_Random_Event_Occurrences_31-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Prob_150pc <- NL_table_Random_Prob_150pc[NL_table_Random_Prob_150pc$scenario==31,]

while (any(grepl('-', names(NL_table_Random_Prob_150pc), fixed = TRUE))) {
  NL_table_Random_Prob_150pc <- NL_table_Random_Prob_150pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Prob_150pc), fixed = TRUE))) {
  NL_table_Random_Prob_150pc <- NL_table_Random_Prob_150pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Prob_150pc), fixed = TRUE))) {
  NL_table_Random_Prob_150pc <- NL_table_Random_Prob_150pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Prob_150pc), fixed = TRUE))) {
  NL_table_Random_Prob_150pc <- NL_table_Random_Prob_150pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Prob_150pc[ , ..list_columns]

NL_table_Random_Prob_150pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Prob_150pc <- as.data.frame(NL_table_Random_Prob_150pc)

NL_table_Random_Prob_150pc[NL_table_Random_Prob_150pc==-1] <- NA

NL_table_Random_Prob_150pc <- subset(NL_table_Random_Prob_150pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Prob_150pc)[names(NL_table_Random_Prob_150pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Prob_150pc)[names(NL_table_Random_Prob_150pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Random_Prob_150pc$loading_w2wed_conc_list[order(NL_table_Random_Prob_150pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_150pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_loading_w2wed_conc_list <- append(random_prob_150pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_150pc$cleaning_w2wed_conc_list[order(NL_table_Random_Prob_150pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_150pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_cleaning_w2wed_conc_list <- append(random_prob_150pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_150pc$drying_w2wed_conc_list[order(NL_table_Random_Prob_150pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_150pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_drying_w2wed_conc_list <- append(random_prob_150pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_150pc$sorting_w2wed_conc_list[order(NL_table_Random_Prob_150pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_150pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_sorting_w2wed_conc_list <- append(random_prob_150pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_150pc$tray_packing_w2wed_conc_list[order(NL_table_Random_Prob_150pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_150pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_tray_packing_w2wed_conc_list <- append(random_prob_150pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_150pc$bag_packing_w2wed_conc_list[order(NL_table_Random_Prob_150pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_150pc_bag_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_bag_packing_w2wed_conc_list <- append(random_prob_150pc_bag_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_150pc$reject_w2wed_conc_list[order(NL_table_Random_Prob_150pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_150pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_reject_w2wed_conc_list <- append(random_prob_150pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_150pc$other_w2wed_conc_list[order(NL_table_Random_Prob_150pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_150pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_other_w2wed_conc_list <- append(random_prob_150pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

random_prob_150pc_loading_concs <- as.data.frame(random_prob_150pc_loading_w2wed_conc_list)
random_prob_150pc_loading_concs$area <- as.factor('loading')
random_prob_150pc_loading_concs$scenario <- as.factor('PR_01')
random_prob_150pc_loading_concs$water <- as.factor('Wet')
names(random_prob_150pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_cleaning_concs <- as.data.frame(random_prob_150pc_cleaning_w2wed_conc_list)
random_prob_150pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_150pc_cleaning_concs$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_sorting_concs <- as.data.frame(random_prob_150pc_sorting_w2wed_conc_list)
random_prob_150pc_sorting_concs$area <- as.factor('sorting')
random_prob_150pc_sorting_concs$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_150pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_reject_concs <- as.data.frame(random_prob_150pc_reject_w2wed_conc_list)
random_prob_150pc_reject_concs$area <- as.factor('reject')
random_prob_150pc_reject_concs$scenario <- as.factor('PR_01')
random_prob_150pc_reject_concs$water <- as.factor('Dry')
names(random_prob_150pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_tray_packing_concs <- as.data.frame(random_prob_150pc_tray_packing_w2wed_conc_list)
random_prob_150pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_concs$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_other_concs <- as.data.frame(random_prob_150pc_other_w2wed_conc_list)
random_prob_150pc_other_concs$area <- as.factor('other')
random_prob_150pc_other_concs$scenario <- as.factor('PR_01')
random_prob_150pc_other_concs$water <- as.factor('Dry')
names(random_prob_150pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_concs <- rbind(random_prob_150pc_loading_concs,random_prob_150pc_cleaning_concs,random_prob_150pc_sorting_concs,random_prob_150pc_tray_packing_concs,random_prob_150pc_reject_concs,random_prob_150pc_other_concs)

random_prob_150pc_loading_prev <- as.data.frame(NL_table_Random_Prob_150pc$loading_w2wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_loading_prev$area <- as.factor('loading')
random_prob_150pc_loading_prev$scenario <- as.factor('PR_01')
random_prob_150pc_loading_prev$water <- as.factor('Wet')
names(random_prob_150pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_150pc$cleaning_w2wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_150pc_cleaning_prev$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_150pc$sorting_w2wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_sorting_prev$area <- as.factor('sorting')
random_prob_150pc_sorting_prev$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_150pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_reject_prev <- as.data.frame(NL_table_Random_Prob_150pc$reject_w2wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_reject_prev$area <- as.factor('reject')
random_prob_150pc_reject_prev$scenario <- as.factor('PR_01')
random_prob_150pc_reject_prev$water <- as.factor('Dry')
names(random_prob_150pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_150pc$tray_packing_w2wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_prev$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_other_prev <- as.data.frame(NL_table_Random_Prob_150pc$other_w2wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_other_prev$area <- as.factor('other')
random_prob_150pc_other_prev$scenario <- as.factor('PR_01')
random_prob_150pc_other_prev$water <- as.factor('Dry')
names(random_prob_150pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_prev <- rbind(random_prob_150pc_loading_prev,random_prob_150pc_cleaning_prev,random_prob_150pc_sorting_prev,random_prob_150pc_tray_packing_prev,random_prob_150pc_reject_prev,random_prob_150pc_other_prev)

random_prob_150pc_wet_prev <- as.data.frame(random_prob_150pc_loading_prev$prevalence*21/100+random_prob_150pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_150pc_wet_prev$scenario <- as.factor('PR_01')
random_prob_150pc_wet_prev$water <- as.factor('Wet')
names(random_prob_150pc_wet_prev) <- c('prevalence','scenario','water')

random_prob_150pc_dry_prev <- as.data.frame(random_prob_150pc_sorting_prev$prevalence*20/100+random_prob_150pc_reject_prev$prevalence*23/100+random_prob_150pc_tray_packing_prev$prevalence*123/100+random_prob_150pc_other_prev$prevalence*10/100)/176*100
random_prob_150pc_dry_prev$scenario <- as.factor('PR_01')
random_prob_150pc_dry_prev$water <- as.factor('Dry')
names(random_prob_150pc_dry_prev) <- c('prevalence','scenario','water')

random_prob_150pc_recombined_prev <- rbind(random_prob_150pc_wet_prev, random_prob_150pc_dry_prev)

random_prob_150pc_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(random_prob_150pc_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('PR_01'),
  as.factor(baseline_recombined_prev$water)
)
colnames(random_prob_150pc_eff_prev)<- c('prevalence', 'scenario', 'water')
```

```{r import Random Event Occurences 200% Delay Period}
NL_table_Random_Prob_200pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-14-01-23 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_P_Random_Event_Occurrences_32-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Prob_200pc <- NL_table_Random_Prob_200pc[NL_table_Random_Prob_200pc$scenario==32,]

while (any(grepl('-', names(NL_table_Random_Prob_200pc), fixed = TRUE))) {
  NL_table_Random_Prob_200pc <- NL_table_Random_Prob_200pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Prob_200pc), fixed = TRUE))) {
  NL_table_Random_Prob_200pc <- NL_table_Random_Prob_200pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Prob_200pc), fixed = TRUE))) {
  NL_table_Random_Prob_200pc <- NL_table_Random_Prob_200pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Prob_200pc), fixed = TRUE))) {
  NL_table_Random_Prob_200pc <- NL_table_Random_Prob_200pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Prob_200pc[ , ..list_columns]

NL_table_Random_Prob_200pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Prob_200pc <- as.data.frame(NL_table_Random_Prob_200pc)

NL_table_Random_Prob_200pc[NL_table_Random_Prob_200pc==-1] <- NA

NL_table_Random_Prob_200pc <- subset(NL_table_Random_Prob_200pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Prob_200pc)[names(NL_table_Random_Prob_200pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Prob_200pc)[names(NL_table_Random_Prob_200pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Random_Prob_200pc$loading_w2wed_conc_list[order(NL_table_Random_Prob_200pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_200pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_loading_w2wed_conc_list <- append(random_prob_200pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_200pc$cleaning_w2wed_conc_list[order(NL_table_Random_Prob_200pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_200pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_cleaning_w2wed_conc_list <- append(random_prob_200pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_200pc$drying_w2wed_conc_list[order(NL_table_Random_Prob_200pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_200pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_drying_w2wed_conc_list <- append(random_prob_200pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_200pc$sorting_w2wed_conc_list[order(NL_table_Random_Prob_200pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_200pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_sorting_w2wed_conc_list <- append(random_prob_200pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_200pc$tray_packing_w2wed_conc_list[order(NL_table_Random_Prob_200pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_200pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_tray_packing_w2wed_conc_list <- append(random_prob_200pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_200pc$bag_packing_w2wed_conc_list[order(NL_table_Random_Prob_200pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_200pc_bag_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_bag_packing_w2wed_conc_list <- append(random_prob_200pc_bag_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_200pc$reject_w2wed_conc_list[order(NL_table_Random_Prob_200pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_200pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_reject_w2wed_conc_list <- append(random_prob_200pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_200pc$other_w2wed_conc_list[order(NL_table_Random_Prob_200pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_200pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_other_w2wed_conc_list <- append(random_prob_200pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

random_prob_200pc_loading_concs <- as.data.frame(random_prob_200pc_loading_w2wed_conc_list)
random_prob_200pc_loading_concs$area <- as.factor('loading')
random_prob_200pc_loading_concs$scenario <- as.factor('PR_02')
random_prob_200pc_loading_concs$water <- as.factor('Wet')
names(random_prob_200pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_cleaning_concs <- as.data.frame(random_prob_200pc_cleaning_w2wed_conc_list)
random_prob_200pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_200pc_cleaning_concs$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_sorting_concs <- as.data.frame(random_prob_200pc_sorting_w2wed_conc_list)
random_prob_200pc_sorting_concs$area <- as.factor('sorting')
random_prob_200pc_sorting_concs$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_200pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_reject_concs <- as.data.frame(random_prob_200pc_reject_w2wed_conc_list)
random_prob_200pc_reject_concs$area <- as.factor('reject')
random_prob_200pc_reject_concs$scenario <- as.factor('PR_02')
random_prob_200pc_reject_concs$water <- as.factor('Dry')
names(random_prob_200pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_tray_packing_concs <- as.data.frame(random_prob_200pc_tray_packing_w2wed_conc_list)
random_prob_200pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_concs$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_other_concs <- as.data.frame(random_prob_200pc_other_w2wed_conc_list)
random_prob_200pc_other_concs$area <- as.factor('other')
random_prob_200pc_other_concs$scenario <- as.factor('PR_02')
random_prob_200pc_other_concs$water <- as.factor('Dry')
names(random_prob_200pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_concs <- rbind(random_prob_200pc_loading_concs,random_prob_200pc_cleaning_concs,random_prob_200pc_sorting_concs,random_prob_200pc_tray_packing_concs,random_prob_200pc_reject_concs,random_prob_200pc_other_concs)

random_prob_200pc_loading_prev <- as.data.frame(NL_table_Random_Prob_200pc$loading_w2wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_loading_prev$area <- as.factor('loading')
random_prob_200pc_loading_prev$scenario <- as.factor('PR_02')
random_prob_200pc_loading_prev$water <- as.factor('Wet')
names(random_prob_200pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_200pc$cleaning_w2wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_200pc_cleaning_prev$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_200pc$sorting_w2wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_sorting_prev$area <- as.factor('sorting')
random_prob_200pc_sorting_prev$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_200pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_reject_prev <- as.data.frame(NL_table_Random_Prob_200pc$reject_w2wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_reject_prev$area <- as.factor('reject')
random_prob_200pc_reject_prev$scenario <- as.factor('PR_02')
random_prob_200pc_reject_prev$water <- as.factor('Dry')
names(random_prob_200pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_200pc$tray_packing_w2wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_prev$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_other_prev <- as.data.frame(NL_table_Random_Prob_200pc$other_w2wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_other_prev$area <- as.factor('other')
random_prob_200pc_other_prev$scenario <- as.factor('PR_02')
random_prob_200pc_other_prev$water <- as.factor('Dry')
names(random_prob_200pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_prev <- rbind(random_prob_200pc_loading_prev,random_prob_200pc_cleaning_prev,random_prob_200pc_sorting_prev,random_prob_200pc_tray_packing_prev,random_prob_200pc_reject_prev,random_prob_200pc_other_prev)

random_prob_200pc_wet_prev <- as.data.frame(random_prob_200pc_loading_prev$prevalence*21/100+random_prob_200pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_200pc_wet_prev$scenario <- as.factor('PR_02')
random_prob_200pc_wet_prev$water <- as.factor('Wet')
names(random_prob_200pc_wet_prev) <- c('prevalence','scenario','water')

random_prob_200pc_dry_prev <- as.data.frame(random_prob_200pc_sorting_prev$prevalence*20/100+random_prob_200pc_reject_prev$prevalence*23/100+random_prob_200pc_tray_packing_prev$prevalence*123/100+random_prob_200pc_other_prev$prevalence*10/100)/176*100
random_prob_200pc_dry_prev$scenario <- as.factor('PR_02')
random_prob_200pc_dry_prev$water <- as.factor('Dry')
names(random_prob_200pc_dry_prev) <- c('prevalence','scenario','water')

random_prob_200pc_recombined_prev <- rbind(random_prob_200pc_wet_prev, random_prob_200pc_dry_prev)

random_prob_200pc_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(random_prob_200pc_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('PR_02'),
  as.factor(baseline_recombined_prev$water)
)
colnames(random_prob_200pc_eff_prev)<- c('prevalence', 'scenario', 'water')
```

```{r import Random Event Occurences 250% Delay Period}
NL_table_Random_Prob_250pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-14-01-23 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_P_Random_Event_Occurrences_33-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Prob_250pc <- NL_table_Random_Prob_250pc[NL_table_Random_Prob_250pc$scenario==33,]

while (any(grepl('-', names(NL_table_Random_Prob_250pc), fixed = TRUE))) {
  NL_table_Random_Prob_250pc <- NL_table_Random_Prob_250pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Prob_250pc), fixed = TRUE))) {
  NL_table_Random_Prob_250pc <- NL_table_Random_Prob_250pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Prob_250pc), fixed = TRUE))) {
  NL_table_Random_Prob_250pc <- NL_table_Random_Prob_250pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Prob_250pc), fixed = TRUE))) {
  NL_table_Random_Prob_250pc <- NL_table_Random_Prob_250pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Prob_250pc[ , ..list_columns]

NL_table_Random_Prob_250pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Prob_250pc <- as.data.frame(NL_table_Random_Prob_250pc)

NL_table_Random_Prob_250pc[NL_table_Random_Prob_250pc==-1] <- NA

NL_table_Random_Prob_250pc <- subset(NL_table_Random_Prob_250pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Prob_250pc)[names(NL_table_Random_Prob_250pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Prob_250pc)[names(NL_table_Random_Prob_250pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Random_Prob_250pc$loading_w2wed_conc_list[order(NL_table_Random_Prob_250pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_250pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_loading_w2wed_conc_list <- append(random_prob_250pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_250pc$cleaning_w2wed_conc_list[order(NL_table_Random_Prob_250pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_250pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_cleaning_w2wed_conc_list <- append(random_prob_250pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_250pc$drying_w2wed_conc_list[order(NL_table_Random_Prob_250pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_250pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_drying_w2wed_conc_list <- append(random_prob_250pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_250pc$sorting_w2wed_conc_list[order(NL_table_Random_Prob_250pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_250pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_sorting_w2wed_conc_list <- append(random_prob_250pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_250pc$tray_packing_w2wed_conc_list[order(NL_table_Random_Prob_250pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_250pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_tray_packing_w2wed_conc_list <- append(random_prob_250pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_250pc$bag_packing_w2wed_conc_list[order(NL_table_Random_Prob_250pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_250pc_bag_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_bag_packing_w2wed_conc_list <- append(random_prob_250pc_bag_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_250pc$reject_w2wed_conc_list[order(NL_table_Random_Prob_250pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_250pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_reject_w2wed_conc_list <- append(random_prob_250pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_250pc$other_w2wed_conc_list[order(NL_table_Random_Prob_250pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_250pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_other_w2wed_conc_list <- append(random_prob_250pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

random_prob_250pc_loading_concs <- as.data.frame(random_prob_250pc_loading_w2wed_conc_list)
random_prob_250pc_loading_concs$area <- as.factor('loading')
random_prob_250pc_loading_concs$scenario <- as.factor('PR_03')
random_prob_250pc_loading_concs$water <- as.factor('Wet')
names(random_prob_250pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_cleaning_concs <- as.data.frame(random_prob_250pc_cleaning_w2wed_conc_list)
random_prob_250pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_250pc_cleaning_concs$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_sorting_concs <- as.data.frame(random_prob_250pc_sorting_w2wed_conc_list)
random_prob_250pc_sorting_concs$area <- as.factor('sorting')
random_prob_250pc_sorting_concs$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_250pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_reject_concs <- as.data.frame(random_prob_250pc_reject_w2wed_conc_list)
random_prob_250pc_reject_concs$area <- as.factor('reject')
random_prob_250pc_reject_concs$scenario <- as.factor('PR_03')
random_prob_250pc_reject_concs$water <- as.factor('Dry')
names(random_prob_250pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_tray_packing_concs <- as.data.frame(random_prob_250pc_tray_packing_w2wed_conc_list)
random_prob_250pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_concs$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_other_concs <- as.data.frame(random_prob_250pc_other_w2wed_conc_list)
random_prob_250pc_other_concs$area <- as.factor('other')
random_prob_250pc_other_concs$scenario <- as.factor('PR_03')
random_prob_250pc_other_concs$water <- as.factor('Dry')
names(random_prob_250pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_concs <- rbind(random_prob_250pc_loading_concs,random_prob_250pc_cleaning_concs,random_prob_250pc_sorting_concs,random_prob_250pc_tray_packing_concs,random_prob_250pc_reject_concs,random_prob_250pc_other_concs)

random_prob_250pc_loading_prev <- as.data.frame(NL_table_Random_Prob_250pc$loading_w2wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_loading_prev$area <- as.factor('loading')
random_prob_250pc_loading_prev$scenario <- as.factor('PR_03')
random_prob_250pc_loading_prev$water <- as.factor('Wet')
names(random_prob_250pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_250pc$cleaning_w2wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_250pc_cleaning_prev$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_250pc$sorting_w2wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_sorting_prev$area <- as.factor('sorting')
random_prob_250pc_sorting_prev$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_250pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_reject_prev <- as.data.frame(NL_table_Random_Prob_250pc$reject_w2wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_reject_prev$area <- as.factor('reject')
random_prob_250pc_reject_prev$scenario <- as.factor('PR_03')
random_prob_250pc_reject_prev$water <- as.factor('Dry')
names(random_prob_250pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_250pc$tray_packing_w2wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_prev$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_other_prev <- as.data.frame(NL_table_Random_Prob_250pc$other_w2wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_other_prev$area <- as.factor('other')
random_prob_250pc_other_prev$scenario <- as.factor('PR_03')
random_prob_250pc_other_prev$water <- as.factor('Dry')
names(random_prob_250pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_prev <- rbind(random_prob_250pc_loading_prev,random_prob_250pc_cleaning_prev,random_prob_250pc_sorting_prev,random_prob_250pc_tray_packing_prev,random_prob_250pc_reject_prev,random_prob_250pc_other_prev)

random_prob_250pc_wet_prev <- as.data.frame(random_prob_250pc_loading_prev$prevalence*21/100+random_prob_250pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_250pc_wet_prev$scenario <- as.factor('PR_03')
random_prob_250pc_wet_prev$water <- as.factor('Wet')
names(random_prob_250pc_wet_prev) <- c('prevalence','scenario','water')

random_prob_250pc_dry_prev <- as.data.frame(random_prob_250pc_sorting_prev$prevalence*20/100+random_prob_250pc_reject_prev$prevalence*23/100+random_prob_250pc_tray_packing_prev$prevalence*123/100+random_prob_250pc_other_prev$prevalence*10/100)/176*100
random_prob_250pc_dry_prev$scenario <- as.factor('PR_03')
random_prob_250pc_dry_prev$water <- as.factor('Dry')
names(random_prob_250pc_dry_prev) <- c('prevalence','scenario','water')

random_prob_250pc_recombined_prev <- rbind(random_prob_250pc_wet_prev, random_prob_250pc_dry_prev)

random_prob_250pc_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(random_prob_250pc_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('PR_03'),
  as.factor(baseline_recombined_prev$water)
)
colnames(random_prob_250pc_eff_prev)<- c('prevalence', 'scenario', 'water')
```

```{r import P Random Event Occurnces 0%}
NL_table_Random_Prob_0pc <- fread(paste0(getwd(),'/BehaviorSpace/2020-10-23-15-14 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Random_Load_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Prob_0pc <- NL_table_Random_Prob_0pc[NL_table_Random_Prob_0pc$scenario==6,]

while (any(grepl('-', names(NL_table_Random_Prob_0pc), fixed = TRUE))) {
  NL_table_Random_Prob_0pc <- NL_table_Random_Prob_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Prob_0pc), fixed = TRUE))) {
  NL_table_Random_Prob_0pc <- NL_table_Random_Prob_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Prob_0pc), fixed = TRUE))) {
  NL_table_Random_Prob_0pc <- NL_table_Random_Prob_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Prob_0pc), fixed = TRUE))) {
  NL_table_Random_Prob_0pc <- NL_table_Random_Prob_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Prob_0pc[ , ..list_columns]

NL_table_Random_Prob_0pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Prob_0pc <- as.data.frame(NL_table_Random_Prob_0pc)

NL_table_Random_Prob_0pc[NL_table_Random_Prob_0pc==-1] <- NA

NL_table_Random_Prob_0pc <- subset(NL_table_Random_Prob_0pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Prob_0pc)[names(NL_table_Random_Prob_0pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Prob_0pc)[names(NL_table_Random_Prob_0pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Random_Prob_0pc$loading_w2wed_conc_list[order(NL_table_Random_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_0pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_0pc_loading_w2wed_conc_list <- append(random_prob_0pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_0pc$cleaning_w2wed_conc_list[order(NL_table_Random_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_0pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_0pc_cleaning_w2wed_conc_list <- append(random_prob_0pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_0pc$drying_w2wed_conc_list[order(NL_table_Random_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_0pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_0pc_drying_w2wed_conc_list <- append(random_prob_0pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_0pc$sorting_w2wed_conc_list[order(NL_table_Random_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_0pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_0pc_sorting_w2wed_conc_list <- append(random_prob_0pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_0pc$tray_packing_w2wed_conc_list[order(NL_table_Random_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_0pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_0pc_tray_packing_w2wed_conc_list <- append(random_prob_0pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_0pc$bag_packing_w2wed_conc_list[order(NL_table_Random_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_0pc_bag_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_0pc_bag_packing_w2wed_conc_list <- append(random_prob_0pc_bag_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_0pc$reject_w2wed_conc_list[order(NL_table_Random_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_0pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_0pc_reject_w2wed_conc_list <- append(random_prob_0pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Random_Prob_0pc$other_w2wed_conc_list[order(NL_table_Random_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
random_prob_0pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_0pc_other_w2wed_conc_list <- append(random_prob_0pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

random_prob_0pc_loading_concs <- as.data.frame(random_prob_0pc_loading_w2wed_conc_list)
random_prob_0pc_loading_concs$area <- as.factor('loading')
random_prob_0pc_loading_concs$scenario <- as.factor('Prob Random Events 0%')
random_prob_0pc_loading_concs$water <- as.factor('Wet')
names(random_prob_0pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_0pc_cleaning_concs <- as.data.frame(random_prob_0pc_cleaning_w2wed_conc_list)
random_prob_0pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_0pc_cleaning_concs$scenario <- as.factor('Prob Random Events 0%')
random_prob_0pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_0pc_sorting_concs <- as.data.frame(random_prob_0pc_sorting_w2wed_conc_list)
random_prob_0pc_sorting_concs$area <- as.factor('sorting')
random_prob_0pc_sorting_concs$scenario <- as.factor('Prob Random Events 0%')
random_prob_0pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_0pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_0pc_reject_concs <- as.data.frame(random_prob_0pc_reject_w2wed_conc_list)
random_prob_0pc_reject_concs$area <- as.factor('reject')
random_prob_0pc_reject_concs$scenario <- as.factor('Prob Random Events 0%')
random_prob_0pc_reject_concs$water <- as.factor('Dry')
names(random_prob_0pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_0pc_tray_packing_concs <- as.data.frame(random_prob_0pc_tray_packing_w2wed_conc_list)
random_prob_0pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_0pc_tray_packing_concs$scenario <- as.factor('Prob Random Events 0%')
random_prob_0pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_0pc_other_concs <- as.data.frame(random_prob_0pc_other_w2wed_conc_list)
random_prob_0pc_other_concs$area <- as.factor('other')
random_prob_0pc_other_concs$scenario <- as.factor('Prob Random Events 0%')
random_prob_0pc_other_concs$water <- as.factor('Dry')
names(random_prob_0pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_0pc_concs <- rbind(random_prob_0pc_loading_concs,random_prob_0pc_cleaning_concs,random_prob_0pc_sorting_concs,random_prob_0pc_tray_packing_concs,random_prob_0pc_reject_concs,random_prob_0pc_other_concs)

random_prob_0pc_loading_prev <- as.data.frame(NL_table_Random_Prob_0pc$loading_w2wed_prev[order(NL_table_Random_Prob_0pc$local_seed)])
random_prob_0pc_loading_prev$area <- as.factor('loading')
random_prob_0pc_loading_prev$scenario <- as.factor('Prob Random Events 0%')
random_prob_0pc_loading_prev$water <- as.factor('Wet')
names(random_prob_0pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_0pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_0pc$cleaning_w2wed_prev[order(NL_table_Random_Prob_0pc$local_seed)])
random_prob_0pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_0pc_cleaning_prev$scenario <- as.factor('Prob Random Events 0%')
random_prob_0pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_0pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_0pc$sorting_w2wed_prev[order(NL_table_Random_Prob_0pc$local_seed)])
random_prob_0pc_sorting_prev$area <- as.factor('sorting')
random_prob_0pc_sorting_prev$scenario <- as.factor('Prob Random Events 0%')
random_prob_0pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_0pc_reject_prev <- as.data.frame(NL_table_Random_Prob_0pc$reject_w2wed_prev[order(NL_table_Random_Prob_0pc$local_seed)])
random_prob_0pc_reject_prev$area <- as.factor('reject')
random_prob_0pc_reject_prev$scenario <- as.factor('Prob Random Events 0%')
random_prob_0pc_reject_prev$water <- as.factor('Dry')
names(random_prob_0pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_0pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_0pc$tray_packing_w2wed_prev[order(NL_table_Random_Prob_0pc$local_seed)])
random_prob_0pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_0pc_tray_packing_prev$scenario <- as.factor('Prob Random Events 0%')
random_prob_0pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_0pc_other_prev <- as.data.frame(NL_table_Random_Prob_0pc$other_w2wed_prev[order(NL_table_Random_Prob_0pc$local_seed)])
random_prob_0pc_other_prev$area <- as.factor('other')
random_prob_0pc_other_prev$scenario <- as.factor('Prob Random Events 0%')
random_prob_0pc_other_prev$water <- as.factor('Dry')
names(random_prob_0pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_0pc_prev <- rbind(random_prob_0pc_loading_prev,random_prob_0pc_cleaning_prev,random_prob_0pc_sorting_prev,random_prob_0pc_tray_packing_prev,random_prob_0pc_reject_prev,random_prob_0pc_other_prev)
```

```{r import P Z4 Reduction 75%}
NL_table_Z4_Prob_75pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-19-10-27 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_P_Z4_Event_Occurrences_35-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Prob_75pc <- NL_table_Z4_Prob_75pc[NL_table_Z4_Prob_75pc$scenario==35,]

while (any(grepl('-', names(NL_table_Z4_Prob_75pc), fixed = TRUE))) {
  NL_table_Z4_Prob_75pc <- NL_table_Z4_Prob_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Prob_75pc), fixed = TRUE))) {
  NL_table_Z4_Prob_75pc <- NL_table_Z4_Prob_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Prob_75pc), fixed = TRUE))) {
  NL_table_Z4_Prob_75pc <- NL_table_Z4_Prob_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Prob_75pc), fixed = TRUE))) {
  NL_table_Z4_Prob_75pc <- NL_table_Z4_Prob_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Prob_75pc[ , ..list_columns]

NL_table_Z4_Prob_75pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Prob_75pc <- as.data.frame(NL_table_Z4_Prob_75pc)

NL_table_Z4_Prob_75pc[NL_table_Z4_Prob_75pc==-1] <- NA

NL_table_Z4_Prob_75pc <- subset(NL_table_Z4_Prob_75pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Prob_75pc)[names(NL_table_Z4_Prob_75pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Prob_75pc)[names(NL_table_Z4_Prob_75pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','z4_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_z4_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Z4_Prob_75pc$loading_w2wed_conc_list[order(NL_table_Z4_Prob_75pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_75pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_loading_w2wed_conc_list <- append(z4_prob_75pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_75pc$cleaning_w2wed_conc_list[order(NL_table_Z4_Prob_75pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_75pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_cleaning_w2wed_conc_list <- append(z4_prob_75pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_75pc$drying_w2wed_conc_list[order(NL_table_Z4_Prob_75pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_75pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_drying_w2wed_conc_list <- append(z4_prob_75pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_75pc$sorting_w2wed_conc_list[order(NL_table_Z4_Prob_75pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_75pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_sorting_w2wed_conc_list <- append(z4_prob_75pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_75pc$tray_packing_w2wed_conc_list[order(NL_table_Z4_Prob_75pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_75pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_tray_packing_w2wed_conc_list <- append(z4_prob_75pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_75pc$bag_packing_w2wed_conc_list[order(NL_table_Z4_Prob_75pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_75pc_bag_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_bag_packing_w2wed_conc_list <- append(z4_prob_75pc_bag_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_75pc$reject_w2wed_conc_list[order(NL_table_Z4_Prob_75pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_75pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_reject_w2wed_conc_list <- append(z4_prob_75pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_75pc$other_w2wed_conc_list[order(NL_table_Z4_Prob_75pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_75pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_other_w2wed_conc_list <- append(z4_prob_75pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

z4_prob_75pc_loading_concs <- as.data.frame(z4_prob_75pc_loading_w2wed_conc_list)
z4_prob_75pc_loading_concs$area <- as.factor('loading')
z4_prob_75pc_loading_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_75pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_cleaning_concs <- as.data.frame(z4_prob_75pc_cleaning_w2wed_conc_list)
z4_prob_75pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_sorting_concs <- as.data.frame(z4_prob_75pc_sorting_w2wed_conc_list)
z4_prob_75pc_sorting_concs$area <- as.factor('sorting')
z4_prob_75pc_sorting_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_reject_concs <- as.data.frame(z4_prob_75pc_reject_w2wed_conc_list)
z4_prob_75pc_reject_concs$area <- as.factor('reject')
z4_prob_75pc_reject_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_75pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_tray_packing_concs <- as.data.frame(z4_prob_75pc_tray_packing_w2wed_conc_list)
z4_prob_75pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_other_concs <- as.data.frame(z4_prob_75pc_other_w2wed_conc_list)
z4_prob_75pc_other_concs$area <- as.factor('other')
z4_prob_75pc_other_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_concs$water <- as.factor('Dry')
names(z4_prob_75pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_concs <- rbind(z4_prob_75pc_loading_concs,z4_prob_75pc_cleaning_concs,z4_prob_75pc_sorting_concs,z4_prob_75pc_tray_packing_concs,z4_prob_75pc_reject_concs,z4_prob_75pc_other_concs)

z4_prob_75pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_75pc$loading_w2wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_loading_prev$area <- as.factor('loading')
z4_prob_75pc_loading_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_75pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_75pc$cleaning_w2wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_75pc$sorting_w2wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_sorting_prev$area <- as.factor('sorting')
z4_prob_75pc_sorting_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_75pc$reject_w2wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_reject_prev$area <- as.factor('reject')
z4_prob_75pc_reject_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_75pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_75pc$tray_packing_w2wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_other_prev <- as.data.frame(NL_table_Z4_Prob_75pc$other_w2wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_other_prev$area <- as.factor('other')
z4_prob_75pc_other_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_prev$water <- as.factor('Dry')
names(z4_prob_75pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_prev <- rbind(z4_prob_75pc_loading_prev,z4_prob_75pc_cleaning_prev,z4_prob_75pc_sorting_prev,z4_prob_75pc_tray_packing_prev,z4_prob_75pc_reject_prev,z4_prob_75pc_other_prev)

z4_prob_75pc_wet_prev <- as.data.frame(z4_prob_75pc_loading_prev$prevalence*21/100+z4_prob_75pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_75pc_wet_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_wet_prev$water <- as.factor('Wet')
names(z4_prob_75pc_wet_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_dry_prev <- as.data.frame(z4_prob_75pc_sorting_prev$prevalence*20/100+z4_prob_75pc_reject_prev$prevalence*23/100+z4_prob_75pc_tray_packing_prev$prevalence*123/100+z4_prob_75pc_other_prev$prevalence*10/100)/176*100
z4_prob_75pc_dry_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_dry_prev$water <- as.factor('Dry')
names(z4_prob_75pc_dry_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_recombined_prev <- rbind(z4_prob_75pc_wet_prev, z4_prob_75pc_dry_prev)

z4_prob_75pc_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(z4_prob_75pc_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('PZ_01'),
  as.factor(baseline_recombined_prev$water)
)
colnames(z4_prob_75pc_eff_prev)<- c('prevalence', 'scenario', 'water')

z4_prob_75pc_z1_prev <- as.data.frame(NL_table_Z4_Prob_75pc$z1_w2wed_prev)
z4_prob_75pc_z1_prev$zone <- as.factor('Z1')
z4_prob_75pc_z1_prev$scenario <- as.factor('PZ_01')
names(z4_prob_75pc_z1_prev) <- c('prevalence','zone','scenario')

z4_prob_75pc_z2_prev <- as.data.frame(NL_table_Z4_Prob_75pc$z2_w2wed_prev)
z4_prob_75pc_z2_prev$zone <- as.factor('Z2')
z4_prob_75pc_z2_prev$scenario <- as.factor('PZ_01')
names(z4_prob_75pc_z2_prev) <- c('prevalence','zone','scenario')

z4_prob_75pc_z3_prev <- as.data.frame(NL_table_Z4_Prob_75pc$z2_w2wed_prev)
z4_prob_75pc_z3_prev$zone <- as.factor('Z3')
z4_prob_75pc_z3_prev$scenario <- as.factor('PZ_01')
names(z4_prob_75pc_z3_prev) <- c('prevalence','zone','scenario')

z4_prob_75pc_zone_prev <- rbind(z4_prob_75pc_z1_prev,z4_prob_75pc_z2_prev,z4_prob_75pc_z3_prev)
```

```{r import P Z4 Reduction 50%}
NL_table_Z4_Prob_50pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-19-10-27 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_P_Z4_Event_Occurrences_36-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Prob_50pc <- NL_table_Z4_Prob_50pc[NL_table_Z4_Prob_50pc$scenario==36,]

while (any(grepl('-', names(NL_table_Z4_Prob_50pc), fixed = TRUE))) {
  NL_table_Z4_Prob_50pc <- NL_table_Z4_Prob_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Prob_50pc), fixed = TRUE))) {
  NL_table_Z4_Prob_50pc <- NL_table_Z4_Prob_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Prob_50pc), fixed = TRUE))) {
  NL_table_Z4_Prob_50pc <- NL_table_Z4_Prob_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Prob_50pc), fixed = TRUE))) {
  NL_table_Z4_Prob_50pc <- NL_table_Z4_Prob_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Prob_50pc[ , ..list_columns]

NL_table_Z4_Prob_50pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Prob_50pc <- as.data.frame(NL_table_Z4_Prob_50pc)

NL_table_Z4_Prob_50pc[NL_table_Z4_Prob_50pc==-1] <- NA

NL_table_Z4_Prob_50pc <- subset(NL_table_Z4_Prob_50pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Prob_50pc)[names(NL_table_Z4_Prob_50pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Prob_50pc)[names(NL_table_Z4_Prob_50pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','z4_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_z4_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Z4_Prob_50pc$loading_w2wed_conc_list[order(NL_table_Z4_Prob_50pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_50pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_loading_w2wed_conc_list <- append(z4_prob_50pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_50pc$cleaning_w2wed_conc_list[order(NL_table_Z4_Prob_50pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_50pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_cleaning_w2wed_conc_list <- append(z4_prob_50pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_50pc$drying_w2wed_conc_list[order(NL_table_Z4_Prob_50pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_50pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_drying_w2wed_conc_list <- append(z4_prob_50pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_50pc$sorting_w2wed_conc_list[order(NL_table_Z4_Prob_50pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_50pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_sorting_w2wed_conc_list <- append(z4_prob_50pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_50pc$tray_packing_w2wed_conc_list[order(NL_table_Z4_Prob_50pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_50pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_tray_packing_w2wed_conc_list <- append(z4_prob_50pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_50pc$bag_packing_w2wed_conc_list[order(NL_table_Z4_Prob_50pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_50pc_bag_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_bag_packing_w2wed_conc_list <- append(z4_prob_50pc_bag_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_50pc$reject_w2wed_conc_list[order(NL_table_Z4_Prob_50pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_50pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_reject_w2wed_conc_list <- append(z4_prob_50pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_50pc$other_w2wed_conc_list[order(NL_table_Z4_Prob_50pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_50pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_other_w2wed_conc_list <- append(z4_prob_50pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

z4_prob_50pc_loading_concs <- as.data.frame(z4_prob_50pc_loading_w2wed_conc_list)
z4_prob_50pc_loading_concs$area <- as.factor('loading')
z4_prob_50pc_loading_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_50pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_cleaning_concs <- as.data.frame(z4_prob_50pc_cleaning_w2wed_conc_list)
z4_prob_50pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_sorting_concs <- as.data.frame(z4_prob_50pc_sorting_w2wed_conc_list)
z4_prob_50pc_sorting_concs$area <- as.factor('sorting')
z4_prob_50pc_sorting_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_reject_concs <- as.data.frame(z4_prob_50pc_reject_w2wed_conc_list)
z4_prob_50pc_reject_concs$area <- as.factor('reject')
z4_prob_50pc_reject_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_50pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_tray_packing_concs <- as.data.frame(z4_prob_50pc_tray_packing_w2wed_conc_list)
z4_prob_50pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_other_concs <- as.data.frame(z4_prob_50pc_other_w2wed_conc_list)
z4_prob_50pc_other_concs$area <- as.factor('other')
z4_prob_50pc_other_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_concs$water <- as.factor('Dry')
names(z4_prob_50pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_concs <- rbind(z4_prob_50pc_loading_concs,z4_prob_50pc_cleaning_concs,z4_prob_50pc_sorting_concs,z4_prob_50pc_tray_packing_concs,z4_prob_50pc_reject_concs,z4_prob_50pc_other_concs)

z4_prob_50pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_50pc$loading_w2wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_loading_prev$area <- as.factor('loading')
z4_prob_50pc_loading_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_50pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_50pc$cleaning_w2wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_50pc$sorting_w2wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_sorting_prev$area <- as.factor('sorting')
z4_prob_50pc_sorting_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_50pc$reject_w2wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_reject_prev$area <- as.factor('reject')
z4_prob_50pc_reject_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_50pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_50pc$tray_packing_w2wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_other_prev <- as.data.frame(NL_table_Z4_Prob_50pc$other_w2wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_other_prev$area <- as.factor('other')
z4_prob_50pc_other_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_prev$water <- as.factor('Dry')
names(z4_prob_50pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_prev <- rbind(z4_prob_50pc_loading_prev,z4_prob_50pc_cleaning_prev,z4_prob_50pc_sorting_prev,z4_prob_50pc_tray_packing_prev,z4_prob_50pc_reject_prev,z4_prob_50pc_other_prev)

z4_prob_50pc_wet_prev <- as.data.frame(z4_prob_50pc_loading_prev$prevalence*21/100+z4_prob_50pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_50pc_wet_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_wet_prev$water <- as.factor('Wet')
names(z4_prob_50pc_wet_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_dry_prev <- as.data.frame(z4_prob_50pc_sorting_prev$prevalence*20/100+z4_prob_50pc_reject_prev$prevalence*23/100+z4_prob_50pc_tray_packing_prev$prevalence*123/100+z4_prob_50pc_other_prev$prevalence*10/100)/176*100
z4_prob_50pc_dry_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_dry_prev$water <- as.factor('Dry')
names(z4_prob_50pc_dry_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_recombined_prev <- rbind(z4_prob_50pc_wet_prev, z4_prob_50pc_dry_prev)

z4_prob_50pc_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(z4_prob_50pc_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('PZ_02'),
  as.factor(baseline_recombined_prev$water)
)
colnames(z4_prob_50pc_eff_prev)<- c('prevalence', 'scenario', 'water')

z4_prob_50pc_z1_prev <- as.data.frame(NL_table_Z4_Prob_50pc$z1_w2wed_prev)
z4_prob_50pc_z1_prev$zone <- as.factor('Z1')
z4_prob_50pc_z1_prev$scenario <- as.factor('PZ_02')
names(z4_prob_50pc_z1_prev) <- c('prevalence','zone','scenario')

z4_prob_50pc_z2_prev <- as.data.frame(NL_table_Z4_Prob_50pc$z2_w2wed_prev)
z4_prob_50pc_z2_prev$zone <- as.factor('Z2')
z4_prob_50pc_z2_prev$scenario <- as.factor('PZ_02')
names(z4_prob_50pc_z2_prev) <- c('prevalence','zone','scenario')

z4_prob_50pc_z3_prev <- as.data.frame(NL_table_Z4_Prob_50pc$z2_w2wed_prev)
z4_prob_50pc_z3_prev$zone <- as.factor('Z3')
z4_prob_50pc_z3_prev$scenario <- as.factor('PZ_02')
names(z4_prob_50pc_z3_prev) <- c('prevalence','zone','scenario')

z4_prob_50pc_zone_prev <- rbind(z4_prob_50pc_z1_prev,z4_prob_50pc_z2_prev,z4_prob_50pc_z3_prev)
```

```{r import P Z4 Reduction 25%}
NL_table_Z4_Prob_25pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-19-10-27 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_P_Z4_Event_Occurrences_37-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Prob_25pc <- NL_table_Z4_Prob_25pc[NL_table_Z4_Prob_25pc$scenario==37,]

while (any(grepl('-', names(NL_table_Z4_Prob_25pc), fixed = TRUE))) {
  NL_table_Z4_Prob_25pc <- NL_table_Z4_Prob_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Prob_25pc), fixed = TRUE))) {
  NL_table_Z4_Prob_25pc <- NL_table_Z4_Prob_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Prob_25pc), fixed = TRUE))) {
  NL_table_Z4_Prob_25pc <- NL_table_Z4_Prob_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Prob_25pc), fixed = TRUE))) {
  NL_table_Z4_Prob_25pc <- NL_table_Z4_Prob_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Prob_25pc[ , ..list_columns]

NL_table_Z4_Prob_25pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Prob_25pc <- as.data.frame(NL_table_Z4_Prob_25pc)

NL_table_Z4_Prob_25pc[NL_table_Z4_Prob_25pc==-1] <- NA

NL_table_Z4_Prob_25pc <- subset(NL_table_Z4_Prob_25pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Prob_25pc)[names(NL_table_Z4_Prob_25pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Prob_25pc)[names(NL_table_Z4_Prob_25pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','z4_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_z4_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Z4_Prob_25pc$loading_w2wed_conc_list[order(NL_table_Z4_Prob_25pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_25pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_loading_w2wed_conc_list <- append(z4_prob_25pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_25pc$cleaning_w2wed_conc_list[order(NL_table_Z4_Prob_25pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_25pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_cleaning_w2wed_conc_list <- append(z4_prob_25pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_25pc$drying_w2wed_conc_list[order(NL_table_Z4_Prob_25pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_25pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_drying_w2wed_conc_list <- append(z4_prob_25pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_25pc$sorting_w2wed_conc_list[order(NL_table_Z4_Prob_25pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_25pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_sorting_w2wed_conc_list <- append(z4_prob_25pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_25pc$tray_packing_w2wed_conc_list[order(NL_table_Z4_Prob_25pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_25pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_tray_packing_w2wed_conc_list <- append(z4_prob_25pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_25pc$bag_packing_w2wed_conc_list[order(NL_table_Z4_Prob_25pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_25pc_bag_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_bag_packing_w2wed_conc_list <- append(z4_prob_25pc_bag_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_25pc$reject_w2wed_conc_list[order(NL_table_Z4_Prob_25pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_25pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_reject_w2wed_conc_list <- append(z4_prob_25pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_25pc$other_w2wed_conc_list[order(NL_table_Z4_Prob_25pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_25pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_other_w2wed_conc_list <- append(z4_prob_25pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

z4_prob_25pc_loading_concs <- as.data.frame(z4_prob_25pc_loading_w2wed_conc_list)
z4_prob_25pc_loading_concs$area <- as.factor('loading')
z4_prob_25pc_loading_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_25pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_cleaning_concs <- as.data.frame(z4_prob_25pc_cleaning_w2wed_conc_list)
z4_prob_25pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_sorting_concs <- as.data.frame(z4_prob_25pc_sorting_w2wed_conc_list)
z4_prob_25pc_sorting_concs$area <- as.factor('sorting')
z4_prob_25pc_sorting_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_reject_concs <- as.data.frame(z4_prob_25pc_reject_w2wed_conc_list)
z4_prob_25pc_reject_concs$area <- as.factor('reject')
z4_prob_25pc_reject_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_25pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_tray_packing_concs <- as.data.frame(z4_prob_25pc_tray_packing_w2wed_conc_list)
z4_prob_25pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_other_concs <- as.data.frame(z4_prob_25pc_other_w2wed_conc_list)
z4_prob_25pc_other_concs$area <- as.factor('other')
z4_prob_25pc_other_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_concs$water <- as.factor('Dry')
names(z4_prob_25pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_concs <- rbind(z4_prob_25pc_loading_concs,z4_prob_25pc_cleaning_concs,z4_prob_25pc_sorting_concs,z4_prob_25pc_tray_packing_concs,z4_prob_25pc_reject_concs,z4_prob_25pc_other_concs)

z4_prob_25pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_25pc$loading_w2wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_loading_prev$area <- as.factor('loading')
z4_prob_25pc_loading_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_25pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_25pc$cleaning_w2wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_25pc$sorting_w2wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_sorting_prev$area <- as.factor('sorting')
z4_prob_25pc_sorting_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_25pc$reject_w2wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_reject_prev$area <- as.factor('reject')
z4_prob_25pc_reject_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_25pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_25pc$tray_packing_w2wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_other_prev <- as.data.frame(NL_table_Z4_Prob_25pc$other_w2wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_other_prev$area <- as.factor('other')
z4_prob_25pc_other_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_prev$water <- as.factor('Dry')
names(z4_prob_25pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_prev <- rbind(z4_prob_25pc_loading_prev,z4_prob_25pc_cleaning_prev,z4_prob_25pc_sorting_prev,z4_prob_25pc_tray_packing_prev,z4_prob_25pc_reject_prev,z4_prob_25pc_other_prev)

z4_prob_25pc_wet_prev <- as.data.frame(z4_prob_25pc_loading_prev$prevalence*21/100+z4_prob_25pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_25pc_wet_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_wet_prev$water <- as.factor('Wet')
names(z4_prob_25pc_wet_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_dry_prev <- as.data.frame(z4_prob_25pc_sorting_prev$prevalence*20/100+z4_prob_25pc_reject_prev$prevalence*23/100+z4_prob_25pc_tray_packing_prev$prevalence*123/100+z4_prob_25pc_other_prev$prevalence*10/100)/176*100
z4_prob_25pc_dry_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_dry_prev$water <- as.factor('Dry')
names(z4_prob_25pc_dry_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_recombined_prev <- rbind(z4_prob_25pc_wet_prev, z4_prob_25pc_dry_prev)

z4_prob_25pc_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(z4_prob_25pc_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('PZ_03'),
  as.factor(baseline_recombined_prev$water)
)
colnames(z4_prob_25pc_eff_prev)<- c('prevalence', 'scenario', 'water')

z4_prob_25pc_z1_prev <- as.data.frame(NL_table_Z4_Prob_25pc$z1_w2wed_prev)
z4_prob_25pc_z1_prev$zone <- as.factor('Z1')
z4_prob_25pc_z1_prev$scenario <- as.factor('PZ_03')
names(z4_prob_25pc_z1_prev) <- c('prevalence','zone','scenario')

z4_prob_25pc_z2_prev <- as.data.frame(NL_table_Z4_Prob_25pc$z2_w2wed_prev)
z4_prob_25pc_z2_prev$zone <- as.factor('Z2')
z4_prob_25pc_z2_prev$scenario <- as.factor('PZ_03')
names(z4_prob_25pc_z2_prev) <- c('prevalence','zone','scenario')

z4_prob_25pc_z3_prev <- as.data.frame(NL_table_Z4_Prob_25pc$z2_w2wed_prev)
z4_prob_25pc_z3_prev$zone <- as.factor('Z3')
z4_prob_25pc_z3_prev$scenario <- as.factor('PZ_03')
names(z4_prob_25pc_z3_prev) <- c('prevalence','zone','scenario')

z4_prob_25pc_zone_prev <- rbind(z4_prob_25pc_z1_prev,z4_prob_25pc_z2_prev,z4_prob_25pc_z3_prev)
```

```{r import P Z4 Reduction 0%}
NL_table_Z4_Prob_0pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-19-10-27 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_P_Z4_Event_Occurrences_38-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Prob_0pc <- NL_table_Z4_Prob_0pc[NL_table_Z4_Prob_0pc$scenario==38,]

while (any(grepl('-', names(NL_table_Z4_Prob_0pc), fixed = TRUE))) {
  NL_table_Z4_Prob_0pc <- NL_table_Z4_Prob_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Prob_0pc), fixed = TRUE))) {
  NL_table_Z4_Prob_0pc <- NL_table_Z4_Prob_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Prob_0pc), fixed = TRUE))) {
  NL_table_Z4_Prob_0pc <- NL_table_Z4_Prob_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Prob_0pc), fixed = TRUE))) {
  NL_table_Z4_Prob_0pc <- NL_table_Z4_Prob_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Prob_0pc[ , ..list_columns]

NL_table_Z4_Prob_0pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Prob_0pc <- as.data.frame(NL_table_Z4_Prob_0pc)

NL_table_Z4_Prob_0pc[NL_table_Z4_Prob_0pc==-1] <- NA

NL_table_Z4_Prob_0pc <- subset(NL_table_Z4_Prob_0pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Prob_0pc)[names(NL_table_Z4_Prob_0pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Prob_0pc)[names(NL_table_Z4_Prob_0pc)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','z4_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_z4_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Z4_Prob_0pc$loading_w2wed_conc_list[order(NL_table_Z4_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_0pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_loading_w2wed_conc_list <- append(z4_prob_0pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_0pc$cleaning_w2wed_conc_list[order(NL_table_Z4_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_0pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_cleaning_w2wed_conc_list <- append(z4_prob_0pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_0pc$drying_w2wed_conc_list[order(NL_table_Z4_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_0pc_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_drying_w2wed_conc_list <- append(z4_prob_0pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_0pc$sorting_w2wed_conc_list[order(NL_table_Z4_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_0pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_sorting_w2wed_conc_list <- append(z4_prob_0pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_0pc$tray_packing_w2wed_conc_list[order(NL_table_Z4_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_0pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_tray_packing_w2wed_conc_list <- append(z4_prob_0pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_0pc$bag_packing_w2wed_conc_list[order(NL_table_Z4_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_0pc_bag_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_bag_packing_w2wed_conc_list <- append(z4_prob_0pc_bag_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_0pc$reject_w2wed_conc_list[order(NL_table_Z4_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_0pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_reject_w2wed_conc_list <- append(z4_prob_0pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Z4_Prob_0pc$other_w2wed_conc_list[order(NL_table_Z4_Prob_0pc$local_seed)]
vector <- vector[vector!='[]']
z4_prob_0pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_other_w2wed_conc_list <- append(z4_prob_0pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

z4_prob_0pc_loading_concs <- as.data.frame(z4_prob_0pc_loading_w2wed_conc_list)
z4_prob_0pc_loading_concs$area <- as.factor('loading')
z4_prob_0pc_loading_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_0pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_cleaning_concs <- as.data.frame(z4_prob_0pc_cleaning_w2wed_conc_list)
z4_prob_0pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_sorting_concs <- as.data.frame(z4_prob_0pc_sorting_w2wed_conc_list)
z4_prob_0pc_sorting_concs$area <- as.factor('sorting')
z4_prob_0pc_sorting_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_reject_concs <- as.data.frame(z4_prob_0pc_reject_w2wed_conc_list)
z4_prob_0pc_reject_concs$area <- as.factor('reject')
z4_prob_0pc_reject_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_0pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_tray_packing_concs <- as.data.frame(z4_prob_0pc_tray_packing_w2wed_conc_list)
z4_prob_0pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_other_concs <- as.data.frame(z4_prob_0pc_other_w2wed_conc_list)
z4_prob_0pc_other_concs$area <- as.factor('other')
z4_prob_0pc_other_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_concs$water <- as.factor('Dry')
names(z4_prob_0pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_concs <- rbind(z4_prob_0pc_loading_concs,z4_prob_0pc_cleaning_concs,z4_prob_0pc_sorting_concs,z4_prob_0pc_tray_packing_concs,z4_prob_0pc_reject_concs,z4_prob_0pc_other_concs)

z4_prob_0pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_0pc$loading_w2wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_loading_prev$area <- as.factor('loading')
z4_prob_0pc_loading_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_0pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_0pc$cleaning_w2wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_0pc$sorting_w2wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_sorting_prev$area <- as.factor('sorting')
z4_prob_0pc_sorting_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_0pc$reject_w2wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_reject_prev$area <- as.factor('reject')
z4_prob_0pc_reject_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_0pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_0pc$tray_packing_w2wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_other_prev <- as.data.frame(NL_table_Z4_Prob_0pc$other_w2wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_other_prev$area <- as.factor('other')
z4_prob_0pc_other_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_prev$water <- as.factor('Dry')
names(z4_prob_0pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_prev <- rbind(z4_prob_0pc_loading_prev,z4_prob_0pc_cleaning_prev,z4_prob_0pc_sorting_prev,z4_prob_0pc_tray_packing_prev,z4_prob_0pc_reject_prev,z4_prob_0pc_other_prev)

z4_prob_0pc_wet_prev <- as.data.frame(z4_prob_0pc_loading_prev$prevalence*21/100+z4_prob_0pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_0pc_wet_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_wet_prev$water <- as.factor('Wet')
names(z4_prob_0pc_wet_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_dry_prev <- as.data.frame(z4_prob_0pc_sorting_prev$prevalence*20/100+z4_prob_0pc_reject_prev$prevalence*23/100+z4_prob_0pc_tray_packing_prev$prevalence*123/100+z4_prob_0pc_other_prev$prevalence*10/100)/176*100
z4_prob_0pc_dry_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_dry_prev$water <- as.factor('Dry')
names(z4_prob_0pc_dry_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_recombined_prev <- rbind(z4_prob_0pc_wet_prev, z4_prob_0pc_dry_prev)

z4_prob_0pc_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(z4_prob_0pc_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('PZ_04'),
  as.factor(baseline_recombined_prev$water)
)
colnames(z4_prob_0pc_eff_prev)<- c('prevalence', 'scenario', 'water')

z4_prob_0pc_z1_prev <- as.data.frame(NL_table_Z4_Prob_0pc$z1_w2wed_prev)
z4_prob_0pc_z1_prev$zone <- as.factor('Z1')
z4_prob_0pc_z1_prev$scenario <- as.factor('PZ_04')
names(z4_prob_0pc_z1_prev) <- c('prevalence','zone','scenario')

z4_prob_0pc_z2_prev <- as.data.frame(NL_table_Z4_Prob_0pc$z2_w2wed_prev)
z4_prob_0pc_z2_prev$zone <- as.factor('Z2')
z4_prob_0pc_z2_prev$scenario <- as.factor('PZ_04')
names(z4_prob_0pc_z2_prev) <- c('prevalence','zone','scenario')

z4_prob_0pc_z3_prev <- as.data.frame(NL_table_Z4_Prob_0pc$z2_w2wed_prev)
z4_prob_0pc_z3_prev$zone <- as.factor('Z3')
z4_prob_0pc_z3_prev$scenario <- as.factor('PZ_04')
names(z4_prob_0pc_z3_prev) <- c('prevalence','zone','scenario')

z4_prob_0pc_zone_prev <- rbind(z4_prob_0pc_z1_prev,z4_prob_0pc_z2_prev,z4_prob_0pc_z3_prev)
```

```{r import Washing & Sanitation Check}
NL_table_WaS_Check <- fread(paste0(getwd(),'/BehaviorSpace/2020-10-28-09-25 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_P_50pc_Clean_Checks-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_WaS_Check <- NL_table_WaS_Check[NL_table_WaS_Check$scenario==40,]

while (any(grepl('-', names(NL_table_WaS_Check), fixed = TRUE))) {
  NL_table_WaS_Check <- NL_table_WaS_Check %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_WaS_Check), fixed = TRUE))) {
  NL_table_WaS_Check <- NL_table_WaS_Check %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_WaS_Check), fixed = TRUE))) {
  NL_table_WaS_Check <- NL_table_WaS_Check %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_WaS_Check), fixed = TRUE))) {
  NL_table_WaS_Check <- NL_table_WaS_Check %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_WaS_Check[ , ..list_columns]

NL_table_WaS_Check[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_WaS_Check <- as.data.frame(NL_table_WaS_Check)

NL_table_WaS_Check[NL_table_WaS_Check==-1] <- NA

NL_table_WaS_Check <- subset(NL_table_WaS_Check, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_WaS_Check)[names(NL_table_WaS_Check)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_WaS_Check)[names(NL_table_WaS_Check)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','z4_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_z4_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_WaS_Check$loading_w2wed_conc_list[order(NL_table_WaS_Check$local_seed)]
vector <- vector[vector!='[]']
was_check_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  was_check_loading_w2wed_conc_list <- append(was_check_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_WaS_Check$cleaning_w2wed_conc_list[order(NL_table_WaS_Check$local_seed)]
vector <- vector[vector!='[]']
was_check_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  was_check_cleaning_w2wed_conc_list <- append(was_check_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_WaS_Check$drying_w2wed_conc_list[order(NL_table_WaS_Check$local_seed)]
vector <- vector[vector!='[]']
was_check_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  was_check_drying_w2wed_conc_list <- append(was_check_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_WaS_Check$sorting_w2wed_conc_list[order(NL_table_WaS_Check$local_seed)]
vector <- vector[vector!='[]']
was_check_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  was_check_sorting_w2wed_conc_list <- append(was_check_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_WaS_Check$tray_packing_w2wed_conc_list[order(NL_table_WaS_Check$local_seed)]
vector <- vector[vector!='[]']
was_check_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  was_check_tray_packing_w2wed_conc_list <- append(was_check_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_WaS_Check$bag_packing_w2wed_conc_list[order(NL_table_WaS_Check$local_seed)]
vector <- vector[vector!='[]']
was_check_bag_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  was_check_bag_packing_w2wed_conc_list <- append(was_check_bag_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_WaS_Check$reject_w2wed_conc_list[order(NL_table_WaS_Check$local_seed)]
vector <- vector[vector!='[]']
was_check_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  was_check_reject_w2wed_conc_list <- append(was_check_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_WaS_Check$other_w2wed_conc_list[order(NL_table_WaS_Check$local_seed)]
vector <- vector[vector!='[]']
was_check_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  was_check_other_w2wed_conc_list <- append(was_check_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

was_check_loading_concs <- as.data.frame(was_check_loading_w2wed_conc_list)
was_check_loading_concs$area <- as.factor('loading')
was_check_loading_concs$scenario <- as.factor('WaS 50% Certainty')
was_check_loading_concs$water <- as.factor('Wet')
names(was_check_loading_concs) <- c('concentration','area','scenario','water')

was_check_cleaning_concs <- as.data.frame(was_check_cleaning_w2wed_conc_list)
was_check_cleaning_concs$area <- as.factor('cleaning')
was_check_cleaning_concs$scenario <- as.factor('WaS 50% Certainty')
was_check_cleaning_concs$water <- as.factor('Wet')
names(was_check_cleaning_concs) <- c('concentration','area','scenario','water')

was_check_sorting_concs <- as.data.frame(was_check_sorting_w2wed_conc_list)
was_check_sorting_concs$area <- as.factor('sorting')
was_check_sorting_concs$scenario <- as.factor('WaS 50% Certainty')
was_check_sorting_concs$water <- as.factor('Dry')
names(was_check_sorting_concs) <- c('concentration','area','scenario','water')

was_check_reject_concs <- as.data.frame(was_check_reject_w2wed_conc_list)
was_check_reject_concs$area <- as.factor('reject')
was_check_reject_concs$scenario <- as.factor('WaS 50% Certainty')
was_check_reject_concs$water <- as.factor('Dry')
names(was_check_reject_concs) <- c('concentration','area','scenario','water')

was_check_tray_packing_concs <- as.data.frame(was_check_tray_packing_w2wed_conc_list)
was_check_tray_packing_concs$area <- as.factor('tray packing')
was_check_tray_packing_concs$scenario <- as.factor('WaS 50% Certainty')
was_check_tray_packing_concs$water <- as.factor('Dry')
names(was_check_tray_packing_concs) <- c('concentration','area','scenario','water')

was_check_other_concs <- as.data.frame(was_check_other_w2wed_conc_list)
was_check_other_concs$area <- as.factor('other')
was_check_other_concs$scenario <- as.factor('WaS 50% Certainty')
was_check_other_concs$water <- as.factor('Dry')
names(was_check_other_concs) <- c('concentration','area','scenario','water')

was_check_concs <- rbind(was_check_loading_concs,was_check_cleaning_concs,was_check_sorting_concs,was_check_tray_packing_concs,was_check_reject_concs,was_check_other_concs)

was_check_loading_prev <- as.data.frame(NL_table_WaS_Check$loading_w2wed_prev[order(NL_table_WaS_Check$local_seed)])
was_check_loading_prev$area <- as.factor('loading')
was_check_loading_prev$scenario <- as.factor('WaS 50% Certainty')
was_check_loading_prev$water <- as.factor('Wet')
names(was_check_loading_prev) <- c('prevalence','area','scenario','water')

was_check_cleaning_prev <- as.data.frame(NL_table_WaS_Check$cleaning_w2wed_prev[order(NL_table_WaS_Check$local_seed)])
was_check_cleaning_prev$area <- as.factor('cleaning')
was_check_cleaning_prev$scenario <- as.factor('WaS 50% Certainty')
was_check_cleaning_prev$water <- as.factor('Wet')
names(was_check_cleaning_prev) <- c('prevalence','area','scenario','water')

was_check_sorting_prev <- as.data.frame(NL_table_WaS_Check$sorting_w2wed_prev[order(NL_table_WaS_Check$local_seed)])
was_check_sorting_prev$area <- as.factor('sorting')
was_check_sorting_prev$scenario <- as.factor('WaS 50% Certainty')
was_check_sorting_prev$water <- as.factor('Dry')
names(was_check_sorting_prev) <- c('prevalence','area','scenario','water')

was_check_reject_prev <- as.data.frame(NL_table_WaS_Check$reject_w2wed_prev[order(NL_table_WaS_Check$local_seed)])
was_check_reject_prev$area <- as.factor('reject')
was_check_reject_prev$scenario <- as.factor('WaS 50% Certainty')
was_check_reject_prev$water <- as.factor('Dry')
names(was_check_reject_prev) <- c('prevalence','area','scenario','water')

was_check_tray_packing_prev <- as.data.frame(NL_table_WaS_Check$tray_packing_w2wed_prev[order(NL_table_WaS_Check$local_seed)])
was_check_tray_packing_prev$area <- as.factor('tray packing')
was_check_tray_packing_prev$scenario <- as.factor('WaS 50% Certainty')
was_check_tray_packing_prev$water <- as.factor('Dry')
names(was_check_tray_packing_prev) <- c('prevalence','area','scenario','water')

was_check_other_prev <- as.data.frame(NL_table_WaS_Check$other_w2wed_prev[order(NL_table_WaS_Check$local_seed)])
was_check_other_prev$area <- as.factor('other')
was_check_other_prev$scenario <- as.factor('WaS 50% Certainty')
was_check_other_prev$water <- as.factor('Dry')
names(was_check_other_prev) <- c('prevalence','area','scenario','water')

was_check_prev <- rbind(was_check_loading_prev,was_check_cleaning_prev,was_check_sorting_prev,was_check_tray_packing_prev,was_check_reject_prev,was_check_other_prev)
```

```{r import Crate Prev 50%+Partial Prob Intervention W&S}
NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-19-02-40 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_CI_S47_48_49-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS[NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$scenario==47,]

while (any(grepl('-', names(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS[ , ..list_columns]

NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS <- as.data.frame(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS)

NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS[NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS==-1] <- NA

NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS <- subset(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS)[names(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS)[names(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','z4_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_z4_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$loading_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_partial_prob_intervention_was_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_partial_prob_intervention_was_loading_w2wed_conc_list <- append(crate_prev_50pc_w_partial_prob_intervention_was_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$cleaning_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_partial_prob_intervention_was_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_partial_prob_intervention_was_cleaning_w2wed_conc_list <- append(crate_prev_50pc_w_partial_prob_intervention_was_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$drying_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_partial_prob_intervention_was_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_partial_prob_intervention_was_drying_w2wed_conc_list <- append(crate_prev_50pc_w_partial_prob_intervention_was_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$sorting_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_partial_prob_intervention_was_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_partial_prob_intervention_was_sorting_w2wed_conc_list <- append(crate_prev_50pc_w_partial_prob_intervention_was_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$tray_packing_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_w2wed_conc_list <- append(crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$bag_packing_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_partial_prob_intervention_was_bag_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_partial_prob_intervention_was_bag_packing_w2wed_conc_list <- append(crate_prev_50pc_w_partial_prob_intervention_was_bag_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$reject_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_partial_prob_intervention_was_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_partial_prob_intervention_was_reject_w2wed_conc_list <- append(crate_prev_50pc_w_partial_prob_intervention_was_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$other_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_partial_prob_intervention_was_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_partial_prob_intervention_was_other_w2wed_conc_list <- append(crate_prev_50pc_w_partial_prob_intervention_was_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

crate_prev_50pc_w_partial_prob_intervention_was_loading_concs <- as.data.frame(crate_prev_50pc_w_partial_prob_intervention_was_loading_w2wed_conc_list)
crate_prev_50pc_w_partial_prob_intervention_was_loading_concs$area <- as.factor('loading')
crate_prev_50pc_w_partial_prob_intervention_was_loading_concs$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_loading_concs$water <- as.factor('Wet')
names(crate_prev_50pc_w_partial_prob_intervention_was_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_cleaning_concs <- as.data.frame(crate_prev_50pc_w_partial_prob_intervention_was_cleaning_w2wed_conc_list)
crate_prev_50pc_w_partial_prob_intervention_was_cleaning_concs$area <- as.factor('cleaning')
crate_prev_50pc_w_partial_prob_intervention_was_cleaning_concs$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_50pc_w_partial_prob_intervention_was_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_sorting_concs <- as.data.frame(crate_prev_50pc_w_partial_prob_intervention_was_sorting_w2wed_conc_list)
crate_prev_50pc_w_partial_prob_intervention_was_sorting_concs$area <- as.factor('sorting')
crate_prev_50pc_w_partial_prob_intervention_was_sorting_concs$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_sorting_concs$water <- as.factor('Dry')
names(crate_prev_50pc_w_partial_prob_intervention_was_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_reject_concs <- as.data.frame(crate_prev_50pc_w_partial_prob_intervention_was_reject_w2wed_conc_list)
crate_prev_50pc_w_partial_prob_intervention_was_reject_concs$area <- as.factor('reject')
crate_prev_50pc_w_partial_prob_intervention_was_reject_concs$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_reject_concs$water <- as.factor('Dry')
names(crate_prev_50pc_w_partial_prob_intervention_was_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_concs <- as.data.frame(crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_w2wed_conc_list)
crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_concs$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_other_concs <- as.data.frame(crate_prev_50pc_w_partial_prob_intervention_was_other_w2wed_conc_list)
crate_prev_50pc_w_partial_prob_intervention_was_other_concs$area <- as.factor('other')
crate_prev_50pc_w_partial_prob_intervention_was_other_concs$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_other_concs$water <- as.factor('Dry')
names(crate_prev_50pc_w_partial_prob_intervention_was_other_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_concs <- rbind(crate_prev_50pc_w_partial_prob_intervention_was_loading_concs,crate_prev_50pc_w_partial_prob_intervention_was_cleaning_concs,crate_prev_50pc_w_partial_prob_intervention_was_sorting_concs,crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_concs,crate_prev_50pc_w_partial_prob_intervention_was_reject_concs,crate_prev_50pc_w_partial_prob_intervention_was_other_concs)

crate_prev_50pc_w_partial_prob_intervention_was_loading_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$loading_w2wed_prev[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)])
crate_prev_50pc_w_partial_prob_intervention_was_loading_prev$area <- as.factor('loading')
crate_prev_50pc_w_partial_prob_intervention_was_loading_prev$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_loading_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w_partial_prob_intervention_was_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$cleaning_w2wed_prev[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)])
crate_prev_50pc_w_partial_prob_intervention_was_cleaning_prev$area <- as.factor('cleaning')
crate_prev_50pc_w_partial_prob_intervention_was_cleaning_prev$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w_partial_prob_intervention_was_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_sorting_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$sorting_w2wed_prev[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)])
crate_prev_50pc_w_partial_prob_intervention_was_sorting_prev$area <- as.factor('sorting')
crate_prev_50pc_w_partial_prob_intervention_was_sorting_prev$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_sorting_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w_partial_prob_intervention_was_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_reject_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$reject_w2wed_prev[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)])
crate_prev_50pc_w_partial_prob_intervention_was_reject_prev$area <- as.factor('reject')
crate_prev_50pc_w_partial_prob_intervention_was_reject_prev$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_reject_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w_partial_prob_intervention_was_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$tray_packing_w2wed_prev[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)])
crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_prev$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_other_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$other_w2wed_prev[order(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$local_seed)])
crate_prev_50pc_w_partial_prob_intervention_was_other_prev$area <- as.factor('other')
crate_prev_50pc_w_partial_prob_intervention_was_other_prev$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_other_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w_partial_prob_intervention_was_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_prev <- rbind(crate_prev_50pc_w_partial_prob_intervention_was_loading_prev,crate_prev_50pc_w_partial_prob_intervention_was_cleaning_prev,crate_prev_50pc_w_partial_prob_intervention_was_sorting_prev,crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_prev,crate_prev_50pc_w_partial_prob_intervention_was_reject_prev,crate_prev_50pc_w_partial_prob_intervention_was_other_prev)

crate_prev_50pc_w_partial_prob_intervention_was_wet_prev <- as.data.frame(crate_prev_50pc_w_partial_prob_intervention_was_loading_prev$prevalence*21/100+crate_prev_50pc_w_partial_prob_intervention_was_cleaning_prev$prevalence*28/100)/49*100
crate_prev_50pc_w_partial_prob_intervention_was_wet_prev$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_wet_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w_partial_prob_intervention_was_wet_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_dry_prev <- as.data.frame(crate_prev_50pc_w_partial_prob_intervention_was_sorting_prev$prevalence*20/100+crate_prev_50pc_w_partial_prob_intervention_was_reject_prev$prevalence*23/100+crate_prev_50pc_w_partial_prob_intervention_was_tray_packing_prev$prevalence*123/100+crate_prev_50pc_w_partial_prob_intervention_was_other_prev$prevalence*10/100)/176*100
crate_prev_50pc_w_partial_prob_intervention_was_dry_prev$scenario <- as.factor('CI_01')
crate_prev_50pc_w_partial_prob_intervention_was_dry_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w_partial_prob_intervention_was_dry_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev <- rbind(crate_prev_50pc_w_partial_prob_intervention_was_wet_prev, crate_prev_50pc_w_partial_prob_intervention_was_dry_prev)

crate_prev_50pc_w_partial_prob_intervention_was_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('CI_01'),
  as.factor(baseline_recombined_prev$water)
)
colnames(crate_prev_50pc_w_partial_prob_intervention_was_eff_prev)<- c('prevalence', 'scenario', 'water')

crate_prev_50pc_w_partial_prob_intervention_was_z1_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$z1_w2wed_prev)
crate_prev_50pc_w_partial_prob_intervention_was_z1_prev$zone <- as.factor('Z1')
crate_prev_50pc_w_partial_prob_intervention_was_z1_prev$scenario <- as.factor('CI_01')
names(crate_prev_50pc_w_partial_prob_intervention_was_z1_prev) <- c('prevalence','zone','scenario')

crate_prev_50pc_w_partial_prob_intervention_was_z2_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$z2_w2wed_prev)
crate_prev_50pc_w_partial_prob_intervention_was_z2_prev$zone <- as.factor('Z2')
crate_prev_50pc_w_partial_prob_intervention_was_z2_prev$scenario <- as.factor('CI_01')
names(crate_prev_50pc_w_partial_prob_intervention_was_z2_prev) <- c('prevalence','zone','scenario')

crate_prev_50pc_w_partial_prob_intervention_was_z3_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Partial_Prob_Intervention_WaS$z2_w2wed_prev)
crate_prev_50pc_w_partial_prob_intervention_was_z3_prev$zone <- as.factor('Z3')
crate_prev_50pc_w_partial_prob_intervention_was_z3_prev$scenario <- as.factor('CI_01')
names(crate_prev_50pc_w_partial_prob_intervention_was_z3_prev) <- c('prevalence','zone','scenario')

crate_prev_50pc_w_partial_prob_intervention_was_zone_prev <- rbind(crate_prev_50pc_w_partial_prob_intervention_was_z1_prev,crate_prev_50pc_w_partial_prob_intervention_was_z2_prev,crate_prev_50pc_w_partial_prob_intervention_was_z3_prev)
```

```{r import Crate prev 50%+Connections Intervention}
NL_table_Crate_Prev_50pc_w_Connections_Intervention <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-19-02-40 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_CI_S47_48_49-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Crate_Prev_50pc_w_Connections_Intervention <- NL_table_Crate_Prev_50pc_w_Connections_Intervention[NL_table_Crate_Prev_50pc_w_Connections_Intervention$scenario==48,]

while (any(grepl('-', names(NL_table_Crate_Prev_50pc_w_Connections_Intervention), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc_w_Connections_Intervention <- NL_table_Crate_Prev_50pc_w_Connections_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Crate_Prev_50pc_w_Connections_Intervention), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc_w_Connections_Intervention <- NL_table_Crate_Prev_50pc_w_Connections_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Crate_Prev_50pc_w_Connections_Intervention), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc_w_Connections_Intervention <- NL_table_Crate_Prev_50pc_w_Connections_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Crate_Prev_50pc_w_Connections_Intervention), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc_w_Connections_Intervention <- NL_table_Crate_Prev_50pc_w_Connections_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Crate_Prev_50pc_w_Connections_Intervention[ , ..list_columns]

NL_table_Crate_Prev_50pc_w_Connections_Intervention[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Crate_Prev_50pc_w_Connections_Intervention <- as.data.frame(NL_table_Crate_Prev_50pc_w_Connections_Intervention)

NL_table_Crate_Prev_50pc_w_Connections_Intervention[NL_table_Crate_Prev_50pc_w_Connections_Intervention==-1] <- NA

NL_table_Crate_Prev_50pc_w_Connections_Intervention <- subset(NL_table_Crate_Prev_50pc_w_Connections_Intervention, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Crate_Prev_50pc_w_Connections_Intervention)[names(NL_table_Crate_Prev_50pc_w_Connections_Intervention)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Crate_Prev_50pc_w_Connections_Intervention)[names(NL_table_Crate_Prev_50pc_w_Connections_Intervention)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','z4_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_z4_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Crate_Prev_50pc_w_Connections_Intervention$loading_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_connections_intervention_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_connections_intervention_loading_w2wed_conc_list <- append(crate_prev_50pc_w_connections_intervention_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Connections_Intervention$cleaning_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_connections_intervention_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_connections_intervention_cleaning_w2wed_conc_list <- append(crate_prev_50pc_w_connections_intervention_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Connections_Intervention$drying_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_connections_intervention_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_connections_intervention_drying_w2wed_conc_list <- append(crate_prev_50pc_w_connections_intervention_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Connections_Intervention$sorting_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_connections_intervention_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_connections_intervention_sorting_w2wed_conc_list <- append(crate_prev_50pc_w_connections_intervention_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Connections_Intervention$tray_packing_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_connections_intervention_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_connections_intervention_tray_packing_w2wed_conc_list <- append(crate_prev_50pc_w_connections_intervention_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Connections_Intervention$bag_packing_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_connections_intervention_bag_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_connections_intervention_bag_packing_w2wed_conc_list <- append(crate_prev_50pc_w_connections_intervention_bag_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Connections_Intervention$reject_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_connections_intervention_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_connections_intervention_reject_w2wed_conc_list <- append(crate_prev_50pc_w_connections_intervention_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Crate_Prev_50pc_w_Connections_Intervention$other_w2wed_conc_list[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
crate_prev_50pc_w_connections_intervention_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_w_connections_intervention_other_w2wed_conc_list <- append(crate_prev_50pc_w_connections_intervention_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

crate_prev_50pc_w_connections_intervention_loading_concs <- as.data.frame(crate_prev_50pc_w_connections_intervention_loading_w2wed_conc_list)
crate_prev_50pc_w_connections_intervention_loading_concs$area <- as.factor('loading')
crate_prev_50pc_w_connections_intervention_loading_concs$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_loading_concs$water <- as.factor('Wet')
names(crate_prev_50pc_w_connections_intervention_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w_connections_intervention_cleaning_concs <- as.data.frame(crate_prev_50pc_w_connections_intervention_cleaning_w2wed_conc_list)
crate_prev_50pc_w_connections_intervention_cleaning_concs$area <- as.factor('cleaning')
crate_prev_50pc_w_connections_intervention_cleaning_concs$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_50pc_w_connections_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w_connections_intervention_sorting_concs <- as.data.frame(crate_prev_50pc_w_connections_intervention_sorting_w2wed_conc_list)
crate_prev_50pc_w_connections_intervention_sorting_concs$area <- as.factor('sorting')
crate_prev_50pc_w_connections_intervention_sorting_concs$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_sorting_concs$water <- as.factor('Dry')
names(crate_prev_50pc_w_connections_intervention_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w_connections_intervention_reject_concs <- as.data.frame(crate_prev_50pc_w_connections_intervention_reject_w2wed_conc_list)
crate_prev_50pc_w_connections_intervention_reject_concs$area <- as.factor('reject')
crate_prev_50pc_w_connections_intervention_reject_concs$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_reject_concs$water <- as.factor('Dry')
names(crate_prev_50pc_w_connections_intervention_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w_connections_intervention_tray_packing_concs <- as.data.frame(crate_prev_50pc_w_connections_intervention_tray_packing_w2wed_conc_list)
crate_prev_50pc_w_connections_intervention_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_50pc_w_connections_intervention_tray_packing_concs$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_50pc_w_connections_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w_connections_intervention_other_concs <- as.data.frame(crate_prev_50pc_w_connections_intervention_other_w2wed_conc_list)
crate_prev_50pc_w_connections_intervention_other_concs$area <- as.factor('other')
crate_prev_50pc_w_connections_intervention_other_concs$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_other_concs$water <- as.factor('Dry')
names(crate_prev_50pc_w_connections_intervention_other_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w_connections_intervention_concs <- rbind(crate_prev_50pc_w_connections_intervention_loading_concs,crate_prev_50pc_w_connections_intervention_cleaning_concs,crate_prev_50pc_w_connections_intervention_sorting_concs,crate_prev_50pc_w_connections_intervention_tray_packing_concs,crate_prev_50pc_w_connections_intervention_reject_concs,crate_prev_50pc_w_connections_intervention_other_concs)

crate_prev_50pc_w_connections_intervention_loading_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Connections_Intervention$loading_w2wed_prev[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)])
crate_prev_50pc_w_connections_intervention_loading_prev$area <- as.factor('loading')
crate_prev_50pc_w_connections_intervention_loading_prev$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_loading_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w_connections_intervention_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w_connections_intervention_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Connections_Intervention$cleaning_w2wed_prev[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)])
crate_prev_50pc_w_connections_intervention_cleaning_prev$area <- as.factor('cleaning')
crate_prev_50pc_w_connections_intervention_cleaning_prev$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w_connections_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w_connections_intervention_sorting_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Connections_Intervention$sorting_w2wed_prev[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)])
crate_prev_50pc_w_connections_intervention_sorting_prev$area <- as.factor('sorting')
crate_prev_50pc_w_connections_intervention_sorting_prev$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_sorting_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w_connections_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w_connections_intervention_reject_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Connections_Intervention$reject_w2wed_prev[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)])
crate_prev_50pc_w_connections_intervention_reject_prev$area <- as.factor('reject')
crate_prev_50pc_w_connections_intervention_reject_prev$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_reject_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w_connections_intervention_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w_connections_intervention_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Connections_Intervention$tray_packing_w2wed_prev[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)])
crate_prev_50pc_w_connections_intervention_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_50pc_w_connections_intervention_tray_packing_prev$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w_connections_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w_connections_intervention_other_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Connections_Intervention$other_w2wed_prev[order(NL_table_Crate_Prev_50pc_w_Connections_Intervention$local_seed)])
crate_prev_50pc_w_connections_intervention_other_prev$area <- as.factor('other')
crate_prev_50pc_w_connections_intervention_other_prev$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_other_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w_connections_intervention_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w_connections_intervention_wet_prev <- as.data.frame(crate_prev_50pc_w_connections_intervention_loading_prev$prevalence*21/100+crate_prev_50pc_w_connections_intervention_cleaning_prev$prevalence*28/100)/49*100
crate_prev_50pc_w_connections_intervention_wet_prev$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_wet_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w_connections_intervention_wet_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w_connections_intervention_dry_prev <- as.data.frame(crate_prev_50pc_w_connections_intervention_sorting_prev$prevalence*20/100+crate_prev_50pc_w_connections_intervention_reject_prev$prevalence*23/100+crate_prev_50pc_w_connections_intervention_tray_packing_prev$prevalence*123/100+crate_prev_50pc_w_connections_intervention_other_prev$prevalence*10/100)/176*100
crate_prev_50pc_w_connections_intervention_dry_prev$scenario <- as.factor('CI_02')
crate_prev_50pc_w_connections_intervention_dry_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w_connections_intervention_dry_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w_connections_intervention_recombined_prev <- rbind(crate_prev_50pc_w_connections_intervention_wet_prev, crate_prev_50pc_w_connections_intervention_dry_prev)

crate_prev_50pc_w_connections_intervention_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(crate_prev_50pc_w_connections_intervention_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('CI_02'),
  as.factor(baseline_recombined_prev$water)
)
colnames(crate_prev_50pc_w_connections_intervention_eff_prev)<- c('prevalence', 'scenario', 'water')

crate_prev_50pc_w_connections_intervention_z1_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Connections_Intervention$z1_w2wed_prev)
crate_prev_50pc_w_connections_intervention_z1_prev$zone <- as.factor('Z1')
crate_prev_50pc_w_connections_intervention_z1_prev$scenario <- as.factor('CI_02')
names(crate_prev_50pc_w_connections_intervention_z1_prev) <- c('prevalence','zone','scenario')

crate_prev_50pc_w_connections_intervention_z2_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Connections_Intervention$z2_w2wed_prev)
crate_prev_50pc_w_connections_intervention_z2_prev$zone <- as.factor('Z2')
crate_prev_50pc_w_connections_intervention_z2_prev$scenario <- as.factor('CI_02')
names(crate_prev_50pc_w_connections_intervention_z2_prev) <- c('prevalence','zone','scenario')

crate_prev_50pc_w_connections_intervention_z3_prev <- as.data.frame(NL_table_Crate_Prev_50pc_w_Connections_Intervention$z2_w2wed_prev)
crate_prev_50pc_w_connections_intervention_z3_prev$zone <- as.factor('Z3')
crate_prev_50pc_w_connections_intervention_z3_prev$scenario <- as.factor('CI_02')
names(crate_prev_50pc_w_connections_intervention_z3_prev) <- c('prevalence','zone','scenario')

crate_prev_50pc_w_connections_intervention_zone_prev <- rbind(crate_prev_50pc_w_connections_intervention_z1_prev,crate_prev_50pc_w_connections_intervention_z2_prev,crate_prev_50pc_w_connections_intervention_z3_prev)
```

```{r import Partial Prob Intervention W&S+Connections Intervention}
NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-19-02-40 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_CI_S47_48_49-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention[NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$scenario==49,]

while (any(grepl('-', names(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention), fixed = TRUE))) {
  NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention), fixed = TRUE))) {
  NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention), fixed = TRUE))) {
  NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention), fixed = TRUE))) {
  NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention[ , ..list_columns]

NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention <- as.data.frame(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention)

NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention[NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention==-1] <- NA

NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention <- subset(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention)[names(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention)[names(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','z4_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_z4_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$loading_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_was_w_connections_intervention_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_was_w_connections_intervention_loading_w2wed_conc_list <- append(partial_prob_intervention_was_w_connections_intervention_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$cleaning_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_was_w_connections_intervention_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_was_w_connections_intervention_cleaning_w2wed_conc_list <- append(partial_prob_intervention_was_w_connections_intervention_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$drying_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_was_w_connections_intervention_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_was_w_connections_intervention_drying_w2wed_conc_list <- append(partial_prob_intervention_was_w_connections_intervention_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$sorting_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_was_w_connections_intervention_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_was_w_connections_intervention_sorting_w2wed_conc_list <- append(partial_prob_intervention_was_w_connections_intervention_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$tray_packing_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_was_w_connections_intervention_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_was_w_connections_intervention_tray_packing_w2wed_conc_list <- append(partial_prob_intervention_was_w_connections_intervention_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$bag_packing_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_was_w_connections_intervention_bag_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_was_w_connections_intervention_bag_packing_w2wed_conc_list <- append(partial_prob_intervention_was_w_connections_intervention_bag_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$reject_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_was_w_connections_intervention_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_was_w_connections_intervention_reject_w2wed_conc_list <- append(partial_prob_intervention_was_w_connections_intervention_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$other_w2wed_conc_list[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
partial_prob_intervention_was_w_connections_intervention_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_was_w_connections_intervention_other_w2wed_conc_list <- append(partial_prob_intervention_was_w_connections_intervention_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

partial_prob_intervention_was_w_connections_intervention_loading_concs <- as.data.frame(partial_prob_intervention_was_w_connections_intervention_loading_w2wed_conc_list)
partial_prob_intervention_was_w_connections_intervention_loading_concs$area <- as.factor('loading')
partial_prob_intervention_was_w_connections_intervention_loading_concs$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_loading_concs$water <- as.factor('Wet')
names(partial_prob_intervention_was_w_connections_intervention_loading_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_was_w_connections_intervention_cleaning_concs <- as.data.frame(partial_prob_intervention_was_w_connections_intervention_cleaning_w2wed_conc_list)
partial_prob_intervention_was_w_connections_intervention_cleaning_concs$area <- as.factor('cleaning')
partial_prob_intervention_was_w_connections_intervention_cleaning_concs$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_cleaning_concs$water <- as.factor('Wet')
names(partial_prob_intervention_was_w_connections_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_was_w_connections_intervention_sorting_concs <- as.data.frame(partial_prob_intervention_was_w_connections_intervention_sorting_w2wed_conc_list)
partial_prob_intervention_was_w_connections_intervention_sorting_concs$area <- as.factor('sorting')
partial_prob_intervention_was_w_connections_intervention_sorting_concs$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_sorting_concs$water <- as.factor('Dry')
names(partial_prob_intervention_was_w_connections_intervention_sorting_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_was_w_connections_intervention_reject_concs <- as.data.frame(partial_prob_intervention_was_w_connections_intervention_reject_w2wed_conc_list)
partial_prob_intervention_was_w_connections_intervention_reject_concs$area <- as.factor('reject')
partial_prob_intervention_was_w_connections_intervention_reject_concs$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_reject_concs$water <- as.factor('Dry')
names(partial_prob_intervention_was_w_connections_intervention_reject_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_was_w_connections_intervention_tray_packing_concs <- as.data.frame(partial_prob_intervention_was_w_connections_intervention_tray_packing_w2wed_conc_list)
partial_prob_intervention_was_w_connections_intervention_tray_packing_concs$area <- as.factor('tray packing')
partial_prob_intervention_was_w_connections_intervention_tray_packing_concs$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_tray_packing_concs$water <- as.factor('Dry')
names(partial_prob_intervention_was_w_connections_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_was_w_connections_intervention_other_concs <- as.data.frame(partial_prob_intervention_was_w_connections_intervention_other_w2wed_conc_list)
partial_prob_intervention_was_w_connections_intervention_other_concs$area <- as.factor('other')
partial_prob_intervention_was_w_connections_intervention_other_concs$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_other_concs$water <- as.factor('Dry')
names(partial_prob_intervention_was_w_connections_intervention_other_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_was_w_connections_intervention_concs <- rbind(partial_prob_intervention_was_w_connections_intervention_loading_concs,partial_prob_intervention_was_w_connections_intervention_cleaning_concs,partial_prob_intervention_was_w_connections_intervention_sorting_concs,partial_prob_intervention_was_w_connections_intervention_tray_packing_concs,partial_prob_intervention_was_w_connections_intervention_reject_concs,partial_prob_intervention_was_w_connections_intervention_other_concs)

partial_prob_intervention_was_w_connections_intervention_loading_prev <- as.data.frame(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$loading_w2wed_prev[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)])
partial_prob_intervention_was_w_connections_intervention_loading_prev$area <- as.factor('loading')
partial_prob_intervention_was_w_connections_intervention_loading_prev$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_loading_prev$water <- as.factor('Wet')
names(partial_prob_intervention_was_w_connections_intervention_loading_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_was_w_connections_intervention_cleaning_prev <- as.data.frame(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$cleaning_w2wed_prev[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)])
partial_prob_intervention_was_w_connections_intervention_cleaning_prev$area <- as.factor('cleaning')
partial_prob_intervention_was_w_connections_intervention_cleaning_prev$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_cleaning_prev$water <- as.factor('Wet')
names(partial_prob_intervention_was_w_connections_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_was_w_connections_intervention_sorting_prev <- as.data.frame(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$sorting_w2wed_prev[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)])
partial_prob_intervention_was_w_connections_intervention_sorting_prev$area <- as.factor('sorting')
partial_prob_intervention_was_w_connections_intervention_sorting_prev$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_sorting_prev$water <- as.factor('Dry')
names(partial_prob_intervention_was_w_connections_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_was_w_connections_intervention_reject_prev <- as.data.frame(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$reject_w2wed_prev[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)])
partial_prob_intervention_was_w_connections_intervention_reject_prev$area <- as.factor('reject')
partial_prob_intervention_was_w_connections_intervention_reject_prev$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_reject_prev$water <- as.factor('Dry')
names(partial_prob_intervention_was_w_connections_intervention_reject_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_was_w_connections_intervention_tray_packing_prev <- as.data.frame(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$tray_packing_w2wed_prev[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)])
partial_prob_intervention_was_w_connections_intervention_tray_packing_prev$area <- as.factor('tray packing')
partial_prob_intervention_was_w_connections_intervention_tray_packing_prev$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_tray_packing_prev$water <- as.factor('Dry')
names(partial_prob_intervention_was_w_connections_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_was_w_connections_intervention_other_prev <- as.data.frame(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$other_w2wed_prev[order(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$local_seed)])
partial_prob_intervention_was_w_connections_intervention_other_prev$area <- as.factor('other')
partial_prob_intervention_was_w_connections_intervention_other_prev$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_other_prev$water <- as.factor('Dry')
names(partial_prob_intervention_was_w_connections_intervention_other_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_was_w_connections_intervention_prev <- rbind(partial_prob_intervention_was_w_connections_intervention_loading_prev,partial_prob_intervention_was_w_connections_intervention_cleaning_prev,partial_prob_intervention_was_w_connections_intervention_sorting_prev,partial_prob_intervention_was_w_connections_intervention_tray_packing_prev,partial_prob_intervention_was_w_connections_intervention_reject_prev,partial_prob_intervention_was_w_connections_intervention_other_prev)

partial_prob_intervention_was_w_connections_intervention_wet_prev <- as.data.frame(partial_prob_intervention_was_w_connections_intervention_loading_prev$prevalence*21/100+partial_prob_intervention_was_w_connections_intervention_cleaning_prev$prevalence*28/100)/49*100
partial_prob_intervention_was_w_connections_intervention_wet_prev$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_wet_prev$water <- as.factor('Wet')
names(partial_prob_intervention_was_w_connections_intervention_wet_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_was_w_connections_intervention_dry_prev <- as.data.frame(partial_prob_intervention_was_w_connections_intervention_sorting_prev$prevalence*20/100+partial_prob_intervention_was_w_connections_intervention_reject_prev$prevalence*23/100+partial_prob_intervention_was_w_connections_intervention_tray_packing_prev$prevalence*123/100+partial_prob_intervention_was_w_connections_intervention_other_prev$prevalence*10/100)/176*100
partial_prob_intervention_was_w_connections_intervention_dry_prev$scenario <- as.factor('CI_03')
partial_prob_intervention_was_w_connections_intervention_dry_prev$water <- as.factor('Dry')
names(partial_prob_intervention_was_w_connections_intervention_dry_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_was_w_connections_intervention_recombined_prev <- rbind(partial_prob_intervention_was_w_connections_intervention_wet_prev, partial_prob_intervention_was_w_connections_intervention_dry_prev)

partial_prob_intervention_was_w_connections_intervention_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(partial_prob_intervention_was_w_connections_intervention_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('CI_03'),
  as.factor(baseline_recombined_prev$water)
)
colnames(partial_prob_intervention_was_w_connections_intervention_eff_prev)<- c('prevalence', 'scenario', 'water')

partial_prob_intervention_was_w_connections_intervention_z1_prev <- as.data.frame(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$z1_w2wed_prev)
partial_prob_intervention_was_w_connections_intervention_z1_prev$zone <- as.factor('Z1')
partial_prob_intervention_was_w_connections_intervention_z1_prev$scenario <- as.factor('CI_03')
names(partial_prob_intervention_was_w_connections_intervention_z1_prev) <- c('prevalence','zone','scenario')

partial_prob_intervention_was_w_connections_intervention_z2_prev <- as.data.frame(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$z2_w2wed_prev)
partial_prob_intervention_was_w_connections_intervention_z2_prev$zone <- as.factor('Z2')
partial_prob_intervention_was_w_connections_intervention_z2_prev$scenario <- as.factor('CI_03')
names(partial_prob_intervention_was_w_connections_intervention_z2_prev) <- c('prevalence','zone','scenario')

partial_prob_intervention_was_w_connections_intervention_z3_prev <- as.data.frame(NL_table_Partial_Prob_Intervention_WaS_w_Connections_Intervention$z2_w2wed_prev)
partial_prob_intervention_was_w_connections_intervention_z3_prev$zone <- as.factor('Z3')
partial_prob_intervention_was_w_connections_intervention_z3_prev$scenario <- as.factor('CI_03')
names(partial_prob_intervention_was_w_connections_intervention_z3_prev) <- c('prevalence','zone','scenario')

partial_prob_intervention_was_w_connections_intervention_zone_prev <- rbind(partial_prob_intervention_was_w_connections_intervention_z1_prev,partial_prob_intervention_was_w_connections_intervention_z2_prev,partial_prob_intervention_was_w_connections_intervention_z3_prev)
```

```{r import Connections Intervention}
NL_table_Connections_Intervention <- fread(paste0(getwd(),'/Data/BehaviorSpace/2021-04-17-05-07 ENABLE-Facility_B-50cm_05-Custom 1000_Runs_Connections_Intervention-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Connections_Intervention <- NL_table_Connections_Intervention[NL_table_Connections_Intervention$scenario==46,]

while (any(grepl('-', names(NL_table_Connections_Intervention), fixed = TRUE))) {
  NL_table_Connections_Intervention <- NL_table_Connections_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Connections_Intervention), fixed = TRUE))) {
  NL_table_Connections_Intervention <- NL_table_Connections_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Connections_Intervention), fixed = TRUE))) {
  NL_table_Connections_Intervention <- NL_table_Connections_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Connections_Intervention), fixed = TRUE))) {
  NL_table_Connections_Intervention <- NL_table_Connections_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Connections_Intervention[ , ..list_columns]

NL_table_Connections_Intervention[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Connections_Intervention <- as.data.frame(NL_table_Connections_Intervention)

NL_table_Connections_Intervention[NL_table_Connections_Intervention==-1] <- NA

NL_table_Connections_Intervention <- subset(NL_table_Connections_Intervention, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Connections_Intervention)[names(NL_table_Connections_Intervention)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Connections_Intervention)[names(NL_table_Connections_Intervention)=='a_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','z4_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_z4_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

vector <- NL_table_Connections_Intervention$loading_w2wed_conc_list[order(NL_table_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
connections_intervention_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_loading_w2wed_conc_list <- append(connections_intervention_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Connections_Intervention$cleaning_w2wed_conc_list[order(NL_table_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
connections_intervention_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_cleaning_w2wed_conc_list <- append(connections_intervention_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Connections_Intervention$drying_w2wed_conc_list[order(NL_table_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
connections_intervention_drying_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_drying_w2wed_conc_list <- append(connections_intervention_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Connections_Intervention$sorting_w2wed_conc_list[order(NL_table_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
connections_intervention_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_sorting_w2wed_conc_list <- append(connections_intervention_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Connections_Intervention$tray_packing_w2wed_conc_list[order(NL_table_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
connections_intervention_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_tray_packing_w2wed_conc_list <- append(connections_intervention_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Connections_Intervention$bag_packing_w2wed_conc_list[order(NL_table_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
connections_intervention_bag_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_bag_packing_w2wed_conc_list <- append(connections_intervention_bag_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Connections_Intervention$reject_w2wed_conc_list[order(NL_table_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
connections_intervention_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_reject_w2wed_conc_list <- append(connections_intervention_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

vector <- NL_table_Connections_Intervention$other_w2wed_conc_list[order(NL_table_Connections_Intervention$local_seed)]
vector <- vector[vector!='[]']
connections_intervention_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_other_w2wed_conc_list <- append(connections_intervention_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}

connections_intervention_loading_concs <- as.data.frame(connections_intervention_loading_w2wed_conc_list)
connections_intervention_loading_concs$area <- as.factor('loading')
connections_intervention_loading_concs$scenario <- as.factor('AI_04')
connections_intervention_loading_concs$water <- as.factor('Wet')
names(connections_intervention_loading_concs) <- c('concentration','area','scenario','water')

connections_intervention_cleaning_concs <- as.data.frame(connections_intervention_cleaning_w2wed_conc_list)
connections_intervention_cleaning_concs$area <- as.factor('cleaning')
connections_intervention_cleaning_concs$scenario <- as.factor('AI_04')
connections_intervention_cleaning_concs$water <- as.factor('Wet')
names(connections_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

connections_intervention_sorting_concs <- as.data.frame(connections_intervention_sorting_w2wed_conc_list)
connections_intervention_sorting_concs$area <- as.factor('sorting')
connections_intervention_sorting_concs$scenario <- as.factor('AI_04')
connections_intervention_sorting_concs$water <- as.factor('Dry')
names(connections_intervention_sorting_concs) <- c('concentration','area','scenario','water')

connections_intervention_reject_concs <- as.data.frame(connections_intervention_reject_w2wed_conc_list)
connections_intervention_reject_concs$area <- as.factor('reject')
connections_intervention_reject_concs$scenario <- as.factor('AI_04')
connections_intervention_reject_concs$water <- as.factor('Dry')
names(connections_intervention_reject_concs) <- c('concentration','area','scenario','water')

connections_intervention_tray_packing_concs <- as.data.frame(connections_intervention_tray_packing_w2wed_conc_list)
connections_intervention_tray_packing_concs$area <- as.factor('tray packing')
connections_intervention_tray_packing_concs$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_concs$water <- as.factor('Dry')
names(connections_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

connections_intervention_other_concs <- as.data.frame(connections_intervention_other_w2wed_conc_list)
connections_intervention_other_concs$area <- as.factor('other')
connections_intervention_other_concs$scenario <- as.factor('AI_04')
connections_intervention_other_concs$water <- as.factor('Dry')
names(connections_intervention_other_concs) <- c('concentration','area','scenario','water')

connections_intervention_concs <- rbind(connections_intervention_loading_concs,connections_intervention_cleaning_concs,connections_intervention_sorting_concs,connections_intervention_tray_packing_concs,connections_intervention_reject_concs,connections_intervention_other_concs)

connections_intervention_loading_prev <- as.data.frame(NL_table_Connections_Intervention$loading_w2wed_prev[order(NL_table_Connections_Intervention$local_seed)])
connections_intervention_loading_prev$area <- as.factor('loading')
connections_intervention_loading_prev$scenario <- as.factor('AI_04')
connections_intervention_loading_prev$water <- as.factor('Wet')
names(connections_intervention_loading_prev) <- c('prevalence','area','scenario','water')

connections_intervention_cleaning_prev <- as.data.frame(NL_table_Connections_Intervention$cleaning_w2wed_prev[order(NL_table_Connections_Intervention$local_seed)])
connections_intervention_cleaning_prev$area <- as.factor('cleaning')
connections_intervention_cleaning_prev$scenario <- as.factor('AI_04')
connections_intervention_cleaning_prev$water <- as.factor('Wet')
names(connections_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

connections_intervention_sorting_prev <- as.data.frame(NL_table_Connections_Intervention$sorting_w2wed_prev[order(NL_table_Connections_Intervention$local_seed)])
connections_intervention_sorting_prev$area <- as.factor('sorting')
connections_intervention_sorting_prev$scenario <- as.factor('AI_04')
connections_intervention_sorting_prev$water <- as.factor('Dry')
names(connections_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

connections_intervention_reject_prev <- as.data.frame(NL_table_Connections_Intervention$reject_w2wed_prev[order(NL_table_Connections_Intervention$local_seed)])
connections_intervention_reject_prev$area <- as.factor('reject')
connections_intervention_reject_prev$scenario <- as.factor('AI_04')
connections_intervention_reject_prev$water <- as.factor('Dry')
names(connections_intervention_reject_prev) <- c('prevalence','area','scenario','water')

connections_intervention_tray_packing_prev <- as.data.frame(NL_table_Connections_Intervention$tray_packing_w2wed_prev[order(NL_table_Connections_Intervention$local_seed)])
connections_intervention_tray_packing_prev$area <- as.factor('tray packing')
connections_intervention_tray_packing_prev$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_prev$water <- as.factor('Dry')
names(connections_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

connections_intervention_other_prev <- as.data.frame(NL_table_Connections_Intervention$other_w2wed_prev[order(NL_table_Connections_Intervention$local_seed)])
connections_intervention_other_prev$area <- as.factor('other')
connections_intervention_other_prev$scenario <- as.factor('AI_04')
connections_intervention_other_prev$water <- as.factor('Dry')
names(connections_intervention_other_prev) <- c('prevalence','area','scenario','water')

connections_intervention_prev <- rbind(connections_intervention_loading_prev,connections_intervention_cleaning_prev,connections_intervention_sorting_prev,connections_intervention_tray_packing_prev,connections_intervention_reject_prev,connections_intervention_other_prev)

connections_intervention_wet_prev <- as.data.frame(connections_intervention_loading_prev$prevalence*21/100+connections_intervention_cleaning_prev$prevalence*28/100)/49*100
connections_intervention_wet_prev$scenario <- as.factor('AI_04')
connections_intervention_wet_prev$water <- as.factor('Wet')
names(connections_intervention_wet_prev) <- c('prevalence','scenario','water')

connections_intervention_dry_prev <- as.data.frame(connections_intervention_sorting_prev$prevalence*20/100+connections_intervention_reject_prev$prevalence*23/100+connections_intervention_tray_packing_prev$prevalence*123/100+connections_intervention_other_prev$prevalence*10/100)/176*100
connections_intervention_dry_prev$scenario <- as.factor('AI_04')
connections_intervention_dry_prev$water <- as.factor('Dry')
names(connections_intervention_dry_prev) <- c('prevalence','scenario','water')

connections_intervention_recombined_prev <- rbind(connections_intervention_wet_prev, connections_intervention_dry_prev)

connections_intervention_eff_prev <- data.frame(
  c(((baseline_recombined_prev$prevalence)-(connections_intervention_recombined_prev$prevalence))/(baseline_recombined_prev$prevalence)),
  as.factor('AI_04'),
  as.factor(baseline_recombined_prev$water)
)
colnames(connections_intervention_eff_prev)<- c('prevalence', 'scenario', 'water')

connections_intervention_z1_prev <- as.data.frame(NL_table_Connections_Intervention$z1_w2wed_prev)
connections_intervention_z1_prev$zone <- as.factor('Z1')
connections_intervention_z1_prev$scenario <- as.factor('AI_04')
names(connections_intervention_z1_prev) <- c('prevalence','zone','scenario')

connections_intervention_z2_prev <- as.data.frame(NL_table_Connections_Intervention$z2_w2wed_prev)
connections_intervention_z2_prev$zone <- as.factor('Z2')
connections_intervention_z2_prev$scenario <- as.factor('AI_04')
names(connections_intervention_z2_prev) <- c('prevalence','zone','scenario')

connections_intervention_z3_prev <- as.data.frame(NL_table_Connections_Intervention$z2_w2wed_prev)
connections_intervention_z3_prev$zone <- as.factor('Z3')
connections_intervention_z3_prev$scenario <- as.factor('AI_04')
names(connections_intervention_z3_prev) <- c('prevalence','zone','scenario')

connections_intervention_zone_prev <- rbind(connections_intervention_z1_prev,connections_intervention_z2_prev,connections_intervention_z3_prev)
```

```{r W2Wed Efficacy}
c_wet <- 0.5/49
c_dry <- 0.5/176

wet_efficacy <- data.frame(scenario=character(),
                           median=double(),
                           upper_quartile=double(),
                           lower_quartile=double(),
                stringsAsFactors=FALSE)
dry_efficacy <- data.frame(scenario=character(),
                           median=double(),
                           lower_quartile=double(),
                           upper_quartile=double(),
                stringsAsFactors=FALSE)

#Random
#PR_01
we <- data.frame("PR_01",round(median((1-(random_prob_150pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(random_prob_150pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(random_prob_150pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("PR_01",round(median((1-(random_prob_150pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(random_prob_150pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(random_prob_150pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#PR_02
we <- data.frame("PR_02",round(median((1-(random_prob_200pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(random_prob_200pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(random_prob_200pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("PR_02",round(median((1-(random_prob_200pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(random_prob_200pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(random_prob_200pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#PR_03
we <- data.frame("PR_03",round(median((1-(random_prob_250pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(random_prob_250pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(random_prob_250pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("PR_03",round(median((1-(random_prob_250pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(random_prob_250pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(random_prob_250pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#LR
#LR_01
we <- data.frame("LR_01",round(median((1-(random_load_1_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(random_load_1_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(random_load_1_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("LR_01",round(median((1-(random_load_1_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(random_load_1_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(random_load_1_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#LR_02
we <- data.frame("LR_02",round(median((1-(random_load_2_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(random_load_2_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(random_load_2_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("LR_02",round(median((1-(random_load_2_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(random_load_2_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(random_load_2_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#LR_03
we <- data.frame("LR_03",round(median((1-(random_load_3_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(random_load_3_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(random_load_3_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("LR_03",round(median((1-(random_load_3_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(random_load_3_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(random_load_3_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#PZ
#PZ_01
we <- data.frame("PZ_01",round(median((1-(z4_prob_75pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(z4_prob_75pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_prob_75pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("PZ_01",round(median((1-(z4_prob_75pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(z4_prob_75pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_prob_75pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#PZ_02
we <- data.frame("PZ_02",round(median((1-(z4_prob_50pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(z4_prob_50pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_prob_50pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("PZ_02",round(median((1-(z4_prob_50pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(z4_prob_50pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_prob_50pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#PZ_03
we <- data.frame("PZ_03",round(median((1-(z4_prob_25pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(z4_prob_25pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_prob_25pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("PZ_03",round(median((1-(z4_prob_25pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(z4_prob_25pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_prob_25pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#PZ_04
we <- data.frame("PZ_04",round(median((1-(z4_prob_0pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(z4_prob_0pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_prob_0pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("PZ_04",round(median((1-(z4_prob_0pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(z4_prob_0pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_prob_0pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#LZ
#LZ_01
we <- data.frame("LZ_01",round(median((1-(z4_load_1_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(z4_load_1_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_load_1_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("LZ_01",round(median((1-(z4_load_1_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(z4_load_1_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_load_1_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#LZ_02
we <- data.frame("LZ_02",round(median((1-(z4_load_2_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(z4_load_2_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_load_2_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("LZ_02",round(median((1-(z4_load_2_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(z4_load_2_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_load_2_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#LZ_03
we <- data.frame("LZ_03",round(median((1-(z4_load_3_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(z4_load_3_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_load_3_log_red_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("LZ_03",round(median((1-(z4_load_3_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(z4_load_3_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(z4_load_3_log_red_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#EC
#EC_01
we <- data.frame("EC_01",round(median((1-(crate_prev_75pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(crate_prev_75pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(crate_prev_75pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("EC_01",round(median((1-(crate_prev_75pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(crate_prev_75pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(crate_prev_75pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#EC_02
we <- data.frame("EC_02",round(median((1-(crate_prev_50pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(crate_prev_50pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(crate_prev_50pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("EC_02",round(median((1-(crate_prev_50pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(crate_prev_50pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(crate_prev_50pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#EC_03
we <- data.frame("EC_03",round(median((1-(crate_prev_25pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(crate_prev_25pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(crate_prev_25pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("EC_03",round(median((1-(crate_prev_25pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(crate_prev_25pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(crate_prev_25pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#EC_04
we <- data.frame("EC_04",round(median((1-(crate_prev_0pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(crate_prev_0pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(crate_prev_0pc_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("EC_04",round(median((1-(crate_prev_0pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(crate_prev_0pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(crate_prev_0pc_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#MI
#MI_01
we <- data.frame("MI_01",round(median((1-(red_3_log_imp_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(red_3_log_imp_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(red_3_log_imp_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("MI_01",round(median((1-(red_3_log_imp_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(red_3_log_imp_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(red_3_log_imp_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#MI_02
we <- data.frame("MI_02",round(median((1-(deep_clean_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(deep_clean_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(deep_clean_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("MI_02",round(median((1-(deep_clean_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(deep_clean_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(deep_clean_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#AI
#AI_01
we <- data.frame("AI_01",round(median((1-(flume_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(flume_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(flume_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("AI_01",round(median((1-(flume_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(flume_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(flume_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#AI_02
we <- data.frame("AI_02",round(median((1-(prob_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(prob_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(prob_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("AI_02",round(median((1-(prob_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(prob_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(prob_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#AI_02C1
we <- data.frame("AI_02C1",NA,NA,NA)
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("AI_02C1",NA,NA,NA)
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#AI_02C2
we <- data.frame("AI_02C2",NA,NA,NA)
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("AI_02C2",NA,NA,NA)
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#AI_03
we <- data.frame("AI_03",round(median((1-(partial_prob_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(partial_prob_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(partial_prob_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("AI_03",round(median((1-(partial_prob_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(partial_prob_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(partial_prob_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#AI_03C1
we <- data.frame("AI_03C1",NA,NA,NA)
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("AI_03C1",NA,NA,NA)
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#AI_03C2
we <- data.frame("AI_03C2",NA,NA,NA)
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("AI_03C2",NA,NA,NA)
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#AI_04
we <- data.frame("AI_04",round(median((1-(connections_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(connections_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(connections_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("AI_04",round(median((1-(connections_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(connections_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(connections_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#CI
#CI_01
we <- data.frame("CI_01",round(median((1-(crate_prev_50pc_w_partial_prob_intervention_was_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(crate_prev_50pc_w_partial_prob_intervention_was_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(crate_prev_50pc_w_partial_prob_intervention_was_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("CI_01",round(median((1-(crate_prev_50pc_w_partial_prob_intervention_was_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(crate_prev_50pc_w_partial_prob_intervention_was_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(crate_prev_50pc_w_partial_prob_intervention_was_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#CI_02
we <- data.frame("CI_02",round(median((1-(crate_prev_50pc_w_connections_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(crate_prev_50pc_w_connections_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(crate_prev_50pc_w_connections_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("CI_02",round(median((1-(crate_prev_50pc_w_connections_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(crate_prev_50pc_w_connections_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(crate_prev_50pc_w_connections_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

#CI_03
we <- data.frame("CI_03",round(median((1-(partial_prob_intervention_was_w_connections_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100),1),round(quantile((1-(partial_prob_intervention_was_w_connections_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(partial_prob_intervention_was_w_connections_intervention_wet_prev$prevalence+c_wet)/(baseline_wet_prev$prevalence+c_wet))*100,c(0.25, 0.75)),1)[2])
names(we) <- c("scenario","median","lower_quartile","upper_quartile")
wet_efficacy <- rbind(wet_efficacy, we)

de <- data.frame("CI_03",round(median((1-(partial_prob_intervention_was_w_connections_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100),1),round(quantile((1-(partial_prob_intervention_was_w_connections_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[1],round(quantile((1-(partial_prob_intervention_was_w_connections_intervention_dry_prev$prevalence+c_dry)/(baseline_dry_prev$prevalence+c_dry))*100,c(0.25, 0.75)),1)[2])
names(de) <- c("scenario","median","lower_quartile","upper_quartile")
dry_efficacy <- rbind(dry_efficacy, de)

rownames(wet_efficacy) <- NULL
rownames(dry_efficacy) <- NULL
```

```{r W2Wed Prevalences}
#Baseline
ggplot(baseline_prev, aes(x=area, y=prevalence, fill=water)) + 
    geom_boxplot() +
    xlab('Area') +
    ylab('Prevalence %') +
    ylim(0,100) +
    ggtitle('B') +
    scale_fill_manual(values=c("#00BFC4","#F8766D")) +
    theme(legend.position = "none") +
    theme(axis.text.x = element_text(size = 11, angle = 0, hjust = .5, vjust = .5, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Controls
ggplot(rbind(baseline_recombined_prev,baseline_2_recombined_prev), aes(x=water, y=prevalence, fill=scenario)) +
  geom_boxplot() +
  xlab('Water') +
  ylab('Prevalence %') +
  ylim(0,100)

#Controls
ggplot(rbind(baseline_prev,crate_introduction_only_prev,z4_introduction_only_prev,random_introduction_only_prev,zero_introduction_prev), aes(x=water, y=prevalence, fill=scenario)) +
  geom_boxplot() +
  xlab('Water') +
  ylab('Prevalence %') +
  ylim(0,100) +
  ggtitle('Model B: Single Introduction Mechanism Testing')

#Random Load - Area
# ggplot(rbind(baseline_prev,random_load_1_log_red_prev,random_load_2_log_red_prev,random_load_3_log_red_prev), aes(x=water, y=prevalence, fill=scenario)) +
#   geom_boxplot() +
#   xlab('Water') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   # theme(legend.position = "none") +
#   theme(legend.position="bottom") +
#   ggtitle('B')

# ggplot(rbind(baseline_prev,random_load_1_log_red_prev,random_load_2_log_red_prev,random_load_3_log_red_prev), aes(x=scenario, y=prevalence, fill=water)) +
#   geom_boxplot() +
#   xlab('Scenario') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   # theme(legend.position="bottom") +
#   ggtitle('B')

ggplot(rbind(baseline_recombined_prev,random_load_1_log_red_recombined_prev,random_load_2_log_red_recombined_prev,random_load_3_log_red_recombined_prev), aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # theme(legend.position="bottom") +
  ggtitle('B') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Random Load - Zone
ggplot(rbind(baseline_zone_prev,random_load_1_log_red_zone_prev,random_load_2_log_red_zone_prev,random_load_3_log_red_zone_prev), aes(x=zone, y=prevalence, fill=scenario)) +
  geom_boxplot() +
  xlab('Zone') +
  ylab('Prevalence %') +
  ylim(0,100) +
  # theme(legend.position = "none") +
  theme(legend.position="bottom") +
  ggtitle('B')

#Random Prob Reduction
# ggplot(rbind(baseline_prev,random_prob_150pc_prev,random_prob_200pc_prev,random_prob_250pc_prev), aes(x=water, y=prevalence, fill=scenario)) +
#   geom_boxplot() +
#   xlab('Water') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   ggtitle('B')

# ggplot(rbind(baseline_prev,random_prob_150pc_prev,random_prob_200pc_prev,random_prob_250pc_prev), aes(x=scenario, y=prevalence, fill=water)) +
#   geom_boxplot() +
#   xlab('Scenario') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   ggtitle('B')

ggplot(rbind(baseline_recombined_prev,random_prob_150pc_recombined_prev,random_prob_200pc_recombined_prev,random_prob_250pc_recombined_prev), aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  ggtitle('B') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Z4 Prob Reduction - Area
# ggplot(rbind(baseline_prev,z4_prob_75pc_prev,z4_prob_50pc_prev,z4_prob_25pc_prev,z4_prob_0pc_prev), aes(x=water, y=prevalence, fill=scenario)) +
#   geom_boxplot() +
#   xlab('Water') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   ggtitle('B')

ggplot(rbind(baseline_recombined_prev,z4_prob_75pc_recombined_prev,z4_prob_50pc_recombined_prev,z4_prob_25pc_recombined_prev,z4_prob_0pc_recombined_prev), aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  ggtitle('B') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Z4 Prob Reduction - Zone
ggplot(rbind(baseline_zone_prev,z4_prob_75pc_zone_prev,z4_prob_50pc_zone_prev,z4_prob_25pc_zone_prev,z4_prob_0pc_zone_prev), aes(x=zone, y=prevalence, fill=scenario)) +
  geom_boxplot() +
  xlab('Zone') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  ggtitle('B')

#Z4 Load - Area
# ggplot(rbind(baseline_prev,z4_load_1_log_red_prev,z4_load_2_log_red_prev,z4_load_3_log_red_prev), aes(x=water, y=prevalence, fill=scenario)) +
#   geom_boxplot() +
#   xlab('Water') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   # theme(legend.position="bottom") +
#   ggtitle('B')

# ggplot(rbind(baseline_prev,z4_load_1_log_red_prev,z4_load_2_log_red_prev,z4_load_3_log_red_prev), aes(x=scenario, y=prevalence, fill=water)) +
#   geom_boxplot() +
#   xlab('Scenario') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   # theme(legend.position="bottom") +
#   ggtitle('B')

ggplot(rbind(baseline_recombined_prev,z4_load_1_log_red_recombined_prev,z4_load_2_log_red_recombined_prev,z4_load_3_log_red_recombined_prev), aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # theme(legend.position="bottom") +
  ggtitle('B') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Z4 Load - Zone
ggplot(rbind(baseline_zone_prev,z4_load_1_log_red_zone_prev,z4_load_2_log_red_zone_prev,z4_load_3_log_red_zone_prev), aes(x=zone, y=prevalence, fill=scenario)) +
  geom_boxplot() +
  xlab('Zone') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # theme(legend.position="bottom") +
  ggtitle('B')

#Crate - Area
# ggplot(rbind(baseline_prev,crate_prev_75pc_prev,crate_prev_50pc_prev,crate_prev_25pc_prev,crate_prev_0pc_prev), aes(x=water, y=prevalence, fill=scenario)) + 
#   geom_boxplot() +
#   xlab('Water') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   # theme(legend.position="bottom") +
#   ggtitle('B')

# ggplot(rbind(baseline_prev,crate_prev_75pc_prev,crate_prev_50pc_prev,crate_prev_25pc_prev,crate_prev_0pc_prev), aes(x=scenario, y=prevalence, fill=water)) + 
#   geom_boxplot() +
#   xlab('Scenario') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   # theme(legend.position="bottom") +
#   scale_fill_manual(values=c("#00BFC4","#F8766D")) +
#   ggtitle('B')

ggplot(rbind(baseline_recombined_prev,crate_prev_75pc_recombined_prev,crate_prev_50pc_recombined_prev,crate_prev_25pc_recombined_prev,crate_prev_0pc_recombined_prev), aes(x=scenario, y=prevalence, fill=water)) + 
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # theme(legend.position="bottom") +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  ggtitle('B') +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"))

# ggplot(rbind(crate_prev_75pc_eff_prev,crate_prev_50pc_eff_prev,crate_prev_25pc_eff_prev,crate_prev_0pc_eff_prev), aes(x=water, y=prevalence, fill=scenario)) + 
#   geom_boxplot() +
#   xlab('Water') +
#   ylab('Prevalence %') +
#   #ylim(0,100) +
#   theme(legend.position = "none") +
#   # theme(legend.position="bottom") +
#   ggtitle('B')

#Crate - Zone
ggplot(rbind(baseline_zone_prev,crate_prev_75pc_zone_prev,crate_prev_50pc_zone_prev,crate_prev_25pc_zone_prev,crate_prev_0pc_zone_prev), aes(x=zone, y=prevalence, fill=scenario)) + 
  geom_boxplot() +
  xlab('Zone') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # theme(legend.position="bottom") +
  ggtitle('B')

#Reduction - Area
# ggplot(rbind(baseline_prev,red_3_log_imp_prev,deep_clean_intervention_prev), aes(x=water, y=prevalence, fill=scenario)) +
#   geom_boxplot() +
#   xlab('Water') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   # theme(legend.position="bottom") +
#   ggtitle('B')

# ggplot(rbind(baseline_prev,red_3_log_imp_prev,deep_clean_intervention_prev), aes(x=scenario, y=prevalence, fill=water)) +
#   geom_boxplot() +
#   xlab('Scenario') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   # theme(legend.position="bottom") +
#   ggtitle('B 1') +
#   scale_fill_manual(values=c("#00BFC4","#F8766D"))

ggplot(rbind(baseline_recombined_prev,red_3_log_imp_recombined_prev,deep_clean_intervention_recombined_prev), aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # theme(legend.position="bottom") +
  ggtitle('B') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Reduction - Zone
ggplot(rbind(baseline_zone_prev,red_3_log_imp_zone_prev,deep_clean_intervention_zone_prev), aes(x=zone, y=prevalence, fill=scenario)) +
  geom_boxplot() +
  xlab('Zone') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # theme(legend.position="bottom") +
  ggtitle('B')

#Interventions - Area
# df <- rbind(baseline_prev,flume_intervention_prev,prob_intervention_prev,partial_prob_intervention_prev,connections_intervention_prev)
# levels(df$scenario) <- c("Baseline","AI_01","AI_02","AI_03","AI_04","AI_02S","AI_03S")
# ggplot(df, aes(x=water, y=prevalence, fill=scenario)) +
#   geom_boxplot() +
#   xlab('Water') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   ggtitle('B') +
#   scale_x_discrete(drop = FALSE) +
#   scale_fill_discrete(drop = FALSE)

# ggplot(rbind(baseline_prev,flume_intervention_prev,prob_intervention_prev,partial_prob_intervention_prev,connections_intervention_prev), aes(x=scenario, y=prevalence, fill=water)) +
#   geom_boxplot() +
#   xlab('Scenario') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   ggtitle('B') +
#   scale_fill_manual(values=c("#00BFC4","#F8766D"))

ggplot(rbind(baseline_recombined_prev,flume_intervention_recombined_prev,prob_intervention_recombined_prev,partial_prob_intervention_recombined_prev,connections_intervention_recombined_prev), aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  ggtitle('B') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"))
  
#Interventions - Zone
ggplot(rbind(baseline_zone_prev,flume_intervention_zone_prev,prob_intervention_zone_prev,partial_prob_intervention_zone_prev,connections_intervention_zone_prev), aes(x=zone, y=prevalence, fill=scenario)) +
  geom_boxplot() +
  xlab('Zone') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  scale_fill_manual(values=c("#F8766D","#C49A00","#00C094","#A58AFF","#FB61D7")) +
  ggtitle('B')

#Synergistic Impact - Area
# ggplot(rbind(baseline_prev,flume_intervention_prev,z4_prob_0pc_prev,partial_prob_intervention_prev,z4_prob_0pc_w_flume_intervention_prev,z4_prob_0pc_w_partial_prob_intervention_was_prev,flume_intervention_w_partial_prob_intervention_was_prev), aes(x=water, y=prevalence, fill=scenario)) +
#   geom_boxplot() +
#   xlab('Water') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   # theme(legend.position="bottom") +
#   ggtitle('B 1')

# ggplot(rbind(baseline_prev,crate_prev_50pc_prev,partial_prob_intervention_prev,connections_intervention_prev,crate_prev_50pc_w_partial_prob_intervention_was_prev,crate_prev_50pc_w_connections_intervention_prev,partial_prob_intervention_was_w_connections_intervention_prev), aes(x=water, y=prevalence, fill=scenario)) +
#   geom_boxplot() +
#   xlab('Water') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   # theme(legend.position="bottom") +
#   ggtitle('B')

# ggplot(rbind(baseline_prev,crate_prev_50pc_prev,partial_prob_intervention_prev,connections_intervention_prev,crate_prev_50pc_w_partial_prob_intervention_was_prev,crate_prev_50pc_w_connections_intervention_prev,partial_prob_intervention_was_w_connections_intervention_prev), aes(x=scenario, y=prevalence, fill=water)) +
#   geom_boxplot() +
#   xlab('Scenario') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   # theme(legend.position="bottom") +
#   scale_fill_manual(values=c("#00BFC4","#F8766D")) +
#   ggtitle('B')

ggplot(rbind(baseline_recombined_prev,crate_prev_50pc_recombined_prev,partial_prob_intervention_recombined_prev,connections_intervention_recombined_prev,crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev,crate_prev_50pc_w_connections_intervention_recombined_prev,partial_prob_intervention_was_w_connections_intervention_recombined_prev), aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # theme(legend.position="bottom") +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  ggtitle('B') +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Synergistic Impact - Zone
# ggplot(rbind(baseline_zone_prev,flume_intervention_zone_prev,z4_prob_0pc_zone_prev,partial_prob_intervention_zone_prev,z4_prob_0pc_w_flume_intervention_zone_prev,z4_prob_0pc_w_partial_prob_intervention_was_zone_prev,flume_intervention_w_partial_prob_intervention_was_zone_prev), aes(x=zone, y=prevalence, fill=scenario)) +
#   geom_boxplot() +
#   xlab('Zone') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   # theme(legend.position="bottom") +
#   ggtitle('B')

ggplot(rbind(baseline_recombined_prev,crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev,crate_prev_50pc_w_connections_intervention_recombined_prev,partial_prob_intervention_was_w_connections_intervention_recombined_prev), aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # theme(legend.position="bottom") +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  ggtitle('B') +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Synergistic Impact - Zone
# ggplot(rbind(baseline_zone_prev,z4_prob_0pc_w_flume_intervention_zone_prev,z4_prob_0pc_w_partial_prob_intervention_was_zone_prev,flume_intervention_w_partial_prob_intervention_was_zone_prev), aes(x=zone, y=prevalence, fill=scenario)) +
#   geom_boxplot() +
#   xlab('Zone') +
#   ylab('Prevalence %') +
#   ylim(0,100) +
#   theme(legend.position = "none") +
#   # theme(legend.position="bottom") +
#   ggtitle('B')
```

```{r W2Wed Concentrations}
#Baseline
ggplot(rbind(baseline_concs), aes(x=area, y=log10(concentration), fill=water)) + 
  geom_boxplot() +
  xlab('Area') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ggtitle('D') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  ylim(-10,5) +
  theme(legend.position = "none") +
  theme(axis.text.x = element_text(size = 11, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 12, angle = 90, hjust = .5, vjust = .5, face = "plain"))

ggplot(rbind(baseline_concs,baseline_2_concs), aes(x=water, y=log10(concentration), fill=scenario)) + 
    geom_boxplot() +
    xlab('Area') +
    ylab('Listeria Concentration Log10(CFU/cm sq.)') +
    ggtitle('Model B: Concentrations of Positive Agents')

#Controls
# ggplot(rbind(crate_introduction_only_concs,z4_introduction_only_concs,random_introduction_only_concs,zero_introduction_concs), aes(x=water, y=log10(concentration), fill=scenario)) + 
#   geom_boxplot() +
#   xlab('Water') +
#   ylab('Listeria Concentration Log10(CFU/cm sq.)') +
#   ggtitle('Model B: Single Introduction Mechanism Testing')

#Z4
ggplot(rbind(baseline_concs,z4_load_1_log_red_concs,z4_load_2_log_red_concs,z4_load_3_log_red_concs), aes(x=water, y=log10(concentration), fill=scenario)) + 
  geom_boxplot() +
  xlab('Water') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D')

ggplot(rbind(baseline_concs,z4_load_1_log_red_concs,z4_load_2_log_red_concs,z4_load_3_log_red_concs), aes(x=scenario, y=log10(concentration), fill=water)) + 
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 12, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Random
ggplot(rbind(baseline_concs,random_load_1_log_red_concs,random_load_2_log_red_concs,random_load_3_log_red_concs), aes(x=water, y=log10(concentration), fill=scenario)) + 
  geom_boxplot() +
  xlab('Water') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D')

ggplot(rbind(baseline_concs,random_load_1_log_red_concs,random_load_2_log_red_concs,random_load_3_log_red_concs), aes(x=scenario, y=log10(concentration), fill=water)) + 
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 12, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Crate Prev
ggplot(rbind(baseline_concs,crate_prev_75pc_concs,crate_prev_50pc_concs,crate_prev_25pc_concs,crate_prev_0pc_concs), aes(x=water, y=log10(concentration), fill=scenario)) + 
  geom_boxplot() +
  xlab('Water') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D')

ggplot(rbind(baseline_concs,crate_prev_75pc_concs,crate_prev_50pc_concs,crate_prev_25pc_concs,crate_prev_0pc_concs), aes(x=scenario, y=log10(concentration), fill=water)) + 
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 12, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Cleaning
ggplot(rbind(baseline_concs,red_3_log_imp_concs,deep_clean_intervention_concs), aes(x=scenario, y=log10(concentration), fill=water)) + 
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 12, angle = 90, hjust = .5, vjust = .5, face = "plain"))

ggplot(rbind(baseline_concs,red_3_log_imp_concs,deep_clean_intervention_concs), aes(x=water, y=log10(concentration), fill=scenario)) + 
  geom_boxplot() +
  xlab('Water') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D') +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 12, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Prob Reduction
ggplot(rbind(baseline_concs,random_prob_150pc_concs,random_prob_200pc_concs,random_prob_250pc_concs), aes(x=water, y=log10(concentration), fill=scenario)) + 
  geom_boxplot() +
  xlab('Water') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D')

ggplot(rbind(baseline_concs,random_prob_150pc_concs,random_prob_200pc_concs,random_prob_250pc_concs), aes(x=scenario, y=log10(concentration), fill=water)) + 
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 12, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Z4 Reduction
ggplot(rbind(baseline_concs,z4_prob_75pc_concs,z4_prob_50pc_concs,z4_prob_25pc_concs,z4_prob_0pc_concs), aes(x=water, y=log10(concentration), fill=scenario)) + 
  geom_boxplot() +
  xlab('Water') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D')

ggplot(rbind(baseline_concs,z4_prob_75pc_concs,z4_prob_50pc_concs,z4_prob_25pc_concs,z4_prob_0pc_concs), aes(x=scenario, y=log10(concentration), fill=water)) + 
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 12, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Interventions
ggplot(rbind(baseline_concs,flume_intervention_concs,prob_intervention_concs,partial_prob_intervention_concs,connections_intervention_concs), aes(x=water, y=log10(concentration), fill=scenario)) +
  geom_boxplot() +
  xlab('Water') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  scale_fill_manual(values=c("#F8766D","#C49A00","#00C094","#A58AFF","#FB61D7")) +
  ggtitle('D')

ggplot(rbind(baseline_concs,flume_intervention_concs,prob_intervention_concs,partial_prob_intervention_concs,connections_intervention_concs), aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  ggtitle('D') +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 12, angle = 90, hjust = .5, vjust = .5, face = "plain"))

#Synergistic Impact
# ggplot(rbind(baseline_concs,flume_intervention_concs,z4_prob_0pc_concs,partial_prob_intervention_concs,z4_prob_0pc_w_flume_intervention_concs,z4_prob_0pc_w_partial_prob_intervention_was_concs,flume_intervention_w_partial_prob_intervention_was_concs), aes(x=water, y=log10(concentration), fill=scenario)) +
#   geom_boxplot() +
#   xlab('Water') +
#   ylab('Listeria Concentration Log10(CFU/cm sq.)') +
#   ylim(-10,5) +
#   theme(legend.position = "none") +
#   ggtitle('D')

ggplot(rbind(baseline_concs,crate_prev_50pc_concs,partial_prob_intervention_concs,connections_intervention_concs,crate_prev_50pc_w_partial_prob_intervention_was_concs,crate_prev_50pc_w_connections_intervention_concs,partial_prob_intervention_was_w_connections_intervention_concs), aes(x=water, y=log10(concentration), fill=scenario)) +
  geom_boxplot() +
  xlab('Water') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  # theme(legend.position = "none") +
  theme(legend.position = "bottom") +
  ggtitle('D')

ggplot(rbind(baseline_concs,crate_prev_50pc_concs,partial_prob_intervention_concs,connections_intervention_concs,crate_prev_50pc_w_partial_prob_intervention_was_concs,crate_prev_50pc_w_connections_intervention_concs,partial_prob_intervention_was_w_connections_intervention_concs), aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 12, angle = 90, hjust = .5, vjust = .5, face = "plain"))

ggplot(rbind(baseline_concs,crate_prev_50pc_w_partial_prob_intervention_was_concs,crate_prev_50pc_w_connections_intervention_concs,partial_prob_intervention_was_w_connections_intervention_concs), aes(x=water, y=log10(concentration), fill=scenario)) +
  geom_boxplot() +
  xlab('Water') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  # theme(legend.position = "none") +
  theme(legend.position = "bottom") +
  ggtitle('D')

ggplot(rbind(baseline_concs,crate_prev_50pc_w_partial_prob_intervention_was_concs,crate_prev_50pc_w_connections_intervention_concs,partial_prob_intervention_was_w_connections_intervention_concs), aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('Scenario') +
  ylab('Listeria Concentration Log10(CFU/cm sq.)') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  ggtitle('D') +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  theme(axis.text.x = element_text(size = 14, angle = 0, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 12, angle = 90, hjust = .5, vjust = .5, face = "plain"))
```

```{r W2Wed Figures}
####Figure 3####
figure <- ggarrange(ggplot(baseline_prev, aes(x=area, y=prevalence, fill=water)) + 
    geom_boxplot() +
    xlab('') +
    ylab('Prevalence %') +
    ylim(0,100) +
    # ggtitle("B") +
    scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
    theme(legend.position = "none") +
    theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")))
annotate_figure(
  figure,fig.lab = "B",
  fig.lab.face = "bold",
  bottom = text_grob("Area", size = 20, y = 1)
)
ggsave("Fig 3_B.tiff", device = "tiff", dpi = 600)

figure <- ggarrange(ggplot(rbind(baseline_concs), aes(x=area, y=log10(concentration), fill=water)) + 
  geom_boxplot() +
  xlab('') +
  ylab(expression(Log["10"]*" CFU/cm sq.")) +
  ylim(-10,5) +
  # ggtitle("D") +
  scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
  theme(legend.position = "none") +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")))
annotate_figure(
  figure,fig.lab = "D",
  fig.lab.face = "bold",
  bottom = text_grob("Area", size = 20, y = 1)
)
ggsave("Fig 3_D.tiff", device = "tiff", dpi = 600)

####Figure 5####
ggplot(wet_efficacy) +
  geom_errorbar(aes(x=scenario, y=median, ymin=lower_quartile, ymax=upper_quartile)) +
  scale_y_continuous(breaks = seq(from = -100, to = 100, by = 20)) +
  coord_cartesian(ylim = c(-100, 100)) +
  geom_point(aes(x = scenario, y = median), color="red", shape=3) +
  geom_point(aes(x = scenario, y = lower_quartile), color="black") +
  geom_point(aes(x = scenario, y = upper_quartile), color="black") +
  xlab('Corrective Action') +
  ylab('Efficacy (%)') +
  ggtitle('A') +
  theme(
    axis.text.x = element_text(angle = 90, size = 12, vjust = 0.5),
    axis.text.y = element_text(size = 12),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
  )
ggsave("Fig 5B_A.tiff", device = "tiff", dpi = 600)
ggplot(dry_efficacy) +
  geom_errorbar(aes(x=scenario, y=median, ymin=lower_quartile, ymax=upper_quartile)) +
  scale_y_continuous(breaks = seq(from = -100, to = 100, by = 20)) +
  coord_cartesian(ylim = c(-100, 100)) +
  geom_point(aes(x = scenario, y = median), color="red", shape=3) +
  geom_point(aes(x = scenario, y = lower_quartile), color="black") +
  geom_point(aes(x = scenario, y = upper_quartile), color="black") +
  xlab('Corrective Action') +
  ylab('Efficacy (%)') +
  ggtitle('B') +
  theme(
    axis.text.x = element_text(angle = 90, size = 12, vjust = 0.5),
    axis.text.y = element_text(size = 12),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
  )
ggsave("Fig 5B_B.tiff", device = "tiff", dpi = 600)

####Figure 6####
wet_plot <- ggplot(rbind(baseline_recombined_prev,crate_prev_75pc_recombined_prev,crate_prev_50pc_recombined_prev,crate_prev_25pc_recombined_prev,crate_prev_0pc_recombined_prev)[which(rbind(baseline_recombined_prev,crate_prev_75pc_recombined_prev,crate_prev_50pc_recombined_prev,crate_prev_25pc_recombined_prev,crate_prev_0pc_recombined_prev)$water=="Wet"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_recombined_prev,crate_prev_75pc_recombined_prev,crate_prev_50pc_recombined_prev,crate_prev_25pc_recombined_prev,crate_prev_0pc_recombined_prev)[which(rbind(baseline_recombined_prev,crate_prev_75pc_recombined_prev,crate_prev_50pc_recombined_prev,crate_prev_25pc_recombined_prev,crate_prev_0pc_recombined_prev)$water=="Dry"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "B", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig 6_B.tiff", device = "tiff", dpi = 600)

wet_plot <- ggplot(rbind(baseline_concs,crate_prev_75pc_concs,crate_prev_50pc_concs,crate_prev_25pc_concs,crate_prev_0pc_concs)[which(rbind(baseline_concs,crate_prev_75pc_concs,crate_prev_50pc_concs,crate_prev_25pc_concs,crate_prev_0pc_concs)$water=="Wet"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab(expression(Log["10"]*" CFU/cm sq.")) +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_concs,crate_prev_75pc_concs,crate_prev_50pc_concs,crate_prev_25pc_concs,crate_prev_0pc_concs)[which(rbind(baseline_concs,crate_prev_75pc_concs,crate_prev_50pc_concs,crate_prev_25pc_concs,crate_prev_0pc_concs)$water=="Dry"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "D", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig 6_D.tiff", device = "tiff", dpi = 600)

####Figure 7####
wet_plot <- ggplot(rbind(baseline_recombined_prev,red_3_log_imp_recombined_prev,deep_clean_intervention_recombined_prev)[which(rbind(baseline_recombined_prev,red_3_log_imp_recombined_prev,deep_clean_intervention_recombined_prev)$water=="Wet"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_recombined_prev,red_3_log_imp_recombined_prev,deep_clean_intervention_recombined_prev)[which(rbind(baseline_recombined_prev,red_3_log_imp_recombined_prev,deep_clean_intervention_recombined_prev)$water=="Dry"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "B", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig 7_B.tiff", device = "tiff", dpi = 600)

wet_plot <- ggplot(rbind(baseline_concs,red_3_log_imp_concs,deep_clean_intervention_concs)[which(rbind(baseline_concs,red_3_log_imp_concs,deep_clean_intervention_concs)$water=="Wet"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab(expression(Log["10"]*" CFU/cm sq.")) +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_concs,red_3_log_imp_concs,deep_clean_intervention_concs)[which(rbind(baseline_concs,red_3_log_imp_concs,deep_clean_intervention_concs)$water=="Dry"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "D", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig 7_D.tiff", device = "tiff", dpi = 600)

####Figure 8####
wet_plot <- ggplot(rbind(baseline_recombined_prev,flume_intervention_recombined_prev,prob_intervention_recombined_prev,partial_prob_intervention_recombined_prev,connections_intervention_recombined_prev)[which(rbind(baseline_recombined_prev,flume_intervention_recombined_prev,prob_intervention_recombined_prev,partial_prob_intervention_recombined_prev,connections_intervention_recombined_prev)$water=="Wet"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_recombined_prev,flume_intervention_recombined_prev,prob_intervention_recombined_prev,partial_prob_intervention_recombined_prev,connections_intervention_recombined_prev)[which(rbind(baseline_recombined_prev,flume_intervention_recombined_prev,prob_intervention_recombined_prev,partial_prob_intervention_recombined_prev,connections_intervention_recombined_prev)$water=="Dry"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "B", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig 8_B.tiff", device = "tiff", dpi = 600)

wet_plot <- ggplot(rbind(baseline_concs,flume_intervention_concs,prob_intervention_concs,partial_prob_intervention_concs,connections_intervention_concs)[which(rbind(baseline_concs,flume_intervention_concs,prob_intervention_concs,partial_prob_intervention_concs,connections_intervention_concs)$water=="Wet"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab(expression(Log["10"]*" CFU/cm sq.")) +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_concs,flume_intervention_concs,prob_intervention_concs,partial_prob_intervention_concs,connections_intervention_concs)[which(rbind(baseline_concs,flume_intervention_concs,prob_intervention_concs,partial_prob_intervention_concs,connections_intervention_concs)$water=="Dry"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "D", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig 8_D.tiff", device = "tiff", dpi = 600)

####Figure 9####
wet_plot <- ggplot(rbind(baseline_recombined_prev,crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev,crate_prev_50pc_w_connections_intervention_recombined_prev,partial_prob_intervention_was_w_connections_intervention_recombined_prev)[which(rbind(baseline_recombined_prev,crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev,crate_prev_50pc_w_connections_intervention_recombined_prev,partial_prob_intervention_was_w_connections_intervention_recombined_prev)$water=="Wet"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_recombined_prev,crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev,crate_prev_50pc_w_connections_intervention_recombined_prev,partial_prob_intervention_was_w_connections_intervention_recombined_prev)[which(rbind(baseline_recombined_prev,crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev,crate_prev_50pc_w_connections_intervention_recombined_prev,partial_prob_intervention_was_w_connections_intervention_recombined_prev)$water=="Dry"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "B", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig 9_B.tiff", device = "tiff", dpi = 600)

wet_plot <- ggplot(rbind(baseline_concs,crate_prev_50pc_w_partial_prob_intervention_was_concs,crate_prev_50pc_w_connections_intervention_concs,partial_prob_intervention_was_w_connections_intervention_concs)[which(rbind(baseline_concs,crate_prev_50pc_w_partial_prob_intervention_was_concs,crate_prev_50pc_w_connections_intervention_concs,partial_prob_intervention_was_w_connections_intervention_concs)$water=="Wet"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab(expression(Log["10"]*" CFU/cm sq.")) +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_concs,crate_prev_50pc_w_partial_prob_intervention_was_concs,crate_prev_50pc_w_connections_intervention_concs,partial_prob_intervention_was_w_connections_intervention_concs)[which(rbind(baseline_concs,crate_prev_50pc_w_partial_prob_intervention_was_concs,crate_prev_50pc_w_connections_intervention_concs,partial_prob_intervention_was_w_connections_intervention_concs)$water=="Dry"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "D", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig 9_D.tiff", device = "tiff", dpi = 600)

####Figure S2####
wet_plot <- ggplot(rbind(baseline_recombined_prev,random_prob_150pc_recombined_prev,random_prob_200pc_recombined_prev,random_prob_250pc_recombined_prev)[which(rbind(baseline_recombined_prev,random_prob_150pc_recombined_prev,random_prob_200pc_recombined_prev,random_prob_250pc_recombined_prev)$water=="Wet"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_recombined_prev,random_prob_150pc_recombined_prev,random_prob_200pc_recombined_prev,random_prob_250pc_recombined_prev)[which(rbind(baseline_recombined_prev,random_prob_150pc_recombined_prev,random_prob_200pc_recombined_prev,random_prob_250pc_recombined_prev)$water=="Dry"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "B", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig S2_B.tiff", device = "tiff", dpi = 600)

wet_plot <- ggplot(rbind(baseline_concs,random_prob_150pc_concs,random_prob_200pc_concs,random_prob_250pc_concs)[which(rbind(baseline_concs,random_prob_150pc_concs,random_prob_200pc_concs,random_prob_250pc_concs)$water=="Wet"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab(expression(Log["10"]*" CFU/cm sq.")) +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_concs,random_prob_150pc_concs,random_prob_200pc_concs,random_prob_250pc_concs)[which(rbind(baseline_concs,random_prob_150pc_concs,random_prob_200pc_concs,random_prob_250pc_concs)$water=="Dry"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "D", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig S2_D.tiff", device = "tiff", dpi = 600)

####Figure S3####
wet_plot <- ggplot(rbind(baseline_recombined_prev,random_load_1_log_red_recombined_prev,random_load_2_log_red_recombined_prev,random_load_3_log_red_recombined_prev)[which(rbind(baseline_recombined_prev,random_load_1_log_red_recombined_prev,random_load_2_log_red_recombined_prev,random_load_3_log_red_recombined_prev)$water=="Wet"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_recombined_prev,random_load_1_log_red_recombined_prev,random_load_2_log_red_recombined_prev,random_load_3_log_red_recombined_prev)[which(rbind(baseline_recombined_prev,random_load_1_log_red_recombined_prev,random_load_2_log_red_recombined_prev,random_load_3_log_red_recombined_prev)$water=="Dry"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "B", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig S3_B.tiff", device = "tiff", dpi = 600)

wet_plot <- ggplot(rbind(baseline_concs,random_load_1_log_red_concs,random_load_2_log_red_concs,random_load_3_log_red_concs)[which(rbind(baseline_concs,random_load_1_log_red_concs,random_load_2_log_red_concs,random_load_3_log_red_concs)$water=="Wet"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab(expression(Log["10"]*" CFU/cm sq.")) +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_concs,random_load_1_log_red_concs,random_load_2_log_red_concs,random_load_3_log_red_concs)[which(rbind(baseline_concs,random_load_1_log_red_concs,random_load_2_log_red_concs,random_load_3_log_red_concs)$water=="Dry"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "D", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig S3_D.tiff", device = "tiff", dpi = 600)

####Figure S4####
wet_plot <- ggplot(rbind(baseline_recombined_prev,z4_prob_75pc_recombined_prev,z4_prob_50pc_recombined_prev,z4_prob_25pc_recombined_prev,z4_prob_0pc_recombined_prev)[which(rbind(baseline_recombined_prev,z4_prob_75pc_recombined_prev,z4_prob_50pc_recombined_prev,z4_prob_25pc_recombined_prev,z4_prob_0pc_recombined_prev)$water=="Wet"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_recombined_prev,z4_prob_75pc_recombined_prev,z4_prob_50pc_recombined_prev,z4_prob_25pc_recombined_prev,z4_prob_0pc_recombined_prev)[which(rbind(baseline_recombined_prev,z4_prob_75pc_recombined_prev,z4_prob_50pc_recombined_prev,z4_prob_25pc_recombined_prev,z4_prob_0pc_recombined_prev)$water=="Dry"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "B", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig S4_B.tiff", device = "tiff", dpi = 600)

wet_plot <- ggplot(rbind(baseline_concs,z4_prob_75pc_concs,z4_prob_50pc_concs,z4_prob_25pc_concs,z4_prob_0pc_concs)[which(rbind(baseline_concs,z4_prob_75pc_concs,z4_prob_50pc_concs,z4_prob_25pc_concs,z4_prob_0pc_concs)$water=="Wet"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab(expression(Log["10"]*" CFU/cm sq.")) +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_concs,z4_prob_75pc_concs,z4_prob_50pc_concs,z4_prob_25pc_concs,z4_prob_0pc_concs)[which(rbind(baseline_concs,z4_prob_75pc_concs,z4_prob_50pc_concs,z4_prob_25pc_concs,z4_prob_0pc_concs)$water=="Dry"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "D", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig S4_D.tiff", device = "tiff", dpi = 600)

####Figure S5####
wet_plot <- ggplot(rbind(baseline_recombined_prev,z4_load_1_log_red_recombined_prev,z4_load_2_log_red_recombined_prev,z4_load_3_log_red_recombined_prev)[which(rbind(baseline_recombined_prev,z4_load_1_log_red_recombined_prev,z4_load_2_log_red_recombined_prev,z4_load_3_log_red_recombined_prev)$water=="Wet"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_recombined_prev,z4_load_1_log_red_recombined_prev,z4_load_2_log_red_recombined_prev,z4_load_3_log_red_recombined_prev)[which(rbind(baseline_recombined_prev,z4_load_1_log_red_recombined_prev,z4_load_2_log_red_recombined_prev,z4_load_3_log_red_recombined_prev)$water=="Dry"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "B", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig S5_B.tiff", device = "tiff", dpi = 600)

wet_plot <- ggplot(rbind(baseline_concs,z4_load_1_log_red_concs,z4_load_2_log_red_concs,z4_load_3_log_red_concs)[which(rbind(baseline_concs,z4_load_1_log_red_concs,z4_load_2_log_red_concs,z4_load_3_log_red_concs)$water=="Wet"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab(expression(Log["10"]*" CFU/cm sq.")) +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#0C7BDC")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_concs,z4_load_1_log_red_concs,z4_load_2_log_red_concs,z4_load_3_log_red_concs)[which(rbind(baseline_concs,z4_load_1_log_red_concs,z4_load_2_log_red_concs,z4_load_3_log_red_concs)$water=="Dry"),], aes(x=scenario, y=log10(concentration), fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(-10,5) +
  theme(legend.position = "none") +
  # ggtitle('D') +
  scale_fill_manual(values=c("#FFC20A")) +
  theme(axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "D", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
ggsave("Fig S5_D.tiff", device = "tiff", dpi = 600)
```

```{r Efficacy Export}
all_eff <- rbind(random_prob_150pc_eff_prev,random_prob_200pc_eff_prev,random_prob_250pc_eff_prev,random_load_1_log_red_eff_prev,random_load_2_log_red_eff_prev,random_load_3_log_red_eff_prev,z4_prob_75pc_eff_prev,z4_prob_50pc_eff_prev,z4_prob_25pc_eff_prev,z4_prob_0pc_eff_prev,z4_load_1_log_red_eff_prev,z4_load_2_log_red_eff_prev,z4_load_3_log_red_eff_prev,crate_prev_75pc_eff_prev,crate_prev_50pc_eff_prev,crate_prev_25pc_eff_prev,crate_prev_0pc_eff_prev,red_3_log_imp_eff_prev,deep_clean_intervention_eff_prev,flume_intervention_eff_prev,prob_intervention_eff_prev,partial_prob_intervention_eff_prev,connections_intervention_eff_prev,crate_prev_50pc_w_partial_prob_intervention_was_eff_prev,crate_prev_50pc_w_connections_intervention_eff_prev,partial_prob_intervention_was_w_connections_intervention_eff_prev)

write.csv(all_eff,paste0(getwd(),'/Facility_B All Efficacies.csv'), row.names = FALSE)
```

```{r Export Figure Data}
#Sensitivity Analysis
write.csv(data_matrix_melted,paste0(getwd(),'/Facility_B_Sensitivity_Analysis.csv'), row.names = TRUE)
#Validation
write.csv(prevalence_melted_validation_shift,paste0(getwd(),'/Facility_B_Validation_Shift.csv'), row.names = FALSE)
write.csv(prevalence_melted_validation_zone,paste0(getwd(),'/Facility_B_Validation_Zone.csv'), row.names = FALSE)
write.csv(prevalence_melted_validation_water,paste0(getwd(),'/Facility_B_Validation_Water.csv'), row.names = FALSE)
write.csv(sites_mid,paste0(getwd(),'/Facility_B_Validation_Sites_Mid.csv'), row.names = FALSE)
write.csv(NL_table$z_sample_mid_prev,paste0(getwd(),'/Facility_B_Sample_Sites_Mid.csv'), row.names = FALSE)
write.csv(sites_z2,paste0(getwd(),'/Facility_B_Validation_Sites_Z2.csv'), row.names = FALSE)
write.csv(NL_table$z2_prev,paste0(getwd(),'/Facility_B_Sample_Sites_Z2.csv'), row.names = FALSE)
write.csv(sites_z3,paste0(getwd(),'/Facility_B_Validation_Sites_Z3.csv'), row.names = FALSE)
write.csv(NL_table$z3_prev,paste0(getwd(),'/Facility_B_Sample_Sites_Z3.csv'), row.names = FALSE)
write.csv(sites_wet,paste0(getwd(),'/Facility_B_Validation_Sites_Wet.csv'), row.names = FALSE)
write.csv(c(NL_table$loading_total_prev,NL_table$cleaning_total_prev),paste0(getwd(),'/Facility_B_Sample_Sites_Wet.csv'), row.names = FALSE)
write.csv(sites_dry,paste0(getwd(),'/Facility_B_Validation_Sites_Dry.csv'), row.names = FALSE)
write.csv(c(NL_table$sorting_total_prev,NL_table$reject_total_prev,NL_table$tray_packing_total_prev,NL_table$bag_packing_total_prev),paste0(getwd(),'/Facility_B_Sample_Sites_Dry.csv'), row.names = FALSE)
#Baseline
write.csv(baseline_prev,paste0(getwd(),'/Facility_B_Baseline_Prev.csv'), row.names = FALSE)
write.csv(baseline_concs,paste0(getwd(),'/Facility_B_Baseline_Concs.csv'), row.names = FALSE)
write.csv(wet_efficacy,paste0(getwd(),'/Facility_B_Wet_Efficacy.csv'), row.names = FALSE)
write.csv(dry_efficacy,paste0(getwd(),'/Facility_B_Dry_Efficacy.csv'), row.names = FALSE)
write.csv(baseline_recombined_prev,paste0(getwd(),'/Facility_B_Baseline_Recombined_Prev.csv'), row.names = FALSE)
write.csv(baseline_zone_prev,paste0(getwd(),'/Facility_B_Baseline_Zone_Prev.csv'), row.names = FALSE)
write.csv(baseline_zone_concs,paste0(getwd(),'/Facility_B_Baseline_Zone_Concs.csv'), row.names = FALSE)
#EC_01
write.csv(crate_prev_75pc_recombined_prev,paste0(getwd(),'/Facility_B_EC_01_Recombined_Prev.csv'), row.names = FALSE)
write.csv(crate_prev_75pc_concs,paste0(getwd(),'/Facility_B_EC_01_Concs.csv'), row.names = FALSE)
#EC_02
write.csv(crate_prev_50pc_recombined_prev,paste0(getwd(),'/Facility_B_EC_02_Recombined_Prev.csv'), row.names = FALSE)
write.csv(crate_prev_50pc_concs,paste0(getwd(),'/Facility_B_EC_02_Concs.csv'), row.names = FALSE)
#EC_03
write.csv(crate_prev_25pc_recombined_prev,paste0(getwd(),'/Facility_B_EC_03_Recombined_Prev.csv'), row.names = FALSE)
write.csv(crate_prev_25pc_concs,paste0(getwd(),'/Facility_B_EC_03_Concs.csv'), row.names = FALSE)
#EC_04
write.csv(crate_prev_0pc_recombined_prev,paste0(getwd(),'/Facility_B_EC_04_Recombined_Prev.csv'), row.names = FALSE)
write.csv(crate_prev_0pc_concs,paste0(getwd(),'/Facility_B_EC_04_Concs.csv'), row.names = FALSE)
#MI_01
write.csv(red_3_log_imp_recombined_prev,paste0(getwd(),'/Facility_B_MI_01_Recombined_Prev.csv'), row.names = FALSE)
write.csv(red_3_log_imp_concs,paste0(getwd(),'/Facility_B_MI_01_Concs.csv'), row.names = FALSE)
#MI_02
write.csv(deep_clean_intervention_recombined_prev,paste0(getwd(),'/Facility_B_MI_02_Recombined_Prev.csv'), row.names = FALSE)
write.csv(deep_clean_intervention_concs,paste0(getwd(),'/Facility_B_MI_02_Concs.csv'), row.names = FALSE)
#AI_01
write.csv(flume_intervention_recombined_prev,paste0(getwd(),'/Facility_B_AI_01_Recombined_Prev.csv'), row.names = FALSE)
write.csv(flume_intervention_concs,paste0(getwd(),'/Facility_B_AI_01_Concs.csv'), row.names = FALSE)
#AI_02
write.csv(prob_intervention_recombined_prev,paste0(getwd(),'/Facility_B_AI_02_Recombined_Prev.csv'), row.names = FALSE)
write.csv(prob_intervention_concs,paste0(getwd(),'/Facility_B_AI_02_Concs.csv'), row.names = FALSE)
#AI_03
write.csv(partial_prob_intervention_recombined_prev,paste0(getwd(),'/Facility_B_AI_03_Recombined_Prev.csv'), row.names = FALSE)
write.csv(partial_prob_intervention_concs,paste0(getwd(),'/Facility_B_AI_03_Concs.csv'), row.names = FALSE)
#AI_04
write.csv(connections_intervention_recombined_prev,paste0(getwd(),'/Facility_B_AI_04_Recombined_Prev.csv'), row.names = FALSE)
write.csv(connections_intervention_concs,paste0(getwd(),'/Facility_B_AI_04_Concs.csv'), row.names = FALSE)
#CI_01
write.csv(crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev,paste0(getwd(),'/Facility_B_CI_01_Recombined_Prev.csv'), row.names = FALSE)
write.csv(crate_prev_50pc_w_partial_prob_intervention_was_concs,paste0(getwd(),'/Facility_B_CI_01_Concs.csv'), row.names = FALSE)
#CI_02
write.csv(crate_prev_50pc_w_connections_intervention_recombined_prev,paste0(getwd(),'/Facility_B_CI_02_Recombined_Prev.csv'), row.names = FALSE)
write.csv(crate_prev_50pc_w_connections_intervention_concs,paste0(getwd(),'/Facility_B_CI_02_Concs.csv'), row.names = FALSE)
#CI_03
write.csv(partial_prob_intervention_was_w_connections_intervention_recombined_prev,paste0(getwd(),'/Facility_B_CI_03_Recombined_Prev.csv'), row.names = FALSE)
write.csv(partial_prob_intervention_was_w_connections_intervention_concs,paste0(getwd(),'/Facility_B_CI_03_Concs.csv'), row.names = FALSE)
#PR_01
write.csv(random_prob_150pc_recombined_prev,paste0(getwd(),'/Facility_B_PR_01_Recombined_Prev.csv'), row.names = FALSE)
write.csv(random_prob_150pc_concs,paste0(getwd(),'/Facility_B_PR_01_Concs.csv'), row.names = FALSE)
#PR_02
write.csv(random_prob_200pc_recombined_prev,paste0(getwd(),'/Facility_B_PR_02_Recombined_Prev.csv'), row.names = FALSE)
write.csv(random_prob_200pc_concs,paste0(getwd(),'/Facility_B_PR_02_Concs.csv'), row.names = FALSE)
#PR_03
write.csv(random_prob_250pc_recombined_prev,paste0(getwd(),'/Facility_B_PR_03_Recombined_Prev.csv'), row.names = FALSE)
write.csv(random_prob_250pc_concs,paste0(getwd(),'/Facility_B_PR_03_Concs.csv'), row.names = FALSE)
#LR_01
write.csv(random_load_1_log_red_recombined_prev,paste0(getwd(),'/Facility_B_LR_01_Recombined_Prev.csv'), row.names = FALSE)
write.csv(random_load_1_log_red_concs,paste0(getwd(),'/Facility_B_LR_01_Concs.csv'), row.names = FALSE)
#LR_02
write.csv(random_load_2_log_red_recombined_prev,paste0(getwd(),'/Facility_B_LR_02_Recombined_Prev.csv'), row.names = FALSE)
write.csv(random_load_2_log_red_concs,paste0(getwd(),'/Facility_B_LR_02_Concs.csv'), row.names = FALSE)
#LR_03
write.csv(random_load_3_log_red_recombined_prev,paste0(getwd(),'/Facility_B_LR_03_Recombined_Prev.csv'), row.names = FALSE)
write.csv(random_load_3_log_red_concs,paste0(getwd(),'/Facility_B_LR_03_Concs.csv'), row.names = FALSE)
#PZ_01
write.csv(z4_prob_75pc_recombined_prev,paste0(getwd(),'/Facility_B_PZ_01_Recombined_Prev.csv'), row.names = FALSE)
write.csv(z4_prob_75pc_concs,paste0(getwd(),'/Facility_B_PZ_01_Concs.csv'), row.names = FALSE)
#PZ_02
write.csv(z4_prob_50pc_recombined_prev,paste0(getwd(),'/Facility_B_PZ_02_Recombined_Prev.csv'), row.names = FALSE)
write.csv(z4_prob_50pc_concs,paste0(getwd(),'/Facility_B_PZ_02_Concs.csv'), row.names = FALSE)
#PZ_03
write.csv(z4_prob_25pc_recombined_prev,paste0(getwd(),'/Facility_B_PZ_03_Recombined_Prev.csv'), row.names = FALSE)
write.csv(z4_prob_25pc_concs,paste0(getwd(),'/Facility_B_PZ_03_Concs.csv'), row.names = FALSE)
#PZ_04
write.csv(z4_prob_0pc_recombined_prev,paste0(getwd(),'/Facility_B_PZ_04_Recombined_Prev.csv'), row.names = FALSE)
write.csv(z4_prob_0pc_concs,paste0(getwd(),'/Facility_B_PZ_04_Concs.csv'), row.names = FALSE)
#LZ_01
write.csv(z4_load_1_log_red_recombined_prev,paste0(getwd(),'/Facility_B_LZ_01_Recombined_Prev.csv'), row.names = FALSE)
write.csv(z4_load_1_log_red_concs,paste0(getwd(),'/Facility_B_LZ_01_Concs.csv'), row.names = FALSE)
#LZ_02
write.csv(z4_load_2_log_red_recombined_prev,paste0(getwd(),'/Facility_B_LZ_02_Recombined_Prev.csv'), row.names = FALSE)
write.csv(z4_load_2_log_red_concs,paste0(getwd(),'/Facility_B_LZ_02_Concs.csv'), row.names = FALSE)
#LZ_03
write.csv(z4_load_3_log_red_recombined_prev,paste0(getwd(),'/Facility_B_LZ_03_Recombined_Prev.csv'), row.names = FALSE)
write.csv(z4_load_3_log_red_concs,paste0(getwd(),'/Facility_B_LZ_03_Concs.csv'), row.names = FALSE)
```

```{r Prevalence Averages}
#Remember all prev values must be "recombined"
#baseline
print('Wet')
round(median(baseline_recombined_prev$prevalence[which(baseline_recombined_prev$water=='Wet')]),2)
print('Dry')
round(median(baseline_recombined_prev$prevalence[which(baseline_recombined_prev$water=='Dry')]),2)
# #random_load_1_log_red_recombined_prev
# print('Wet')
# round(median(random_load_1_log_red_recombined_prev$prevalence[which(random_load_1_log_red_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(random_load_1_log_red_recombined_prev$prevalence[which(random_load_1_log_red_recombined_prev$water=='Dry')]),2)
# #random_load_2_log_red_recombined_prev
# print('Wet')
# round(median(random_load_2_log_red_recombined_prev$prevalence[which(random_load_2_log_red_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(random_load_2_log_red_recombined_prev$prevalence[which(random_load_2_log_red_recombined_prev$water=='Dry')]),2)
# #random_load_3_log_red_recombined_prev
# print('Wet')
# round(median(random_load_3_log_red_recombined_prev$prevalence[which(random_load_3_log_red_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(random_load_3_log_red_recombined_prev$prevalence[which(random_load_3_log_red_recombined_prev$water=='Dry')]),2)
# #z4_load_1_log_red_recombined_prev
# print('Wet')
# round(median(z4_load_1_log_red_recombined_prev$prevalence[which(z4_load_1_log_red_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(z4_load_1_log_red_recombined_prev$prevalence[which(z4_load_1_log_red_recombined_prev$water=='Dry')]),2)
# #z4_load_2_log_red_recombined_prev
# print('Wet')
# round(median(z4_load_2_log_red_recombined_prev$prevalence[which(z4_load_2_log_red_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(z4_load_2_log_red_recombined_prev$prevalence[which(z4_load_2_log_red_recombined_prev$water=='Dry')]),2)
# # z4_load_3_log_red_recombined_prev
# print('Wet')
# round(median(z4_load_3_log_red_recombined_prev$prevalence[which(z4_load_3_log_red_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(z4_load_3_log_red_recombined_prev$prevalence[which(z4_load_3_log_red_recombined_prev$water=='Dry')]),2)
# #crate_prev_75pc_recombined_prev
# print('Wet')
# round(median(crate_prev_75pc_recombined_prev$prevalence[which(crate_prev_75pc_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(crate_prev_75pc_recombined_prev$prevalence[which(crate_prev_75pc_recombined_prev$water=='Dry')]),2)
# #crate_prev_50pc_recombined_prev
# print('Wet')
# round(median(crate_prev_50pc_recombined_prev$prevalence[which(crate_prev_50pc_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(crate_prev_50pc_recombined_prev$prevalence[which(crate_prev_50pc_recombined_prev$water=='Dry')]),2)
# #crate_prev_25pc_recombined_prev
# print('Wet')
# round(median(crate_prev_25pc_recombined_prev$prevalence[which(crate_prev_25pc_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(crate_prev_25pc_recombined_prev$prevalence[which(crate_prev_25pc_recombined_prev$water=='Dry')]),2)
# #crate_prev_0pc_recombined_prev
# print('Wet')
# round(median(crate_prev_0pc_recombined_prev$prevalence[which(crate_prev_0pc_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(crate_prev_0pc_recombined_prev$prevalence[which(crate_prev_0pc_recombined_prev$water=='Dry')]),2)
# #deep_clean_intervention_recombined_prev
# print('wet')
# round(median(deep_clean_intervention_recombined_prev$prevalence[which(deep_clean_intervention_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(deep_clean_intervention_recombined_prev$prevalence[which(deep_clean_intervention_recombined_prev$water=='Dry')]),2)
# #flume_intervention_recombined_prev
# print('wet')
# round(median(flume_intervention_recombined_prev$prevalence[which(flume_intervention_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(flume_intervention_recombined_prev$prevalence[which(flume_intervention_recombined_prev$water=='Dry')]),2)
# #partial_prob_intervention_recombined_prev
# print('Wet')
# round(median(partial_prob_intervention_recombined_prev$prevalence[which(partial_prob_intervention_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(partial_prob_intervention_recombined_prev$prevalence[which(partial_prob_intervention_recombined_prev$water=='Dry')]),2)
# #connections_intervention_recombined_prev
# print('Wet')
# round(median(connections_intervention_recombined_prev$prevalence[which(connections_intervention_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(connections_intervention_recombined_prev$prevalence[which(connections_intervention_recombined_prev$water=='Dry')]),2)
# #random_prob_150pc_recombined_prev
# print('Wet')
# round(median(random_prob_150pc_recombined_prev$prevalence[which(random_prob_150pc_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(random_prob_150pc_recombined_prev$prevalence[which(random_prob_150pc_recombined_prev$water=='Dry')]),2)
# #random_prob_200pc_recombined_prev
# print('Wet')
# round(median(random_prob_200pc_recombined_prev$prevalence[which(random_prob_200pc_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(random_prob_200pc_recombined_prev$prevalence[which(random_prob_200pc_recombined_prev$water=='Dry')]),2)
# #random_prob_250pc_recombined_prev
# print('Wet')
# round(median(random_prob_250pc_recombined_prev$prevalence[which(random_prob_250pc_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(random_prob_250pc_recombined_prev$prevalence[which(random_prob_250pc_recombined_prev$water=='Dry')]),2)
#z4_prob_0pc_recombined_prev
print('Wet')
round(median(z4_prob_0pc_recombined_prev$prevalence[which(z4_prob_0pc_recombined_prev$water=='Wet')]),2)
print('Dry')
round(median(z4_prob_0pc_recombined_prev$prevalence[which(z4_prob_0pc_recombined_prev$water=='Dry')]),2)
# #crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev
# print('Wet')
# round(median(crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev$prevalence[which(crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev$prevalence[which(crate_prev_50pc_w_partial_prob_intervention_was_recombined_prev$water=='Dry')]),2)
# #crate_prev_50pc_w_connections_intervention_recombined_prev
# print('Wet')
# round(median(crate_prev_50pc_w_connections_intervention_recombined_prev$prevalence[which(crate_prev_50pc_w_connections_intervention_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(crate_prev_50pc_w_connections_intervention_recombined_prev$prevalence[which(crate_prev_50pc_w_connections_intervention_recombined_prev$water=='Dry')]),2)
# #partial_prob_intervention_was_w_connections_intervention_recombined_prev
# print('Wet')
# round(median(partial_prob_intervention_was_w_connections_intervention_recombined_prev$prevalence[which(partial_prob_intervention_was_w_connections_intervention_recombined_prev$water=='Wet')]),2)
# print('Dry')
# round(median(partial_prob_intervention_was_w_connections_intervention_recombined_prev$prevalence[which(partial_prob_intervention_was_w_connections_intervention_recombined_prev$water=='Dry')]),2)
```

```{r Concentration Averages}
#Baseline
print('wet')
round(median(log10(baseline_concs$concentration)[which(baseline_concs$water=='Wet')][!is.infinite(log10(baseline_concs$concentration)[which(baseline_concs$water=='Wet')])]),2)
print('dry')
round(median(log10(baseline_concs$concentration)[which(baseline_concs$water=='Dry')][!is.infinite(log10(baseline_concs$concentration)[which(baseline_concs$water=='Dry')])]),2)
# #random_load_1_log_red_concs
# print('wet')
# round(median(log10(random_load_1_log_red_concs$concentration)[which(random_load_1_log_red_concs$water=='Wet')][!is.infinite(log10(random_load_1_log_red_concs$concentration)[which(random_load_1_log_red_concs$water=='Wet')])]),2)
# print('dry')
# round(median(log10(random_load_1_log_red_concs$concentration)[which(random_load_1_log_red_concs$water=='Dry')][!is.infinite(log10(random_load_1_log_red_concs$concentration)[which(random_load_1_log_red_concs$water=='Dry')])]),2)
# #random_load_2_log_red_concs
# print('wet')
# round(median(log10(random_load_2_log_red_concs$concentration)[which(random_load_2_log_red_concs$water=='Wet')][!is.infinite(log10(random_load_2_log_red_concs$concentration)[which(random_load_2_log_red_concs$water=='Wet')])]),2)
# print('dry')
# round(median(log10(random_load_2_log_red_concs$concentration)[which(random_load_2_log_red_concs$water=='Dry')][!is.infinite(log10(random_load_2_log_red_concs$concentration)[which(random_load_2_log_red_concs$water=='Dry')])]),2)
# #random_load_3_log_red_concs
# print('wet')
# round(median(log10(random_load_3_log_red_concs$concentration)[which(random_load_3_log_red_concs$water=='Wet')][!is.infinite(log10(random_load_3_log_red_concs$concentration)[which(random_load_3_log_red_concs$water=='Wet')])]),2)
# print('dry')
# round(median(log10(random_load_3_log_red_concs$concentration)[which(random_load_3_log_red_concs$water=='Dry')][!is.infinite(log10(random_load_3_log_red_concs$concentration)[which(random_load_3_log_red_concs$water=='Dry')])]),2)
#z4_load_1_log_red_concs
print('wet')
round(median(log10(z4_load_1_log_red_concs$concentration)[which(z4_load_1_log_red_concs$water=='Wet')][!is.infinite(log10(z4_load_1_log_red_concs$concentration)[which(z4_load_1_log_red_concs$water=='Wet')])]),2)
print('dry')
round(median(log10(z4_load_1_log_red_concs$concentration)[which(z4_load_1_log_red_concs$water=='Dry')][!is.infinite(log10(z4_load_1_log_red_concs$concentration)[which(z4_load_1_log_red_concs$water=='Dry')])]),2)
#z4_load_2_log_red_concs
print('wet')
round(median(log10(z4_load_2_log_red_concs$concentration)[which(z4_load_2_log_red_concs$water=='Wet')][!is.infinite(log10(z4_load_2_log_red_concs$concentration)[which(z4_load_2_log_red_concs$water=='Wet')])]),2)
print('dry')
round(median(log10(z4_load_2_log_red_concs$concentration)[which(z4_load_2_log_red_concs$water=='Dry')][!is.infinite(log10(z4_load_2_log_red_concs$concentration)[which(z4_load_2_log_red_concs$water=='Dry')])]),2)
#z4_load_3_log_red_concs
print('wet')
round(median(log10(z4_load_3_log_red_concs$concentration)[which(z4_load_3_log_red_concs$water=='Wet')][!is.infinite(log10(z4_load_3_log_red_concs$concentration)[which(z4_load_3_log_red_concs$water=='Wet')])]),2)
print('dry')
round(median(log10(z4_load_3_log_red_concs$concentration)[which(z4_load_3_log_red_concs$water=='Dry')][!is.infinite(log10(z4_load_3_log_red_concs$concentration)[which(z4_load_3_log_red_concs$water=='Dry')])]),2)
# #crate_prev_75pc_concs
# round(median(log10(crate_prev_75pc_concs$concentration[which(crate_prev_75pc_concs$water=='Wet' & crate_prev_75pc_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(crate_prev_75pc_concs$concentration[which(crate_prev_75pc_concs$water=='Dry' & crate_prev_75pc_concs$concentration != 0)])),2)
# #crate_prev_50pc_concs
# round(median(log10(crate_prev_50pc_concs$concentration[which(crate_prev_50pc_concs$water=='Wet' & crate_prev_50pc_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(crate_prev_50pc_concs$concentration[which(crate_prev_50pc_concs$water=='Dry' & crate_prev_50pc_concs$concentration != 0)])),2)
# #crate_prev_25pc_concs
# round(median(log10(crate_prev_25pc_concs$concentration[which(crate_prev_25pc_concs$water=='Wet' & crate_prev_25pc_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(crate_prev_25pc_concs$concentration[which(crate_prev_25pc_concs$water=='Dry' & crate_prev_25pc_concs$concentration != 0)])),2)
# #crate_prev_0pc_concs
# print('Wet')
# round(median(log10(crate_prev_0pc_concs$concentration[which(crate_prev_0pc_concs$water=='Wet' & crate_prev_0pc_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(crate_prev_0pc_concs$concentration[which(crate_prev_0pc_concs$water=='Dry' & crate_prev_0pc_concs$concentration != 0)])),2)
# #deep_clean_intervention_concs
# print('Wet')
# round(median(log10(deep_clean_intervention_concs$concentration[which(deep_clean_intervention_concs$water=='Wet' & deep_clean_intervention_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(deep_clean_intervention_concs$concentration[which(deep_clean_intervention_concs$water=='Dry' & deep_clean_intervention_concs$concentration != 0)])),2)
# #partial_prob_intervention_concs
# print('Wet')
# round(median(log10(partial_prob_intervention_concs$concentration[which(partial_prob_intervention_concs$water=='Wet' & partial_prob_intervention_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(partial_prob_intervention_concs$concentration[which(partial_prob_intervention_concs$water=='Dry' & partial_prob_intervention_concs$concentration != 0)])),2)
# #random_prob_150pc_concs
# print('Wet')
# round(median(log10(random_prob_150pc_concs$concentration[which(random_prob_150pc_concs$water=='Wet' & random_prob_150pc_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(random_prob_150pc_concs$concentration[which(random_prob_150pc_concs$water=='Dry' & random_prob_150pc_concs$concentration != 0)])),2)
# #random_prob_200pc_concs
# print('Wet')
# round(median(log10(random_prob_200pc_concs$concentration[which(random_prob_200pc_concs$water=='Wet' & random_prob_200pc_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(random_prob_200pc_concs$concentration[which(random_prob_200pc_concs$water=='Dry' & random_prob_200pc_concs$concentration != 0)])),2)
# #random_prob_250pc_concs
# print('Wet')
# round(median(log10(random_prob_250pc_concs$concentration[which(random_prob_250pc_concs$water=='Wet' & random_prob_250pc_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(random_prob_250pc_concs$concentration[which(random_prob_250pc_concs$water=='Dry' & random_prob_250pc_concs$concentration != 0)])),2)
# #z4_prob_0pc_concs
# print('Wet')
# round(median(log10(z4_prob_0pc_concs$concentration[which(z4_prob_0pc_concs$water=='Wet' & z4_prob_0pc_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(z4_prob_0pc_concs$concentration[which(z4_prob_0pc_concs$water=='Dry' & z4_prob_0pc_concs$concentration != 0)])),2)
# #prob_intervention_concs
# print('Wet')
# round(median(log10(prob_intervention_concs$concentration[which(prob_intervention_concs$water=='Wet' & prob_intervention_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(prob_intervention_concs$concentration[which(prob_intervention_concs$water=='Dry' & prob_intervention_concs$concentration != 0)])),2)
# #partial_prob_intervention_concs
# print('Wet')
# round(median(log10(partial_prob_intervention_concs$concentration[which(partial_prob_intervention_concs$water=='Wet' & partial_prob_intervention_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(partial_prob_intervention_concs$concentration[which(partial_prob_intervention_concs$water=='Dry' & partial_prob_intervention_concs$concentration != 0)])),2)
# #connections_intervention_concs
# print('Wet')
# round(median(log10(connections_intervention_concs$concentration[which(connections_intervention_concs$water=='Wet' & connections_intervention_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(connections_intervention_concs$concentration[which(connections_intervention_concs$water=='Dry' & connections_intervention_concs$concentration != 0)])),2)
# #crate_prev_50pc_w_partial_prob_intervention_was_concs
# print('Wet')
# round(median(log10(crate_prev_50pc_w_partial_prob_intervention_was_concs$concentration[which(crate_prev_50pc_w_partial_prob_intervention_was_concs$water=='Wet' & crate_prev_50pc_w_partial_prob_intervention_was_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(crate_prev_50pc_w_partial_prob_intervention_was_concs$concentration[which(crate_prev_50pc_w_partial_prob_intervention_was_concs$water=='Dry' & crate_prev_50pc_w_partial_prob_intervention_was_concs$concentration != 0)])),2)
# #crate_prev_50pc_w_connections_intervention_concs
# print('Wet')
# round(median(log10(crate_prev_50pc_w_connections_intervention_concs$concentration[which(crate_prev_50pc_w_connections_intervention_concs$water=='Wet' & crate_prev_50pc_w_connections_intervention_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(crate_prev_50pc_w_connections_intervention_concs$concentration[which(crate_prev_50pc_w_connections_intervention_concs$water=='Dry' & crate_prev_50pc_w_connections_intervention_concs$concentration != 0)])),2)
# #partial_prob_intervention_was_w_connections_intervention_concs
# print('Wet')
# round(median(log10(partial_prob_intervention_was_w_connections_intervention_concs$concentration[which(partial_prob_intervention_was_w_connections_intervention_concs$water=='Wet' & partial_prob_intervention_was_w_connections_intervention_concs$concentration != 0)])),2)
# print('Dry')
# round(median(log10(partial_prob_intervention_was_w_connections_intervention_concs$concentration[which(partial_prob_intervention_was_w_connections_intervention_concs$water=='Dry' & partial_prob_intervention_was_w_connections_intervention_concs$concentration != 0)])),2)
```

```{r Get Agent Contamination Probabilities}
agents$zone_item[which(0.66<=agents$prob_contamination & agents$prob_contamination<=0.99)]
agents$zone_item[which(0.33<=agents$prob_contamination & agents$prob_contamination<=0.65)]
agents$zone_item[which(0.00<=agents$prob_contamination & agents$prob_contamination<=0.32)]
```

```{r}
wet_plot <- ggplot(rbind(baseline_recombined_prev,crate_prev_75pc_recombined_prev,crate_prev_50pc_recombined_prev,crate_prev_25pc_recombined_prev,crate_prev_0pc_recombined_prev)[which(rbind(baseline_recombined_prev,crate_prev_75pc_recombined_prev,crate_prev_50pc_recombined_prev,crate_prev_25pc_recombined_prev,crate_prev_0pc_recombined_prev)$water=="Wet"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#0C7BDC")) +
  scale_x_discrete(labels = c("Baseline", "25% Reduction", "50% Reduction","75% Reduction","100% Reduction")) +
  theme(axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_recombined_prev,crate_prev_75pc_recombined_prev,crate_prev_50pc_recombined_prev,crate_prev_25pc_recombined_prev,crate_prev_0pc_recombined_prev)[which(rbind(baseline_recombined_prev,crate_prev_75pc_recombined_prev,crate_prev_50pc_recombined_prev,crate_prev_25pc_recombined_prev,crate_prev_0pc_recombined_prev)$water=="Dry"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('B') +
  scale_fill_manual(values=c("#FFC20A")) +
  scale_x_discrete(labels = c("Baseline", "25% Reduction", "50% Reduction","75% Reduction","100% Reduction")) +
  theme(axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "B", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))

wet_plot <- ggplot(rbind(baseline_recombined_prev,red_3_log_imp_recombined_prev,deep_clean_intervention_recombined_prev)[which(rbind(baseline_recombined_prev,red_3_log_imp_recombined_prev,deep_clean_intervention_recombined_prev)$water=="Wet"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('A') +
  scale_fill_manual(values=c("#0C7BDC")) +
  scale_x_discrete(labels = c("Baseline", "Improved Performance", "Deep Cleaning")) +
  theme(axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_recombined_prev,red_3_log_imp_recombined_prev,deep_clean_intervention_recombined_prev)[which(rbind(baseline_recombined_prev,red_3_log_imp_recombined_prev,deep_clean_intervention_recombined_prev)$water=="Dry"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('A') +
  scale_fill_manual(values=c("#FFC20A")) +
  scale_x_discrete(labels = c("Baseline", "Improved Performance", "Deep Cleaning")) +
  theme(axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "B", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))

wet_plot <- ggplot(rbind(baseline_recombined_prev,flume_intervention_recombined_prev,prob_intervention_recombined_prev,partial_prob_intervention_recombined_prev,connections_intervention_recombined_prev)[which(rbind(baseline_recombined_prev,flume_intervention_recombined_prev,prob_intervention_recombined_prev,partial_prob_intervention_recombined_prev,connections_intervention_recombined_prev)$water=="Wet"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('A') +
  scale_fill_manual(values=c("#0C7BDC")) +
  scale_x_discrete(labels = c("Baseline", "Flume Water Treatment", "Full Reorganization", "Partial Reorganization", "Connection Change")) +
  theme(axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  plot.margin=unit(c(0,0,0,0), "cm"))
dry_plot <- ggplot(rbind(baseline_recombined_prev,flume_intervention_recombined_prev,prob_intervention_recombined_prev,partial_prob_intervention_recombined_prev,connections_intervention_recombined_prev)[which(rbind(baseline_recombined_prev,flume_intervention_recombined_prev,prob_intervention_recombined_prev,partial_prob_intervention_recombined_prev,connections_intervention_recombined_prev)$water=="Dry"),], aes(x=scenario, y=prevalence, fill=water)) +
  geom_boxplot() +
  xlab('') +
  ylab('') +
  ylim(0,100) +
  theme(legend.position = "none") +
  # ggtitle('A') +
  scale_fill_manual(values=c("#FFC20A")) +
  scale_x_discrete(labels = c("Baseline", "Flume Water Treatment", "Full Reorganization", "Partial Reorganization", "Connection Change")) +
  theme(axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1, face = "plain"),
  axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
  axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y=element_blank(),
  axis.ticks.y=element_blank(),
  plot.margin=unit(c(0,0,0,-1), "cm"))
figure <- ggarrange(wet_plot, dry_plot)
annotate_figure(figure,fig.lab = "B", fig.lab.face = "bold",
                bottom = text_grob("Scenario", size = 20, y = 1,))
```